<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Vip Â· Segment</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="description" content="å‘½ç†å¿ƒæ€œç©ºé—´ Â· å…è´¹ä½“éªŒåŒºä¸VIPä¸“åŒºï¼šå…«å­—ã€å æ˜Ÿã€çµæ•°ã€å¡”ç½—ã€ä¹æ˜Ÿæ°”å­¦ã€èƒ½é‡ç±»å‹ç­‰ï¼Œä¸€ç«™å¼çµæ€§ä¸å‘½ç†ä½“éªŒã€‚">
  <meta property="og:title" content="å‘½ç†å¿ƒæ€œç©ºé—´ Â· Soul Sanctuary">
  <meta property="og:description" content="å…è´¹ä½“éªŒåŒºä¸VIPä¸“åŒºï¼šå…«å­—ã€å æ˜Ÿã€çµæ•°ã€å¡”ç½—ã€ä¹æ˜Ÿæ°”å­¦ã€èƒ½é‡ç±»å‹ç­‰ã€‚">
  <meta property="og:type" content="website">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600&family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b0f14; --card:#11161dCC; --line:#1f2a36; --text:#e8edf3; --muted:#98a7b7;
      --brand:#d4af37; --accent:#58b9ff; --radius:14px; --shadow:0 8px 30px rgba(0,0,0,.35); --blur:10px;
    }
    html,body{height:100%} html{font-size:16px}
    @media(min-width:768px){ html{font-size:17px} } @media(min-width:1200px){ html{font-size:18px} }
    body{
      margin:0; color:var(--text);
      background: radial-gradient(1200px 600px at 70% -10%, #16202b 10%, transparent 60%) no-repeat,
                  linear-gradient(180deg,#0b0f14,#0b0f14);
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans SC", Arial, sans-serif;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }
    body::before{
      content:""; position:fixed; inset:0; z-index:-2;
      background:url('assets/images/gate.jpg') center/cover no-repeat;
      filter:brightness(.45) saturate(.9) blur(2px);
    }
    .glow{position:fixed; inset:auto auto 10% -10%; width:45vw; height:45vw; max-width:700px; max-height:700px;
      background:radial-gradient(closest-side, #2a98ff33, transparent 70%); filter:blur(30px); z-index:-1; pointer-events:none;}
    .container{width:100%; max-width:1100px; padding:24px 16px 80px; margin:0 auto;}
    header{position:sticky; top:0; z-index:10; backdrop-filter:saturate(140%) blur(12px);
      background:#0b0f14cc; border-bottom:1px solid #0f1622;}
    .head-inner{display:flex; align-items:center; justify-content:space-between; gap:14px; padding:16px}
    .brand{display:flex; align-items:center; gap:12px}
    .brand-badge{width:36px; height:36px; border-radius:10px; background:linear-gradient(145deg,#273243,#0e141c);
      display:grid; place-items:center; color:var(--brand); font-weight:700; box-shadow:var(--shadow)}
    .title{font-family:"Noto Serif SC","Noto Serif",serif; font-weight:600; letter-spacing:.02em; font-size:1.1rem}
    .subtitle{color:var(--muted); font-size:.9rem}

    /* è¯­è¨€é€‰æ‹©å™¨ */
    .lang{display:flex; align-items:center; gap:8px}
    .lang label{color:var(--muted); font-size:.9rem}
    .lang select{
      appearance:none; border-radius:10px; border:1px solid #243244; background:#0e1520; color:var(--text);
      padding:10px 34px 10px 12px; font-size:.95rem;
      background-image:url("data:image/svg+xml,%3Csvg width='12' height='8' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%2398a7b7' stroke-width='2' fill='none'/%3E%3C/svg%3E");
      background-repeat:no-repeat; background-position:calc(100% - 12px) 50%;
    }

    .section{margin-top:18px}
    .card{background:var(--card); border:1px solid var(--line); border-radius:var(--radius);
      box-shadow:var(--shadow); backdrop-filter: blur(var(--blur)); padding:18px;}
    .grid-links{display:grid; gap:12px; grid-template-columns:repeat(1,1fr)}
    @media(min-width:640px){ .grid-links{grid-template-columns:repeat(2,1fr)} }
    @media(min-width:980px){ .grid-links{grid-template-columns:repeat(3,1fr)} }
    .link-card{display:flex; align-items:center; justify-content:center; text-align:center; padding:16px 12px;
      border:1px solid #263448; background:#0e1520; border-radius:12px; text-decoration:none; color:var(--text);
      transition:transform .05s ease, box-shadow .2s ease;}
    .link-card:hover{box-shadow:0 6px 18px rgba(88,185,255,.15)}
    .group-title{font-size:1.05rem; color:#ffe084; margin:6px 0 14px}

    .row{display:grid; gap:12px}
    @media(min-width:640px){ .row{grid-template-columns:1fr 1fr 1fr} }
    input,button{
      width:100%; box-sizing:border-box; border-radius:12px; border:1px solid #243244;
      background:#0e1520; color:var(--text); padding:14px 13px; font-size:1rem; outline:none;
    }
    input::placeholder{color:#6f8092}
    .btn{background:linear-gradient(180deg,#1d2a3a,#101723); border:1px solid #28364a; font-weight:600; letter-spacing:.02em; cursor:pointer}
    .btn:hover{box-shadow:0 6px 18px rgba(88,185,255,.15), inset 0 1px 0 #2e3c50}
    .btn[disabled]{opacity:.6; cursor:not-allowed}
    .btn-gold{background:linear-gradient(180deg,#f7e7a8,#d4af37); color:#191919; border:1px solid #d4af37}

    .columns{display:grid; gap:12px; grid-template-columns:1fr}
    @media(min-width:900px){ .columns{grid-template-columns:1fr 1fr} }
    .list-block{border:1px solid #263448; background:#0e1520; border-radius:12px; padding:16px}
    .list-block ul{margin:.2rem 0 0; padding-left:1.1rem}
    .muted{color:var(--muted)} .error{color:#ff8f8f; margin-top:8px}
    footer{color:#6c7b8c; font-size:.85rem; text-align:center; padding:30px 0}

    /* Chat æµ®çª— */
    .ss-chat-fab{
      position: fixed; right: 18px; bottom: 18px; z-index: 50;
      width: 56px; height: 56px; border-radius: 50%;
      background: linear-gradient(180deg,#f7e7a8,#d4af37); color:#191919;
      display:grid; place-items:center; font-weight:800; box-shadow:0 8px 30px rgba(0,0,0,.35); cursor:pointer;
      border:1px solid #d4af37;
    }
    .ss-chat-panel{
      position: fixed; right: 18px; bottom: 90px; z-index: 50;
      width: min(380px, 92vw); max-height: 70vh; display:none; flex-direction: column;
      background: #0e1520f2; backdrop-filter: blur(12px);
      border:1px solid #263448; border-radius: 14px; box-shadow: 0 8px 30px rgba(0,0,0,.35);
    }
    .ss-chat-head{
      padding: 12px 14px; border-bottom:1px solid #1f2a36; display:flex; align-items:center; justify-content:space-between;
    }
    .ss-chat-title{ color:#ffe084; font-weight:700 }
    .ss-chat-body{ padding: 12px; overflow:auto; display:flex; flex-direction:column; gap:10px }
    .ss-msg{ padding:10px 12px; border:1px solid #243244; border-radius: 12px; background:#0b1018; color:#e8edf3; max-width: 85% }
    .ss-msg.me{ margin-left:auto; background:#111a2a; border-color:#2f3e53 }
    .ss-chat-input{ display:flex; gap:8px; padding:12px; border-top:1px solid #1f2a36 }
    /* Fix: override global widths for chat controls */
    .ss-chat-input input, .ss-chat-input button { width:auto; }
    .ss-chat-input input{
      flex:1; min-height:48px; font-size:1rem; color:#e8edf3; caret-color:#e8edf3;
      border-radius:12px; border:1px solid #243244; background:#0e1520; padding:12px;
    }
    .ss-chat-input input::placeholder{ color:#8ea0b5 }
    .ss-chat-input button{
      min-height:48px; border-radius:12px; padding:0 16px;
      background:linear-gradient(180deg,#1d2a3a,#101723); color:#e8edf3; border:1px solid #28364a; cursor:pointer;
      white-space:nowrap;
    }
    .ss-close{ color:#98a7b7; cursor:pointer }
    /* ===== åŸºç¡€è‰²ç³» ===== */
  :root{
    --gold:#d4af37; --gold2:#f2d27a; --txt:#e8ecf4; --muted:#9aa3b2;
    --panel:rgba(255,255,255,.02); --border:rgba(212,175,55,.22); --radius:14px;
  }
  body{
    background: radial-gradient(1200px 800px at 50% 0%, #111a2b 0%, #0b0f17 38%, #070a11 100%) fixed;
    color:#e6e9ef;
  }
  /* ===== æ— éšœç¢éšè—æ–‡å­— ===== */
  .sr-only{position:absolute !important; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); border:0;}

  /* ===== å¤–å±‚å¡ç‰‡ ===== */
  .astro-auth{
    max-width: 980px; margin: 28px auto; padding: 20px 18px;
    background: linear-gradient(180deg, var(--panel), rgba(255,255,255,.01));
    border: 1px solid var(--border); border-radius: var(--radius);
    box-shadow: 0 18px 50px rgba(0,0,0,.35);
  }

  /* ===== æ …æ ¼ï¼šæ¡Œé¢åŒæ  / æ‰‹æœºå•æ  ===== */
  .auth-grid{
    display:grid; gap:18px;
    grid-template-columns: 1.2fr .8fr; /* å·¦å®½å³çª„ */
  }
  @media (max-width: 860px){
    .auth-grid{ grid-template-columns: 1fr; }
  }

  /* ===== é¢æ¿ ===== */
  .panel{
    background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01));
    border:1px solid var(--border);
    border-radius: var(--radius);
    box-shadow: 0 10px 30px rgba(0,0,0,.35);
  }
  .panel .head{
    padding:16px 18px; border-bottom:1px solid var(--border);
    color:var(--gold); font-weight:700; letter-spacing:.3px;
  }
  .panel .body{ padding:18px; }

  /* ===== è¡Œå¸ƒå±€ ===== */
  .row{ display:grid; grid-template-columns: 1fr 1fr; gap:12px; }
  .row.one{ grid-template-columns: 1fr; }
  .row.center{ align-items:center; }
  @media (max-width:640px){ .row{ grid-template-columns: 1fr; } }

  /* ===== è¾“å…¥æ¡† ===== */
  .astro-auth input[type="email"],
  .astro-auth input[type="password"]{
    width:100%; background:#0f1522; color:#eaf0ff;
    border:1px solid rgba(212,175,55,.28); border-radius:10px;
    padding:13px 12px; outline:none; transition:.18s;
  }
  .astro-auth input:focus{
    border-color:var(--gold2); box-shadow:0 0 0 3px rgba(212,175,55,.2);
  }

  /* ===== æŒ‰é’® ===== */
  .btn{
    display:inline-grid; place-items:center; text-decoration:none;
    padding:13px 16px; border-radius:12px; border:0; cursor:pointer;
    font-weight:600; letter-spacing:.3px;
    background:linear-gradient(180deg, var(--gold2), var(--gold)); color:#231a04;
    box-shadow:0 6px 18px rgba(212,175,55,.3); transition:.15s;
  }
  .btn:hover{ transform:translateY(-1px); box-shadow:0 10px 22px rgba(212,175,55,.35); }
  .btn.btn-gold{ background:linear-gradient(180deg, var(--gold2), var(--gold)); color:#231a04; }
  .btn.ghost{
    background:transparent; color:var(--gold2);
    border:1px solid rgba(212,175,55,.45); box-shadow:none;
  }
/* block æŒ‰é’®åŸºå‡† */
.btn.block {
  display: block;        /* æ™®é€šå—çº§å³å¯ */
  width: 100%;           /* å æ»¡çˆ¶å®¹å™¨ */
  max-width: 100%;       /* ä¸å…è®¸è¶…å‡º */
  box-sizing: border-box;/* è®¡ç®—è¾¹æ¡†å†…æ”¶ */
}

/* å¦‚æœè¦åœ¨ .row.one é‡Œå¼ºåˆ¶è¦†ç›– inline-grid */
.row.one .btn.block {
  display: block !important; /* å¼ºåˆ¶è¦†ç›–ï¼Œé¿å… inline-grid æ ·å¼æ®‹ç•™ */
}

/* ä¿è¯æŒ‰é’®åœ¨ panel å†…å±…ä¸­ */
.panel .body .btn.block {
  margin-left: auto;
  margin-right: auto;
}

  /* ===== è¯´æ˜ä¸é”™è¯¯ ===== */
  .muted{ color:var(--muted); font-size:13px; line-height:1.6; }
  .error{ color:#ffb4b4; background:rgba(255,0,0,.08); border:1px solid rgba(255,0,0,.25);
          padding:10px 12px; border-radius:10px; }
  .spacer{ height:12px; }
</style>
</head>
<body>
    <h1>ğŸŒ™ å‘½ç†ç©ºé—´ Â· Astro Sanctuary</h1>
    <div class="container1">
    <h1>å‘½ç†åˆ†æ</h1>
    <form action="/secure/report.html" method="GET">
      <label for="type">å‘½ç›˜ç±»å‹</label>
      <select id="type" name="type" onchange="togglePartner(this.value)" class="form-control">
        <option value="personal">ä¸ªäººå‘½ç›˜</option>
        <option value="compatibility">åˆç›˜ï¼ˆä¸¤äººèµ„æ–™ï¼‰</option>
      </select>

      <label for="name1">å§“åï¼ˆæœ¬äººï¼‰</label>
      <input type="text" id="name1" name="name1" required class="form-control">

      <label for="birthdate1">å‡ºç”Ÿæ—¥æœŸ Birthdate</label>
      <input type="date" id="birthdate1" name="birthdate1" required class="form-control">

      <label for="calendar1">å†æ³•é€‰æ‹© Calendar</label>
      <select id="calendar1" name="calendar1" class="form-control">
        <option value="é˜³å†">é˜³å† (Gregorian)</option>
        <option value="å†œå†">å†œå† (Lunar)</option>
      </select>

      <label for="birthtime1">å‡ºç”Ÿæ—¶é—´ Birth Time</label>
      <input type="time" id="birthtime1" name="birthtime1" class="form-control">

      <label for="country1">å‡ºç”Ÿå›½å®¶ / åœ°åŒº Country</label>
      <input type="text" id="country1" name="country1" required class="form-control">

      <label for="culture">å‘½ç†å®—æ•™æ–¹å‘ System Direction</label>
      <select id="culture" name="culture" class="form-control">
        <option value="auto">è‡ªåŠ¨è¯†åˆ« Auto Detect</option>
        <option value="ä¸œæ–¹">ä¸œæ–¹ Chinese / Bazi</option>
        <option value="è¥¿æ–¹">è¥¿æ–¹ Astrology / Tarot</option>
        <option value="æ—¥å¼">æ—¥å¼ä¹æ˜Ÿ Japanese</option>
        <option value="å é™€">å°åº¦å é™€ Vedic</option>
      </select>

      <div id="partner-section" style="display: none;">
        <hr style="margin:30px 0; border-color:#ffd700;">
        <h3>ç¬¬äºŒäººèµ„æ–™ï¼ˆåˆç›˜ä¸“ç”¨ï¼‰</h3>
        <label for="name2">å§“åï¼ˆç¬¬äºŒäººï¼‰</label>
        <input type="text" id="name2" name="name2" class="form-control">
        <label for="birthdate2">å‡ºç”Ÿæ—¥æœŸ</label>
        <input type="date" id="birthdate2" name="birthdate2" class="form-control">
        <label for="calendar2">å†æ³•é€‰æ‹©</label>
        <select id="calendar2" name="calendar2" class="form-control">
          <option value="é˜³å†">é˜³å† (Gregorian)</option>
          <option value="å†œå†">å†œå† (Lunar)</option>
        </select>
        <label for="birthtime2">å‡ºç”Ÿæ—¶é—´</label>
        <input type="time" id="birthtime2" name="birthtime2" class="form-control">
        <label for="country2">å‡ºç”Ÿå›½å®¶ / åœ°åŒº</label>
        <input type="text" id="country2" name="country2" class="form-control">
      </div>

      <label for="purpose">å‘½ç†é€‰é¢˜ Report Focus</label>
      <select id="purpose_personal" name="purpose" class="form-control">
        <optgroup label="å§»ç¼˜ Love">
          <option value="æ‹çˆ±ç¼˜åˆ†">æ‹çˆ±ç¼˜åˆ†</option>
          <option value="å©šå§»èµ°åŠ¿">å©šå§»èµ°åŠ¿</option>
        </optgroup>
        <optgroup label="äº‹ä¸š Career">
          <option value="èŒåœºå‘å±•">èŒåœºå‘å±•</option>
          <option value="åˆ›ä¸šæ½œåŠ›">åˆ›ä¸šæ½œåŠ›</option>
        </optgroup>
        <optgroup label="è´¢è¿ Wealth">
          <option value="è´¢ä½åˆ†æ">è´¢ä½åˆ†æ</option>
          <option value="ç†è´¢æ—¶æœº">ç†è´¢æ—¶æœº</option>
        </optgroup>
        <optgroup label="æ‹©æ—¥ Auspicious Date">
          <option value="å©šæœŸæ‹©æ—¥">å©šæœŸæ‹©æ—¥</option>
          <option value="æ–°ç”Ÿå®å®æ‹©æ—¥">æ–°ç”Ÿå®å®æ‹©æ—¥</option>
          <option value="æ–°å®¶å…¥ä½æ‹©æ—¥">æ–°å®¶å…¥ä½æ‹©æ—¥</option>
          <option value="æ–°å…¬å¸å…¥ä½æ‹©æ—¥">æ–°å…¬å¸å…¥ä½æ‹©æ—¥</option>
        </optgroup>
        <optgroup label="æµ‹å Name Analysis">
          <option value="å®å®å">å®å®å</option>
          <option value="å® ç‰©å">å® ç‰©å</option>
          <option value="å…¬å¸å">å…¬å¸å</option>
          <option value="å‘½åæ”¹è¿">å‘½åæ”¹è¿</option>
        </optgroup>
        <optgroup label="é£æ°´ Feng Shui">
          <option value="ä½å®¶">ä½å®¶</option>
          <option value="åŠå…¬å®¤">åŠå…¬å®¤</option>
        </optgroup>
      </select>

      <select id="purpose_compatibility" name="purpose" style="display:none;" class="form-control">
        <optgroup label="åˆç›˜åˆ†æ Compatibility">
          <option value="ç¼˜åˆ†èµ·è½">æƒ…ä¾£åˆç›˜ï¼ˆç¼˜åˆ†èµ·è½ / æš§æ˜§è¿›å±•ï¼‰</option>
          <option value="å¤«å¦»æµå¹´">å¤«å¦»æµå¹´ï¼ˆå©šå§»å‘å±•ï¼‰</option>
          <option value="åˆç›˜åˆ†æ">ä¸ªæ€§åˆç›˜ï¼ˆå†²çª / äº’è¡¥ï¼‰</option>
          <option value="äº‹ä¸šå…±äº‹">äº‹ä¸šåˆç›˜ï¼ˆåˆä¼™äºº / å‘˜å·¥ï¼‰</option>
          <option value="æ–­è”ä¿®å¤">æ–­è”ä¿®å¤ï¼ˆæœ‹å‹ / æƒ…äºº / å®¶äººï¼‰</option>
          <option value="å® ç‰©ç¼˜åˆ†">å® ç‰©åˆç›˜ï¼ˆä¸»äººä¸å® ç‰©ï¼‰</option> 
        </optgroup>
      </select>

      <button type="submit">ç”ŸæˆæŠ¥å‘Š Generate Report</button>
    </form>
  </div>
<br>
  <div>
    <br>
    <div class="container">
    <h1>ğŸŒ™ å¿ƒæ€œç©ºé—´ Â· Soul Sanctuary</h1>
    <div class="vip-section">
      <h2>ğŸ§˜â€â™€ï¸ çµæ€§æ—¥è®°</h2>
      <ul>
        <li>ç…§ç‰‡ä¸Šä¼ ï¼šè®°å½•ç¥åœ£æ—¶åˆ»ä¸å®¶æ—ç”Ÿæ´»</li>
        <li>è¯­éŸ³è®°å½•ï¼šç¥ˆç¥·ã€æ¢¦å¢ƒæè¿°ã€äº²äººå£°éŸ³</li>
        <li>çµæ€§ç¬”è®°ï¼šå†…åœ¨æ„Ÿåº”ã€æ¢¦å¢ƒè§£æã€èƒ½é‡è®°å½•</li>
        <li>è®°äº‹æœ¬ï¼šå®¶åº­æˆå‘˜å…±äº«æ—¥å¿—</li>
        <li>æ„¿æœ›ç¥ˆç¥·ï¼šæ’°å†™æ„¿æœ›ï¼Œé€‰å®šç¥æ˜ï¼Œæ¯æ—¥è‡ªåŠ¨åŠ æŒ</li>
      </ul>
      <br>
      <button onclick="window.location.href='personal_memory.html'">ä¸ªäººéšè—è®°å½• / Personal Memory</button>
      <button onclick="window.location.href='family_memory.html'">å®¶åº­å…±äº«è®°å½• / Family Memory</button>
      <button onclick="window.location.href='memory_upload.html'">ä¸Šä¼ è®°å½• / Submit Memory</button>
    </div>

    <div class="vip-section">
      <h2>ğŸ“˜ å‘½ç†è¯¾ç¨‹ä¸“åŒº</h2>
<ul>
  <li>å…«å­—å‘½ç†ï¼šåç¥ / æµå¹´ / ç”¨ç¥åˆ†æ</li>
  <li>å¡”ç½—ç‰Œï¼šç‰Œé˜µè§£è¯» / æƒ…å¢ƒå®æˆ˜</li>
</ul>

<h4 style="margin-top:25px;color:#d4af37;">ğŸŒ™ ä»¥ä¸‹è¯¾ç¨‹å°šåœ¨é…é…¿ä¸­ï¼š</h4>
<ul style="opacity:0.7;">
  <li>å æ˜Ÿå­¦ï¼šæœ¬å‘½ç›˜ / åˆç›˜ / è¡Œè¿æ¨æ¼”</li>
  <li>çµæ•°ç³»ç»Ÿï¼šç”Ÿå‘½è·¯å¾„ / çµé­‚è“å›¾</li>
  <li>äººç±»å›¾ Human Design</li>
  <li>å…­çˆ»å åœè¯¾ç¨‹</li>
  <li>å†¥æƒ³å¼•å¯¼è¯¾ç¨‹</li>
  <li>å¥‡é—¨éç”²è¯¾ç¨‹</li>
  <li>æ—¥å¼ç¥æ˜ä¿¡ä»°ãƒ»ç¥ç¤¾å·¡ç¤¼</li>
  <li>ç´«å¾®æ–—æ•°</li>
  <li>èƒ½é‡å­¦è¯¾ç¨‹</li>
  <li>è¥¿æ´‹å æ˜ŸåŸºç¡€è¯¾ç¨‹</li>
  <li>å¿ƒçµè¯¾ç¨‹</li>
</ul>

<p style="margin-top:10px;color:#aaa;font-size:0.9rem;">
âœ¨ è¿™äº›è¯¾ç¨‹æ­£é™å€™æ—¶æœºï¼Œå°†äºæœªæ¥é™†ç»­å¼€æ”¾ï¼Œæ¬¢è¿åŠ å…¥ç­‰å€™ä¸ç¥ˆæ„¿æ¸…å• ğŸŒ±
</p>
      <br>
      <button onclick="window.location.href='soul_integration_course.html'">è¿›å…¥ / Enter</button>      
    </div>

    <div class="vip-section">
      <h2>ğŸ›ï¸ èƒ½é‡å•†åŸ Â· VIPæŠ˜æ‰£ & å¾¡å®ˆè®¢åˆ¶</h2>
      <ul>
        <li>ä¸“å±ç¥ˆæ„¿åŒ…åˆ†ç±»ï¼š</li>
        <ul class="sub-list">
          <li><a href="é˜´å€ºå’Œè§£åŒ….html">é˜´å€ºå’Œè§£åŒ…</a></li>
          <li><a href="è´¢åº“åŒ….html">è´¢åº“åŒ…</a></li>
          <li><a href="çµé­‚å¼€æ‚Ÿçš„æŒ‡å¼•åŒ….html">å¿ƒçµåŒ…</a></li>
          <li><a href="è´¢è¿åŒ….html">è´¢è¿åŒ…</a></li> 
          <li><a href="å§»ç¼˜åŒ….html">å§»ç¼˜åŒ…</a></li>
          <li><a href="å­¦ä¸šåŒ….html">å­¦ä¸šåŒ…</a></li>
          <li><a href="äº‹ä¸šåŒ….html">äº‹ä¸šåŒ…</a></li>
          <li><a href="å¾¡å®ˆåŒ….html">å¾¡å®ˆåŒ…</a></li>
          <li><a href="å¤ªå²åŒ….html">å¤ªå²åŒ…</a></li>
          <li><a href="ä¸ƒæœˆåŒ….html">ä¸ƒæœˆåŒ…</a></li>
          <li><a href="å®¶æ—ç¦æŠ¥åŒ….html">å®¶æ—ç¦æŠ¥åŒ…</a></li>
          <li><a href="æƒ…ä¼¤ç–—æ„ˆåŒ….html">æƒ…ä¼¤ç–—æ„ˆåŒ…</a></li>
          <li><a href="åŠ«éš¾åŒ….html">åŠ«éš¾åŒ…</a></li>
          <li><a href="æ–°å®…åŠå…¬å®¤åŒ….html">æ–°å®… / åŠå…¬å®¤åŒ…</a></li>      
        </ul>
        <li>æ¯ä½ä¼šå‘˜å¯è®¢åˆ¶ä¸“å±å¾¡å®ˆæŠ¥å‘Š + å¼€è¿å»ºè®®</li>
      </ul>
    </div>

    <div class="vip-section">
      <h2>ğŸ”® æ¢¦æƒ³æäº¤ Dream Submission</h2>
      <ul>
        <li>æ¢¦æƒ³ç±»å‹ï¼šæ ¹æ®æ¢¦æƒ³ç±»å‹å¼•å¯¼å’Œæ¨åŠ¨</li>
      </ul>
      <br>
      <button onclick="window.location.href='wish_submission.html'">æ¢¦æƒ³è§„åˆ’ / Dream Manifestation</button>      
    </div>
    
    <div class="vip-section">
      <h2>ğŸ“– çµæ€§ç©ºé—´ ~ å¾€ç”Ÿè®°æ€œå½•</h2>
      <ul>
        <li>è®°å½•å·²è¿‡ä¸–äº²äººçš„çµé­‚æ¡£æ¡ˆ</li>
        <li>çºªå¿µå›å¿†ï¼šç…§ç‰‡ / è¯­éŸ³ / æ–‡å­—è¿½æ€å…¨å­˜æ¡£</li>
        <li>çµæ€§å»¶ç»­ï¼šä¸€é”®è½¬ä¸ºçºªå¿µçŠ¶æ€ï¼Œä¼ æ‰¿åŠŸå¾·</li>
      </ul>
      <br>
      <button onclick="window.location.href='login_memorial.html'">ç™»å…¥çµæ€§ç©ºé—´ / Login Memorial</button>  
      <button onclick="window.location.href='upload_memorial.html'">ä¸Šä¼ å¾€ç”Ÿå½• / Upload Memorial</button> 
      <button onclick="window.location.href='register_soul_memorial.html'">æ³¨å†Œçµæ€§ç©ºé—´ / Register Soul Memorial</button>   
    </div>
    
    <footer>
      å¿ƒæ€œç©ºé—´ Â· çµé­‚æˆé•¿ Ã— å®¶æ—å»¶ç»­ Ã— çµæ€§ååŠ©<br/>
      All content Â© VIP Sanctuary 2025
    </footer>
  </div>
<script>
  // ============== ç»Ÿä¸€é…ç½®ï¼ˆä½ çš„ Worker åŸŸåï¼‰ ==============
  const API_BASE = 'https://throbbing-lab-1440.hello5xliving.workers.dev'; // â† æ”¹æˆä½ çš„ Workers.dev

  // å·¥å…·å‡½æ•°
  const $ = id => document.getElementById(id);
  function showErr(msg){ const e=$("error"); e.textContent=msg; e.style.display="block"; setTimeout(()=>{e.style.display='none'},5000); }
  function hideErr(){ const e=$("error"); e.style.display="none"; e.textContent=""; }
  function lock(el, v){ if(el) el.disabled = v; }
  function strongPwd(pw){
    return pw.length>=8 && /[A-Z]/.test(pw) && /[a-z]/.test(pw) && /[0-9]/.test(pw) && /[^A-Za-z0-9]/.test(pw);
  }

  // ============== å¤šè¯­è¨€ ==============
  const LANG_KEY = "site_lang";
  function getLang(){ return localStorage.getItem(LANG_KEY) || document.documentElement.lang || "zh-CN"; }

  // ï¼ˆä¿ç•™ä½ åŸæ¥çš„ç¿»è¯‘è¡¨ï¼Œæˆ‘è¿™é‡Œæ˜¯å®Œæ•´ä¸€ä»½ï¼ŒåŒ…å« chat_fab/chat_placeholder/chat_sendï¼‰
  const translations = {
    "zh-CN": {
      page_title:"å‘½ç†å¿ƒæ€œç©ºé—´ Â· Index",
      site_title:"å‘½ç†å¿ƒæ€œç©ºé—´ Â· Soul Sanctuary",
      site_subtitle:"å…è´¹ä½“éªŒ & ä¼šå‘˜ä¸“åŒº Â· ç»Ÿä¸€é£æ ¼ç‰ˆ",
      lang_label:"è¯­è¨€",
      free_title:"ğŸŒ€ å…è´¹ä½“éªŒåŒº Free Segment",
      link_bazi:"å…«å­—å‘½ç†åˆ†æ", link_natal:"æœ¬å‘½æ˜Ÿç›˜åˆ†æ", link_life:"çµæ•°åˆ†æ",
      link_tarot:"å¡”ç½—æŒ‡å¼•åˆ†æ", link_kyuusei:"ä¹æ˜Ÿæ°”å­¦åˆ†æ", link_energy:"èƒ½é‡ç±»å‹åˆ†æ", link_vedic:"å°åº¦å‘½ç†å é™€å æ˜Ÿ",
      vip_title:"ğŸŒ™ ä¼šå‘˜åŒºåŸŸ VIP Segment",
      vip_mingli:"ğŸ— å‘½ç†ç©ºé—´ä¸“å±å†…å®¹",
      vip_love:"å§»ç¼˜æ–¹å‘ï¼šæ‹çˆ±ç¼˜åˆ†ã€å©šå§»èµ°åŠ¿",
      vip_career:"äº‹ä¸šæ–¹å‘ï¼šèŒåœºå‘å±•ã€åˆ›ä¸šæ½œåŠ›",
      vip_wealth:"è´¢è¿æ–¹å‘ï¼šè´¢ä½åˆ†æã€ç†è´¢æ—¶æœº",
      vip_pet:"å® ç‰©å‘½ç†ï¼šä¼´ä¾£åŠ¨ç‰©çš„æ€§æ ¼ä¸ç¼˜åˆ†",
      vip_hepan:"åˆç›˜åˆ†æï¼šå©šæœŸæ‹©æ—¥ã€æ–°ç”Ÿæ‹©æ—¶",
      vip_name:"æµ‹ååˆ†æï¼šå…¬å¸åã€å®å®åã€å‘½åæ”¹è¿",
      vip_fengshui:"è´¢ä½åˆç›˜ï¼šä½å®¶ / åŠå…¬å®¤åŠ¨çº¿é…åˆ",
      vip_xinlian:"ğŸŒ™ å¿ƒæ€œç©ºé—´ä¸“å±å†…å®¹",
      vip_record:"çµæ€§è®°å½•ï¼šç…§ç‰‡ã€æ¢¦å¢ƒã€å£°éŸ³ã€æ„¿æœ›ç¥ˆç¥·",
      vip_course:"å‘½ç†è¯¾ç¨‹ï¼šå…«å­— / å¡”ç½— / å æ˜Ÿ / çµæ•° / äººç±»å›¾",
      vip_memorial:"å®¶æ—çºªå¿µç³»ç»Ÿï¼šäº²äººçµæ€§çºªå¿µ & å»¶ç»­",
      vip_tasks:"æ¯å‘¨èƒ½é‡ç»ƒä¹  / ç¥æ˜ä»ªå¼ä»»åŠ¡",
      vip_shop:"èƒ½é‡å•†åŸä¸“å±æŠ˜æ‰£ & å¾¡å®ˆè®¢åˆ¶",
      login_title:"ğŸ’ ç™»å…¥ VIP åŠŸèƒ½",
      ph_email:"é‚®ç®± Email",
      ph_password:"å¯†ç  Passwordï¼ˆè‡³å°‘8ä½ï¼Œå«å¤§å°å†™æ•°å­—ç¬¦å·ï¼‰",
      btn_register:"æ³¨å†Œè´¦æˆ·",
      btn_login:"ç™»å…¥è´¦æˆ·",
      btn_upgrade:"ğŸ’ å‡çº§ä¸º VIPï¼ˆæœˆè´¹ï¼‰",
      btn_backshop:"â† è¿”å›å‘½ç†å•†åŸ",
      btn_reset:"ğŸ”‘ é‡è®¾å¯†ç ",
      note_price:"$9.9 / æœˆè´¹ VIPï¼ˆå‘½ç†ç©ºé—´ + å¿ƒæ€œç©ºé—´ + çµæ€§è¯¾ç¨‹ï¼‰ Â· æ³¨å†Œè´¦å·èµ é€ä¸€æ¬¡å…è´¹ä½“éªŒ",
      err_need_ep:"è¯·è¾“å…¥é‚®ç®±ä¸å¯†ç ",
      err_pwd_rule:"å¯†ç è‡³å°‘8ä½ï¼Œéœ€åŒ…å«å¤§å†™/å°å†™/æ•°å­—/ç‰¹æ®Šç¬¦å·",
      err_exists:"æ­¤é‚®ç®±å·²æ³¨å†Œï¼Œè¯·ç›´æ¥ç™»å…¥",
      err_register_fail:"æ³¨å†Œå¤±è´¥ï¼š",
      err_no_account:"è´¦æˆ·ä¸å­˜åœ¨ï¼Œè¯·å…ˆæ³¨å†Œ",
      err_wrong_pwd:"å¯†ç é”™è¯¯",
      err_expired:"ä¼šå‘˜å·²è¿‡æœŸï¼Œè¯·ç»­è´¹",
      err_login_fail:"ç™»å…¥å¤±è´¥ï¼š",
      prompt_email:"è¯·è¾“å…¥æ³¨å†Œé‚®ç®±ï¼š",
      err_email_empty:"é‚®ç®±ä¸èƒ½ä¸ºç©º",
      prompt_newpwd:"è¯·è¾“å…¥æ–°å¯†ç ï¼ˆè‡³å°‘8ä½ï¼Œå«å¤§å°å†™ã€æ•°å­—ã€ç¬¦å·ï¼‰ï¼š",
      err_pwd_empty:"å¯†ç ä¸èƒ½ä¸ºç©º",
      err_reset_fail:"é‡è®¾å¤±è´¥ï¼š",
      msg_reset_ok:"å¯†ç å·²æˆåŠŸæ›´æ–°ï¼Œè¯·ç”¨æ–°å¯†ç é‡æ–°ç™»å…¥ã€‚",
      chat_fab:"é—®", chat_placeholder:"è¯·é—®æ‚¨æƒ³äº†è§£ä»€ä¹ˆï¼Ÿï¼ˆå¦‚ï¼šå¦‚ä½•å¼€å§‹å…è´¹ä½“éªŒï¼‰", chat_send:"å‘é€"
    },
    "zh-TW": {
      page_title:"å‘½ç†å¿ƒæ†ç©ºé–“ Â· Index",
      site_title:"å‘½ç†å¿ƒæ†ç©ºé–“ Â· Soul Sanctuary",
      site_subtitle:"å…è²»é«”é©— & æœƒå“¡å°ˆå€ Â· çµ±ä¸€é¢¨æ ¼ç‰ˆ",
      lang_label:"èªè¨€",
      free_title:"ğŸŒ€ å…è²»é«”é©—å€ Free Segment",
      link_bazi:"å…«å­—å‘½ç†åˆ†æ", link_natal:"æœ¬å‘½æ˜Ÿç›¤åˆ†æ", link_life:"éˆæ•¸åˆ†æ",
      link_tarot:"å¡”ç¾…æŒ‡å¼•åˆ†æ", link_kyuusei:"ä¹æ˜Ÿæ°£å­¸åˆ†æ", link_energy:"èƒ½é‡é¡å‹åˆ†æ", link_vedic:"å°åº¦å‘½ç†å é™€å æ˜Ÿ",
      vip_title:"ğŸŒ™ æœƒå“¡å€åŸŸ VIP Segment",
      vip_mingli:"ğŸ— å‘½ç†ç©ºé–“å°ˆå±¬å…§å®¹",
      vip_love:"å§»ç·£æ–¹å‘ï¼šæˆ€æ„›ç·£åˆ†ã€å©šå§»èµ°å‹¢",
      vip_career:"äº‹æ¥­æ–¹å‘ï¼šè·å ´ç™¼å±•ã€å‰µæ¥­æ½›åŠ›",
      vip_wealth:"è²¡é‹æ–¹å‘ï¼šè²¡ä½åˆ†æã€ç†è²¡æ™‚æ©Ÿ",
      vip_pet:"å¯µç‰©å‘½ç†ï¼šä¼´ä¾¶å‹•ç‰©çš„æ€§æ ¼èˆ‡ç·£åˆ†",
      vip_hepan:"åˆç›¤åˆ†æï¼šå©šæœŸæ“‡æ—¥ã€æ–°ç”Ÿæ“‡æ™‚",
      vip_name:"æ¸¬ååˆ†æï¼šå…¬å¸åã€å¯¶å¯¶åã€å‘½åæ”¹é‹",
      vip_fengshui:"è²¡ä½åˆç›¤ï¼šä½å®¶ / è¾¦å…¬å®¤å‹•ç·šé…åˆ",
      vip_xinlian:"ğŸŒ™ å¿ƒæ†ç©ºé–“å°ˆå±¬å…§å®¹",
      vip_record:"éˆæ€§è¨˜éŒ„ï¼šç…§ç‰‡ã€å¤¢å¢ƒã€è²éŸ³ã€é¡˜æœ›ç¥ˆç¦±",
      vip_course:"å‘½ç†èª²ç¨‹ï¼šå…«å­— / å¡”ç¾… / å æ˜Ÿ / éˆæ•¸ / äººé¡åœ–",
      vip_memorial:"å®¶æ—ç´€å¿µç³»çµ±ï¼šè¦ªäººéˆæ€§ç´€å¿µ & å»¶çºŒ",
      vip_tasks:"æ¯é€±èƒ½é‡ç·´ç¿’ / ç¥æ˜å„€å¼ä»»å‹™",
      vip_shop:"èƒ½é‡å•†åŸå°ˆå±¬æŠ˜æ‰£ & å¾¡å®ˆè¨‚è£½",
      login_title:"ğŸ’ ç™»å…¥ VIP åŠŸèƒ½",
      ph_email:"é›»å­éƒµä»¶ Email",
      ph_password:"å¯†ç¢¼ Passwordï¼ˆè‡³å°‘8ä½ï¼Œå«å¤§å°å¯«æ•¸å­—ç¬¦è™Ÿï¼‰",
      btn_register:"è¨»å†Šå¸³æˆ¶", btn_login:"ç™»å…¥å¸³æˆ¶",
      btn_upgrade:"ğŸ’ å‡ç´šç‚º VIPï¼ˆæœˆè²»ï¼‰", btn_backshop:"â† è¿”å›å‘½ç†å•†åŸ",
      btn_reset:"ğŸ”‘ é‡è¨­å¯†ç¢¼",
      note_price:"$9.9 / æœˆè²» VIPï¼ˆå‘½ç†ç©ºé–“ + å¿ƒæ†ç©ºé–“ + éˆæ€§èª²ç¨‹ï¼‰ Â· è¨»å†Šè´ˆä¸€æ¬¡å…è²»é«”é©—",
      err_need_ep:"è«‹è¼¸å…¥é›»å­éƒµä»¶èˆ‡å¯†ç¢¼",
      err_pwd_rule:"å¯†ç¢¼è‡³å°‘8ä½ï¼Œéœ€åŒ…å«å¤§å°å¯«/æ•¸å­—/ç‰¹æ®Šç¬¦è™Ÿ",
      err_exists:"æ­¤éƒµç®±å·²è¨»å†Šï¼Œè«‹ç›´æ¥ç™»å…¥",
      err_register_fail:"è¨»å†Šå¤±æ•—ï¼š",
      err_no_account:"å¸³æˆ¶ä¸å­˜åœ¨ï¼Œè«‹å…ˆè¨»å†Š",
      err_wrong_pwd:"å¯†ç¢¼éŒ¯èª¤",
      err_expired:"æœƒå“¡å·²éæœŸï¼Œè«‹çºŒè²»",
      err_login_fail:"ç™»å…¥å¤±æ•—ï¼š",
      prompt_email:"è«‹è¼¸å…¥è¨»å†Šéƒµç®±ï¼š",
      err_email_empty:"éƒµç®±ä¸èƒ½ç‚ºç©º",
      prompt_newpwd:"è«‹è¼¸å…¥æ–°å¯†ç¢¼ï¼ˆè‡³å°‘8ä½ï¼Œå«å¤§å°å¯«ã€æ•¸å­—ã€ç¬¦è™Ÿï¼‰ï¼š",
      err_pwd_empty:"å¯†ç¢¼ä¸èƒ½ç‚ºç©º",
      err_reset_fail:"é‡è¨­å¤±æ•—ï¼š",
      msg_reset_ok:"å¯†ç¢¼å·²æˆåŠŸæ›´æ–°ï¼Œè«‹ç”¨æ–°å¯†ç¢¼é‡æ–°ç™»å…¥ã€‚",
      chat_fab:"å•", chat_placeholder:"æƒ³äº†è§£ä»€éº¼ï¼Ÿï¼ˆä¾‹å¦‚ï¼šå¦‚ä½•é–‹å§‹å…è²»é«”é©—ï¼‰", chat_send:"ç™¼é€"
    },
    "en": {
      page_title:"Soul Sanctuary Â· Index",
      site_title:"Soul Sanctuary",
      site_subtitle:"Free Segment & VIP Area Â· Unified Style",
      lang_label:"Language",
      free_title:"ğŸŒ€ Free Segment",
      link_bazi:"Bazi Reading", link_natal:"Natal Chart", link_life:"Numerology",
      link_tarot:"Tarot Guidance", link_kyuusei:"Nine Star Ki", link_energy:"Energy Type", link_vedic:"Vedic Astrology",
      vip_title:"ğŸŒ™ VIP Segment",
      vip_mingli:"ğŸ— Astro Sanctuary Â· Exclusive",
      vip_love:"Love: Dating Fate, Marriage Trend",
      vip_career:"Career: Workplace, Entrepreneurship",
      vip_wealth:"Wealth: Wealth Position, Timing",
      vip_pet:"Pet Destiny: Temperament & Bond",
      vip_hepan:"Synastry: Wedding Dates, Birthtime",
      vip_name:"Name Reading: Company/Baby/Renaming",
      vip_fengshui:"Wealth & Layout: Home / Office",
      vip_xinlian:"ğŸŒ™ Soul Sanctuary Â· Exclusive",
      vip_record:"Spiritual Logs: Photos, Dreams, Voice, Prayers",
      vip_course:"Courses: Bazi / Tarot / Astrology / Numerology / Human Design",
      vip_memorial:"Family Memorial: Spiritual Archive & Legacy",
      vip_tasks:"Weekly Energy Practices / Divine Ritual Tasks",
      vip_shop:"Store Discounts & Omamori",
      login_title:"ğŸ’ VIP Login",
      ph_email:"Email",
      ph_password:"Password (8+ chars, upper/lower/digit/symbol)",
      btn_register:"Create Account", btn_login:"Log in",
      btn_upgrade:"ğŸ’ Upgrade to VIP (Monthly)", btn_backshop:"â† Back to Store",
      btn_reset:"ğŸ”‘ Reset Password",
      note_price:"$9.9 / month Â· VIP (Astro + Soul + Courses). New account gets one free trial.",
      err_need_ep:"Enter email and password",
      err_pwd_rule:"Password must be 8+ and include upper/lowercase, number, symbol",
      err_exists:"Email already registered. Please log in.",
      err_register_fail:"Registration failed: ",
      err_no_account:"Account not found. Please register first.",
      err_wrong_pwd:"Incorrect password",
      err_expired:"Membership expired. Please renew.",
      err_login_fail:"Login failed: ",
      prompt_email:"Enter your registered email:",
      err_email_empty:"Email cannot be empty",
      prompt_newpwd:"Enter a new password (8+, upper/lower/digit/symbol):",
      err_pwd_empty:"Password cannot be empty",
      err_reset_fail:"Reset failed: ",
      msg_reset_ok:"Password updated. Please log in with the new one.",
      chat_fab:"Chat", chat_placeholder:"What would you like to know? (e.g., how to start the free trial)", chat_send:"Send"
    },
    "ja": {
      page_title:"ã‚½ã‚¦ãƒ«ãƒ»ã‚µãƒ³ã‚¯ãƒãƒ¥ã‚¢ãƒª Â· Index",
      site_title:"ã‚½ã‚¦ãƒ«ãƒ»ã‚µãƒ³ã‚¯ãƒãƒ¥ã‚¢ãƒª",
      site_subtitle:"ç„¡æ–™ä½“é¨“ & VIP Â· çµ±ä¸€ãƒ‡ã‚¶ã‚¤ãƒ³",
      lang_label:"è¨€èª",
      free_title:"ğŸŒ€ ç„¡æ–™ä½“é¨“ã‚¾ãƒ¼ãƒ³",
      link_bazi:"å››æŸ±æ¨å‘½", link_natal:"ãƒã‚¤ã‚¿ãƒ«ãƒãƒ£ãƒ¼ãƒˆ", link_life:"æ•°ç§˜è¡“",
      link_tarot:"ã‚¿ãƒ­ãƒƒãƒˆ", link_kyuusei:"ä¹æ˜Ÿæ°—å­¦", link_energy:"ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚¿ã‚¤ãƒ—", link_vedic:"ãƒ´ã‚§ãƒ¼ãƒ‡ã‚£ãƒƒã‚¯å æ˜Ÿè¡“",
      vip_title:"ğŸŒ™ VIP ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ",
      vip_mingli:"ğŸ— å‘½ç†ã‚¨ãƒªã‚¢ Â· é™å®š",
      vip_love:"ç¸çµã³ï¼šæ‹æ„›ãƒ»çµå©šã®æµã‚Œ",
      vip_career:"ä»•äº‹ï¼šè·å ´ãƒ»èµ·æ¥­ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«",
      vip_wealth:"é‡‘é‹ï¼šè²¡ä½ãƒ»ã‚¿ã‚¤ãƒŸãƒ³ã‚°",
      vip_pet:"ãƒšãƒƒãƒˆå‘½ç†ï¼šæ€§æ ¼ã¨ã”ç¸",
      vip_hepan:"ç›¸æ€§ï¼šçµå©šæ—¥ãƒ»å‡ºç”£æ™‚åˆ»",
      vip_name:"å‘½åï¼šä¼šç¤¾åãƒ»èµ¤ã¡ã‚ƒã‚“åãƒ»æ”¹å",
      vip_fengshui:"è²¡ä½Ã—ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼šä½å®… / ã‚ªãƒ•ã‚£ã‚¹",
      vip_xinlian:"ğŸŒ™ å¿ƒæ€œã‚¨ãƒªã‚¢ Â· é™å®š",
      vip_record:"ã‚¹ãƒ”ãƒªãƒãƒ¥ã‚¢ãƒ«è¨˜éŒ²ï¼šå†™çœŸ/å¤¢/éŸ³å£°/ç¥ˆã‚Š",
      vip_course:"è¬›åº§ï¼šå››æŸ±/ã‚¿ãƒ­ãƒƒãƒˆ/å æ˜Ÿ/æ•°ç§˜/HD",
      vip_memorial:"å®¶æ—ãƒ¡ãƒ¢ãƒªã‚¢ãƒ«ï¼šéœŠçš„è¨˜éŒ²ã¨ç¶™æ‰¿",
      vip_tasks:"æ¯é€±ã‚¨ãƒŠã‚¸ãƒ¼ç·´ç¿’ / å„€å¼ã‚¿ã‚¹ã‚¯",
      vip_shop:"ã‚¹ãƒˆã‚¢å‰²å¼• & ãŠå®ˆã‚Š",
      login_title:"ğŸ’ VIP ãƒ­ã‚°ã‚¤ãƒ³",
      ph_email:"ãƒ¡ãƒ¼ãƒ«",
      ph_password:"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆ8æ–‡å­—ä»¥ä¸Šã€å¤§å°è‹±å­—ãƒ»æ•°å­—ãƒ»è¨˜å·ï¼‰",
      btn_register:"ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ", btn_login:"ãƒ­ã‚°ã‚¤ãƒ³",
      btn_upgrade:"ğŸ’ VIPã«ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ï¼ˆæœˆé¡ï¼‰", btn_backshop:"â† ã‚¹ãƒˆã‚¢ã¸æˆ»ã‚‹",
      btn_reset:"ğŸ”‘ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å†è¨­å®š",
      note_price:"$9.9/æœˆï¼ˆå‘½ç† + å¿ƒæ€œ + è¬›åº§ï¼‰ã€‚æ–°è¦ç™»éŒ²ã¯1å›ç„¡æ–™ä½“é¨“ã€‚",
      err_need_ep:"ãƒ¡ãƒ¼ãƒ«ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„",
      err_pwd_rule:"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯8æ–‡å­—ä»¥ä¸Šã§ã€å¤§å°è‹±å­—ãƒ»æ•°å­—ãƒ»è¨˜å·ã‚’å«ã‚ã¦ãã ã•ã„",
      err_exists:"ã“ã®ãƒ¡ãƒ¼ãƒ«ã¯ç™»éŒ²æ¸ˆã¿ã§ã™ã€‚ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„ã€‚",
      err_register_fail:"ç™»éŒ²å¤±æ•—ï¼š",
      err_no_account:"ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚å…ˆã«ç™»éŒ²ã—ã¦ãã ã•ã„ã€‚",
      err_wrong_pwd:"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™",
      err_expired:"ä¼šå“¡æœŸé™åˆ‡ã‚Œã€‚æ›´æ–°ã—ã¦ãã ã•ã„ã€‚",
      err_login_fail:"ãƒ­ã‚°ã‚¤ãƒ³å¤±æ•—ï¼š",
      prompt_email:"ç™»éŒ²ãƒ¡ãƒ¼ãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼š",
      err_email_empty:"ãƒ¡ãƒ¼ãƒ«ã¯å¿…é ˆã§ã™",
      prompt_newpwd:"æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ï¼ˆ8æ–‡å­—ä»¥ä¸Šã€å¤§å°è‹±å­—ãƒ»æ•°å­—ãƒ»è¨˜å·ï¼‰ï¼š",
      err_pwd_empty:"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯å¿…é ˆã§ã™",
      err_reset_fail:"å†è¨­å®šå¤±æ•—ï¼š",
      msg_reset_ok:"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„ã€‚",
      chat_fab:"å•", chat_placeholder:"ä½•ã‚’çŸ¥ã‚ŠãŸã„ã§ã™ã‹ï¼Ÿï¼ˆä¾‹ï¼šç„¡æ–™ä½“é¨“ã®å§‹ã‚æ–¹ï¼‰", chat_send:"é€ä¿¡"
    },
    "th": {
      page_title:"Soul Sanctuary Â· à¸«à¸™à¹‰à¸²à¹à¸£à¸",
      site_title:"Soul Sanctuary",
      site_subtitle:"à¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¸Ÿà¸£à¸µ & à¸à¸·à¹‰à¸™à¸—à¸µà¹ˆ VIP Â· à¸ªà¹„à¸•à¸¥à¹Œà¹€à¸”à¸µà¸¢à¸§à¸à¸±à¸™",
      lang_label:"à¸ à¸²à¸©à¸²",
      free_title:"ğŸŒ€ à¸à¸·à¹‰à¸™à¸—à¸µà¹ˆà¸—à¸”à¸¥à¸­à¸‡à¹ƒà¸Šà¹‰à¸Ÿà¸£à¸µ",
      link_bazi:"à¸”à¸§à¸‡à¸ˆà¸µà¸™ (Bazi)", link_natal:"à¸”à¸§à¸‡à¸à¸³à¹€à¸™à¸´à¸”", link_life:"à¸•à¸±à¸§à¹€à¸¥à¸‚à¸Šà¸µà¸§à¸´à¸•",
      link_tarot:"à¹„à¸à¹ˆà¸—à¸²à¹‚à¸£à¸•à¹Œ", link_kyuusei:"à¹€à¸à¹‰à¸²à¸”à¸²à¸§à¸„à¸´à¸§à¹€à¸‹", link_energy:"à¸›à¸£à¸°à¹€à¸ à¸—à¸à¸¥à¸±à¸‡à¸‡à¸²à¸™", link_vedic:"à¹‚à¸«à¸£à¸²à¸¨à¸²à¸ªà¸•à¸£à¹Œà¹€à¸§à¸—",
      vip_title:"ğŸŒ™ à¸à¸·à¹‰à¸™à¸—à¸µà¹ˆ VIP",
      vip_mingli:"ğŸ— à¹€à¸™à¸·à¹‰à¸­à¸«à¸²à¸à¸´à¹€à¸¨à¸© Â· Astro",
      vip_love:"à¸„à¸§à¸²à¸¡à¸£à¸±à¸: à¸„à¸¹à¹ˆà¹à¸—à¹‰/à¹à¸™à¸§à¹‚à¸™à¹‰à¸¡à¹à¸•à¹ˆà¸‡à¸‡à¸²à¸™",
      vip_career:"à¸à¸²à¸£à¸‡à¸²à¸™: à¸—à¸µà¹ˆà¸—à¸³à¸‡à¸²à¸™/à¸¨à¸±à¸à¸¢à¸ à¸²à¸à¸˜à¸¸à¸£à¸à¸´à¸ˆ",
      vip_wealth:"à¸à¸²à¸£à¹€à¸‡à¸´à¸™: à¸ˆà¸¸à¸”à¹‚à¸Šà¸„à¸¥à¸²à¸ /à¸ˆà¸±à¸‡à¸«à¸§à¸°à¸¥à¸‡à¸—à¸¸à¸™",
      vip_pet:"à¸”à¸§à¸‡à¸ªà¸±à¸•à¸§à¹Œà¹€à¸¥à¸µà¹‰à¸¢à¸‡: à¸™à¸´à¸ªà¸±à¸¢ & à¸ªà¸²à¸¢à¹ƒà¸¢",
      vip_hepan:"à¸„à¸§à¸²à¸¡à¹€à¸‚à¹‰à¸²à¸à¸±à¸™à¹„à¸”à¹‰: à¸§à¸±à¸™à¹à¸•à¹ˆà¸‡/à¹€à¸§à¸¥à¸²à¸„à¸¥à¸­à¸”",
      vip_name:"à¸•à¸±à¹‰à¸‡à¸Šà¸·à¹ˆà¸­: à¸šà¸£à¸´à¸©à¸±à¸—/à¸—à¸²à¸£à¸/à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸Šà¸·à¹ˆà¸­",
      vip_fengshui:"à¸®à¸§à¸‡à¸ˆà¸¸à¹‰à¸¢à¸à¸²à¸£à¹€à¸‡à¸´à¸™: à¸šà¹‰à¸²à¸™ / à¸ªà¸³à¸™à¸±à¸à¸‡à¸²à¸™",
      vip_xinlian:"ğŸŒ™ à¹€à¸™à¸·à¹‰à¸­à¸«à¸²à¹€à¸‰à¸à¸²à¸° Â· Soul",
      vip_record:"à¸šà¸±à¸™à¸—à¸¶à¸à¸ˆà¸´à¸•à¸§à¸´à¸à¸à¸²à¸“: à¸£à¸¹à¸›/à¸„à¸§à¸²à¸¡à¸à¸±à¸™/à¹€à¸ªà¸µà¸¢à¸‡/à¸„à¸³à¸­à¸˜à¸´à¸©à¸à¸²à¸™",
      vip_course:"à¸„à¸­à¸£à¹Œà¸ª: Bazi / Tarot / Astrology / Numerology / HD",
      vip_memorial:"à¸­à¸™à¸¸à¸ªà¸£à¸“à¹Œà¸„à¸£à¸­à¸šà¸„à¸£à¸±à¸§: à¸šà¸±à¸™à¸—à¸¶à¸à¸§à¸´à¸à¸à¸²à¸“ & à¸ªà¸·à¸šà¸ªà¸²à¸™",
      vip_tasks:"à¸à¸¶à¸à¸à¸¥à¸±à¸‡à¸‡à¸²à¸™à¸£à¸²à¸¢à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œ / à¸à¸´à¸˜à¸µà¸à¸£à¸£à¸¡",
      vip_shop:"à¸ªà¹ˆà¸§à¸™à¸¥à¸”à¸£à¹‰à¸²à¸™à¸„à¹‰à¸² & Omamori",
      login_title:"ğŸ’ à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š VIP",
      ph_email:"à¸­à¸µà¹€à¸¡à¸¥",
      ph_password:"à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™ (8+ à¸•à¸±à¸§à¸­à¸±à¸à¸©à¸£ à¸¡à¸µà¸à¸´à¸¡à¸à¹Œà¹€à¸¥à¹‡à¸/à¹ƒà¸«à¸à¹ˆ à¸•à¸±à¸§à¹€à¸¥à¸‚à¹à¸¥à¸°à¸ªà¸±à¸à¸¥à¸±à¸à¸©à¸“à¹Œ)",
      btn_register:"à¸ªà¸¡à¸±à¸„à¸£à¸šà¸±à¸à¸Šà¸µ", btn_login:"à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š",
      btn_upgrade:"ğŸ’ à¸­à¸±à¸›à¹€à¸à¸£à¸” VIP (à¸£à¸²à¸¢à¹€à¸”à¸·à¸­à¸™)", btn_backshop:"â† à¸à¸¥à¸±à¸šà¸£à¹‰à¸²à¸™à¸„à¹‰à¸²",
      btn_reset:"ğŸ”‘ à¸£à¸µà¹€à¸‹à¹‡à¸•à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™",
      note_price:"$9.9 / à¹€à¸”à¸·à¸­à¸™ (Astro + Soul + à¸„à¸­à¸£à¹Œà¸ª) à¸ªà¸¡à¸±à¸„à¸£à¹ƒà¸«à¸¡à¹ˆà¹ƒà¸Šà¹‰à¸Ÿà¸£à¸µ 1 à¸„à¸£à¸±à¹‰à¸‡",
      err_need_ep:"à¸à¸£à¸­à¸à¸­à¸µà¹€à¸¡à¸¥à¹à¸¥à¸°à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™",
      err_pwd_rule:"à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™à¸•à¹‰à¸­à¸‡ 8+ à¸•à¸±à¸§à¸­à¸±à¸à¸©à¸£ à¹à¸¥à¸°à¸¡à¸µà¸à¸´à¸¡à¸à¹Œà¹€à¸¥à¹‡à¸/à¹ƒà¸«à¸à¹ˆ à¸•à¸±à¸§à¹€à¸¥à¸‚ à¸ªà¸±à¸à¸¥à¸±à¸à¸©à¸“à¹Œ",
      err_exists:"à¸­à¸µà¹€à¸¡à¸¥à¸™à¸µà¹‰à¸¡à¸µà¸šà¸±à¸à¸Šà¸µà¹à¸¥à¹‰à¸§ à¸à¸£à¸¸à¸“à¸²à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š",
      err_register_fail:"à¸ªà¸¡à¸±à¸„à¸£à¹„à¸¡à¹ˆà¸ªà¸³à¹€à¸£à¹‡à¸ˆ: ",
      err_no_account:"à¹„à¸¡à¹ˆà¸à¸šà¸šà¸±à¸à¸Šà¸µ à¸à¸£à¸¸à¸“à¸²à¸ªà¸¡à¸±à¸„à¸£à¸à¹ˆà¸­à¸™",
      err_wrong_pwd:"à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™à¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡",
      err_expired:"à¸ªà¸¡à¸²à¸Šà¸´à¸à¸«à¸¡à¸”à¸­à¸²à¸¢à¸¸ à¸à¸£à¸¸à¸“à¸²à¸•à¹ˆà¸­à¸­à¸²à¸¢à¸¸",
      err_login_fail:"à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸šà¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§: ",
      prompt_email:"à¸à¸£à¸­à¸à¸­à¸µà¹€à¸¡à¸¥à¸—à¸µà¹ˆà¸ªà¸¡à¸±à¸„à¸£:",
      err_email_empty:"à¸­à¸µà¹€à¸¡à¸¥à¸«à¹‰à¸²à¸¡à¸§à¹ˆà¸²à¸‡",
      prompt_newpwd:"à¸à¸£à¸­à¸à¸£à¸«à¸±à¸ªà¹ƒà¸«à¸¡à¹ˆ (8+, à¸¡à¸µà¸à¸´à¸¡à¸à¹Œà¹€à¸¥à¹‡à¸/à¹ƒà¸«à¸à¹ˆ à¸•à¸±à¸§à¹€à¸¥à¸‚ à¸ªà¸±à¸à¸¥à¸±à¸à¸©à¸“à¹Œ):",
      err_pwd_empty:"à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™à¸«à¹‰à¸²à¸¡à¸§à¹ˆà¸²à¸‡",
      err_reset_fail:"à¸£à¸µà¹€à¸‹à¹‡à¸•à¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§: ",
      msg_reset_ok:"à¸­à¸±à¸›à¹€à¸”à¸•à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™à¹à¸¥à¹‰à¸§ à¹‚à¸›à¸£à¸”à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸šà¸”à¹‰à¸§à¸¢à¸£à¸«à¸±à¸ªà¹ƒà¸«à¸¡à¹ˆ",
      chat_fab:"à¸–à¸²à¸¡", chat_placeholder:"à¸­à¸¢à¸²à¸à¸£à¸¹à¹‰à¸­à¸°à¹„à¸£ (à¹€à¸Šà¹ˆà¸™ à¹€à¸£à¸´à¹ˆà¸¡à¸—à¸”à¸¥à¸­à¸‡à¸Ÿà¸£à¸µà¸­à¸¢à¹ˆà¸²à¸‡à¹„à¸£)", chat_send:"à¸ªà¹ˆà¸‡"
    },
    "ms": {
      page_title:"Soul Sanctuary Â· Indeks",
      site_title:"Soul Sanctuary",
      site_subtitle:"Segmen Percuma & VIP Â· Gaya Bersatu",
      lang_label:"Bahasa",
      free_title:"ğŸŒ€ Segmen Percuma",
      link_bazi:"Bazi", link_natal:"Carta Kelahiran", link_life:"Numerologi",
      link_tarot:"Tarot", link_kyuusei:"Nine Star Ki", link_energy:"Jenis Tenaga", link_vedic:"Astrologi Veda",
      vip_title:"ğŸŒ™ Segmen VIP",
      vip_mingli:"ğŸ— Kandungan Eksklusif Â· Astro",
      vip_love:"Cinta: Jodoh/Lalu lintas perkahwinan",
      vip_career:"Kerjaya: Tempat kerja/Usahawan",
      vip_wealth:"Kewangan: Posisi kekayaan/Masa",
      vip_pet:"Nasib Haiwan: Perangai & Ikatan",
      vip_hepan:"Keserasian: Tarikh nikah/Waktu lahir",
      vip_name:"Nama: Syarikat/Bayi/Pertukaran nama",
      vip_fengshui:"Feng Shui Kekayaan: Rumah / Pejabat",
      vip_xinlian:"ğŸŒ™ Kandungan Eksklusif Â· Soul",
      vip_record:"Log Spirit: Foto, Mimpi, Suara, Doa",
      vip_course:"Kursus: Bazi / Tarot / Astrologi / Numerologi / HD",
      vip_memorial:"Memorial Keluarga: Arkib & Legasi",
      vip_tasks:"Latihan Tenaga Mingguan / Ritual",
      vip_shop:"Diskaun Kedai & Omamori",
      login_title:"ğŸ’ Log Masuk VIP",
      ph_email:"Emel",
      ph_password:"Kata laluan (8+ aksara, huruf besar/kecil, nombor, simbol)",
      btn_register:"Daftar Akaun", btn_login:"Log Masuk",
      btn_upgrade:"ğŸ’ Naik Taraf VIP (Bulanan)", btn_backshop:"â† Kembali ke Kedai",
      btn_reset:"ğŸ”‘ Tetap Semula Kata Laluan",
      note_price:"$9.9 / bulan (Astro + Soul + Kursus). Akaun baharu percubaan percuma sekali.",
      err_need_ep:"Masukkan emel dan kata laluan",
      err_pwd_rule:"Kata laluan mesti 8+ dan ada huruf besar/kecil, nombor, simbol",
      err_exists:"Emel telah didaftarkan. Sila log masuk.",
      err_register_fail:"Pendaftaran gagal: ",
      err_no_account:"Akaun tidak ditemui. Sila daftar dahulu.",
      err_wrong_pwd:"Kata laluan salah",
      err_expired:"Keahlian tamat tempoh. Sila perbaharui.",
      err_login_fail:"Log masuk gagal: ",
      prompt_email:"Masukkan emel berdaftar:",
      err_email_empty:"Emel tidak boleh kosong",
      prompt_newpwd:"Masukkan kata laluan baharu (8+, huruf besar/kecil, nombor, simbol):",
      err_pwd_empty:"Kata laluan tidak boleh kosong",
      err_reset_fail:"Tetap semula gagal: ",
      msg_reset_ok:"Kata laluan dikemas kini. Sila log masuk semula.",
      chat_fab:"Tanya", chat_placeholder:"Anda mahu tahu apa? (cth: cara mula percubaan)", chat_send:"Hantar"
    }
  };

  function t(key){
    const L = translations[getLang()] || translations["zh-CN"];
    return L[key] || (translations["zh-CN"][key] || key);
  }
  function applyI18n(){
    document.querySelectorAll("[data-i18n]").forEach(el=>{
      const key = el.getAttribute("data-i18n");
      el.textContent = t(key);
    });
    document.querySelectorAll("[data-i18n-ph]").forEach(el=>{
      const key = el.getAttribute("data-i18n-ph");
      el.setAttribute("placeholder", t(key));
    });
    const titleEl = document.querySelector("title[data-i18n]");
    if (titleEl) titleEl.textContent = t(titleEl.getAttribute("data-i18n"));
  }
  function setLang(code){ localStorage.setItem(LANG_KEY, code); document.documentElement.lang = code; }

  // ============== Chat æµ®çª—ï¼ˆèµ° /api/chatï¼‰ ==============
  function applyChatI18n(){
    const fab = document.getElementById('ssChatFab');
    const inp = document.getElementById('ssChatInput');
    const btn = document.getElementById('ssChatSend');
    if (fab) fab.textContent = t('chat_fab');
    if (inp) inp.placeholder = t('chat_placeholder');
    if (btn) btn.textContent = t('chat_send');
  }

  document.addEventListener('DOMContentLoaded', ()=>{
    // Chat æŒ‰é’®ä¸é¢æ¿
    const chatFab = document.createElement('div');
    chatFab.className = 'ss-chat-fab'; chatFab.id = 'ssChatFab'; chatFab.title = 'å¿ƒæ€œç®¡å®¶';

    const chatPanel = document.createElement('div');
    chatPanel.className = 'ss-chat-panel'; chatPanel.id = 'ssChatPanel'; chatPanel.setAttribute('role','dialog'); chatPanel.setAttribute('aria-label','å¿ƒæ€œç®¡å®¶');
    chatPanel.innerHTML = `
      <div class="ss-chat-head">
        <div class="ss-chat-title">å¿ƒæ€œç®¡å®¶ Â· Chat</div>
        <div class="ss-close" id="ssChatClose">âœ•</div>
      </div>
      <div class="ss-chat-body" id="ssChatBody" aria-live="polite"></div>
      <div class="ss-chat-input">
        <input id="ssChatInput" type="text" />
        <button id="ssChatSend"></button>
      </div>`;

    document.body.appendChild(chatFab);
    document.body.appendChild(chatPanel);

    // åˆå§‹è¯­è¨€ï¼ˆé¡µé¢ + chatï¼‰
    const select = document.getElementById("langSelect");
    const current = getLang();
    if (select) select.value = current;
    applyI18n();
    applyChatI18n();

    const $body  = document.getElementById('ssChatBody');
    const $input = document.getElementById('ssChatInput');
    const $send  = document.getElementById('ssChatSend');
    const $close = document.getElementById('ssChatClose');

    const openPanel  = () => { chatPanel.style.display = 'flex'; $input.focus(); };
    const closePanel = () => { chatPanel.style.display = 'none'; };
    chatFab.addEventListener('click', openPanel);
    $close.addEventListener('click', closePanel);

    function addMsg(text, me=false){
      const div = document.createElement('div');
      div.className = 'ss-msg' + (me ? ' me' : '');
      div.textContent = text;
      $body.appendChild(div);
      $body.scrollTop = $body.scrollHeight;
    }

    async function askChat(prompt){
      addMsg(prompt, true);
      $input.value = '';
      $input.focus();
      try{
        const r = await fetch(`${API_BASE}/api/chat`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            messages: [
              { role:'system', content:'ä½ æ˜¯â€œå¿ƒæ€œç®¡å®¶â€ï¼Œå¸®åŠ©è®¿å®¢äº†è§£å‘½ç†å¿ƒæ€œç©ºé—´çš„åŠŸèƒ½ã€å¯¼èˆªä¸ä¼šå‘˜è¯´æ˜ï¼Œè¯­æ°”æ¸©æš–ä¸“ä¸šã€ç®€æ´æœ‰æ¡ç†ã€‚' },
              { role:'user', content: prompt }
            ]
          })
        });
        let data, reply = '';
        try { data = await r.json(); } catch { data = {}; }
        reply = data.reply ?? data.text ?? data?.choices?.[0]?.message?.content ?? "";
        if (!reply) return addMsg('æŠ±æ­‰ï¼ŒæœåŠ¡æš‚æ—¶ç¹å¿™ï¼Œè¯·ç¨åé‡è¯•ã€‚');
        addMsg(reply);
      }catch(e){
        addMsg('ç½‘ç»œå¼‚å¸¸ï¼Œè¯·ç¨åå†è¯•ã€‚');
      }
    }
    $send.addEventListener('click', ()=>{ const v=$input.value.trim(); if(v) askChat(v); });
    $input.addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ const v=$input.value.trim(); if(v) askChat(v); }});

    // è¯­è¨€åˆ‡æ¢æ—¶ï¼ŒåŒæ­¥æ›´æ–°
    if (select) {
      select.addEventListener("change", ()=>{
        setLang(select.value);
        applyI18n();
        applyChatI18n();
      });
    }
  });

  // ============== ç™»å½•æµç¨‹ï¼ˆé›†ä¸­å¤„ç† exists / expired / expiresAtï¼‰ ==============
  async function safeJson(resp){
    try { return await resp.json(); } catch { return { ok:false, msg:'upstream_error' }; }
  }

  async function loginFlow(email, password){
    const res = await safeJson(await fetch(`${API_BASE}/api/login`, {
      method: 'POST', headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email, password })
    }));

    const msg = (res.msg || "").toString().toLowerCase();

    // âœ… ç»Ÿä¸€åˆ¤æ–­æ˜¯å¦è¿‡æœŸï¼ˆå…¼å®¹ msg/flag/æ—¶é—´æˆ³ï¼‰
    let expired = false;
    if (res.expired === true) expired = true;
    else if (msg === 'expired') expired = true;
    else if (res.expiresAt) {
      const ts = Date.parse(res.expiresAt);
      if (!Number.isNaN(ts) && ts < Date.now()) expired = true;
    }

    if (expired) {
      // åªæç¤ºï¼Œä¸è·³è½¬ï¼›å¯ä¸€é”®å¼•å¯¼ç»­è´¹
      const go = confirm(t('err_expired') + "ã€‚æ˜¯å¦å‰å¾€ç»­è´¹ï¼Ÿ");
      if (go) window.open("https://yourshopifyshop.com/products/monthly-vip", "_blank");
      return;
    }

    // âœ… æ­£å¸¸é€šè¿‡æ‰è·³ VIP
    if (res.ok === true) {
      localStorage.setItem("vipEmail", res.email || email);
      location.href = "https://astro.5xliving.com/vip_soul_sanctuary.html";
      return;
    }

    // å¸¸è§é”™è¯¯
    if (msg === 'no_account') return showErr(t('err_no_account'));
    if (msg === 'wrong_pwd')  return showErr(t('err_wrong_pwd'));
    return showErr(t('err_login_fail') + (res.msg ? ` ${res.msg}` : ''));
  }

  // ======== è¡¨å•äº‹ä»¶ï¼ˆæ³¨å†Œ / ç™»å½• / é‡è®¾ï¼‰ ========
  document.getElementById("registerForm").addEventListener("submit", async (e)=>{
    e.preventDefault();
    hideErr();
    const email = $("email").value.trim();
    const password = $("password").value.trim();
    if (!email || !password) return showErr(t('err_need_ep'));
    if (!strongPwd(password)) return showErr(t('err_pwd_rule'));

    lock($("registerBtn"), true);
    try{
      const res = await safeJson(await fetch(`${API_BASE}/api/register`, {
        method: 'POST', headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email, password })
      }));

      if (res.ok === true){
        localStorage.setItem("vipEmail", email);
        location.href = "vip_trial.html";
        return;
      }

      // å·²å­˜åœ¨ï¼šè‡ªåŠ¨å°è¯•ç™»å½•ï¼ˆç”¨åˆšè¾“å…¥çš„å¯†ç ï¼‰
      if ((res.msg||"").toString() === 'exists'){
        await loginFlow(email, password);
        return;
      }

      return showErr((res.msg && (res.msg+'')) || t('err_register_fail'));
    } catch(err){
      showErr(t('err_register_fail') + (err?.message || ''));
    } finally{
      lock($("registerBtn"), false);
    }
  });

  document.getElementById("loginForm").addEventListener("submit", async (e)=>{
    e.preventDefault();
    hideErr();
    const email = $("email").value.trim();
    const password = $("password").value.trim();
    if (!email || !password) return showErr(t('err_need_ep'));
    lock($("loginBtn"), true);
    try{
      await loginFlow(email, password);
    } catch(err){
      showErr(t('err_login_fail') + (err?.message || ''));
    } finally{
      lock($("loginBtn"), false);
    }
  });

  document.getElementById("resetBtn").addEventListener("click", async ()=>{
    hideErr();
    let email = prompt(t('prompt_email'));
    if (email === null) return; email = email.trim();
    if (!email) return showErr(t('err_email_empty'));

    let newPassword = prompt(t('prompt_newpwd'));
    if (newPassword === null) return; newPassword = newPassword.trim();
    if (!newPassword) return showErr(t('err_pwd_empty'));
    if (!strongPwd(newPassword)) return showErr(t('err_pwd_rule'));

    lock($("resetBtn"), true);
    try{
      const res = await safeJson(await fetch(`${API_BASE}/api/reset`, {
        method: 'POST', headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email, newPassword })
      }));
      if (!res.ok) return showErr((res.msg && (res.msg+'')) || t('err_reset_fail'));
      alert(t('msg_reset_ok'));
    } catch(err){
      showErr(t('err_reset_fail') + (err?.message || ''));
    } finally{
      lock($("resetBtn"), false);
    }
  });
</script>    
</body>
</html>
