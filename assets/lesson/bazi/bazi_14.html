<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>三大特殊命式解析</title>
  <style>
    body {
      background-color: #0b0b0b;
      color: #ffd700;
      font-family: "Noto Serif SC", serif;
      padding: 30px;
      max-width: 800px;
      margin: auto;
      line-height: 1.9;
      letter-spacing: 0.4px;
    }

    h1 {
      text-align: center;
      font-size: 2rem;
      margin-bottom: 30px;
    }

    section {
      background: rgba(255,255,255,0.05);
      padding: 20px;
      margin: 20px 0;
      border-left: 5px solid #ffd700;
      border-radius: 8px;
    }

    .speak-btn {
      margin-top: 10px;
      padding: 6px 12px;
      font-size: 0.9em;
      background-color: #1a1a1a;
      color: #ffd700;
      border: 1px solid #ffd700;
      border-radius: 6px;
      cursor: pointer;
    }

    .speak-btn:hover {
      background-color: #333;
    }

    #langSelect {
      margin-bottom: 20px;
      background: #1a1a1a;
      color: #ffd700;
      border: 1px solid #ffd700;
      padding: 6px 10px;
      border-radius: 6px;
    }

    label {
      font-weight: bold;
    }
  </style>
</head>
<body>

<h1>📘 第14课：三大特殊命式解析</h1>

<select id="langSelect">
  <option value="zh-CN">中文（简体）</option>
  <option value="zh-TW">中文（繁體）</option>
  <option value="en-US">English</option>
  <option value="ja-JP">日本語</option>
  <option value="th-TH">ภาษาไทย</option>
  <option value="id-ID">Bahasa Indonesia</option>
  <option value="vi-VN">Tiếng Việt</option>
  <option value="tl-PH">Filipino（菲律宾）</option>
  <option value="fr-FR">Français（法语）</option>
  <option value="de-DE">Deutsch（德语）</option>
  <option value="es-ES">Español（西语）</option>
  <option value="pt-PT">Português（葡语）</option>
  <option value="hi-IN">हिन्दी（Hindi）</option>
</select>

<section>
  <h2>🌊 什么是特殊命式？</h2>
  <p data-lang="zh-CN">
    特殊命式是指八字结构脱离常规格局判断，形成极端倾向、需要顺势取用的命局。<br>
    最常见的有三种：从格、化气格、专旺格。<br>
    它们的成立需要严谨条件，判断失误容易导致误用神、错方向。
  </p>
  <button class="speak-btn" onclick="toggleSpeak(this)">📣 翻译并朗读</button>
</section>

<section>
  <h2>🧩 从格（从强、从弱）</h2>
  <p data-lang="zh-CN">
    从格，是指日主力量极弱（或极强），完全无法抗衡，因而“从附于局”。<br>
    从强格：日主弱，四柱全为比劫印星，不见克泄制<br>
    从弱格：日主强，四柱全为食伤财官，不见帮扶<br>
    假从格：表面像从，实则有一柱反抗，即不成从格<br><br>
    判断重点：四柱中是否“毫无反抗”，只要有一处克制或帮扶，都不能从。
  </p>
  <button class="speak-btn" onclick="toggleSpeak(this)">📣 翻译并朗读</button>
</section>

<section>
  <h2>🔥 化气格</h2>
  <p data-lang="zh-CN">
    化气格，是一种“化而为一”的特殊格局，所有五行力量集中支持一股主气。<br>
    成格要件包括：月令得气、天干通透、地支无破、格神纯粹。<br>
    例如甲日主生于寅月，地支火局，天干丙丁透出，即为“化火格”。<br>
    一旦成立，必须顺化之气取用，违之反伤本命。
  </p>
  <button class="speak-btn" onclick="toggleSpeak(this)">📣 翻译并朗读</button>
</section>

<section>
  <h2>🪨 专旺格</h2>
  <p data-lang="zh-CN">
    专旺格，属于极端身强之命。比劫或印星极旺，且得令、得地、得助三得齐全。<br>
    此时命局无克泄调和，需靠食伤泄秀或官杀制服。<br>
    若错判为普通旺命，误用印比，则等于“火上加油”，反成内耗结构。<br>
    专旺格一般气势强烈，主极度自我、命运爆发性强。
  </p>
  <button class="speak-btn" onclick="toggleSpeak(this)">📣 翻译并朗读</button>
</section>

<section>
  <h2>📚 判断特殊格的三步骤</h2>
  <p data-lang="zh-CN">
    结构检查：是否存在四柱同向、无一反抗之形<br>
    条件确认：是否满足月令得气、地支纯粹、无破坏<br>
    顺势判断：若成立，从其势取用；若未成，则回归常规格局法<br>
    特殊格不能强套，一旦破格，反比普通格局更难运。
  </p>
  <button class="speak-btn" onclick="toggleSpeak(this)">📣 翻译并朗读</button>
</section>

<section>
  <h2>⚠️ 特殊命式的误判陷阱</h2>
  <p data-lang="zh-CN">
    假从 ≠ 真从：只要命盘中有一柱反抗日主，皆不从<br>
    化气被破即无化：遇冲、合、克，即不成格<br>
    专旺若缺一得，只是旺命而非格<br>
    误判结果将导致：用神全错、流年预测失准、建议方向走偏。
  </p>
  <button class="speak-btn" onclick="toggleSpeak(this)">📣 翻译并朗读</button>
</section>

<section>
  <h2>📝 练习：以下八字可能为特殊命式吗？</h2>
  <p data-lang="zh-CN">
    八字：甲寅年、丙寅月、乙卯日、丁卯时<br>
    地支皆为寅卯木局，天干透火，木火通明<br>
    你认为此盘是普通日主强旺？还是“化火格”？<br>
    下一课我们将带你实战判断，并讲解其用神与行运之道。
  </p>
  <button class="speak-btn" onclick="toggleSpeak(this)">📣 翻译并朗读</button>
</section>

<section>
  <h2>📌 小结：极端结构，极端判断</h2>
  <p data-lang="zh-CN">
    特殊命式往往隐藏高能潜力，也易走极端路线。<br>
    学会判断是否成格、如何取用，是命理高手的标志。<br>
    真正的化、从、专旺，都不常见，但一遇必须懂得辨识与顺势操作。
  </p>
  <button class="speak-btn" onclick="toggleSpeak(this)">📣 翻译并朗读</button>
</section>

<script>
let currentAudio = null;
async function toggleSpeak(button) {
  if (currentAudio) {
    currentAudio.pause();
    currentAudio = null;
    button.textContent = "📣 翻译并朗读";
    return;
  }

  const lang = document.getElementById("langSelect").value;
  const section = button.closest("section");
  const text = section.querySelector("p").textContent.trim();

  let finalText = text;

  try {
    if (lang !== "zh-CN") {
      const transRes = await fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=zh-CN&tl=${lang}&dt=t&q=${encodeURIComponent(text)}`);
      const transData = await transRes.json();
      finalText = transData[0].map(d => d[0]).join(" ");
    }

    const ttsRes = await fetch("https://texttospeech.googleapis.com/v1/text:synthesize?key=AIzaSyAjTuqwHfTVLdxDOHqfbI9UJcFoM1hBlX4", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        input: { text: finalText },
        voice: { languageCode: lang, ssmlGender: "NEUTRAL" },
        audioConfig: { audioEncoding: "MP3" }
      })
    });

    const ttsData = await ttsRes.json();
    if (!ttsData.audioContent) throw new Error("语音生成失败");

    const audio = new Audio("data:audio/mp3;base64," + ttsData.audioContent);
    audio.play();
    button.textContent = "⏹️ 停止朗读";

    currentAudio = audio;
    audio.onended = () => {
      currentAudio = null;
      button.textContent = "📣 翻译并朗读";
    };
  } catch (err) {
    alert("❌ 无法播放语音：" + err.message);
  }
}
</script>

</body>
</html>
