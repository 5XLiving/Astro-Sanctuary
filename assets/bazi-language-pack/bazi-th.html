<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>‡∏î‡∏ß‡∏á‡∏à‡∏µ‡∏ô‡∏™‡∏µ‡πà‡πÄ‡∏™‡∏≤ ¬∑ ‡∏ú‡∏π‡∏Å‡∏î‡∏ß‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <link rel="icon" href="data:,">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600&family=Inter:wght@400;600&display=swap" rel="stylesheet">

  <style>
/* ---- same visual style as other versions ---- */
:root{
  --bg:#0b0f14; --bg-accent:#0e1520; --card:#11161dcc; --surface:#0f1624; --line:#1f2a36;
  --text:#e8edf3; --muted:#98a7b7; --brand:#d4af37; --gold:#d4af37; --gold2:#f2d27a; --accent:#58b9ff;
  --radius:14px; --radius-sm:10px; --radius-lg:18px; --shadow:0 8px 30px rgba(0,0,0,.35); --shadow-sm:0 4px 14px rgba(0,0,0,.28);
  --container:1100px; --gap:12px; --pad:18px; --focus:0 0 0 2px rgba(212,175,55,0.2);
  --bp-s:520px; --bp-m:760px; --bp-l:900px;
}
*,*::before,*::after{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; padding:0; color:var(--text);
  background: radial-gradient(1200px 600px at 70% -10%, #16202b 10%, transparent 60%) no-repeat,
             linear-gradient(180deg, #0b0f14, #0b0f14);
  font-family:Inter,system-ui,-apple-system,"Noto Sans Thai","Noto Sans SC","Segoe UI",Roboto,Arial,sans-serif;
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}
body::before{
  content:""; position:fixed; inset:0; z-index:-2;
  background:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" opacity="0.05"><rect width="100" height="100" fill="%23d4af37"/></svg>') center/cover no-repeat;
  filter:brightness(0.45) saturate(0.9) blur(2px);
}
.container{max-width:var(--container); margin:0 auto; padding:24px 16px 80px}
.site-header{position:sticky; top:0; z-index:10; background:rgba(11,15,20,.8); border-bottom:1px solid #0f1622; backdrop-filter:saturate(140%) blur(12px)}
.head-inner{display:flex; align-items:center; justify-content:space-between; gap:14px; padding:14px 16px}
.brand{display:flex; align-items:center; gap:10px; text-decoration:none; color:var(--text)}
.brand-badge{display:inline-grid; place-items:center; width:34px; height:34px; border-radius:8px; background:linear-gradient(180deg,#0e1520,#0b1018); border:1px solid #2a3546; box-shadow:var(--shadow-sm); font-weight:800; color:#ffe084}
.title{font-family:"Noto Serif SC",serif; font-weight:700; letter-spacing:0.02em; font-size:1.1rem}
.now{font-size:.9rem; color:var(--muted)}

.section{margin-top:18px}
.card{background:var(--card); border:1px solid var(--line); border-radius:var(--radius); box-shadow:var(--shadow); backdrop-filter:blur(10px); padding:var(--pad); margin:16px 0}
.h2{font-size:1.2rem; margin:0 0 12px 0; font-weight:800; color:#ffe084; display:flex; gap:8px; align-items:center}
.h2::before{content:""; width:4px; height:18px; background:var(--brand); border-radius:2px}
.row{display:grid; gap:var(--gap); grid-template-columns:1fr}
@media (min-width:760px){ .row.cols-3{grid-template-columns:1fr 1fr 1fr} .row.cols-2{grid-template-columns:1fr 1fr} }
input,select{width:100%; border-radius:12px; border:1px solid #243244; background:var(--bg-accent); color:var(--text); padding:12px 12px; font-size:15px; outline:0}
input::placeholder{color:#6f8092}
input:focus,select:focus{box-shadow:var(--focus); border-color:#3a4c63}
.btn{display:inline-grid; place-items:center; padding:12px 16px; border-radius:12px; border:1px solid #e6c76e; background:linear-gradient(180deg,#fff9e6,#e6c76e); color:#191919; font-weight:800; cursor:pointer; transition:transform .2s ease, box-shadow .2s ease}
.btn:hover{transform:translateY(-1px); box-shadow:0 10px 22px rgba(230,199,110,.5)}
.btn[disabled]{opacity:.6; cursor:not-allowed}
.btn.ghost{background:transparent; color:var(--gold2); border:1px solid rgba(212,175,55,.45); box-shadow:none}
.btn.block{display:block; width:100%}
.pillars{display:grid; grid-template-columns:repeat(4,1fr); gap:10px; margin-bottom:20px}
.pillar{background:var(--surface); border:1px solid #253245; border-radius:12px; padding:14px 10px; text-align:center}
.pillar .tit{color:#9aa3b2; font-size:0.85rem; margin-bottom:6px}
.pillar .gz{font-size:1.5rem; font-weight:800; color:var(--gold2)}
@media (max-width:520px){ .pillars{grid-template-columns:repeat(2,1fr)} }
.bazi-table{width:100%; border-collapse:collapse; margin-top:12px; background:var(--surface); border-radius:8px; overflow:hidden}
.bazi-table th,.bazi-table td{padding:10px 12px; border:1px solid #253245; text-align:center; vertical-align:middle}
.bazi-table th{background:rgba(212,175,55,.1); color:var(--gold2)}
.bazi-table-wrap{overflow:auto}
@media (max-width:420px){ .bazi-table th,.bazi-table td{padding:8px 10px} }
.bar{height:10px; background:#0d1420; border:1px solid #233146; border-radius:999px; overflow:hidden; margin:6px 0}
.bar i{display:block; height:100%; background:linear-gradient(90deg,#ffe084,#f2d27a); width:0%; transition:width 0.5s ease}
.bar-row{display:grid; grid-template-columns:80px 1fr 60px; gap:10px; align-items:center}
.error-message{background:rgba(255,90,95,.1); border:1px solid #ff5a5f; border-radius:8px; padding:10px; display:none; margin-top:10px}
.muted{color:var(--muted)}
.time-row{display:flex; align-items:center; gap:10px}
.time-row .time-unknown{display:flex; align-items:center; gap:6px; white-space:nowrap}
.time-row input[type="time"]{width:auto !important; flex:0 0 160px; min-width:140px}
.gen-wrap{display:flex; align-items:flex-end; justify-content:flex-end}
#genBtn{width:auto !important}
.analysis-grid{display:grid; gap:16px; margin-top:20px}
.analysis-card{background:var(--surface); border:1px solid #253245; border-radius:12px; padding:16px}
.analysis-card h3{color:var(--gold2); margin:0 0 12px 0; font-size:1.1rem}
.analysis-content{line-height:1.6}
.columns{display:grid; gap:12px; grid-template-columns:1fr}
@media (min-width:900px){ .columns{grid-template-columns:1fr 1fr} }
.list-block{border:1px solid #263448; background:var(--bg-accent); border-radius:12px; padding:16px}
.list-block ul{margin:0.2rem 0 0 0; padding-left:1.1rem}
.group-title{font-size:1.05rem; color:#ffe084; margin:6px 0 14px}
.astro-auth{max-width:980px; margin:28px auto; padding:20px 18px; background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.01)); border:1px solid rgba(212,175,55,.22); border-radius:14px; box-shadow:0 18px 50px rgba(0,0,0,.35)}
.auth-grid{display:grid; gap:18px; grid-template-columns:1.2fr .8fr}
@media (max-width:860px){ .auth-grid{grid-template-columns:1fr} }
.panel{background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.01)); border:1px solid rgba(212,175,55,.22); border-radius:14px; box-shadow:0 10px 30px rgba(0,0,0,.35)}
.panel .head{padding:16px 18px; border-bottom:1px solid rgba(212,175,55,.22); color:var(--gold); font-weight:700; letter-spacing:0.3px}
.panel .body{padding:18px}
.spacer{height:12px}

/* Butler / Pro report */
.butler-professional{display:none; margin-top:20px; background:var(--card); border:1px solid var(--line); border-radius:var(--radius); padding:20px}
.butler-header{display:flex; align-items:center; gap:10px; margin-bottom:20px; color:var(--gold2); font-size:1.2rem; font-weight:700}
.butler-content{line-height:1.8; max-height:600px; overflow-y:auto; padding:15px; background:var(--surface); border-radius:10px; border:1px solid #253245}
.butler-section{margin-bottom:25px; padding-bottom:15px; border-bottom:1px solid #253245}
.butler-section h4{color:var(--gold2); margin-bottom:10px; font-size:1.05rem}

/* floating chat */
.chat-float{position:fixed; bottom:20px; right:20px; width:350px; height:500px; background:var(--card); border:1px solid var(--line); border-radius:var(--radius); box-shadow:var(--shadow); backdrop-filter:blur(10px); z-index:1000; display:none; flex-direction:column}
.chat-float-header{padding:12px 16px; border-bottom:1px solid var(--line); background:rgba(212,175,55,.1); color:var(--gold2); font-weight:700; display:flex; justify-content:space-between; align-items:center; cursor:move}
.chat-float-close{background:none; border:none; color:var(--gold2); font-size:1.2rem; cursor:pointer; padding:4px; border-radius:4px}
.chat-float-close:hover{background:rgba(212,175,55,.2)}
.chat-float-body{flex:1; display:flex; flex-direction:column; padding:0}
.chat-float-messages{flex:1; overflow-y:auto; padding:12px; background:var(--surface); font-size:0.9rem}
.chat-float-input-area{padding:12px; border-top:1px solid var(--line); background:var(--bg-accent)}
.chat-toggle-btn{position:fixed; bottom:20px; right:20px; width:60px; height:60px; border-radius:50%; background:linear-gradient(180deg,#fff9e6,#e6c76e); border:1px solid #e6c76e; color:#191919; font-size:1.5rem; cursor:pointer; box-shadow:0 4px 12px rgba(230,199,110,.3); z-index:1001; display:flex; align-items:center; justify-content:center}
.chat-toggle-btn:hover{transform:scale(1.05); box-shadow:0 6px 20px rgba(230,199,110,.5)}
@media (max-width:768px){
  .chat-float{width:300px; height:400px; bottom:10px; right:10px}
  .chat-toggle-btn{width:50px; height:50px; bottom:10px; right:10px}
}

/* form focus simplification */
input:focus,select:focus,textarea:focus{outline:none!important; box-shadow:none!important; border-color:#243244!important}
button:focus,.btn:focus,a:focus{outline:none!important; box-shadow:none!important}
*{-webkit-tap-highlight-color:transparent}

footer{color:#6c7b8c; font-size:0.85rem; text-align:center; padding:30px 0; margin-top:40px}
@media (prefers-reduced-motion: reduce){ *{animation:none !important; transition:none !important} }
  </style>
</head>
<body>
<header class="site-header">
  <div class="head-inner container">
    <a class="brand" href="https://astro.5xliving.com/" target="_self">
      <span class="brand-badge">5X</span>
      <span class="title">5xLiving ¬∑ Bazi Brief</span>
    </a>
    <div style="display:flex; align-items:center; gap:10px;">
      <!-- Language selector -->
      <select id="langSelect" style="border-radius:999px; padding:6px 10px; border:1px solid #243244; background:#0e1520; color:#e8edf3; font-size:0.85rem;">
        <option value="zh-CN">ÁÆÄ‰Ωì‰∏≠Êñá</option>
        <option value="zh-TW">ÁπÅÈ´î‰∏≠Êñá</option>
        <option value="en">English</option>
        <option value="ja">Êó•Êú¨Ë™û</option>
        <option value="th">‡πÑ‡∏ó‡∏¢</option>
        <option value="ms">Bahasa Melayu</option>
      </select>

      <span id="nowBox" class="now"></span>
    </div>
  </div>
</header>

  <main class="container">
    <!-- Input card -->
    <section class="card">
      <div class="h2">‡∏î‡∏ß‡∏á‡∏à‡∏µ‡∏ô‡∏™‡∏µ‡πà‡πÄ‡∏™‡∏≤ ¬∑ ‡∏ú‡∏π‡∏Å‡∏î‡∏ß‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß</div>
      <div class="row cols-3">
        <div>
          <label class="muted">‡∏ä‡∏∑‡πà‡∏≠ (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</label>
          <input id="name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡∏î‡∏ß‡∏á‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏ï‡∏±‡∏ß)" />
        </div>
        <div>
          <label class="muted">‡πÄ‡∏û‡∏®</label>
          <select id="gender">
            <option value="">‡πÑ‡∏°‡πà‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏£‡∏∞‡∏ö‡∏∏</option>
            <option value="male">‡∏ä‡∏≤‡∏¢</option>
            <option value="female">‡∏´‡∏ç‡∏¥‡∏á</option>
          </select>
        </div>
        <div>
          <label class="muted">‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô</label>
          <select id="calendar">
            <option value="gregorian">‡∏™‡∏∏‡∏£‡∏¥‡∏¢‡∏Ñ‡∏ï‡∏¥ (‡∏™‡∏≤‡∏Å‡∏•)</option>
            <option value="lunar">‡∏à‡∏±‡∏ô‡∏ó‡∏£‡∏Ñ‡∏ï‡∏¥ (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö)</option>
          </select>
        </div>
      </div>
      <div class="row cols-3" style="margin-top:10px">
        <div>
          <label class="muted">‡∏ß‡∏±‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏µ‡πÄ‡∏Å‡∏¥‡∏î</label>
          <input type="date" id="birthdate" />
        </div>
        <div>
          <label class="muted">‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡∏¥‡∏î</label>
          <div class="time-row">
            <input type="time" id="birthtime" />
            <label class="muted time-unknown">
              <input type="checkbox" id="timeUnknown" />
              <span>‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡∏¥‡∏î</span>
            </label>
          </div>
        </div>
        <div class="gen-wrap">
          <button class="btn" id="genBtn" type="button">
            <span id="genBtnText">‡∏ú‡∏π‡∏Å‡∏î‡∏ß‡∏á</span>
            <span id="genBtnLoading" style="display:none">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì...</span>
          </button>
        </div>
      </div>
      <div id="error" class="error-message"></div>
    </section>

    <!-- Result: pillars & elements -->
    <section id="result" style="display:none;">
      <div class="card">
        <div class="h2">‡∏ú‡∏±‡∏á‡∏î‡∏ß‡∏á Bazi ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</div>
        <div class="pillars" id="bazi-pillars"></div>
        <div class="muted" id="bazi-date" style="margin-top:6px"></div>
        <table class="bazi-table">
          <thead>
          <tr>
            <th></th>
            <th>‡πÄ‡∏™‡∏≤‡∏õ‡∏µ</th>
            <th>‡πÄ‡∏™‡∏≤‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</th>
            <th>‡πÄ‡∏™‡∏≤‡∏ß‡∏±‡∏ô</th>
            <th>‡πÄ‡∏™‡∏≤‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</th>
          </tr>
          </thead>
          <tbody>
          <tr>
            <td>‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ü‡πâ‡∏≤ (Â§©Âπ≤)</td>
            <td id="year-stem">-</td><td id="month-stem">-</td><td id="day-stem">-</td><td id="hour-stem">-</td>
          </tr>
          <tr>
            <td>‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏î‡∏¥‡∏ô (Âú∞ÊîØ)</td>
            <td id="year-branch">-</td><td id="month-branch">-</td><td id="day-branch">-</td><td id="hour-branch">-</td>
          </tr>
          <tr>
            <td>‡∏ò‡∏≤‡∏ï‡∏∏‡∏´‡∏•‡∏±‡∏Å (‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ü‡πâ‡∏≤)</td>
            <td id="year-element">-</td><td id="month-element">-</td><td id="day-element">-</td><td id="hour-element">-</td>
          </tr>
          <tr>
            <td>‡∏ô‡πà‡∏≤‡∏´‡∏¢‡∏¥‡∏ô (Á¥çÈü≥)</td>
            <td id="year-nayin">-</td><td id="month-nayin">-</td><td id="day-nayin">-</td><td id="hour-nayin">-</td>
          </tr>
          </tbody>
        </table>
      </div>

      <div class="card">
        <div class="h2">‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏û‡∏•‡∏±‡∏á‡∏ò‡∏≤‡∏ï‡∏∏‡∏ó‡∏±‡πâ‡∏á‡∏´‡πâ‡∏≤</div>
        <div class="bar-row"><span>‡πÑ‡∏°‡πâ</span><div class="bar"><i id="bar-wood"></i></div><span id="pct-wood">0%</span></div>
        <div class="bar-row"><span>‡πÑ‡∏ü</span><div class="bar"><i id="bar-fire"></i></div><span id="pct-fire">0%</span></div>
        <div class="bar-row"><span>‡∏î‡∏¥‡∏ô</span><div class="bar"><i id="bar-earth"></i></div><span id="pct-earth">0%</span></div>
        <div class="bar-row"><span>‡πÇ‡∏•‡∏´‡∏∞</span><div class="bar"><i id="bar-metal"></i></div><span id="pct-metal">0%</span></div>
        <div class="bar-row"><span>‡∏ô‡πâ‡∏≥</span><div class="bar"><i id="bar-water"></i></div><span id="pct-water">0%</span></div>
        <div id="bazi-elements-balance" class="muted" style="margin-top:8px"></div>
      </div>
    </section>

    <!-- Pro report -->
    <section id="butlerProfessional" class="butler-professional">
      <div class="butler-header">
        <span>üßô‚Äç‚ôÇÔ∏è Xinlian Butler ¬∑ ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏î‡∏ß‡∏á‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å</span>
      </div>
      <div class="butler-content" id="professionalReport"></div>
    </section>

    <!-- Floating chat -->
    <button class="chat-toggle-btn" id="chatToggle">‡∏ñ‡∏≤‡∏°‡∏î‡∏ß‡∏á</button>
    <div class="chat-float" id="chatFloat">
      <div class="chat-float-header">
        <span>üßô‚Äç‚ôÇÔ∏è Xinlian Butler ¬∑ ‡∏ñ‡∏≤‡∏°‡∏ï‡∏≠‡∏ö</span>
        <button class="chat-float-close" id="chatClose">√ó</button>
      </div>
      <div class="chat-float-body">
        <div class="chat-float-messages" id="chatMessages">
          <div class="ss-msg">
            ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏∞ ‡∏â‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏î‡∏ß‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ‡∏ú‡∏π‡∏Å‡∏î‡∏ß‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß
            ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ñ‡∏≤‡∏°‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å ‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô ‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢
          </div>
        </div>
        <div class="chat-float-input-area">
          <div style="display:flex;gap:8px;">
            <input type="text" id="chatInput" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì..." style="flex:1; padding:10px; border-radius:8px; border:1px solid #253245; background:#0e1520; color:#e8edf3;">
            <button class="btn" id="chatSend" style="padding:8px 16px;">‡∏™‡πà‡∏á</button>
          </div>
        </div>
      </div>
    </div>

    <!-- VIP segment -->
    <section class="card section">
      <h2 class="group-title">üåô ‡πÇ‡∏ã‡∏ô VIP</h2>
      <div class="columns">
        <div class="list-block">
          <div class="group-title">üóù Mingli Space ¬∑ ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</div>
          <ul>
            <li>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å: ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏Ñ‡∏π‡πà‡∏Ñ‡∏£‡∏≠‡∏á ‡∏Å‡∏≤‡∏£‡πÅ‡∏ï‡πà‡∏á‡∏á‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå</li>
            <li>‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô: ‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡πÅ‡∏•‡∏∞‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏î‡∏ß‡∏á</li>
            <li>‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô: ‡∏à‡∏∏‡∏î‡∏î‡∏∂‡∏á‡∏î‡∏π‡∏î‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤ ‡πÅ‡∏•‡∏∞‡∏à‡∏∏‡∏î‡∏£‡∏±‡πà‡∏ß‡πÑ‡∏´‡∏•</li>
            <li>‡∏î‡∏ß‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á: ‡∏û‡∏•‡∏±‡∏á‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏±‡∏ö‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏Ñ‡∏π‡πà‡πÉ‡∏à</li>
          </ul>
        </div>
        <div class="list-block">
          <div class="group-title">üåô Xinlian Space ¬∑ ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏±‡∏ß‡πÉ‡∏à</div>
          <ul>
            <li>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏à‡∏¥‡∏ï‡∏ß‡∏¥‡∏ç‡∏ç‡∏≤‡∏ì: ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ù‡∏±‡∏ô ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏©‡∏ê‡∏≤‡∏ô</li>
            <li>‡∏Ñ‡∏≠‡∏£‡πå‡∏™‡πÄ‡∏£‡∏µ‡∏¢‡∏ô: ‡∏î‡∏ß‡∏á‡∏à‡∏µ‡∏ô Bazi / ‡πÑ‡∏û‡πà‡∏ó‡∏≤‡πÇ‡∏£‡∏ï‡πå / ‡πÇ‡∏´‡∏£‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå / ‡πÄ‡∏•‡∏Ç‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå</li>
            <li>‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏∞‡∏•‡∏∂‡∏Å‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏•‡πà‡∏ß‡∏á‡∏•‡∏±‡∏ö</li>
            <li>‡πÅ‡∏ö‡∏ö‡∏ù‡∏∂‡∏Å‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå ‡πÅ‡∏•‡∏∞‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏û‡∏¥‡∏ò‡∏µ‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏•‡πá‡∏Å ‡πÜ ‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡πÄ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ö‡πâ‡∏≤‡∏ô</li>
          </ul>
        </div>
      </div>

      <div class="group-title" style="margin-top:14px">üíé ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö VIP</div>
      <section class="astro-auth">
        <div class="auth-grid">
          <div class="panel">
            <div class="head">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö / ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</div>
            <div class="body">
              <div class="row" id="authFields">
                <input id="email" name="email" type="email" inputmode="email" autocomplete="username" placeholder="‡∏≠‡∏µ‡πÄ‡∏°‡∏•">
                <input id="password" name="password" type="password" autocomplete="current-password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 8 ‡∏ï‡∏±‡∏ß)">
              </div>
              <div class="spacer"></div>
              <form id="loginForm" class="row one">
                <button class="btn block" id="loginBtn" type="submit">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
              </form>
              <div class="spacer"></div>
              <div class="row one">
                <button class="btn ghost block" id="resetBtn" type="button">üîë ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</button>
              </div>
              <div class="spacer"></div>
              <form class="row one" id="registerForm">
                <button class="btn block" id="registerBtn" type="submit">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÉ‡∏´‡∏°‡πà</button>
                <div class="muted">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏≠‡πà‡∏≤‡∏ô‡∏î‡∏ß‡∏á‡∏ü‡∏£‡∏µ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</div>
                <div class="spacer"></div>
                <div class="error-message" id="authError" style="display:none"></div>
              </form>
            </div>
          </div>

          <div class="panel">
            <div class="head">‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</div>
            <div class="body">
              <div class="row one">
                <a class="btn block" href="https://yourshopifyshop.com/products/monthly-vip" target="_blank" rel="noopener noreferrer">
                  üíé ‡∏≠‡∏±‡∏õ‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏õ‡πá‡∏ô VIP ‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
                </a>
              </div>
              <div class="row one">
                <a class="btn ghost block" href="https://yourshopifyshop.myshopify.com" target="_blank" rel="noopener noreferrer">
                  ‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏£‡πâ‡∏≤‡∏ô Astro Store
                </a>
              </div>
              <div class="muted">$9.9 / ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ¬∑ Mingli Space + Xinlian Space + ‡∏Ñ‡∏≠‡∏£‡πå‡∏™‡∏à‡∏¥‡∏ï‡∏ß‡∏¥‡∏ç‡∏ç‡∏≤‡∏ì‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
            </div>
          </div>
        </div>
      </section>
    </section>

    <footer>¬© 5XLiving ‚Ä¢ Astro Sanctuary</footer>
  </main>

  <script>
  window.API_BASE = 'https://throbbing-lab-1440.hello5xliving.workers.dev';

  (function(){
    'use strict';
    const SG_TZ = 'Asia/Singapore';
    const $ = id => document.getElementById(id);
    const state = window.state = window.state || {};
    state.lang = 'th';

    // current page language
    const CURRENT_LANG = 'th';

    // map language code -> page URL (relative paths)
    const LANG_PAGES = {
      'zh-CN': '/bazi.html',
      'en':    '/assets/bazi-language-pack/bazi-en.html',
      'zh-TW': '/assets/bazi-language-pack/bazi-zh-TW.html',
      'ja':    '/assets/bazi-language-pack/bazi-ja.html',
      'th':    '/assets/bazi-language-pack/bazi-th.html', // this page
      'ms':    '/assets/bazi-language-pack/bazi-ms.html'
    };

    /* ===== time in header (SG) ‚Äì kept simple, your second script will keep it in sync too ===== */
    function updateNowBox(){
      try{
        const now = new Date();
        const fmt = new Intl.DateTimeFormat('th-TH',{
          timeZone:SG_TZ,
          year:'numeric',month:'short',day:'2-digit',
          hour:'2-digit',minute:'2-digit'
        });
        const box = $('nowBox');
        if(box) box.textContent = fmt.format(now) + ' (SGT)';
      }catch(e){}
    }
    updateNowBox();
    setInterval(updateNowBox, 60000);

    /* ===== Bazi calculator (same logic) ===== */
    class BaziCalculator {
      constructor(){
        this.HEAVENLY_STEMS=['Jia','Yi','Bing','Ding','Wu','Ji','Geng','Xin','Ren','Gui'];
        this.STEMS_CN=['Áî≤','‰πô','‰∏ô','‰∏Å','Êàä','Â∑±','Â∫ö','Ëæõ','Â£¨','Áô∏'];
        this.EARTHLY_BRANCHES=['Â≠ê','‰∏ë','ÂØÖ','ÂçØ','Ëæ∞','Â∑≥','Âçà','Êú™','Áî≥','ÈÖâ','Êàå','‰∫•'];
        this.NAYIN=[
          '‡πÇ‡∏•‡∏´‡∏∞‡πÉ‡∏ô‡∏ó‡∏∞‡πÄ‡∏•','‡πÑ‡∏ü‡πÉ‡∏ô‡πÄ‡∏ï‡∏≤','‡πÑ‡∏°‡πâ‡πÉ‡∏ô‡∏õ‡πà‡∏≤','‡∏î‡∏¥‡∏ô‡∏£‡∏¥‡∏°‡∏ó‡∏≤‡∏á',
          '‡πÇ‡∏•‡∏´‡∏∞‡∏Ñ‡∏°‡∏î‡∏≤‡∏ö','‡πÑ‡∏ü‡∏ö‡∏ô‡∏†‡∏π‡πÄ‡∏Ç‡∏≤','‡∏ô‡πâ‡∏≥‡πÉ‡∏ï‡πâ‡∏ò‡∏≤‡∏£','‡∏î‡∏¥‡∏ô‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÄ‡∏°‡∏∑‡∏≠‡∏á',
          '‡πÇ‡∏•‡∏´‡∏∞‡∏Ç‡∏µ‡πâ‡∏ú‡∏∂‡πâ‡∏á‡∏Ç‡∏≤‡∏ß','‡πÑ‡∏°‡πâ‡∏ï‡πâ‡∏ô‡∏´‡∏•‡∏¥‡∏ß','‡∏ô‡πâ‡∏≥‡πÉ‡∏ô‡∏ö‡πà‡∏≠','‡∏î‡∏¥‡∏ô‡∏ö‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Ñ‡∏≤',
          '‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏£‡πâ‡∏≠‡∏á','‡πÑ‡∏°‡πâ‡∏™‡∏ô‡πÅ‡∏•‡∏∞‡πÑ‡∏ã‡πÄ‡∏õ‡∏£‡∏™','‡∏™‡∏≤‡∏¢‡∏ô‡πâ‡∏≥‡πÑ‡∏´‡∏•','‡πÇ‡∏•‡∏´‡∏∞‡∏ó‡∏£‡∏≤‡∏¢‡∏Å‡∏£‡∏ß‡∏î',
          '‡πÑ‡∏ü‡πÄ‡∏ä‡∏¥‡∏á‡πÄ‡∏Ç‡∏≤','‡πÑ‡∏°‡πâ‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏ö','‡∏î‡∏¥‡∏ô‡∏Å‡∏≥‡πÅ‡∏û‡∏á','‡πÇ‡∏•‡∏´‡∏∞‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥‡πÄ‡∏õ‡∏•‡∏ß',
          '‡πÑ‡∏ü‡∏ï‡∏∞‡πÄ‡∏Å‡∏µ‡∏¢‡∏á','‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≥‡∏ö‡∏ô‡∏ü‡πâ‡∏≤','‡∏î‡∏¥‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏ó‡∏≤‡∏á','‡πÇ‡∏•‡∏´‡∏∞‡∏≠‡∏±‡∏ç‡∏°‡∏ì‡∏µ',
          '‡πÑ‡∏°‡πâ‡∏´‡∏°‡πà‡∏≠‡∏ô','‡∏ô‡πâ‡∏≥‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≥‡πÉ‡∏´‡∏ç‡πà','‡∏î‡∏¥‡∏ô‡∏ó‡∏£‡∏≤‡∏¢','‡πÑ‡∏ü‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå',
          '‡πÑ‡∏°‡πâ‡∏ó‡∏±‡∏ö‡∏ó‡∏¥‡∏°','‡∏ô‡πâ‡∏≥‡∏°‡∏´‡∏≤‡∏™‡∏°‡∏∏‡∏ó‡∏£'
        ];
      }
      stemCn(index){ return this.STEMS_CN[(index+10)%10]; }
      yearPillar(year){
        const s=(year-4)%10, b=(year-4)%12;
        return {stemCn:this.stemCn(s), stem:this.HEAVENLY_STEMS[(s+10)%10], branch:this.EARTHLY_BRANCHES[(b+12)%12]};
      }
      solarMonthIndex(y,m,d){
        const mmdd=m*100+d;
        const gates=[[106,12],[204,1],[306,2],[405,3],[506,4],[606,5],[707,6],[808,7],[908,8],[1008,9],[1107,10],[1207,11]];
        let idx=11; for(const [thr,val] of gates){ if(mmdd>=thr) idx=val; }
        const branchBy={1:'ÂØÖ',2:'ÂçØ',3:'Ëæ∞',4:'Â∑≥',5:'Âçà',6:'Êú™',7:'Áî≥',8:'ÈÖâ',9:'Êàå',10:'‰∫•',11:'Â≠ê',12:'‰∏ë'};
        return {index:idx, branch:branchBy[idx]};
      }
      monthPillar(year,month,day){
        const {index,branch}=this.solarMonthIndex(year,month,day);
        const yStemIdx=(this.yearPillar(year).stemCn && this.STEMS_CN.indexOf(this.yearPillar(year).stemCn)) || 0;
        const startMap={0:2,1:4,2:6,3:8,4:0,5:2,6:4,7:6,8:8,9:0};
        const stemIdx=(startMap[yStemIdx]+(index-1))%10;
        return {stemCn:this.stemCn(stemIdx), stem:this.HEAVENLY_STEMS[stemIdx], branch};
      }
      dayPillar(year,month,day){
        const baseUTC=Date.UTC(1900,0,31), targetUTC=Date.UTC(year,month-1,day);
        const dayDiff=Math.floor((targetUTC-baseUTC)/86400000);
        const stemIdx=(0+dayDiff)%10, branchIdx=(4+dayDiff)%12;
        return {stemCn:this.stemCn(stemIdx), stem:this.HEAVENLY_STEMS[(stemIdx+10)%10],branch:this.EARTHLY_BRANCHES[(branchIdx+12)%12]};
      }
      hourPillar(dayStemCn,hour){
        const branchMap={23:'Â≠ê',0:'Â≠ê',1:'‰∏ë',2:'‰∏ë',3:'ÂØÖ',4:'ÂØÖ',5:'ÂçØ',6:'ÂçØ',7:'Ëæ∞',8:'Ëæ∞',9:'Â∑≥',10:'Â∑≥',11:'Âçà',12:'Âçà',13:'Êú™',14:'Êú™',15:'Áî≥',16:'Áî≥',17:'ÈÖâ',18:'ÈÖâ',19:'Êàå',20:'Êàå',21:'‰∫•',22:'‰∫•'};
        const startMap={0:0,1:2,2:4,3:6,4:8,5:0,6:2,7:4,8:6,9:8};
        const dayIdx=this.STEMS_CN.indexOf(dayStemCn);
        const hourIndex=Math.floor((hour+1)/2)%12;
        const stemIdx=(startMap[dayIdx]+hourIndex)%10;
        return {stemCn:this.stemCn(stemIdx), stem:this.HEAVENLY_STEMS[stemIdx], branch:branchMap[hour]};
      }
      stemElem(cn){
        return ({'Áî≤':'Kayu','‰πô':'Kayu','‰∏ô':'Api','‰∏Å':'Api','Êàä':'Tanah','Â∑±':'Tanah',
                 'Â∫ö':'Logam','Ëæõ':'Logam','Â£¨':'Air','Áô∏':'Air'})[cn]||'-';
      }
      branchElem(b){
        return ({'Â≠ê':'Air','‰∏ë':'Tanah','ÂØÖ':'Kayu','ÂçØ':'Kayu','Ëæ∞':'Tanah','Â∑≥':'Api',
                 'Âçà':'Api','Êú™':'Tanah','Áî≥':'Logam','ÈÖâ':'Logam','Êàå':'Tanah','‰∫•':'Air'})[b]||'-';
      }

      // Stem name + ‡∏ò‡∏≤‡∏ï‡∏∏‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢
      stemNameEn(stemCn){
        const idx = this.STEMS_CN.indexOf(stemCn);
        if (idx === -1) return stemCn;
        const base = this.HEAVENLY_STEMS[idx]; // Jia / Yi / Bing ...
        const elemKey = this.stemElem(stemCn); // Kayu / Api / Tanah / Logam / Air
        const elemThMap = { Kayu:'‡πÑ‡∏°‡πâ', Api:'‡πÑ‡∏ü', Tanah:'‡∏î‡∏¥‡∏ô', Logam:'‡πÇ‡∏•‡∏´‡∏∞', Air:'‡∏ô‡πâ‡∏≥' };
        const elemTh = elemThMap[elemKey] || elemKey;
        return `${base} (${elemTh})`;
      }

      // Branch name + ‡∏™‡∏±‡∏ï‡∏ß‡πå 12 ‡∏ô‡∏±‡∏Å‡∏©‡∏±‡∏ï‡∏£‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢
      branchNameEn(b){
        const map = {
          'Â≠ê':'Zi (‡∏´‡∏ô‡∏π)',
          '‰∏ë':'Chou (‡∏ß‡∏±‡∏ß)',
          'ÂØÖ':'Yin (‡πÄ‡∏™‡∏∑‡∏≠)',
          'ÂçØ':'Mao (‡∏Å‡∏£‡∏∞‡∏ï‡πà‡∏≤‡∏¢)',
          'Ëæ∞':'Chen (‡∏°‡∏±‡∏á‡∏Å‡∏£)',
          'Â∑≥':'Si (‡∏á‡∏π)',
          'Âçà':'Wu (‡∏°‡πâ‡∏≤)',
          'Êú™':'Wei (‡πÅ‡∏û‡∏∞)',
          'Áî≥':'Shen (‡∏•‡∏¥‡∏á)',
          'ÈÖâ':'You (‡πÑ‡∏Å‡πà)',
          'Êàå':'Xu (‡∏™‡∏∏‡∏ô‡∏±‡∏Ç)',
          '‰∫•':'Hai (‡∏´‡∏°‡∏π)'
        };
        return map[b] || b;
      }

      nayin(stemCn,branch){
        const si=this.STEMS_CN.indexOf(stemCn), bi=this.EARTHLY_BRANCHES.indexOf(branch);
        return this.NAYIN[(si*2+bi)%this.NAYIN.length];
      }
    }

    /* ===== Simple analysis helpers in THAI ===== */
    const DayMasterText = {
      'Áî≤':'Êó•‰∏ª Áî≤‡πÑ‡∏°‡πâ‡πÉ‡∏´‡∏ç‡πà: ‡∏Å‡∏•‡πâ‡∏≤‡∏Ñ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≤‡∏ó‡∏≥ ‡∏ä‡∏≠‡∏ö‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡∏¥‡πà‡∏á‡πÉ‡∏´‡∏°‡πà ‡πÜ ‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏•‡∏±‡∏á‡∏ô‡∏≥‡∏ó‡∏µ‡∏° ‡πÅ‡∏ï‡πà‡∏ö‡∏≤‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏î‡∏±‡∏ô‡∏ó‡∏∏‡∏£‡∏±‡∏á‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢',
      '‰πô':'Êó•‰∏ª ‰πô‡πÑ‡∏°‡πâ‡πÄ‡∏•‡∏∑‡πâ‡∏≠‡∏¢: ‡∏≠‡πà‡∏≠‡∏ô‡πÇ‡∏¢‡∏ô ‡∏õ‡∏£‡∏∞‡∏ô‡∏µ‡∏õ‡∏£‡∏∞‡∏ô‡∏≠‡∏° ‡πÄ‡∏Å‡πà‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏π‡πÅ‡∏•‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô ‡πÅ‡∏ï‡πà‡∏ä‡∏≠‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡πÄ‡∏Å‡∏£‡∏á‡πÉ‡∏à‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô',
      '‰∏ô':'Êó•‰∏ª ‰∏ô‡πÑ‡∏ü‡πÉ‡∏´‡∏ç‡πà: ‡∏™‡∏î‡πÉ‡∏™ ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢ ‡∏ä‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏°‡∏µ‡∏™‡∏µ‡∏™‡∏±‡∏ô ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏û‡∏•‡∏±‡∏á‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏≠‡∏Å',
      '‰∏Å':'Êó•‰∏ª ‰∏Å‡πÑ‡∏ü‡∏ï‡∏∞‡πÄ‡∏Å‡∏µ‡∏¢‡∏á: ‡πÉ‡∏à‡∏î‡∏µ ‡∏≠‡∏ö‡∏≠‡∏∏‡πà‡∏ô ‡∏£‡∏±‡∏Å‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß ‡πÄ‡∏Å‡πà‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÉ‡∏´‡πâ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏à‡∏Ñ‡∏ô‡∏£‡∏≠‡∏ö‡∏ï‡∏±‡∏ß ‡πÅ‡∏ï‡πà‡∏≠‡∏≤‡∏à‡∏•‡∏±‡∏á‡πÄ‡∏•‡πÄ‡∏ß‡∏•‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏≠‡∏á',
      'Êàä':'Êó•‰∏ª Êàä‡∏î‡∏¥‡∏ô‡∏†‡∏π‡πÄ‡∏Ç‡∏≤: ‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á ‡∏´‡∏ô‡∏±‡∏Å‡πÅ‡∏ô‡πà‡∏ô ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏™‡∏π‡∏á ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß',
      'Â∑±':'Êó•‰∏ª Â∑±‡∏î‡∏¥‡∏ô‡∏£‡∏≤‡∏ö: ‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏≠‡∏ö ‡∏Ñ‡∏¥‡∏î‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÄ‡∏™‡∏°‡∏≠ ‡πÅ‡∏ï‡πà‡∏°‡∏µ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏Ñ‡∏¥‡∏î‡∏Å‡∏±‡∏á‡∏ß‡∏•‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡πå‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÅ‡∏£‡∏á',
      'Â∫ö':'Êó•‰∏ª Â∫ö‡πÇ‡∏•‡∏´‡∏∞‡∏î‡∏¥‡∏ö: ‡∏ï‡∏£‡∏á‡πÑ‡∏õ‡∏ï‡∏£‡∏á‡∏°‡∏≤ ‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡πÑ‡∏ß ‡πÑ‡∏°‡πà‡∏ä‡∏≠‡∏ö‡∏≠‡∏∞‡πÑ‡∏£‡∏Ñ‡∏£‡∏∂‡πà‡∏á ‡πÜ ‡∏Å‡∏•‡∏≤‡∏á ‡πÜ ‡∏£‡∏±‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô',
      'Ëæõ':'Êó•‰∏ª Ëæõ‡πÇ‡∏•‡∏´‡∏∞‡∏õ‡∏£‡∏∞‡∏ì‡∏µ‡∏ï: ‡πÄ‡∏ô‡∏µ‡πâ‡∏¢‡∏ö ‡∏£‡∏™‡∏ô‡∏¥‡∏¢‡∏°‡∏î‡∏µ ‡πÉ‡∏™‡πà‡πÉ‡∏à‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ‡∏°‡∏±‡∏Å‡∏ï‡∏±‡πâ‡∏á‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡πÑ‡∏ß‡πâ‡∏™‡∏π‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏Å‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô',
      'Â£¨':'Êó•‰∏ª Â£¨‡∏ô‡πâ‡∏≥‡∏°‡∏´‡∏≤‡∏™‡∏°‡∏∏‡∏ó‡∏£: ‡∏£‡∏±‡∏Å‡∏≠‡∏¥‡∏™‡∏£‡∏∞ ‡∏ä‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß ‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏Å‡∏≤‡∏®‡∏ö‡πà‡∏≠‡∏¢ ‡πÜ',
      'Áô∏':'Êó•‰∏ª Áô∏‡∏ô‡πâ‡∏≥‡∏ù‡∏ô: ‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏≠‡πà‡∏≠‡∏ô ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡∏•‡∏∂‡∏Å‡∏ã‡∏∂‡πâ‡∏á ‡πÅ‡∏ï‡πà‡πÄ‡∏Å‡πá‡∏ö‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡πÉ‡∏à‡∏á‡πà‡∏≤‡∏¢ ‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢'
    };

    const RelationText = {
      'Áî≤':{
        traits:'‡πÉ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå ‡∏Ñ‡∏∏‡∏ì‡∏°‡∏±‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏ù‡πà‡∏≤‡∏¢‡∏ô‡∏≥ ‡∏Ñ‡∏≠‡∏¢‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô ‡πÅ‡∏•‡∏∞‡∏î‡∏π‡πÅ‡∏•‡∏≠‡∏µ‡∏Å‡∏ù‡πà‡∏≤‡∏¢',
        tips:'‡∏Å‡πà‡∏≠‡∏ô‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÉ‡∏´‡∏ç‡πà ‡∏•‡∏≠‡∏á‡∏ä‡∏∞‡∏•‡∏≠‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞‡∏•‡∏á‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏´‡∏ô‡∏∂‡πà‡∏á ‡∏ü‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏π‡πà‡πÉ‡∏´‡πâ‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏Å‡∏ô‡∏¥‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏•‡∏∂‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô'
      },
      '‰πô':{
        traits:'‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡∏£‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏≠‡πà‡∏≠‡∏ô‡πÇ‡∏¢‡∏ô ‡∏ä‡∏≠‡∏ö‡∏ä‡πà‡∏ß‡∏¢ ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô ‡πÅ‡∏•‡∏∞‡∏°‡∏±‡∏Å‡πÉ‡∏´‡πâ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö',
        tips:'‡∏•‡∏≠‡∏á‡∏ù‡∏∂‡∏Å‡∏ö‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏ï‡∏£‡∏á ‡πÜ ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï‡∏ó‡∏µ‡πà‡∏™‡∏ö‡∏≤‡∏¢‡πÉ‡∏à ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡πÄ‡∏´‡∏ô‡∏∑‡πà‡∏≠‡∏¢‡∏•‡πâ‡∏≤‡πÉ‡∏ô‡πÉ‡∏à'
      },
      '‰∏ô':{
        traits:'‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏ï‡∏∑‡πà‡∏ô‡πÄ‡∏ï‡πâ‡∏ô ‡∏≠‡∏ö‡∏≠‡∏∏‡πà‡∏ô ‡πÅ‡∏•‡∏∞‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡πÉ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å',
        tips:'‡πÄ‡∏ß‡∏•‡∏≤‡∏°‡∏µ‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏Ç‡∏∂‡πâ‡∏ô‡∏™‡∏π‡∏á ‡∏Ñ‡∏ß‡∏£‡∏û‡∏±‡∏Å‡πÉ‡∏à‡πÉ‡∏´‡πâ‡πÄ‡∏¢‡πá‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏∏‡∏¢ ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡∏•‡∏î‡∏Ñ‡∏≥‡∏û‡∏π‡∏î‡πÅ‡∏£‡∏á ‡πÜ ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡πÉ‡∏à‡∏Å‡∏±‡∏ô‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á'
      },
      '‰∏Å':{
        traits:'‡∏•‡∏∂‡∏Å ‡πÜ ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Å‡∏±‡∏ö ‚Äú‡∏ö‡πâ‡∏≤‡∏ô‚Äù ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏°‡∏≤‡∏Å',
        tips:'‡∏≠‡∏¢‡πà‡∏≤‡∏Ñ‡∏¥‡∏î‡πÅ‡∏ó‡∏ô‡∏≠‡∏µ‡∏Å‡∏ù‡πà‡∏≤‡∏¢‡∏ó‡∏∏‡∏Å‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á ‡∏•‡∏≠‡∏á‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡∏ß‡πà‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡πÉ‡∏™‡πà‡πÉ‡∏à‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏ö‡πâ‡∏≤‡∏á‡πÄ‡∏ä‡πà‡∏ô‡∏Å‡∏±‡∏ô'
      },
      'Êàä':{
        traits:'‡∏Ñ‡∏∏‡∏ì‡∏°‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡πÅ‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏±‡∏á ‡πÄ‡∏ô‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡πÅ‡∏•‡∏∞‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô',
        tips:'‡∏ô‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¥‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡πà‡∏≠‡∏ô‡πÇ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡πÇ‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå‡πÄ‡∏•‡πá‡∏Å ‡πÜ ‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡πÑ‡∏°‡πà‡πÅ‡∏´‡πâ‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ'
      },
      'Â∑±':{
        traits:'‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏™‡πà‡πÉ‡∏à‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏•‡πá‡∏Å ‡πÜ ‡∏ô‡πâ‡∏≠‡∏¢ ‡πÜ ‡πÉ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå ‡πÅ‡∏•‡∏∞‡∏°‡∏±‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏≤‡∏Ñ‡∏¥‡∏î',
        tips:'‡∏≠‡∏¢‡πà‡∏≤‡πÇ‡∏ó‡∏©‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ ‡πÅ‡∏ö‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏Å‡∏±‡∏ö‡∏Ñ‡∏π‡πà ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢ ‡πÜ ‡πÅ‡∏Å‡πâ‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô'
      },
      'Â∫ö':{
        traits:'‡∏Ñ‡∏∏‡∏ì‡∏ä‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô ‡πÑ‡∏°‡πà‡∏ä‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏•‡∏∏‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡πÉ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å',
        tips:'‡πÄ‡∏ß‡∏•‡∏≤‡∏û‡∏π‡∏î‡∏ï‡∏£‡∏á ‡∏•‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏∏‡πà‡∏°‡∏ô‡∏ß‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡∏ô‡∏¥‡∏î‡∏´‡∏ô‡∏∂‡πà‡∏á ‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡∏û‡∏π‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ñ‡∏π‡∏Å‡∏ü‡∏±‡∏á‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô'
      },
      'Ëæõ':{
        traits:'‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏™‡∏π‡∏á‡πÉ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå ‡πÅ‡∏•‡∏∞‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏Å‡∏≤‡∏®‡πÑ‡∏î‡πâ‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î',
        tips:'‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡∏ß‡πà‡∏≤‡∏Ñ‡∏ô‡∏£‡∏±‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡πâ‡∏≠‡∏á ‚Äú‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡πÅ‡∏ö‡∏ö‚Äù ‡πÅ‡∏Ñ‡πà‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô‡∏Å‡πá‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠'
      },
      'Â£¨':{
        traits:'‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏≠‡∏¥‡∏™‡∏£‡∏∞‡πÅ‡∏°‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå ‡πÑ‡∏°‡πà‡∏ä‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ',
        tips:'‡∏Ñ‡∏ß‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏´‡∏°‡πà ‡πÜ ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö‡∏Ñ‡∏π‡πà ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏î‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏™‡∏°‡∏≠ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏õ‡∏´‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏∑‡πà‡∏ô‡πÄ‡∏ï‡πâ‡∏ô‡∏ô‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå'
      },
      'Áô∏':{
        traits:'‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏ã‡∏ô‡∏ã‡∏¥‡∏ó‡∏µ‡∏ü‡∏Å‡∏±‡∏ö‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏Å‡∏≤‡∏®‡∏°‡∏≤‡∏Å ‡∏£‡∏±‡∏ö‡∏£‡∏π‡πâ‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏Ñ‡∏ô‡∏£‡∏±‡∏Å‡πÑ‡∏ß',
        tips:'‡∏Å‡πà‡∏≠‡∏ô‡∏à‡∏∞‡∏Ñ‡∏∏‡∏¢‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏ô‡∏±‡∏Å ‡πÜ ‡∏•‡∏≠‡∏á‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÉ‡∏´‡πâ‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡πÑ‡∏î‡πâ‡∏•‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏´‡∏•‡∏∏‡∏î‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå'
      }
    };

    // ‡πÅ‡∏õ‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ò‡∏≤‡∏ï‡∏∏ (‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏¢‡∏±‡∏á‡πÉ‡∏ä‡πâ Kayu/Api/Tanah/Logam/Air)
    const ELEM_LABEL_TH = {
      Kayu:  '‡πÑ‡∏°‡πâ',
      Api:   '‡πÑ‡∏ü',
      Tanah: '‡∏î‡∏¥‡∏ô',
      Logam: '‡πÇ‡∏•‡∏´‡∏∞',
      Air:   '‡∏ô‡πâ‡∏≥'
    };

    function strongestWeakest(counts){
      const order=['Kayu','Api','Tanah','Logam','Air'];
      let max = -1, min = 1e9, maxKey='Kayu', minKey='Kayu';
      order.forEach(k=>{
        const v = counts[k]||0;
        if(v>max){ max=v; maxKey=k; }
        if(v<min){ min=v; minKey=k; }
      });
      return {strongest:maxKey, weakest:minKey};
    }

    /* ===== Pro report builder (TH) ===== */
    function buildProReport(ctx){
      const box = $('professionalReport');
      if(!box || !ctx) return;
      const dmStemCn = ctx.day.stemCn;
      const rel = RelationText[dmStemCn] || {
        traits:'‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ã‡∏±‡∏û‡∏û‡∏≠‡∏£‡πå‡∏ï‡∏Å‡∏±‡∏ô‡πÉ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå',
        tips:'‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡∏ï‡∏£‡∏á‡πÑ‡∏õ‡∏ï‡∏£‡∏á‡∏°‡∏≤‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏£‡πâ‡∏≤‡∏¢‡πÉ‡∏à‡∏Å‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß'
      };
      const dmLine = DayMasterText[dmStemCn] || '‡∏ß‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å (Day Master) ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡πÑ‡∏î‡πâ‡∏î‡∏µ';
      const {strongest, weakest} = strongestWeakest(ctx.elements);
      const strongestLabel = ELEM_LABEL_TH[strongest] || strongest;
      const weakestLabel   = ELEM_LABEL_TH[weakest]   || weakest;

      const parts = [];

      parts.push(`
        <div class="butler-section">
          <h4>1. ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏° ¬∑ ‡∏ß‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å (Day Master)</h4>
          <p><strong>‡∏ß‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å:</strong> ${ctx.day.stemEn} (${dmStemCn})</p>
          <p>${dmLine}</p>
        </div>
      `);

      parts.push(`
        <div class="butler-section">
          <h4>2. ‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏ò‡∏≤‡∏ï‡∏∏‡∏ó‡∏±‡πâ‡∏á‡∏´‡πâ‡∏≤</h4>
          <p>
            ‡πÑ‡∏°‡πâ: ${ctx.elements.Kayu || ctx.elements.Wood || 0}% ¬∑
            ‡πÑ‡∏ü: ${ctx.elements.Api || ctx.elements.Fire || 0}% ¬∑
            ‡∏î‡∏¥‡∏ô: ${ctx.elements.Tanah || ctx.elements.Earth || 0}% ¬∑
            ‡πÇ‡∏•‡∏´‡∏∞: ${ctx.elements.Logam || ctx.elements.Metal || 0}% ¬∑
            ‡∏ô‡πâ‡∏≥: ${ctx.elements.Air || ctx.elements.Water || 0}%.
          </p>
          <p>
            <strong>‡∏ò‡∏≤‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡πÄ‡∏î‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î:</strong> ${strongestLabel}<br/>
            <strong>‡∏ò‡∏≤‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡∏≠‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î:</strong> ${weakestLabel}
          </p>
          <p>
            ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏à‡∏£‡∏¥‡∏á ‡πÉ‡∏´‡πâ ‚Äú‡∏û‡∏∂‡πà‡∏á‡∏û‡∏≤‡∏ò‡∏≤‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡πÄ‡∏î‡πà‡∏ô‚Äù ‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à
            ‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≠‡∏¢ ‡πÜ ‚Äú‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏ò‡∏≤‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡∏≠‡πà‡∏≠‡∏ô‚Äù ‡∏ú‡πà‡∏≤‡∏ô‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏° ‡∏™‡∏µ ‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤ ‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏ö
            ‡πÅ‡∏•‡∏∞‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏≥
          </p>
        </div>
      `);

      parts.push(`
        <div class="butler-section">
          <h4>3. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å & ‡∏Å‡∏≤‡∏£‡πÅ‡∏ï‡πà‡∏á‡∏á‡∏≤‡∏ô</h4>
          <p><strong>‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì:</strong> ${rel.traits}</p>
          <p><strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ${rel.tips}</p>
          <p>
            ‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°‡πÅ‡∏•‡πâ‡∏ß ‡∏î‡∏ß‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡πà‡∏≠‡∏¢ ‡πÜ ‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï
            ‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ô‡∏ö‡πà‡∏≠‡∏¢ ‡πÜ ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß‡∏ï‡∏≤‡∏°‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏ä‡∏±‡πà‡∏ß‡∏ß‡∏π‡∏ö
            ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏±‡∏Å‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏á‡∏≤‡∏ô‡∏Å‡∏î‡∏î‡∏±‡∏ô‡∏°‡∏≤‡∏Å ‡πÜ
          </p>
        </div>
      `);

      parts.push(`
        <div class="butler-section">
          <h4>4. ‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏á‡∏≤‡∏ô & ‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏≠‡∏≤‡∏ä‡∏µ‡∏û</h4>
          <p>
            ‡∏î‡∏ß‡∏á‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏ô‡∏µ‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡πÅ‡∏ö‡∏ö ‚Äú‡∏Ñ‡πà‡∏≠‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≠‡∏¢‡πÑ‡∏õ ‡πÅ‡∏ï‡πà‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‚Äù
            ‡∏Ñ‡∏∑‡∏≠‡∏¢‡∏¥‡πà‡∏á‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡∏°‡∏≤‡∏Å‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏£ ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô‡∏ï‡∏•‡∏≤‡∏î‡∏Å‡πá‡∏à‡∏∞‡∏¢‡∏¥‡πà‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô
          </p>
          <p>
            ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πâ/‡πÑ‡∏ü‡πÄ‡∏î‡πà‡∏ô ‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡∏ñ‡∏ô‡∏±‡∏î‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏à‡∏≠‡∏Ñ‡∏ô ‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß ‡∏û‡∏π‡∏î‡∏Ñ‡∏∏‡∏¢ ‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠
            ‡∏ñ‡πâ‡∏≤‡πÇ‡∏•‡∏´‡∏∞/‡∏ô‡πâ‡∏≥‡πÄ‡∏î‡πà‡∏ô ‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡∏ñ‡∏ô‡∏±‡∏î‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå ‡∏£‡∏∞‡∏ö‡∏ö ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏≤‡∏á
            ‡πÉ‡∏´‡πâ‡∏•‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏ï‡∏≤‡∏°‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡∏™‡∏±‡∏á‡∏Ñ‡∏°
          </p>
        </div>
      `);

      parts.push(`
        <div class="butler-section">
          <h4>5. ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô & ‡∏ß‡∏¥‡∏ò‡∏µ‡∏î‡∏π‡πÅ‡∏•‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÄ‡∏á‡∏¥‡∏ô</h4>
          <p>
            ‡∏î‡∏ß‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏ô‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á ‚Äú‡∏ê‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‚Äù ‡∏Å‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏ï‡πà‡∏≠‡∏¢‡∏≠‡∏î‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏ï‡∏≤‡∏°‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï
            ‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÉ‡∏´‡∏ç‡πà‡πÅ‡∏ö‡∏ö‡∏ó‡∏∏‡πà‡∏°‡∏´‡∏°‡∏î‡∏ï‡∏±‡∏ß‡πÉ‡∏ô‡∏ó‡∏µ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
          </p>
          <p>
            ‡∏ï‡∏±‡πâ‡∏á‡∏á‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢ ‡πÜ ‡πÄ‡∏ä‡πà‡∏ô ‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô 3 ‡∏™‡πà‡∏ß‡∏ô:
            <br>‚ë† ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô ‚ë° ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô ‚ë¢ ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á/‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏•‡∏≠‡∏á‡∏Ç‡∏≠‡∏á
            ‡∏ó‡∏µ‡πà‡∏¢‡∏≠‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô
          </p>
        </div>
      `);

      parts.push(`
        <div class="butler-section">
          <h4>6. ‡πÄ‡∏ä‡πá‡∏Å‡∏•‡∏¥‡∏™‡∏ï‡πå‡∏•‡∏á‡∏°‡∏∑‡∏≠‡πÉ‡∏ô 30 ‡∏ß‡∏±‡∏ô</h4>
          <ul>
            <li>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å 1 ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏Å‡πÉ‡∏ô 30 ‡∏ß‡∏±‡∏ô (‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏á‡∏≤‡∏ô ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û) ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô</li>
            <li>‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ß‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Å‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå 1 ‡∏ß‡∏±‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏ß‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏°‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏´‡∏ô‡πÅ‡∏•‡πâ‡∏ß</li>
            <li>‡πÉ‡∏ä‡πâ‡∏™‡∏µ ‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏∑‡πà‡∏≠‡∏ñ‡∏∂‡∏á‡∏ò‡∏≤‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡πÄ‡∏î‡πà‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ï‡∏¥‡∏°‡∏û‡∏•‡∏±‡∏á‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á</li>
            <li>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ô‡∏¥‡∏™‡∏±‡∏¢‡πÄ‡∏•‡πá‡∏Å ‡πÜ ‡πÄ‡∏û‡∏µ‡∏¢‡∏á 1‚Äì2 ‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏ò‡∏≤‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡∏≠‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠ ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</li>
          </ul>
        </div>
      `);

      box.innerHTML = parts.join('\n');
      const sec = $('butlerProfessional');
      if(sec) sec.style.display = 'block';
    }

    /* ===== Generate Bazi flow ===== */
    const calc = new BaziCalculator();

    function showError(msg){
      const e = $('error');
      if(!e) return;
      e.textContent = msg;
      e.style.display = 'block';
    }
    function clearError(){
      const e = $('error');
      if(e){ e.textContent=''; e.style.display='none'; }
    }

    function onGenerate(){
      clearError();
      const btn = $('genBtn');
      const textSpan = $('genBtnText');
      const loadSpan = $('genBtnLoading');
      const birthdate = $('birthdate').value;
      const timeStr = $('birthtime').value;
      const timeUnknown = $('timeUnknown').checked;

      if(!birthdate){
        showError('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ß‡∏±‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏µ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì');
        return;
      }
      const m = birthdate.match(/^(\d{4})-(\d{2})-(\d{2})$/);
      if(!m){
        showError('‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡πÉ‡∏ä‡πâ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö YYYY-MM-DD)');
        return;
      }
      const year = parseInt(m[1],10), month=parseInt(m[2],10), day=parseInt(m[3],10);

      let hour = null, minute = null;
      if(!timeUnknown && timeStr){
        const tm = timeStr.match(/^(\d{2}):(\d{2})$/);
        if(tm){
          hour = parseInt(tm[1],10);
          minute = parseInt(tm[2],10);
        }
      }

      if(btn){ btn.disabled=true; }
      if(textSpan) textSpan.style.display='none';
      if(loadSpan) loadSpan.style.display='inline';

      try{
        const yearP = calc.yearPillar(year);
        const monthP = calc.monthPillar(year,month,day);
        const dayP = calc.dayPillar(year,month,day);
        const hasHour = hour!==null && !isNaN(hour);
        const hourP = hasHour ? calc.hourPillar(dayP.stemCn,hour) : null;

        const pillarsBox = $('bazi-pillars');
        if(pillarsBox){
          pillarsBox.innerHTML = '';
          const arr = [
            {label:'‡πÄ‡∏™‡∏≤‡∏õ‡∏µ', p:yearP},
            {label:'‡πÄ‡∏™‡∏≤‡πÄ‡∏î‡∏∑‡∏≠‡∏ô',p:monthP},
            {label:'‡πÄ‡∏™‡∏≤‡∏ß‡∏±‡∏ô',p:dayP},
            {label:'‡πÄ‡∏™‡∏≤‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á',p:hourP}
          ];
          arr.forEach(item=>{
            const div = document.createElement('div');
            div.className='pillar';
            if(item.p){
              const stemFull = calc.stemNameEn(item.p.stemCn);
              const branchFull = calc.branchNameEn(item.p.branch);
              div.innerHTML = `
                <div class="tit">${item.label}</div>
                <div class="gz">${stemFull} ¬∑ ${branchFull}</div>
                <div class="muted">${item.p.stemCn}${item.p.branch}</div>
              `;
            }else{
              div.innerHTML = `
                <div class="tit">${item.label}</div>
                <div class="gz">‚Äî</div>
                <div class="muted">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>
              `;
            }
            pillarsBox.appendChild(div);
          });
        }

        function setText(id,val){ const el=$(id); if(el) el.textContent = val==null?'-':val; }
        setText('year-stem',  `${calc.stemNameEn(yearP.stemCn)} (${yearP.stemCn})`);
        setText('month-stem', `${calc.stemNameEn(monthP.stemCn)} (${monthP.stemCn})`);
        setText('day-stem',   `${calc.stemNameEn(dayP.stemCn)} (${dayP.stemCn})`);
        setText('hour-stem',  hourP ? `${calc.stemNameEn(hourP.stemCn)} (${hourP.stemCn})` : '‚Äî');

        setText('year-branch',  `${calc.branchNameEn(yearP.branch)} (${yearP.branch})`);
        setText('month-branch', `${calc.branchNameEn(monthP.branch)} (${monthP.branch})`);
        setText('day-branch',   `${calc.branchNameEn(dayP.branch)} (${dayP.branch})`);
        setText('hour-branch',  hourP ? `${calc.branchNameEn(hourP.branch)} (${hourP.branch})` : '‚Äî');

        const yearElem = calc.stemElem(yearP.stemCn);
        const monthElem = calc.stemElem(monthP.stemCn);
        const dayElem = calc.stemElem(dayP.stemCn);
        const hourElem = hourP ? calc.stemElem(hourP.stemCn) : '‚Äî';

        const ELEM_TH = {
          Kayu:'‡πÑ‡∏°‡πâ', Api:'‡πÑ‡∏ü', Tanah:'‡∏î‡∏¥‡∏ô', Logam:'‡πÇ‡∏•‡∏´‡∏∞', Air:'‡∏ô‡πâ‡∏≥'
        };

        setText('year-element', ELEM_TH[yearElem]  || yearElem);
        setText('month-element',ELEM_TH[monthElem] || monthElem);
        setText('day-element',  ELEM_TH[dayElem]   || dayElem);
        setText('hour-element', hourElem==='‚Äî' ? '‚Äî' : (ELEM_TH[hourElem] || hourElem));

        const yearNa = calc.nayin(yearP.stemCn,yearP.branch);
        const monthNa = calc.nayin(monthP.stemCn,monthP.branch);
        const dayNa = calc.nayin(dayP.stemCn,dayP.branch);
        const hourNa = hourP?calc.nayin(hourP.stemCn,hourP.branch):'‚Äî';
        setText('year-nayin',yearNa);
        setText('month-nayin',monthNa);
        setText('day-nayin',dayNa);
        setText('hour-nayin',hourNa);

        const dateBox = $('bazi-date');
        if(dateBox){
          let timePart = timeUnknown ? '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡∏¥‡∏î' : (hour!=null?`${String(hour).padStart(2,'0')}:${String(minute||0).padStart(2,'0')}`:'‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡∏¥‡∏î');
          dateBox.textContent = `‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î: ${year}-${String(month).padStart(2,'0')}-${String(day).padStart(2,'0')} ${timePart}`;
        }

        const counts = {Kayu:0,Api:0,Tanah:0,Logam:0,Air:0};
        function addElem(e){ if(e && counts.hasOwnProperty(e)) counts[e]++; }
        const all = [yearP,monthP,dayP].concat(hourP? [hourP] : []);
        all.forEach(p=>{
          const se = calc.stemElem(p.stemCn);
          const be = calc.branchElem(p.branch);
          addElem(se); addElem(be);
        });
        const total = Object.values(counts).reduce((a,b)=>a+b,0) || 1;
        const pct = {};
        Object.keys(counts).forEach(k=>{
          pct[k] = Math.round(counts[k]/total*100);
        });

        function setBar(name,val){
          const bar = $('bar-'+name.toLowerCase());
          const txt = $('pct-'+name.toLowerCase());
          if(bar) bar.style.width = val + '%';
          if(txt) txt.textContent = val + '%';
        }
        setBar('wood',pct.Kayu);
        setBar('fire',pct.Api);
        setBar('earth',pct.Tanah);
        setBar('metal',pct.Logam);
        setBar('water',pct.Air);

        const bw = $('bazi-elements-balance');
        const {strongest,weakest} = strongestWeakest(pct);
        if(bw){
          const sTh = ELEM_LABEL_TH[strongest] || strongest;
          const wTh = ELEM_LABEL_TH[weakest]   || weakest;
          bw.textContent = `‡πÉ‡∏ô‡∏î‡∏ß‡∏á‡∏ô‡∏µ‡πâ ‡∏ò‡∏≤‡∏ï‡∏∏„Äå${sTh}„Äç‡πÄ‡∏î‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡πÅ‡∏•‡∏∞‡∏ò‡∏≤‡∏ï‡∏∏„Äå${wTh}„Äç‡∏≠‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î`;
        }

        const ctx = {
          name: $('name').value || '',
          gender: $('gender').value || '',
          birth: {year,month,day,hour,minute,timeUnknown},
          year: {stemCn:yearP.stemCn, stemEn:yearP.stem, branch:yearP.branch, element:yearElem, nayin:yearNa},
          month:{stemCn:monthP.stemCn, stemEn:monthP.stem, branch:monthP.branch, element:monthElem, nayin:monthNa},
          day:  {stemCn:dayP.stemCn, stemEn:calc.stemNameEn(dayP.stemCn), branch:dayP.branch, element:dayElem, nayin:dayNa},
          hour: hourP?{stemCn:hourP.stemCn, stemEn:hourP.stem, branch:hourP.branch, element:hourElem, nayin:hourNa}:null,
          elements:{
            Kayu:pct.Kayu, Api:pct.Api, Tanah:pct.Tanah, Logam:pct.Logam, Air:pct.Air,
            Wood:pct.Kayu, Fire:pct.Api, Earth:pct.Tanah, Metal:pct.Logam, Water:pct.Air
          }
        };
        window.lastCtx = ctx;

        const resSec = $('result');
        if(resSec) resSec.style.display = 'block';
        buildProReport(ctx);

      }catch(e){
        console.error(e);
        showError('‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á');
      }finally{
        if(btn){ btn.disabled=false; }
        if(textSpan) textSpan.style.display='inline';
        if(loadSpan) loadSpan.style.display='none';
      }
    }

    /* ===== Chat behaviour (simple local reply) ===== */
    function appendChat(role,text){
      const box = $('chatMessages');
      if(!box) return;
      const div = document.createElement('div');
      div.style.marginBottom = '8px';
      div.style.whiteSpace = 'pre-wrap';
      if(role==='user'){
        div.style.textAlign='right';
        div.innerHTML = `<strong>‡∏Ñ‡∏∏‡∏ì:</strong> ${text}`;
      }else{
        div.innerHTML = `<strong>Butler:</strong> ${text}`;
      }
      box.appendChild(div);
      box.scrollTop = box.scrollHeight;
    }

    async function handleChatSend(){
      const input = $('chatInput');
      if(!input) return;
      const q = input.value.trim();
      if(!q) return;
      appendChat('user', q);
      input.value = '';

      const ctx = window.lastCtx;
      if(!ctx){
        appendChat('bot','‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ú‡∏π‡∏Å‡∏î‡∏ß‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡∏Å‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏ñ‡∏≤‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏à‡∏≤‡∏∞‡∏à‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å ‡∏á‡∏≤‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏∞');
        return;
      }

      const dm = ctx.day.stemEn || 'Day Master';
      appendChat(
        'bot',
        `‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (${dm}) ‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏∞‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á ‚Äú${q}‚Äù ‡∏•‡∏≠‡∏á‡πÄ‡∏ä‡πá‡∏Å 3 ‡∏Ç‡πâ‡∏≠‡∏ô‡∏µ‡πâ:\n\n` +
        `1) ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∏‡∏ì‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô‡∏û‡∏≠‡πÑ‡∏´‡∏° ‡πÅ‡∏•‡∏∞‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏ô‡∏¥‡πà‡∏á‡∏û‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏Å‡πà‡∏≠‡∏ô‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à\n` +
        `2) ‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ô‡∏µ‡πâ‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏ô‡∏¥‡∏™‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏à‡∏£‡∏¥‡∏á ‡πÜ ‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏Ñ‡πà‡∏ï‡∏≤‡∏°‡πÅ‡∏£‡∏á‡∏Å‡∏î‡∏î‡∏±‡∏ô‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô\n` +
        `3) ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏Ç‡∏≠‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡∏•‡∏≠‡∏á‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡πÄ‡∏•‡πá‡∏Å ‡πÜ ‡πÅ‡∏•‡πâ‡∏ß‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏ó‡∏µ‡∏•‡∏∞‡∏ä‡πà‡∏ß‡∏á ‡∏à‡∏∞‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏Å‡∏ß‡πà‡∏≤`
      );
    }

    /* ===== Chat toggle & drag ===== */
    function initChat(){
      const toggle = $('chatToggle');
      const panel = $('chatFloat');
      const closeBtn = $('chatClose');
      const sendBtn = $('chatSend');
      const input = $('chatInput');
      if(!toggle || !panel) return;
      toggle.addEventListener('click', ()=>{ panel.style.display = panel.style.display==='flex'?'none':'flex'; });
      if(closeBtn) closeBtn.addEventListener('click', ()=>{ panel.style.display='none'; });
      if(sendBtn) sendBtn.addEventListener('click', handleChatSend);
      if(input) input.addEventListener('keydown', e=>{ if(e.key==='Enter'){ e.preventDefault(); handleChatSend(); } });

      const header = panel.querySelector('.chat-float-header');
      if(header){
        let dragging=false, startX=0,startY=0,startLeft=0,startTop=0;
        header.addEventListener('mousedown',e=>{
          dragging=true;
          startX=e.clientX; startY=e.clientY;
          const rect=panel.getBoundingClientRect();
          startLeft=rect.left; startTop=rect.top;
          document.body.style.userSelect='none';
        });
        window.addEventListener('mousemove',e=>{
          if(!dragging) return;
          const dx=e.clientX-startX, dy=e.clientY-startY;
          panel.style.left = (startLeft+dx)+'px';
          panel.style.top = (startTop+dy)+'px';
          panel.style.right = 'auto';
          panel.style.bottom = 'auto';
        });
        window.addEventListener('mouseup',()=>{
          dragging=false;
          document.body.style.userSelect='';
        });
      }
    }

    /* ===== Init ===== */
    document.addEventListener('DOMContentLoaded', ()=>{
      const btn = $('genBtn');
      if(btn) btn.addEventListener('click', onGenerate);
      initChat();

      // language selector
      const langSelect = $('langSelect');
      if (langSelect) {
        langSelect.value = CURRENT_LANG;
        langSelect.addEventListener('change', e => {
          const code = e.target.value;
          const url = LANG_PAGES[code];
          if (url) window.location.href = url;
        });
      }

      // dummy auth handlers
      const loginForm = $('loginForm');
      const registerForm = $('registerForm');
      const resetBtn = $('resetBtn');
      const authError = $('authError');
      if(loginForm){
        loginForm.addEventListener('submit', e=>{
          e.preventDefault();
          if(authError){
            authError.textContent = '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ API ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö backend ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì';
            authError.style.display='block';
          }
        });
      }
      if(registerForm){
        registerForm.addEventListener('submit', e=>{
          e.preventDefault();
          if(authError){
            authError.textContent = '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ API ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö backend ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì';
            authError.style.display='block';
          }
        });
      }
      if(resetBtn){
        resetBtn.addEventListener('click', ()=>{
          if(authError){
            authError.textContent = '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô reset ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà';
            authError.style.display='block';
          }
        });
      }
    });
  })();
  </script>

  <!-- Clock + defaults keep-in-sync with language (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÑ‡∏ü‡∏•‡πå ms ‡πÄ‡∏î‡∏¥‡∏° ‡πÅ‡∏Ñ‡πà default ‡πÄ‡∏õ‡πá‡∏ô th) -->
  <script>
  (function () {
    const $ = (id) => document.getElementById(id);
    const TZ = 'Asia/Singapore';
    const localeMap = { 'zh-CN':'zh-CN','zh-TW':'zh-TW','en':'en-US','ja':'ja-JP','th':'th-TH','ms':'ms-MY' };
    const getLocale = () => (localeMap[(window.state && window.state.lang) || 'th'] || 'th-TH');

    // Chain applyI18n without breaking the version the app set earlier
    window.applyI18n = (function(prev){
      return function(){
        if (typeof prev === 'function') prev();
        if (typeof window.tickNow === 'function') window.tickNow();
      };
    })(window.applyI18n);

    if (typeof window.tickNow !== 'function') {
      window.tickNow = function tickNow(){
        const box = $('nowBox'); if (!box) return;
        const fmt = new Intl.DateTimeFormat(getLocale(), {
          weekday:'short', year:'numeric', month:'2-digit', day:'2-digit',
          hour:'2-digit', minute:'2-digit', hour12:false, timeZone: TZ
        });
        box.textContent = fmt.format(new Date()) + ' (SGT)';
      };
    }

    function initBirthDefaults() {
      const bd = $('birthdate'); const bt = $('birthtime'); const unk = $('timeUnknown');
      const nowSG = new Date(new Date().toLocaleString('en-US', { timeZone: TZ }));

      if (bd && !bd.value){
        const y=nowSG.getFullYear(), m=String(nowSG.getMonth()+1).padStart(2,'0'), d=String(nowSG.getDate()).padStart(2,'0');
        bd.value = `${y}-${m}-${d}`;
      }

      if (bt){
        const hh=String(nowSG.getHours()).padStart(2,'0'), mm=String(nowSG.getMinutes()).padStart(2,'0');
        if (!bt.value) bt.value = `${hh}:${mm}`;
        const setUnknownState = ()=>{ const isUnknown = !!(unk && unk.checked); bt.disabled = isUnknown; if (isUnknown) bt.value = ''; };
        setUnknownState();
        if (unk && !unk._wired){
          unk._wired = true;
          unk.addEventListener('change', ()=>{
            if (unk.checked){
              bt.disabled = true; bt.value = '';
            } else {
              bt.disabled = false;
              if (!bt.value){
                const n = new Date(new Date().toLocaleString('en-US',{timeZone:TZ}));
                bt.value = `${String(n.getHours()).padStart(2,'0')}:${String(n.getMinutes()).padStart(2,'0')}`;
              }
            }
          });
        }
      }
    }

    initBirthDefaults();
    if (typeof window.tickNow === 'function') window.tickNow();
    if (!window._clock) window._clock = setInterval(()=>{ try{ window.tickNow(); }catch{} }, 60000);
  })();
  </script>
</body>
</html>
