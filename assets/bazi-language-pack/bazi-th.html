<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>‡∏î‡∏ß‡∏á‡∏à‡∏µ‡∏ô‡∏™‡∏µ‡πà‡πÄ‡∏™‡∏≤ ¬∑ ‡∏ú‡∏π‡∏Å‡∏î‡∏ß‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <link rel="icon" href="data:,">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600&family=Inter:wght@400;600&display=swap" rel="stylesheet">

  <style>
/* ---- same visual style as other versions ---- */
:root{
  --bg:#0b0f14; --bg-accent:#0e1520; --card:#11161dcc; --surface:#0f1624; --line:#1f2a36;
  --text:#e8edf3; --muted:#98a7b7; --brand:#d4af37; --gold:#d4af37; --gold2:#f2d27a; --accent:#58b9ff;
  --radius:14px; --radius-sm:10px; --radius-lg:18px; --shadow:0 8px 30px rgba(0,0,0,.35); --shadow-sm:0 4px 14px rgba(0,0,0,.28);
  --container:1100px; --gap:12px; --pad:18px; --focus:0 0 0 2px rgba(212,175,55,0.2);
  --bp-s:520px; --bp-m:760px; --bp-l:900px;
}
*,*::before,*::after{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; padding:0; color:var(--text);
  background: radial-gradient(1200px 600px at 70% -10%, #16202b 10%, transparent 60%) no-repeat,
             linear-gradient(180deg, #0b0f14, #0b0f14);
  font-family:Inter,system-ui,-apple-system,"Noto Sans Thai","Noto Sans SC","Segoe UI",Roboto,Arial,sans-serif;
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}
body::before{
  content:""; position:fixed; inset:0; z-index:-2;
  background:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" opacity="0.05"><rect width="100" height="100" fill="%23d4af37"/></svg>') center/cover no-repeat;
  filter:brightness(0.45) saturate(0.9) blur(2px);
}
.container{max-width:var(--container); margin:0 auto; padding:24px 16px 80px}
.site-header{position:sticky; top:0; z-index:10; background:rgba(11,15,20,.8); border-bottom:1px solid #0f1622; backdrop-filter:saturate(140%) blur(12px)}
.head-inner{display:flex; align-items:center; justify-content:space-between; gap:14px; padding:14px 16px}
.brand{display:flex; align-items:center; gap:10px; text-decoration:none; color:var(--text)}
.brand-badge{display:inline-grid; place-items:center; width:34px; height:34px; border-radius:8px; background:linear-gradient(180deg,#0e1520,#0b1018); border:1px solid #2a3546; box-shadow:var(--shadow-sm); font-weight:800; color:#ffe084}
.title{font-family:"Noto Serif SC",serif; font-weight:700; letter-spacing:0.02em; font-size:1.1rem}
.now{font-size:.9rem; color:var(--muted)}

.section{margin-top:18px}
.card{background:var(--card); border:1px solid var(--line); border-radius:var(--radius); box-shadow:var(--shadow); backdrop-filter:blur(10px); padding:var(--pad); margin:16px 0}
.h2{font-size:1.2rem; margin:0 0 12px 0; font-weight:800; color:#ffe084; display:flex; gap:8px; align-items:center}
.h2::before{content:""; width:4px; height:18px; background:var(--brand); border-radius:2px}
.row{display:grid; gap:var(--gap); grid-template-columns:1fr}
@media (min-width:760px){ .row.cols-3{grid-template-columns:1fr 1fr 1fr} .row.cols-2{grid-template-columns:1fr 1fr} }
input,select{width:100%; border-radius:12px; border:1px solid #243244; background:var(--bg-accent); color:var(--text); padding:12px 12px; font-size:15px; outline:0}
input::placeholder{color:#6f8092}
input:focus,select:focus{box-shadow:var(--focus); border-color:#3a4c63}
.btn{display:inline-grid; place-items:center; padding:12px 16px; border-radius:12px; border:1px solid #e6c76e; background:linear-gradient(180deg,#fff9e6,#e6c76e); color:#191919; font-weight:800; cursor:pointer; transition:transform .2s ease, box-shadow .2s ease}
.btn:hover{transform:translateY(-1px); box-shadow:0 10px 22px rgba(230,199,110,.5)}
.btn[disabled]{opacity:.6; cursor:not-allowed}
.btn.ghost{background:transparent; color:var(--gold2); border:1px solid rgba(212,175,55,.45); box-shadow:none}
.btn.block{display:block; width:100%}
.pillars{display:grid; grid-template-columns:repeat(4,1fr); gap:10px; margin-bottom:20px}
.pillar{background:var(--surface); border:1px solid #253245; border-radius:12px; padding:14px 10px; text-align:center}
.pillar .tit{color:#9aa3b2; font-size:0.85rem; margin-bottom:6px}
.pillar .gz{font-size:1.5rem; font-weight:800; color:var(--gold2)}
@media (max-width:520px){ .pillars{grid-template-columns:repeat(2,1fr)} }
.bazi-table{width:100%; border-collapse:collapse; margin-top:12px; background:var(--surface); border-radius:8px; overflow:hidden}
.bazi-table th,.bazi-table td{padding:10px 12px; border:1px solid #253245; text-align:center; vertical-align:middle}
.bazi-table th{background:rgba(212,175,55,.1); color:var(--gold2)}
.bazi-table-wrap{overflow:auto}
@media (max-width:420px){ .bazi-table th,.bazi-table td{padding:8px 10px} }
.bar{height:10px; background:#0d1420; border:1px solid #233146; border-radius:999px; overflow:hidden; margin:6px 0}
.bar i{display:block; height:100%; background:linear-gradient(90deg,#ffe084,#f2d27a); width:0%; transition:width 0.5s ease}
.bar-row{display:grid; grid-template-columns:80px 1fr 60px; gap:10px; align-items:center}
.error-message{background:rgba(255,90,95,.1); border:1px solid #ff5a5f; border-radius:8px; padding:10px; display:none; margin-top:10px}
.muted{color:var(--muted)}
.time-row{display:flex; align-items:center; gap:10px}
.time-row .time-unknown{display:flex; align-items:center; gap:6px; white-space:nowrap}
.time-row input[type="time"]{width:auto !important; flex:0 0 160px; min-width:140px}
.gen-wrap{display:flex; align-items:flex-end; justify-content:flex-end}
#genBtn{width:auto !important}
.analysis-grid{display:grid; gap:16px; margin-top:20px}
.analysis-card{background:var(--surface); border:1px solid #253245; border-radius:12px; padding:16px}
.analysis-card h3{color:var(--gold2); margin:0 0 12px 0; font-size:1.1rem}
.analysis-content{line-height:1.6}
.columns{display:grid; gap:12px; grid-template-columns:1fr}
@media (min-width:900px){ .columns{grid-template-columns:1fr 1fr} }
.list-block{border:1px solid #263448; background:var(--bg-accent); border-radius:12px; padding:16px}
.list-block ul{margin:0.2rem 0 0 0; padding-left:1.1rem}
.group-title{font-size:1.05rem; color:#ffe084; margin:6px 0 14px}
.astro-auth{max-width:980px; margin:28px auto; padding:20px 18px; background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.01)); border:1px solid rgba(212,175,55,.22); border-radius:14px; box-shadow:0 18px 50px rgba(0,0,0,.35)}
.auth-grid{display:grid; gap:18px; grid-template-columns:1.2fr .8fr}
@media (max-width:860px){ .auth-grid{grid-template-columns:1fr} }
.panel{background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.01)); border:1px solid rgba(212,175,55,.22); border-radius:14px; box-shadow:0 10px 30px rgba(0,0,0,.35)}
.panel .head{padding:16px 18px; border-bottom:1px solid rgba(212,175,55,.22); color:var(--gold); font-weight:700; letter-spacing:0.3px}
.panel .body{padding:18px}
.spacer{height:12px}

/* ===== Chat ===== */
.ss-chat-fab{
  position:fixed;
  right:18px;
  bottom:18px;
  z-index:50;
  width:56px;
  height:56px;
  border-radius:50%;
  background:linear-gradient(180deg,#fff9e6,#e6c76e);
  color:#191919;
  display:grid;
  place-items:center;
  font-size: 22px;
  font-weight:800;
  box-shadow:0 8px 30px rgba(0,0,0,.35);
  cursor:pointer;
  border:1px solid #e6c76e;
}
.ss-chat-panel{
  position:fixed;
  right:18px;
  bottom:88px;
  z-index:50;
  width:min(460px,92vw);
  display:none;
  flex-direction:column;
  background:#0e1520;
  border:1px solid #243244;
  border-radius:14px;
  box-shadow:var(--shadow);
}
.ss-chat-panel[aria-hidden="false"]{display:flex;}
.ss-chat-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:10px 12px;
  border-bottom:1px solid #243244;
}
.ss-chat-title{font-weight:700}
.ss-chat-body{
  max-height:300px;
  overflow:auto;
  padding:10px 12px;
  display:flex;
  flex-direction:column;
  gap:8px;
}
.ss-msg{
  padding:8px 10px;
  background:#0f1624;
  border:1px solid #243244;
  border-radius:10px;
  margin:6px 0;
  max-width:80%;
  font-size:.9rem;
  line-height:1.6;
}
.ss-msg.me{
  margin-left:auto;
  background:#132033;
}
.ss-chat-input{
  display:flex;
  align-items:center;
  gap:8px;
  padding:10px 12px;
  border-top:1px solid #243244;
}
.ss-chat-input input{
  flex:1 1 auto;
  min-width:0;
}    

/* form focus simplification */
input:focus,select:focus,textarea:focus{outline:none!important; box-shadow:none!important; border-color:#243244!important}
button:focus,.btn:focus,a:focus{outline:none!important; box-shadow:none!important}
*{-webkit-tap-highlight-color:transparent}

footer{color:#6c7b8c; font-size:0.85rem; text-align:center; padding:30px 0; margin-top:40px}
@media (prefers-reduced-motion: reduce){ *{animation:none !important; transition:none !important} }
  </style>
</head>
<body>
<header class="site-header">
  <div class="head-inner container">
    <a class="brand" href="https://astro.5xliving.com/" target="_self">
      <span class="brand-badge">5X</span>
      <span class="title">5xLiving ¬∑ Bazi Brief</span>
    </a>
    <div style="display:flex; align-items:center; gap:10px;">
      <!-- Language selector -->
      <select id="langSelect" style="border-radius:999px; padding:6px 10px; border:1px solid #243244; background:#0e1520; color:#e8edf3; font-size:0.85rem;">
        <option value="zh-CN">ÁÆÄ‰Ωì‰∏≠Êñá</option>
        <option value="zh-TW">ÁπÅÈ´î‰∏≠Êñá</option>
        <option value="en">English</option>
        <option value="ja">Êó•Êú¨Ë™û</option>
        <option value="th">‡πÑ‡∏ó‡∏¢</option>
        <option value="ms">Bahasa Melayu</option>
      </select>

      <span id="nowBox" class="now"></span>
    </div>
  </div>
</header>

  <main class="container">
    <!-- Input card -->
    <section class="card">
      <div class="h2">‡∏î‡∏ß‡∏á‡∏à‡∏µ‡∏ô‡∏™‡∏µ‡πà‡πÄ‡∏™‡∏≤ ¬∑ ‡∏ú‡∏π‡∏Å‡∏î‡∏ß‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß</div>
      <div class="row cols-3">
        <div>
          <label class="muted">‡∏ä‡∏∑‡πà‡∏≠ (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</label>
          <input id="name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡∏î‡∏ß‡∏á‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏ï‡∏±‡∏ß)" />
        </div>
        <div>
          <label class="muted">‡πÄ‡∏û‡∏®</label>
          <select id="gender">
            <option value="">‡πÑ‡∏°‡πà‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏£‡∏∞‡∏ö‡∏∏</option>
            <option value="male">‡∏ä‡∏≤‡∏¢</option>
            <option value="female">‡∏´‡∏ç‡∏¥‡∏á</option>
          </select>
        </div>
        <div>
          <label class="muted">‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô</label>
          <select id="calendar">
            <option value="gregorian">‡∏™‡∏∏‡∏£‡∏¥‡∏¢‡∏Ñ‡∏ï‡∏¥ (‡∏™‡∏≤‡∏Å‡∏•)</option>
            <option value="lunar">‡∏à‡∏±‡∏ô‡∏ó‡∏£‡∏Ñ‡∏ï‡∏¥ (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö)</option>
          </select>
        </div>
      </div>
      <div class="row cols-3" style="margin-top:10px">
        <div>
          <label class="muted">‡∏ß‡∏±‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏µ‡πÄ‡∏Å‡∏¥‡∏î</label>
          <input type="date" id="birthdate" />
        </div>
        <div>
          <label class="muted">‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡∏¥‡∏î</label>
          <div class="time-row">
            <input type="time" id="birthtime" />
            <label class="muted time-unknown">
              <input type="checkbox" id="timeUnknown" />
              <span>‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡∏¥‡∏î</span>
            </label>
          </div>
        </div>
        <div class="gen-wrap">
          <button class="btn" id="genBtn" type="button">
            <span id="genBtnText">‡∏ú‡∏π‡∏Å‡∏î‡∏ß‡∏á</span>
            <span id="genBtnLoading" style="display:none">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì...</span>
          </button>
        </div>
      </div>
      <div id="error" class="error-message"></div>
    </section>

    <!-- Result: pillars & elements -->
    <section id="result" style="display:none;">
      <div class="card">
        <div class="h2">‡∏ú‡∏±‡∏á‡∏î‡∏ß‡∏á Bazi ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</div>
        <div class="pillars" id="bazi-pillars"></div>
        <div class="muted" id="bazi-date" style="margin-top:6px"></div>
        <table class="bazi-table">
          <thead>
          <tr>
            <th></th>
            <th>‡πÄ‡∏™‡∏≤‡∏õ‡∏µ</th>
            <th>‡πÄ‡∏™‡∏≤‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</th>
            <th>‡πÄ‡∏™‡∏≤‡∏ß‡∏±‡∏ô</th>
            <th>‡πÄ‡∏™‡∏≤‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</th>
          </tr>
          </thead>
          <tbody>
          <tr>
            <td>‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ü‡πâ‡∏≤ (Â§©Âπ≤)</td>
            <td id="year-stem">-</td><td id="month-stem">-</td><td id="day-stem">-</td><td id="hour-stem">-</td>
          </tr>
          <tr>
            <td>‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏î‡∏¥‡∏ô (Âú∞ÊîØ)</td>
            <td id="year-branch">-</td><td id="month-branch">-</td><td id="day-branch">-</td><td id="hour-branch">-</td>
          </tr>
          <tr>
            <td>‡∏ò‡∏≤‡∏ï‡∏∏‡∏´‡∏•‡∏±‡∏Å (‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ü‡πâ‡∏≤)</td>
            <td id="year-element">-</td><td id="month-element">-</td><td id="day-element">-</td><td id="hour-element">-</td>
          </tr>
          <tr>
            <td>‡∏ô‡πà‡∏≤‡∏´‡∏¢‡∏¥‡∏ô (Á¥çÈü≥)</td>
            <td id="year-nayin">-</td><td id="month-nayin">-</td><td id="day-nayin">-</td><td id="hour-nayin">-</td>
          </tr>
          </tbody>
        </table>
      </div>

      <div class="card">
        <div class="h2">‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏û‡∏•‡∏±‡∏á‡∏ò‡∏≤‡∏ï‡∏∏‡∏ó‡∏±‡πâ‡∏á‡∏´‡πâ‡∏≤</div>
        <div class="bar-row"><span>‡πÑ‡∏°‡πâ</span><div class="bar"><i id="bar-wood"></i></div><span id="pct-wood">0%</span></div>
        <div class="bar-row"><span>‡πÑ‡∏ü</span><div class="bar"><i id="bar-fire"></i></div><span id="pct-fire">0%</span></div>
        <div class="bar-row"><span>‡∏î‡∏¥‡∏ô</span><div class="bar"><i id="bar-earth"></i></div><span id="pct-earth">0%</span></div>
        <div class="bar-row"><span>‡πÇ‡∏•‡∏´‡∏∞</span><div class="bar"><i id="bar-metal"></i></div><span id="pct-metal">0%</span></div>
        <div class="bar-row"><span>‡∏ô‡πâ‡∏≥</span><div class="bar"><i id="bar-water"></i></div><span id="pct-water">0%</span></div>
        <div id="bazi-elements-balance" class="muted" style="margin-top:8px"></div>
      </div>
    </section>

    <!-- Pro report -->
    <section id="butlerProfessional" class="butler-professional">
      <div class="butler-header">
        <span>üßô‚Äç‚ôÇÔ∏è Xinlian Butler ¬∑ ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏î‡∏ß‡∏á‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å</span>
      </div>
      <div class="butler-content" id="professionalReport"></div>
    </section>

    <!-- Floating chat -->
    <button class="chat-toggle-btn" id="chatToggle">‡∏ñ‡∏≤‡∏°‡∏î‡∏ß‡∏á</button>
    <div class="chat-float" id="chatFloat">
      <div class="chat-float-header">
        <span>üßô‚Äç‚ôÇÔ∏è Xinlian Butler ¬∑ ‡∏ñ‡∏≤‡∏°‡∏ï‡∏≠‡∏ö</span>
        <button class="chat-float-close" id="chatClose">√ó</button>
      </div>
      <div class="chat-float-body">
        <div class="chat-float-messages" id="chatMessages">
          <div class="ss-msg">
            ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏∞ ‡∏â‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏î‡∏ß‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ‡∏ú‡∏π‡∏Å‡∏î‡∏ß‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß
            ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ñ‡∏≤‡∏°‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å ‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô ‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢
          </div>
        </div>
        <div class="chat-float-input-area">
          <div style="display:flex;gap:8px;">
            <input type="text" id="chatInput" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì..." style="flex:1; padding:10px; border-radius:8px; border:1px solid #253245; background:#0e1520; color:#e8edf3;">
            <button class="btn" id="chatSend" style="padding:8px 16px;">‡∏™‡πà‡∏á</button>
          </div>
        </div>
      </div>
    </div>

    <!-- VIP segment -->
    <section class="card section">
      <h2 class="group-title">üåô ‡πÇ‡∏ã‡∏ô VIP</h2>
      <div class="columns">
        <div class="list-block">
          <div class="group-title">üóù Mingli Space ¬∑ ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</div>
          <ul>
            <li>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å: ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏Ñ‡∏π‡πà‡∏Ñ‡∏£‡∏≠‡∏á ‡∏Å‡∏≤‡∏£‡πÅ‡∏ï‡πà‡∏á‡∏á‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå</li>
            <li>‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô: ‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡πÅ‡∏•‡∏∞‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏î‡∏ß‡∏á</li>
            <li>‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô: ‡∏à‡∏∏‡∏î‡∏î‡∏∂‡∏á‡∏î‡∏π‡∏î‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤ ‡πÅ‡∏•‡∏∞‡∏à‡∏∏‡∏î‡∏£‡∏±‡πà‡∏ß‡πÑ‡∏´‡∏•</li>
            <li>‡∏î‡∏ß‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á: ‡∏û‡∏•‡∏±‡∏á‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏±‡∏ö‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏Ñ‡∏π‡πà‡πÉ‡∏à</li>
          </ul>
        </div>
        <div class="list-block">
          <div class="group-title">üåô Xinlian Space ¬∑ ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏±‡∏ß‡πÉ‡∏à</div>
          <ul>
            <li>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏à‡∏¥‡∏ï‡∏ß‡∏¥‡∏ç‡∏ç‡∏≤‡∏ì: ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ù‡∏±‡∏ô ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏©‡∏ê‡∏≤‡∏ô</li>
            <li>‡∏Ñ‡∏≠‡∏£‡πå‡∏™‡πÄ‡∏£‡∏µ‡∏¢‡∏ô: ‡∏î‡∏ß‡∏á‡∏à‡∏µ‡∏ô Bazi / ‡πÑ‡∏û‡πà‡∏ó‡∏≤‡πÇ‡∏£‡∏ï‡πå / ‡πÇ‡∏´‡∏£‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå / ‡πÄ‡∏•‡∏Ç‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå</li>
            <li>‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏∞‡∏•‡∏∂‡∏Å‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏•‡πà‡∏ß‡∏á‡∏•‡∏±‡∏ö</li>
            <li>‡πÅ‡∏ö‡∏ö‡∏ù‡∏∂‡∏Å‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå ‡πÅ‡∏•‡∏∞‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏û‡∏¥‡∏ò‡∏µ‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏•‡πá‡∏Å ‡πÜ ‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡πÄ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ö‡πâ‡∏≤‡∏ô</li>
          </ul>
        </div>
      </div>

      <div class="group-title" style="margin-top:14px">üíé ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö VIP</div>
      <section class="astro-auth">
        <div class="auth-grid">
          <div class="panel">
            <div class="head">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö / ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</div>
            <div class="body">
              <div class="row" id="authFields">
                <input id="email" name="email" type="email" inputmode="email" autocomplete="username" placeholder="‡∏≠‡∏µ‡πÄ‡∏°‡∏•">
                <input id="password" name="password" type="password" autocomplete="current-password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 8 ‡∏ï‡∏±‡∏ß)">
              </div>
              <div class="spacer"></div>
              <form id="loginForm" class="row one">
                <button class="btn block" id="loginBtn" type="submit">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
              </form>
              <div class="spacer"></div>
              <div class="row one">
                <button class="btn ghost block" id="resetBtn" type="button">üîë ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</button>
              </div>
              <div class="spacer"></div>
              <form class="row one" id="registerForm">
                <button class="btn block" id="registerBtn" type="submit">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÉ‡∏´‡∏°‡πà</button>
                <div class="muted">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏≠‡πà‡∏≤‡∏ô‡∏î‡∏ß‡∏á‡∏ü‡∏£‡∏µ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</div>
                <div class="spacer"></div>
                <div class="error-message" id="authError" style="display:none"></div>
              </form>
            </div>
          </div>

          <div class="panel">
            <div class="head">‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</div>
            <div class="body">
              <div class="row one">
                <a class="btn block" href="https://yourshopifyshop.com/products/monthly-vip" target="_blank" rel="noopener noreferrer">
                  üíé ‡∏≠‡∏±‡∏õ‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏õ‡πá‡∏ô VIP ‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
                </a>
              </div>
              <div class="row one">
                <a class="btn ghost block" href="https://yourshopifyshop.myshopify.com" target="_blank" rel="noopener noreferrer">
                  ‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏£‡πâ‡∏≤‡∏ô Astro Store
                </a>
              </div>
              <div class="muted">$9.9 / ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ¬∑ Mingli Space + Xinlian Space + ‡∏Ñ‡∏≠‡∏£‡πå‡∏™‡∏à‡∏¥‡∏ï‡∏ß‡∏¥‡∏ç‡∏ç‡∏≤‡∏ì‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
            </div>
          </div>
        </div>
      </section>
    </section>

<footer data-i18n="footer.copy">¬© 5XLiving ‚Ä¢ ‡πÅ‡∏≠‡∏™‡πÇ‡∏ï‡∏£-‡πÅ‡∏ã‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ß‡∏£‡∏µ</footer>
</main>

<!-- Xinlian Butler ¬∑ GPT (Unified Floating Chat) -->
<button class="ss-chat-fab" id="ssChatFab" type="button">
  <span data-i18n="chat.toggle">‡∏ñ‡∏≤‡∏°</span>
</button>

<div class="ss-chat-panel" id="chatPanel" aria-hidden="true">
  <div class="ss-chat-head">
    <div class="ss-chat-title" id="chatTitle" data-i18n="chat_title">‡∏ö‡∏±‡∏ï‡πÄ‡∏•‡∏≠‡∏£‡πå‡∏ã‡∏¥‡∏ô‡πÄ‡∏´‡∏•‡∏µ‡∏¢‡∏ô ¬∑ GPT</div>
    <div class="ss-close" id="chatClose">‚úï</div>
  </div>

  <!-- Chat messages are appended by JS -->
  <div class="ss-chat-body" id="chatBody"></div>

  <!-- Input -->
  <div class="ss-chat-input">
    <input id="chatInput" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‚Ä¶" data-i18n-ph="chat.placeholder" />
    <button class="btn" id="chatSend" data-i18n="chat.send">‡∏™‡πà‡∏á</button>
  </div>
</div>

<script>
(() => {
  'use strict';

  /* ===================== BASIC HELPERS ===================== */
  const SG_TZ = 'Asia/Singapore';
  const $id = (id) => document.getElementById(id);
  const $ = $id;

  const deepGet = (obj, path) => {
    if (!obj || !path) return undefined;
    const parts = String(path).split(".");
    let cur = obj;
    for (const p of parts) { if (!cur) return undefined; cur = cur[p]; }
    return cur;
  };

  /* ===================== CONFIG ===================== */
  const API_BASE = "https://throbbing-lab-1440.hello5xliving.workers.dev";
  const CHAT_ENDPOINT = "/api/chat";
  const LANG_KEY = "5x_lang";

  const state = (window.state = window.state || {});
  state.lang = 'th-TH';              // ‚úÖ This page is locked to Thai
  try { localStorage.setItem(LANG_KEY, 'th-TH'); } catch {}

  /* ===================== I18N (TH ONLY) ===================== */
  window.I18N = window.I18N || {};
  const I18N = window.I18N;

  I18N['th-TH'] = Object.assign({}, I18N['th-TH'] || {}, {
    action:{
      weekly:'‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå',
      energy:'‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô',
      career:'‡∏≠‡∏≤‡∏ä‡∏µ‡∏û: ‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏Å‡∏°‡πÅ‡∏ö‡∏ö‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á ‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏¢‡∏¥‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå',
      career2:'‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠ & ‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô (‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‚Üí‡πÅ‡∏ú‡∏ô‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‚Üí‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‚Üí‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á)',
      relationship:'‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå: ‡∏Ñ‡∏∏‡∏¢‡∏ï‡∏£‡∏á‡πÅ‡∏ï‡πà‡∏™‡∏∏‡∏†‡∏≤‡∏û ‡∏ï‡∏±‡πâ‡∏á‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï ‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞',
      wealth:'‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô: ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î ‡∏ó‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏≤‡∏Å‡∏ó‡∏±‡∏Å‡∏©‡∏∞ ‡πÅ‡∏•‡∏∞‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á'
    },
    brand:{ subtitle:'5xLiving ¬∑ ‡∏ï‡∏£‡∏ß‡∏à‡∏õ‡∏≤‡∏à‡∏∑‡πä‡∏≠‡πÅ‡∏ö‡∏ö‡∏î‡πà‡∏ß‡∏ô' },

    app:{ title:'‡∏õ‡∏≤‡∏à‡∏∑‡πä‡∏≠ ¬∑ ‡∏ú‡∏±‡∏á‡∏™‡∏µ‡πà‡πÄ‡∏™‡∏≤‡πÅ‡∏ö‡∏ö‡∏î‡πà‡∏ß‡∏ô' },
    form:{
      nameLabel:'‡∏ä‡∏∑‡πà‡∏≠ (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)',
      namePlaceholder:'‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö: ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Ñ‡∏∏‡∏ì)',
      genderLabel:'‡πÄ‡∏û‡∏®',
      gender:{ hidden:'‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏', male:'‡∏ä‡∏≤‡∏¢', female:'‡∏´‡∏ç‡∏¥‡∏á' },
      calendarLabel:'‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô',
      calendar:{ gregorian:'‡∏™‡∏∏‡∏£‡∏¥‡∏¢‡∏Ñ‡∏ï‡∏¥', lunar:'‡∏à‡∏±‡∏ô‡∏ó‡∏£‡∏Ñ‡∏ï‡∏¥' },
      birthdateLabel:'‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î',
      birthtimeLabel:'‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡∏¥‡∏î',
      timeUnknown:'‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡∏¥‡∏î'
    },

    btn:{ generate:'‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏≤‡∏à‡∏∑‡πä‡∏≠', loading:'‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‚Ä¶' },
    result:{ title:'‡∏õ‡∏≤‡∏à‡∏∑‡πä‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (‡∏™‡∏µ‡πà‡πÄ‡∏™‡∏≤)' },
    pillar:{ year:'‡πÄ‡∏™‡∏≤‡∏õ‡∏µ', month:'‡πÄ‡∏™‡∏≤‡πÄ‡∏î‡∏∑‡∏≠‡∏ô', day:'‡πÄ‡∏™‡∏≤‡∏ß‡∏±‡∏ô', hour:'‡πÄ‡∏™‡∏≤‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á' },
    table:{ row:{ stem:'‡∏•‡∏≥‡∏ï‡πâ‡∏ô‡∏ü‡πâ‡∏≤ (Â§©Âπ≤)', branch:'‡∏Å‡∏¥‡πà‡∏á‡∏î‡∏¥‡∏ô (Âú∞ÊîØ)', fiveElem:'‡∏ò‡∏≤‡∏ï‡∏∏‡∏ó‡∏±‡πâ‡∏á‡∏´‡πâ‡∏≤', nayin:'‡∏ô‡πà‡∏≤‡∏´‡∏¢‡∏¥‡∏ô (Á¥çÈü≥)' } },
    energy:{ title:'‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏ò‡∏≤‡∏ï‡∏∏‡∏ó‡∏±‡πâ‡∏á‡∏´‡πâ‡∏≤' },
    elem:{ wood:'‡πÑ‡∏°‡πâ', fire:'‡πÑ‡∏ü', earth:'‡∏î‡∏¥‡∏ô', metal:'‡∏ó‡∏≠‡∏á', water:'‡∏ô‡πâ‡∏≥', month:'‡πÄ‡∏î‡∏∑‡∏≠‡∏ô', fiveElements:'‡∏ò‡∏≤‡∏ï‡∏∏‡∏ó‡∏±‡πâ‡∏á‡∏´‡πâ‡∏≤' },

    chat_title:'‡∏ö‡∏±‡∏ï‡πÄ‡∏•‡∏≠‡∏£‡πå‡∏ã‡∏¥‡∏ô‡πÄ‡∏´‡∏•‡∏µ‡∏¢‡∏ô ¬∑ GPT',
    pro:{
      title:'‡∏ö‡∏±‡∏ï‡πÄ‡∏•‡∏≠‡∏£‡πå‡∏ã‡∏¥‡∏ô‡πÄ‡∏´‡∏•‡∏µ‡∏¢‡∏ô ¬∑ ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏ö‡∏ö‡πÇ‡∏õ‡∏£',
      welcome:'‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö/‡∏Ñ‡πà‡∏∞ ‡∏â‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠‡∏ö‡∏±‡∏ï‡πÄ‡∏•‡∏≠‡∏£‡πå‡∏ã‡∏¥‡∏ô‡πÄ‡∏´‡∏•‡∏µ‡∏¢‡∏ô ¬∑ GPT ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏î ‚Äú‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏≤‡∏à‡∏∑‡πä‡∏≠‚Äù ‡∏Å‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏ñ‡∏≤‡∏°‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏á‡∏≤‡∏ô ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å ‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û ‡∏Ø‡∏•‡∏Ø ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢'
    },
    chat:{ send:'‡∏™‡πà‡∏á', placeholder:'‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‚Ä¶', toggle:'‡∏ñ‡∏≤‡∏°' },

    vip:{
      title:'‡πÇ‡∏ã‡∏ô VIP',
      group:{ astrology:'‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏≤‡∏à‡∏∑‡πä‡∏≠', spiritual:'‡∏ã‡∏π‡∏•‡πÅ‡∏ã‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ß‡∏£‡∏µ' },
      astrology:{
        match:'‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å & ‡πÅ‡∏ï‡πà‡∏á‡∏á‡∏≤‡∏ô: ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°',
        career:'‡∏≠‡∏≤‡∏ä‡∏µ‡∏û: ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á/‡∏¢‡πâ‡∏≤‡∏¢‡∏á‡∏≤‡∏ô/‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à',
        wealth:'‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô: ‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞',
        pet:'‡∏î‡∏ß‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á: ‡∏ô‡∏¥‡∏™‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏¢‡πÉ‡∏¢'
      },
      spiritual:{
        record:'‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏à‡∏¥‡∏ï‡∏ß‡∏¥‡∏ç‡∏ç‡∏≤‡∏ì: ‡∏£‡∏π‡∏õ/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ù‡∏±‡∏ô/‡πÄ‡∏™‡∏µ‡∏¢‡∏á/‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏©‡∏ê‡∏≤‡∏ô',
        courses:'‡∏Ñ‡∏≠‡∏£‡πå‡∏™: ‡∏õ‡∏≤‡∏à‡∏∑‡πä‡∏≠/‡∏ó‡∏≤‡πÇ‡∏£‡∏ï‡πå/‡πÇ‡∏´‡∏£‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå/‡πÄ‡∏•‡∏Ç‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå',
        family:'‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß',
        practice:'‡∏Å‡∏¥‡∏à‡∏ß‡∏±‡∏ï‡∏£‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå/‡∏á‡∏≤‡∏ô‡∏û‡∏¥‡∏ò‡∏µ‡∏Å‡∏£‡∏£‡∏°'
      },
      login:{ title:'‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö VIP' },
      services:{ header:'‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å' },
      upgrade:'‡∏≠‡∏±‡∏õ‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏õ‡πá‡∏ô VIP (‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)',
      back:'‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤',
      priceNote:'‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô $9.9 (‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏≤‡∏à‡∏∑‡πä‡∏≠ + ‡∏ã‡∏π‡∏•‡πÅ‡∏ã‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ß‡∏£‡∏µ + ‡∏Ñ‡∏≠‡∏£‡πå‡∏™‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)'
    },

    auth:{
      header:'‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö / ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å',
      login:'‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö',
      reset:'‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô',
      register:'‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å',
      freeTrialNote:'‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏•‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏ü‡∏£‡∏µ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á',
      emailPlaceholder:'‡∏≠‡∏µ‡πÄ‡∏°‡∏•',
      passwordPlaceholder:'‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 8 ‡∏ï‡∏±‡∏ß: ‡∏ï‡∏±‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏´‡∏ç‡πà/‡πÄ‡∏•‡πá‡∏Å ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç ‡πÅ‡∏•‡∏∞‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå)'
    },

    footer:{ copy:'¬© 5XLiving ‚Ä¢ ‡πÅ‡∏≠‡∏™‡πÇ‡∏ï‡∏£-‡πÅ‡∏ã‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ß‡∏£‡∏µ' },

    err:{
      fillBirthdate:'‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î',
      invalidDate:'‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏ä‡πâ YYYY-MM-DD',
      generateFail:'‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á'
    },

    ui:{
      timeUnknown:'‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡∏¥‡∏î',
      hourSuffix:'{hh}:{mm}',
      birthSummary:'‡πÄ‡∏Å‡∏¥‡∏î: {y}-{m}-{d} {timeText}',
      balance:'‡∏ò‡∏≤‡∏ï‡∏∏‡πÄ‡∏î‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î: {strongest} ¬∑ ‡∏ò‡∏≤‡∏ï‡∏∏‡∏≠‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î: {weakest}'
    },

    badge:{ noHour:'‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏™‡∏≤‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á' },

    report:{
      hourUnknownTip:'‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡∏¥‡∏î ‡∏Å‡∏≤‡∏£‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á',
      tipTitle:'‡∏ó‡∏¥‡∏õ',
      generating:'‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö‡πÇ‡∏õ‡∏£‚Ä¶',
      failed:'‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á'
    },

    reportTitles:{
      overview:'‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏î‡∏ß‡∏á',
      fiveElements:'‡∏ò‡∏≤‡∏ï‡∏∏‡∏ó‡∏±‡πâ‡∏á‡∏´‡πâ‡∏≤',
      tenGods:'‡∏™‡∏¥‡∏ö‡πÄ‡∏ó‡∏û (ÂçÅÁ•û)',
      useful:'‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏ò‡∏≤‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏∑‡πâ‡∏≠‡∏´‡∏ô‡∏∏‡∏ô',
      relationship:'‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå',
      career:'‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏≠‡∏≤‡∏ä‡∏µ‡∏û',
      wealth:'‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô',
      health:'‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û',
      nearTerm:'‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏£‡∏∞‡∏¢‡∏∞‡πÉ‡∏Å‡∏•‡πâ',
      actions:'‡πÄ‡∏ä‡πá‡∏Å‡∏•‡∏¥‡∏™‡∏ï‡πå‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏°‡∏∑‡∏≠‡∏ó‡∏≥'
    },

    tenGodsNames:{
      biJian:'ÊØîËÇ© (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô/‡∏û‡∏∂‡πà‡∏á‡∏ï‡∏ô)',
      jieCai:'Âä´Ë≤° (‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô/‡πÅ‡∏¢‡πà‡∏á‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå)',
      shiShen:'È£üÁ•û (‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏≠‡∏Å/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç)',
      shangGuan:'ÂÇ∑ÂÆò (‡∏ó‡∏∞‡∏•‡∏∏‡∏Å‡∏£‡∏≠‡∏ö/‡∏ß‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡πå)',
      zhengCai:'Ê≠£Ë≤° (‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á)',
      pianCai:'ÂÅèË≤° (‡πÇ‡∏≠‡∏Å‡∏≤‡∏™/‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏™‡∏£‡∏¥‡∏°)',
      zhengGuan:'Ê≠£ÂÆò (‡∏£‡∏∞‡∏ö‡∏ö/‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á)',
      qiSha:'‰∏ÉÊÆ∫ (‡πÅ‡∏£‡∏á‡∏Å‡∏î‡∏î‡∏±‡∏ô/‡∏•‡∏á‡∏°‡∏∑‡∏≠‡∏à‡∏£‡∏¥‡∏á)',
      zhengYin:'Ê≠£Âç∞ (‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ/‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô)',
      pianYin:'ÂÅèÂç∞ (‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏ç‡∏≤‡∏ì/‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡πÄ‡∏≠‡∏á)'
    },
    tenGodsHints:{
      biJian:'‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏ó‡∏≤‡∏á ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á ‡∏Å‡∏≤‡∏£‡∏£‡πà‡∏ß‡∏°‡∏°‡∏∑‡∏≠‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô',
      jieCai:'‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á/‡∏Å‡∏≤‡∏£‡πÅ‡∏¢‡πà‡∏á ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡πÉ‡∏ä‡πâ‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡∏≤‡∏°‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå',
      shiShen:'‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ú‡∏•‡∏á‡∏≤‡∏ô ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥',
      shangGuan:'‡∏ô‡∏ß‡∏±‡∏ï‡∏Å‡∏£‡∏£‡∏°‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡πå ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏õ‡∏∞‡∏ó‡∏∞‡∏Å‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏≠‡∏≥‡∏ô‡∏≤‡∏à',
      zhengCai:'‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î ‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏ö‡∏ö‡∏Ñ‡πà‡∏≠‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≠‡∏¢‡πÑ‡∏õ',
      pianCai:'‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏™‡∏£‡∏¥‡∏°/‡πÇ‡∏≠‡∏Å‡∏≤‡∏™ ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏û‡∏î‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î',
      zhengGuan:'‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ñ‡∏∑‡∏≠',
      qiSha:'‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏î‡∏î‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÉ‡∏´‡∏ç‡πà ‡∏•‡∏á‡∏°‡∏∑‡∏≠‡πÄ‡∏Å‡πà‡∏á‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ö‡∏≤‡∏•‡∏≤‡∏ô‡∏ã‡πå',
      zhengYin:'‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô ‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ ‡πÄ‡∏°‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå',
      pianYin:'‡πÑ‡∏≠‡πÄ‡∏î‡∏µ‡∏¢‡πÄ‡∏â‡∏µ‡∏¢‡∏ö ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏≤‡∏á ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏Ñ‡∏¥‡∏¥‡∏î‡∏°‡∏≤‡∏Å'
    },

    reportLabels:{
      dayMaster:'‡∏ò‡∏≤‡∏ï‡∏∏‡∏ß‡∏±‡∏ô (Êó•‰∏ª)',
      symbolise:'‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢',
      analysis:'‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥',
      suitableCareers:'‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞',
      careerAdvice:'‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏≠‡∏≤‡∏ä‡∏µ‡∏û',
      favorableDirections:'‡∏ó‡∏¥‡∏®‡∏°‡∏á‡∏Ñ‡∏• (‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á)',
      healthCharacteristics:'‡∏à‡∏∏‡∏î‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏î‡πâ‡∏≤‡∏ô‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢',
      healthTips:'‡∏ó‡∏¥‡∏õ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û',
      wellnessAdvice:'‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏ß‡∏∞',
      overallFortune:'‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°',
      favorableTiming:'‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏î‡∏µ',
      cautions:'‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á'
    },

    cautions:{ default:'‡∏≠‡∏¢‡πà‡∏≤‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏ï‡∏≤‡∏°‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢' },

    fortune:{
      upward:'‡∏ä‡πà‡∏ß‡∏á‡∏Ç‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô: ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏´‡∏ô‡πâ‡∏≤-‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£-‡∏ó‡∏≥‡∏ú‡∏•‡∏á‡∏≤‡∏ô',
      focus:'‡πÇ‡∏´‡∏°‡∏î‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏£‡∏∞‡∏ö‡∏ö: ‡πÄ‡∏î‡πà‡∏ô‡∏á‡∏≤‡∏ô‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥/‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á',
      study:'‡πÇ‡∏´‡∏°‡∏î‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏Å‡πà‡∏≠‡∏ô: ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•-‡∏ó‡∏î‡∏•‡∏≠‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏Å‡πà‡∏≠‡∏ô‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏à‡∏£‡∏¥‡∏á',
      foundation:'‡πÇ‡∏´‡∏°‡∏î‡∏õ‡∏π‡∏ê‡∏≤‡∏ô: ‡∏ó‡∏≥‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠ ‡∏™‡∏∞‡∏™‡∏°‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡∏ô'
    },

    // Day Master lines
    'report.dayMaster.jia':'Áî≤‡πÑ‡∏°‡πâ‡πÉ‡∏´‡∏ç‡πà: ‡∏ô‡∏±‡∏Å‡∏ö‡∏∏‡∏Å‡πÄ‡∏ö‡∏¥‡∏Å ‡πÄ‡∏î‡∏¥‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏≠‡∏∂‡∏î ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ',
    'report.dayMaster.yi':'‰πô‡πÑ‡∏°‡πâ‡πÄ‡∏•‡πá‡∏Å: ‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô ‡∏≠‡πà‡∏≠‡∏ô‡πÇ‡∏¢‡∏ô ‡πÇ‡∏ï‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠',
    'report.dayMaster.bing':'‰∏ô‡πÑ‡∏ü‡πÉ‡∏´‡∏ç‡πà: ‡∏™‡∏î‡πÉ‡∏™ ‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à ‡πÄ‡∏õ‡∏•‡πà‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏¢‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏ô‡∏≥',
    'report.dayMaster.ding':'‰∏Å‡πÑ‡∏ü‡πÄ‡∏•‡πá‡∏Å: ‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏≠‡∏ö ‡πÉ‡∏´‡πâ‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏ß‡πâ‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∂‡∏Å‡∏ã‡∏∂‡πâ‡∏á',
    'report.dayMaster.wu':'Êàä‡∏î‡∏¥‡∏ô‡πÉ‡∏´‡∏ç‡πà: ‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏±‡∏á ‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á ‡πÄ‡∏Å‡πà‡∏á‡∏ß‡∏≤‡∏á‡∏ê‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£',
    'report.dayMaster.ji':'Â∑±‡∏î‡∏¥‡∏ô‡πÄ‡∏•‡πá‡∏Å: ‡πÉ‡∏™‡πà‡πÉ‡∏à‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ‡πÄ‡∏Å‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡∏∞‡∏á‡∏≤‡∏ô‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô',
    'report.dayMaster.geng':'Â∫ö‡∏ó‡∏≠‡∏á‡πÅ‡∏Ç‡πá‡∏á: ‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡πÑ‡∏ß ‡∏Å‡∏•‡πâ‡∏≤‡∏•‡∏∏‡∏¢ ‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏£‡∏á‡πÄ‡∏Å‡∏¥‡∏ô',
    'report.dayMaster.xin':'Ëæõ‡∏ó‡∏≠‡∏á‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î: ‡πÄ‡∏õ‡πä‡∏∞ ‡∏°‡∏µ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô ‡∏ä‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á',
    'report.dayMaster.ren':'Â£¨‡∏ô‡πâ‡∏≥‡πÉ‡∏´‡∏ç‡πà: ‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô ‡πÑ‡∏≠‡πÄ‡∏î‡∏µ‡∏¢‡πÄ‡∏£‡πá‡∏ß ‡∏£‡∏±‡∏Å‡∏≠‡∏¥‡∏™‡∏£‡∏∞',
    'report.dayMaster.gui':'Áô∏‡∏ô‡πâ‡∏≥‡πÄ‡∏•‡πá‡∏Å: ‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ‡∏≠‡∏î‡∏ó‡∏ô ‡πÅ‡∏£‡∏á‡∏Ç‡∏±‡∏ö‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡πâ‡∏≤‡∏á‡πÉ‡∏ô ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏Ñ‡∏¥‡∏¥‡∏î‡∏°‡∏≤‡∏Å',

    // Presets
    'report.marriage.stable':'‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏°‡∏±‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡πÑ‡∏î‡πâ‡∏î‡∏µ ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß',
    'report.marriage.experienced':'‡∏°‡∏µ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÄ‡∏à‡∏≠‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏£‡∏±‡∏Å‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡∏™‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡∏î‡∏π‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ô‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î',
    'report.marriage.default':'‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏≤‡∏®‡∏±‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∏‡∏¢‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡∏Ç‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏ù‡πà‡∏≤‡∏¢',

    'report.career.leadership':'‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó‡∏ú‡∏π‡πâ‡∏ô‡∏≥‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡∏ô',
    'report.career.business':'‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏á‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≤‡∏¢/‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô ‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏ô‡∏±‡∏¢',
    'report.career.creative':'‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏á‡∏≤‡∏ô‡∏Ñ‡∏£‡∏µ‡πÄ‡∏≠‡∏ó‡∏µ‡∏ü/‡πÄ‡∏ó‡∏Ñ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á',
    'report.career.steady':'‡∏Ñ‡πà‡∏≠‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≠‡∏¢‡πÑ‡∏õ: ‡∏•‡∏∂‡∏Å‡πÉ‡∏´‡πâ‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏ó‡∏±‡∏Å‡∏©‡∏∞ ‡πÅ‡∏•‡πâ‡∏ß‡πÇ‡∏ï‡∏î‡πâ‡∏ß‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏™‡∏µ‡∏¢‡∏á'
  });

  function t(path, lang = (window.state && window.state.lang) || 'th-TH') {
    const pack = (window.I18N && window.I18N[lang]) || {};
    const baseTH = (window.I18N && window.I18N['th-TH']) || {};

    let v = pack[path];
    if (v != null && v !== '') return v;

    v = deepGet(pack, path);
    if (v != null && v !== '') return v;

    v = baseTH[path];
    if (v != null && v !== '') return v;

    v = deepGet(baseTH, path);
    if (v != null && v !== '') return v;

    return '';
  }
  window.t = t;

  function applyI18n(){
    const lang = state.lang || 'th-TH';
    document.documentElement.lang = lang;

    document.querySelectorAll('[data-i18n]').forEach(el=>{
      const key = el.getAttribute('data-i18n');
      const val = t(key);
      if (typeof val === 'string' && val !== '') el.textContent = val;
    });

    const setPh = (id, value) => { const el=$(id); if (el && typeof value === 'string' && value) el.placeholder = value; };
    setPh('name', t('form.namePlaceholder'));
    setPh('chatInput', t('chat.placeholder'));

    if (window.lastCtx && typeof window.buildProReport === 'function') window.buildProReport(window.lastCtx);
  }
  window.applyI18n = applyI18n;

  /* ===================== BAZI CALCULATOR ===================== */
  class BaziCalculator {
    constructor(){
      this.HEAVENLY_STEMS=['Áî≤','‰πô','‰∏ô','‰∏Å','Êàä','Â∑±','Â∫ö','Ëæõ','Â£¨','Áô∏'];
      this.EARTHLY_BRANCHES=['Â≠ê','‰∏ë','ÂØÖ','ÂçØ','Ëæ∞','Â∑≥','Âçà','Êú™','Áî≥','ÈÖâ','Êàå','‰∫•'];

      // NaYin
      this.NAYIN=[
        'Êµ∑‰∏≠Èáë','ÁÇâ‰∏≠ÁÅ´','Â§ßÊûóÊú®','Ë∑ØÂÇçÂúü','Ââ£ÈãíÈáë',
        'Â±±È†≠ÁÅ´','Êæó‰∏ãÊ∞¥','ÂüéÈ†≠Âúü','ÁôΩËùãÈáë','Ê•äÊü≥Êú®',
        'Ê≥â‰∏≠Ê∞¥','Â±ã‰∏äÂúü','ÈúπÈùÇÁÅ´','ÊùæÊüèÊú®','Èï∑ÊµÅÊ∞¥',
        'Á†Ç‰∏≠Èáë','Â±±‰∏ãÁÅ´','Âπ≥Âú∞Êú®','Â£Å‰∏äÂúü','ÈáëÁÆîÈáë',
        'Ë¶ÜÁÅØÁÅ´','Â§©Ê≤≥Ê∞¥','Â§ßÈßÖÂúü','ÈáµÈáßÈáë','Ê°ëÊüòÊú®',
        'Â§ßÊ∏ìÊ∞¥','Ê≤ô‰∏≠Âúü','Â§©‰∏äÁÅ´','Áü≥Ê¶¥Êú®','Â§ßÊµ∑Ê∞¥'
      ];
    }
    yearPillar(year){ const s=(year-4)%10, b=(year-4)%12; return {stem:this.HEAVENLY_STEMS[(s+10)%10], branch:this.EARTHLY_BRANCHES[(b+12)%12]}; }
    solarMonthIndex(y,m,d){
      const mmdd=m*100+d;
      const gates=[[106,12],[204,1],[306,2],[405,3],[506,4],[606,5],[707,6],[808,7],[908,8],[1008,9],[1107,10],[1207,11]];
      let idx=11; for(const [thr,val] of gates){ if(mmdd>=thr) idx=val; }
      const branchBy={1:'ÂØÖ',2:'ÂçØ',3:'Ëæ∞',4:'Â∑≥',5:'Âçà',6:'Êú™',7:'Áî≥',8:'ÈÖâ',9:'Êàå',10:'‰∫•',11:'Â≠ê',12:'‰∏ë'};
      return {index:idx, branch:branchBy[idx]};
    }
    monthPillar(year,month,day){
      const {index,branch}=this.solarMonthIndex(year,month,day);
      const yStemIdx=this.HEAVENLY_STEMS.indexOf(this.yearPillar(year).stem);
      const startMap={0:2,1:4,2:6,3:8,4:0,5:2,6:4,7:6,8:8,9:0};
      const stemIdx=(startMap[yStemIdx]+(index-1))%10;
      return {stem:this.HEAVENLY_STEMS[stemIdx], branch};
    }
    dayPillar(year,month,day){
      const baseUTC=Date.UTC(1900,0,31), targetUTC=Date.UTC(year,month-1,day);
      const dayDiff=Math.floor((targetUTC-baseUTC)/86400000);
      const stemIdx=(0+dayDiff)%10, branchIdx=(4+dayDiff)%12;
      return {stem:this.HEAVENLY_STEMS[(stemIdx+10)%10],branch:this.EARTHLY_BRANCHES[(branchIdx+12)%12]};
    }
    hourPillar(dayStem,hour){
      const branchMap={23:'Â≠ê',0:'Â≠ê',1:'‰∏ë',2:'‰∏ë',3:'ÂØÖ',4:'ÂØÖ',5:'ÂçØ',6:'ÂçØ',7:'Ëæ∞',8:'Ëæ∞',9:'Â∑≥',10:'Â∑≥',11:'Âçà',12:'Âçà',13:'Êú™',14:'Êú™',15:'Áî≥',16:'Áî≥',17:'ÈÖâ',18:'ÈÖâ',19:'Êàå',20:'Êàå',21:'‰∫•',22:'‰∫•'};
      const startMap={0:0,1:2,2:4,3:6,4:8,5:0,6:2,7:4,8:6,9:8};
      const dayIdx=this.HEAVENLY_STEMS.indexOf(dayStem);
      const hourIndex=Math.floor((hour+1)/2)%12;
      const stemIdx=(startMap[dayIdx]+hourIndex)%10;
      return {stem:this.HEAVENLY_STEMS[stemIdx], branch:branchMap[hour]};
    }
    stemElem(s){ return ({Áî≤:'Êú®',‰πô:'Êú®',‰∏ô:'ÁÅ´',‰∏Å:'ÁÅ´',Êàä:'Âúü',Â∑±:'Âúü',Â∫ö:'Èáë',Ëæõ:'Èáë',Â£¨:'Ê∞¥',Áô∏:'Ê∞¥'})[s]||'-'; }
    branchElem(b){ return ({Â≠ê:'Ê∞¥',‰∏ë:'Âúü',ÂØÖ:'Êú®',ÂçØ:'Êú®',Ëæ∞:'Âúü',Â∑≥:'ÁÅ´',Âçà:'ÁÅ´',Êú™:'Âúü',Áî≥:'Èáë',ÈÖâ:'Èáë',Êàå:'Âúü',‰∫•:'Ê∞¥'})[b]||'-'; }
    nayin(s,b){ const si=this.HEAVENLY_STEMS.indexOf(s), bi=this.EARTHLY_BRANCHES.indexOf(b); return this.NAYIN[(si*2+bi)%this.NAYIN.length]; }
    tenGods(dayStem, stems){
      const map={
        'Áî≤':{'Áî≤':'ÊØîËÇ©','‰πô':'Âä´Ë≤°','‰∏ô':'È£üÁ•û','‰∏Å':'ÂÇ∑ÂÆò','Êàä':'ÂÅèË≤°','Â∑±':'Ê≠£Ë≤°','Â∫ö':'‰∏ÉÊÆ∫','Ëæõ':'Ê≠£ÂÆò','Â£¨':'ÂÅèÂç∞','Áô∏':'Ê≠£Âç∞'},
        '‰πô':{'Áî≤':'Âä´Ë≤°','‰πô':'ÊØîËÇ©','‰∏ô':'ÂÇ∑ÂÆò','‰∏Å':'È£üÁ•û','Êàä':'Ê≠£Ë≤°','Â∑±':'ÂÅèË≤°','Â∫ö':'Ê≠£ÂÆò','Ëæõ':'‰∏ÉÊÆ∫','Â£¨':'Ê≠£Âç∞','Áô∏':'ÂÅèÂç∞'},
        '‰∏ô':{'Áî≤':'ÂÅèÂç∞','‰πô':'Ê≠£Âç∞','‰∏ô':'ÊØîËÇ©','‰∏Å':'Âä´Ë≤°','Êàä':'È£üÁ•û','Â∑±':'ÂÇ∑ÂÆò','Â∫ö':'ÂÅèË≤°','Ëæõ':'Ê≠£Ë≤°','Â£¨':'‰∏ÉÊÆ∫','Áô∏':'Ê≠£ÂÆò'},
        '‰∏Å':{'Áî≤':'Ê≠£Âç∞','‰πô':'ÂÅèÂç∞','‰∏ô':'Âä´Ë≤°','‰∏Å':'ÊØîËÇ©','Êàä':'ÂÇ∑ÂÆò','Â∑±':'È£üÁ•û','Â∫ö':'Ê≠£Ë≤°','Ëæõ':'ÂÅèË≤°','Â£¨':'Ê≠£ÂÆò','Áô∏':'‰∏ÉÊÆ∫'},
        'Êàä':{'Áî≤':'‰∏ÉÊÆ∫','‰πô':'Ê≠£ÂÆò','‰∏ô':'ÂÅèÂç∞','‰∏Å':'Ê≠£Âç∞','Êàä':'ÊØîËÇ©','Â∑±':'Âä´Ë≤°','Â∫ö':'È£üÁ•û','Ëæõ':'ÂÇ∑ÂÆò','Â£¨':'ÂÅèË≤°','Áô∏':'Ê≠£Ë≤°'},
        'Â∑±':{'Áî≤':'Ê≠£ÂÆò','‰πô':'‰∏ÉÊÆ∫','‰∏ô':'Ê≠£Âç∞','‰∏Å':'ÂÅèÂç∞','Êàä':'Âä´Ë≤°','Â∑±':'ÊØîËÇ©','Â∫ö':'ÂÇ∑ÂÆò','Ëæõ':'È£üÁ•û','Â£¨':'Ê≠£Ë≤°','Áô∏':'ÂÅèË≤°'},
        'Â∫ö':{'Áî≤':'ÂÅèË≤°','‰πô':'Ê≠£Ë≤°','‰∏ô':'‰∏ÉÊÆ∫','‰∏Å':'Ê≠£ÂÆò','Êàä':'ÂÅèÂç∞','Â∑±':'Ê≠£Âç∞','Â∫ö':'ÊØîËÇ©','Ëæõ':'Âä´Ë≤°','Â£¨':'È£üÁ•û','Áô∏':'ÂÇ∑ÂÆò'},
        'Ëæõ':{'Áî≤':'Ê≠£Ë≤°','‰πô':'ÂÅèË≤°','‰∏ô':'Ê≠£ÂÆò','‰∏Å':'‰∏ÉÊÆ∫','Êàä':'Ê≠£Âç∞','Â∑±':'ÂÅèÂç∞','Â∫ö':'Âä´Ë≤°','Ëæõ':'ÊØîËÇ©','Â£¨':'ÂÇ∑ÂÆò','Áô∏':'È£üÁ•û'},
        'Â£¨':{'Áî≤':'È£üÁ•û','‰πô':'ÂÇ∑ÂÆò','‰∏ô':'ÂÅèË≤°','‰∏Å':'Ê≠£Ë≤°','Êàä':'‰∏ÉÊÆ∫','Â∑±':'Ê≠£ÂÆò','Â∫ö':'ÂÅèÂç∞','Ëæõ':'Ê≠£Âç∞','Â£¨':'ÊØîËÇ©','Áô∏':'Âä´Ë≤°'},
        'Áô∏':{'Áî≤':'ÂÇ∑ÂÆò','‰πô':'È£üÁ•û','‰∏ô':'Ê≠£Ë≤°','‰∏Å':'ÂÅèË≤°','Êàä':'Ê≠£ÂÆò','Â∑±':'‰∏ÉÊÆ∫','Â∫ö':'Ê≠£Âç∞','Ëæõ':'ÂÅèÂç∞','Â£¨':'Âä´Ë≤°','Áô∏':'ÊØîËÇ©'}
      };
      const m=map[dayStem]||{};
      return stems.map(s=>m[s]||'-');
    }
  }

  /* ===================== ANALYSIS HELPERS ===================== */
  function stemToPinyin(stem){
    const map = {'Áî≤':'jia','‰πô':'yi','‰∏ô':'bing','‰∏Å':'ding','Êàä':'wu','Â∑±':'ji','Â∫ö':'geng','Ëæõ':'xin','Â£¨':'ren','Áô∏':'gui'};
    return map[stem] || String(stem).toLowerCase();
  }

  const BaziAnalysis = {
    dayMasterLine(stem){ return t('report.dayMaster.'+stemToPinyin(stem)) || ''; },

    relation(dayStem){
      const dict={
        'Áî≤':{traits:'‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡∏°‡∏±‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏ù‡πà‡∏≤‡∏¢‡∏ô‡∏≥‡∏á‡πà‡∏≤‡∏¢ ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏ß‡πâ‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏≠‡∏µ‡∏Å‡∏ù‡πà‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡∏î‡πâ‡∏ß‡∏¢',tips:'‡∏ü‡∏±‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏ï‡∏≠‡∏ö ‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∏‡∏¢'},
        '‰πô':{traits:'‡∏≠‡πà‡∏≠‡∏ô‡πÇ‡∏¢‡∏ô ‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏û‡∏∂‡πà‡∏á‡∏û‡∏≤‡∏°‡∏≤‡∏Å‡πÑ‡∏õ',tips:'‡∏ö‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏≥‡∏û‡∏π‡∏î ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡∏ó‡∏µ‡∏•‡∏∞‡∏ô‡∏¥‡∏î'},
        '‰∏ô':{traits:'‡∏≠‡∏ö‡∏≠‡∏∏‡πà‡∏ô‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏≠‡∏Å‡∏ä‡∏±‡∏î ‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏Ç‡∏∂‡πâ‡∏ô‡∏•‡∏á‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏ú‡∏•‡∏≠‡∏£‡∏µ‡∏ö‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡πÑ‡∏î‡πâ',tips:'‡∏´‡∏¢‡∏∏‡∏î‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡∏•‡∏∂‡∏Å 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏ï‡∏≠‡∏ö ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏û‡∏π‡∏î'},
        '‰∏Å':{traits:'‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏±‡∏á‡πÅ‡∏•‡∏∞‡∏ó‡∏∏‡πà‡∏°‡πÄ‡∏ó ‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏¥‡∏î‡∏°‡∏≤‡∏Å/‡∏£‡∏∞‡πÅ‡∏ß‡∏á‡∏á‡πà‡∏≤‡∏¢',tips:'‡∏ù‡∏∂‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏ß‡πâ‡πÉ‡∏à ‡∏•‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô‡∏à‡∏£‡∏¥‡∏á'},
        'Êàä':{traits:'‡∏°‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å ‡πÅ‡∏ï‡πà‡∏ö‡∏≤‡∏á‡∏ó‡∏µ‡∏≠‡∏≤‡∏à‡∏î‡∏π ‚Äú‡πÅ‡∏Ç‡πá‡∏á‚Äù',tips:'‡πÄ‡∏ï‡∏¥‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡πà‡∏≠‡∏ô‡πÇ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡πÇ‡∏£‡πÅ‡∏°‡∏ô‡∏ï‡∏¥‡∏Å‡πÉ‡∏´‡πâ‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô'},
        'Â∑±':{traits:'‡πÉ‡∏™‡πà‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏Å‡πà‡∏á ‡πÅ‡∏ï‡πà‡∏ö‡∏≤‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢',tips:'‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏¥‡∏à‡∏ß‡∏±‡∏ï‡∏£‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡πÄ‡∏•‡πá‡∏Å‡πÜ'},
        'Â∫ö':{traits:'‡∏ï‡∏£‡∏á‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡πÑ‡∏ß ‡πÑ‡∏°‡πà‡∏ä‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏•‡∏∏‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠',tips:'‡∏Ñ‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏à‡πÑ‡∏ß‡πâ ‡πÅ‡∏ï‡πà‡∏õ‡∏£‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÉ‡∏´‡πâ‡∏ô‡∏∏‡πà‡∏°‡∏•‡∏á'},
        'Ëæõ':{traits:'‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏™‡∏π‡∏á ‡πÉ‡∏™‡πà‡πÉ‡∏à‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û',tips:'‡∏≠‡∏¢‡πà‡∏≤‡πÄ‡∏û‡∏≠‡∏£‡πå‡πÄ‡∏ü‡πá‡∏Å‡∏ï‡πå‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô'},
        'Â£¨':{traits:'‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏î‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡∏∞‡∏≠‡∏¥‡∏™‡∏£‡∏∞ ‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏ß',tips:'‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏¥‡∏à‡∏ß‡∏±‡∏ï‡∏£‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ô‡∏∏‡∏Å‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô'},
        'Áô∏':{traits:'‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡∏µ‡∏¢‡πå‡∏™‡∏π‡∏á ‡πÄ‡∏à‡∏≠‡πÅ‡∏£‡∏á‡∏Å‡∏î‡∏î‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß',tips:'‡∏ù‡∏∂‡∏Å‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå ‡∏Ñ‡∏∏‡∏¢‡πÅ‡∏ö‡∏ö‡∏°‡∏µ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤'}
      };
      return dict[dayStem]||{traits:'‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á ‡∏ñ‡πâ‡∏≤‡∏î‡∏π‡πÅ‡∏•‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏à‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡∏ó‡∏µ‡πà',tips:'‡πÄ‡∏Ñ‡∏≤‡∏£‡∏û‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏Ñ‡∏∏‡∏¢‡∏ï‡∏£‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏†‡∏≤‡∏û‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏∏‡∏ç‡πÅ‡∏à'};
    },

    marriageAdvice(ten){
      if(ten.includes('Ê≠£ÂÆò')||ten.includes('Ê≠£Ë≤°')) return t('report.marriage.stable');
      if(ten.includes('‰∏ÉÊÆ∫')||ten.includes('ÂÅèË≤°')) return t('report.marriage.experienced');
      return t('report.marriage.default');
    },

    career(dayStem,ten){
      const map={
        Áî≤:'‡∏ú‡∏π‡πâ‡∏ô‡∏≥/‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à ‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô ‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°/‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á',
        ‰πô:'‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô ‡∏î‡∏µ‡πÑ‡∏ã‡∏ô‡πå ‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤ ‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå/‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå',
        ‰∏ô:'‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î ‡πÄ‡∏ã‡∏•‡∏™‡πå ‡∏™‡∏∑‡πà‡∏≠ ‡∏á‡∏≤‡∏ô‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô/‡∏≠‡∏µ‡πÄ‡∏ß‡∏ô‡∏ï‡πå',
        ‰∏Å:'R&D/‡πÑ‡∏≠‡∏ó‡∏µ ‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£/‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û ‡∏á‡∏≤‡∏ô‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏ä‡∏¥‡∏á‡∏ä‡πà‡∏≤‡∏á',
        Êàä:'‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô ‡∏≠‡∏™‡∏±‡∏á‡∏´‡∏≤ ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå/‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£',
        Â∑±:'HR ‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô ‡∏á‡∏≤‡∏ô‡πÄ‡∏Å‡∏©‡∏ï‡∏£/‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö',
        Â∫ö:'‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢ ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£/‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏° ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢/‡∏ã‡∏µ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏ß‡∏£‡∏¥‡∏ï‡∏µ‡πâ',
        Ëæõ:'‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥ ‡∏•‡∏±‡∏Å‡∏ä‡∏±‡∏ß‡∏£‡∏µ/‡∏≠‡∏±‡∏ç‡∏°‡∏ì‡∏µ',
        Â£¨:'‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏≤/‡πÇ‡∏•‡∏à‡∏¥‡∏™‡∏ï‡∏¥‡∏Å‡∏™‡πå ‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß ‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏°‡∏Ñ‡∏£‡∏µ‡πÄ‡∏≠‡∏ó‡∏µ‡∏ü',
        Áô∏:'‡∏ß‡∏¥‡∏à‡∏±‡∏¢ ‡∏à‡∏¥‡∏ï‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤/‡πÇ‡∏Ñ‡πâ‡∏ä ‡∏®‡∏¥‡∏•‡∏õ‡∏∞/‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô'
      };
      let adv = t('report.career.steady');
      if(ten.includes('Ê≠£ÂÆò')||ten.includes('‰∏ÉÊÆ∫')) adv=t('report.career.leadership');
      else if(ten.includes('Ê≠£Ë≤°')||ten.includes('ÂÅèË≤°')) adv=t('report.career.business');
      else if(ten.includes('È£üÁ•û')||ten.includes('ÂÇ∑ÂÆò')) adv=t('report.career.creative');
      return { suitable: map[dayStem] || '‡∏Ñ‡πà‡∏≠‡∏¢‡πÜ‡∏™‡∏∞‡∏™‡∏°‡∏ó‡∏±‡∏Å‡∏©‡∏∞ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß', advice: adv };
    },

    // Directions (reference)
    wealthDirs(dayStem){
      const dirs={
        Áî≤:'‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å/‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡πÉ‡∏ï‡πâ',
        ‰πô:'‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å/‡πÉ‡∏ï‡πâ',
        ‰∏ô:'‡πÉ‡∏ï‡πâ',
        ‰∏Å:'‡πÉ‡∏ï‡πâ/‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏ï‡∏Å‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡πÉ‡∏ï‡πâ',
        Êàä:'‡∏Å‡∏•‡∏≤‡∏á/‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏¥‡∏°',
        Â∑±:'‡∏Å‡∏•‡∏≤‡∏á/‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏¥‡∏°/‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏ï‡∏Å‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡πÉ‡∏ï‡πâ',
        Â∫ö:'‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏ï‡∏Å/‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏ï‡∏Å‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠',
        Ëæõ:'‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏ï‡∏Å/‡πÄ‡∏´‡∏ô‡∏∑‡∏≠',
        Â£¨:'‡πÄ‡∏´‡∏ô‡∏∑‡∏≠',
        Áô∏:'‡πÄ‡∏´‡∏ô‡∏∑‡∏≠/‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å'
      };
      return dirs[dayStem] || '-';
    },

    health(dayStem){
      const c={
        Áî≤:'‡∏ï‡∏±‡∏ö/‡∏ñ‡∏∏‡∏á‡∏ô‡πâ‡∏≥‡∏î‡∏µ ‡∏î‡∏ß‡∏á‡∏ï‡∏≤ ‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏≠‡πá‡∏ô',
        ‰πô:'‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå',
        ‰∏ô:'‡∏´‡∏±‡∏ß‡πÉ‡∏à/‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏•‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏î‡∏ß‡∏á‡∏ï‡∏≤ ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏Ç‡∏∂‡πâ‡∏ô‡∏•‡∏á',
        ‰∏Å:'‡∏´‡∏±‡∏ß‡πÉ‡∏à/‡πÑ‡∏´‡∏•‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô ‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô',
        Êàä:'‡∏£‡∏∞‡∏ö‡∏ö‡∏¢‡πà‡∏≠‡∏¢‡∏≠‡∏≤‡∏´‡∏≤‡∏£ ‡∏à‡∏±‡∏î‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏¥‡∏ô‡πÉ‡∏´‡πâ‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠',
        Â∑±:'‡∏¢‡πà‡∏≠‡∏¢‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á ‡πÉ‡∏™‡πà‡πÉ‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∏‡πà‡∏°‡∏ä‡∏∑‡πâ‡∏ô',
        Â∫ö:'‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡∏•‡∏≥‡πÑ‡∏™‡πâ‡πÉ‡∏´‡∏ç‡πà ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏´‡πâ‡∏á',
        Ëæõ:'‡∏õ‡∏≠‡∏î/‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏¢‡πÉ‡∏à ‡∏à‡∏±‡∏î‡∏™‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÉ‡∏´‡πâ‡∏î‡∏µ',
        Â£¨:'‡πÑ‡∏ï/‡∏ó‡∏≤‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏õ‡∏±‡∏™‡∏™‡∏≤‡∏ß‡∏∞ ‡∏ö‡∏≤‡∏•‡∏≤‡∏ô‡∏ã‡πå‡∏ô‡πâ‡∏≥',
        Áô∏:'‡πÑ‡∏ï/‡∏Å‡∏£‡∏∞‡πÄ‡∏û‡∏≤‡∏∞‡∏õ‡∏±‡∏™‡∏™‡∏≤‡∏ß‡∏∞ ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡πÇ‡∏´‡∏°‡∏á‡∏≤‡∏ô'
      };
      return c[dayStem] || '‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏ö‡∏≤‡∏•‡∏≤‡∏ô‡∏ã‡πå ‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡πÉ‡∏´‡πâ‡∏Ñ‡∏á‡∏ó‡∏µ‡πà';
    }
  };

  /* ===================== AI INSIGHT (UNCHANGED) ===================== */
  (function () {
    const LS_DOWN = 'ai:insight:downUntil';
    const now = () => Date.now();
    const downUntil = () => { try { return parseInt(localStorage.getItem(LS_DOWN)||'0',10)||0; } catch { return 0; } };
    const markDown = (ms = 180000) => { try { localStorage.setItem(LS_DOWN, String(now()+ms)); } catch {} };
    const clearDown = () => { try { localStorage.removeItem(LS_DOWN); } catch {} };

    async function fetchJSON(url, init={}, timeoutMs=15000){
      const ctrl = new AbortController(); const t=setTimeout(()=>ctrl.abort(), timeoutMs);
      try{
        const res = await fetch(url, {...init, signal: ctrl.signal});
        if(!res.ok) throw new Error(`HTTP ${res.status}`);
        return await res.json();
      } finally { clearTimeout(t); }
    }

    async function _aiExplain(section, ctx, {lang, temperature=0.7, seed=null}={}){
      if (!window.API_BASE) return null;
      const json = await fetchJSON(`${String(window.API_BASE).replace(/\/$/,'')}/bazi/insight`, {
        method:'POST', headers:{ 'Content-Type':'application/json' },
        body: JSON.stringify({ section, lang, temperature, seed, ctx })
      });
      if (json && (json.symbolise || json.analysis)) return json;
      return null;
    }

    window.aiExplain = async function (section, ctx, opts) {
      if (now() < downUntil()) return null;
      try {
        const out = await _aiExplain(section, ctx, opts||{});
        if (out) { clearDown(); return out; }
        markDown(); return null;
      } catch {
        markDown(); return null;
      }
    };

    window.injectAI = async function (section, symId, anaId, ctx, opts) {
      try {
        const out = await window.aiExplain(section, ctx, opts);
        if (!out) return;
        const $sym = document.getElementById(symId);
        const $ana = document.getElementById(anaId);
        if ($sym && out.symbolise) $sym.textContent = `${t('reportLabels.symbolise')}Ôºö${out.symbolise}`;
        if ($ana && out.analysis)  $ana.textContent = `${t('reportLabels.analysis')}Ôºö${out.analysis}`;
      } catch {}
    };

    window.forceAiInsightRetry = function () { try { localStorage.removeItem(LS_DOWN); } catch {} };
  })();

  /* ===================== RENDERERS ===================== */
  function renderPillars(labels){
    const titles=[t('pillar.year'),t('pillar.month'),t('pillar.day'),t('pillar.hour')];
    const box = $('bazi-pillars'); if(!box) return;
    box.innerHTML = labels.map((lab,i)=>`
      <div class="pillar"><div class="tit">${titles[i]}</div><div class="gz">${lab||'-'}</div></div>
    `).join('');
  }

  function renderTable(data){
    const keys=['year','month','day','hour'];
    const translateElem = (val)=>{
      const map = { 'Êú®': t('elem.wood'), 'ÁÅ´': t('elem.fire'),'Âúü': t('elem.earth'),'Èáë': t('elem.metal'),'Ê∞¥': t('elem.water') };
      return map[val] || val;
    };
    ['stem','branch','element','nayin'].forEach(row=>{
      keys.forEach((k, i)=>{
        const cell = $(k+'-'+row); if (!cell) return;
        let v = (Array.isArray(data[row]) ? data[row][i] : '-') ?? '-';
        if (row === 'element') v = translateElem(v);
        cell.textContent = v;
      });
    });
  }

  function renderBars(pcts){
    ['Êú®','ÁÅ´','Âúü','Èáë','Ê∞¥'].forEach(e=>{
      const pct=Math.max(0,Math.min(100,Math.round(pcts[e]||0)));
      const bar=$('bar-'+e), lab=$('pct-'+e);
      if(bar) bar.style.width=pct+'%';
      if(lab) lab.textContent=pct+'%';
    });
    const entries=Object.entries(pcts).sort((a,b)=>b[1]-a[1]);
    if(entries.length){
      const strongest = entries[0][0], weakest = entries.at(-1)[0];
      const mapName = {Êú®:t('elem.wood'),ÁÅ´:t('elem.fire'),Âúü:t('elem.earth'),Èáë:t('elem.metal'),Ê∞¥:t('elem.water')};
      const tpl = (t('ui.balance') || '‡∏ò‡∏≤‡∏ï‡∏∏‡πÄ‡∏î‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î: {strongest} ¬∑ ‡∏ò‡∏≤‡∏ï‡∏∏‡∏≠‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î: {weakest}');
      const txt = tpl.replace('{strongest}', mapName[strongest]).replace('{weakest}', mapName[weakest]);
      const el=$('bazi-elements-balance'); if(el) el.textContent=txt;
    }
  }

  /* ===================== PRO REPORT (TH, 10 SECTIONS) ===================== */
  function supportElems(dm){
    const map = { Áî≤:['Ê∞¥','Êú®'], ‰πô:['Ê∞¥','Êú®'], ‰∏ô:['Êú®','ÁÅ´'], ‰∏Å:['Êú®','ÁÅ´'], Êàä:['ÁÅ´','Âúü'], Â∑±:['ÁÅ´','Âúü'], Â∫ö:['Âúü','Èáë'], Ëæõ:['Âúü','Èáë'], Â£¨:['Èáë','Ê∞¥'], Áô∏:['Èáë','Ê∞¥'] };
    const key = (x)=>({Êú®:'elem.wood',ÁÅ´:'elem.fire',Âúü:'elem.earth',Èáë:'elem.metal',Ê∞¥:'elem.water'})[x];
    return (map[dm]||[]).map(key);
  }
  function restrainElems(dm){
    const map = { Áî≤:['Èáë'], ‰πô:['Èáë'], ‰∏ô:['Ê∞¥'], ‰∏Å:['Ê∞¥'], Êàä:['Êú®'], Â∑±:['Êú®'], Â∫ö:['ÁÅ´'], Ëæõ:['ÁÅ´'], Â£¨:['Âúü'], Áô∏:['Âúü'] };
    const key = (x)=>({Êú®:'elem.wood',ÁÅ´:'elem.fire',Âúü:'elem.earth',Èáë:'elem.metal',Ê∞¥:'elem.water'})[x];
    return (map[dm]||[]).map(key);
  }
  function computeUseful(p){ // two weakest elements
    const arr = Object.entries({Êú®:p.Êú®||0,ÁÅ´:p.ÁÅ´||0,Âúü:p.Âúü||0,Èáë:p.Èáë||0,Ê∞¥:p.Ê∞¥||0})
      .sort((a,b)=>a[1]-b[1])
      .slice(0,2)
      .map(([k])=>k);
    const key = (x)=>({Êú®:'elem.wood',ÁÅ´:'elem.fire',Âúü:'elem.earth',Èáë:'elem.metal',Ê∞¥:'elem.water'})[x];
    return arr.map(key);
  }

  window.buildProReport = function buildProReport(ctx){
    const box = $('professionalReport');
    if (!box || !ctx) return;

    const dm = ctx.dayStem || '';
    const pctsCN = ctx.pcts || {};
    const ten = Array.isArray(ctx.tenGods) ? ctx.tenGods.filter(Boolean) : [];

    const elem = {
      Wood:  pctsCN['Êú®'] || 0,
      Fire:  pctsCN['ÁÅ´'] || 0,
      Earth: pctsCN['Âúü'] || 0,
      Metal: pctsCN['Èáë'] || 0,
      Water: pctsCN['Ê∞¥'] || 0,
    };

    function strongestWeakest(obj){
      const arr = Object.entries(obj || {});
      if (!arr.length) return { strongest:'', weakest:'' };
      arr.sort((a,b)=> b[1] - a[1]);
      return { strongest: arr[0][0], weakest: arr[arr.length - 1][0] };
    }

    const { strongest, weakest } = strongestWeakest(elem);
    const strongestLabel = strongest || '-';
    const weakestLabel   = weakest   || '-';

    const dmLine   = BaziAnalysis.dayMasterLine(dm) || '‡∏ô‡∏¥‡∏™‡∏±‡∏¢‡∏Ç‡∏≠‡∏á‡∏ò‡∏≤‡∏ï‡∏∏‡∏ß‡∏±‡∏ô‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå';
    const rel      = BaziAnalysis.relation(dm);
    const marriage = BaziAnalysis.marriageAdvice(ten);
    const career   = BaziAnalysis.career(dm, ten);
    const wealthDir= BaziAnalysis.wealthDirs(dm);
    const healthFo = BaziAnalysis.health(dm);

    const supportText  = supportElems(dm).map(k=>t(k)).filter(Boolean).join('„ÄÅ') || '-';
    const restrainText = restrainElems(dm).map(k=>t(k)).filter(Boolean).join('„ÄÅ') || '-';
    const usefulText   = computeUseful({ Êú®:pctsCN['Êú®']||0, ÁÅ´:pctsCN['ÁÅ´']||0, Âúü:pctsCN['Âúü']||0, Èáë:pctsCN['Èáë']||0, Ê∞¥:pctsCN['Ê∞¥']||0 })
      .map(k=>t(k)).filter(Boolean).join('„ÄÅ') || '-';

    const elemLine = `
      ‡πÑ‡∏°‡πâ: ${Math.round(elem.Wood)}% ¬∑
      ‡πÑ‡∏ü: ${Math.round(elem.Fire)}% ¬∑
      ‡∏î‡∏¥‡∏ô: ${Math.round(elem.Earth)}% ¬∑
      ‡∏ó‡∏≠‡∏á: ${Math.round(elem.Metal)}% ¬∑
      ‡∏ô‡πâ‡∏≥: ${Math.round(elem.Water)}%
    `.replace(/\s+/g,' ');

    let nearTermFocus  = t('fortune.foundation') || '‡πÇ‡∏´‡∏°‡∏î‡∏õ‡∏π‡∏ê‡∏≤‡∏ô: ‡∏ó‡∏≥‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠ ‡∏™‡∏∞‡∏™‡∏°‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡∏ô';
    let nearTermAdvice = t('cautions.default')   || '‡∏≠‡∏¢‡πà‡∏≤‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏ï‡∏≤‡∏°‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢';

    switch (strongest) {
      case 'Wood':
      case 'Fire':
        nearTermFocus  = t('fortune.upward') || '‡∏ä‡πà‡∏ß‡∏á‡∏Ç‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô: ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏´‡∏ô‡πâ‡∏≤-‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£-‡∏ó‡∏≥‡∏ú‡∏•‡∏á‡∏≤‡∏ô';
        nearTermAdvice = strongest === 'Wood'
          ? '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡πÉ‡∏´‡∏°‡πà 1 ‡∏≠‡∏¢‡πà‡∏≤‡∏á ‡∏Ç‡∏¢‡∏≤‡∏¢‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢ ‡πÅ‡∏•‡∏∞‡∏Ç‡∏¢‡∏±‡∏ö‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏•‡∏∞ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á'
          : '‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏û‡∏£‡∏µ‡πÄ‡∏ã‡∏ô‡∏ï‡πå/‡∏ï‡πà‡∏≠‡∏£‡∏≠‡∏á/‡∏õ‡∏¥‡∏î‡∏á‡∏≤‡∏ô ‡πÅ‡∏ï‡πà‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏´‡∏∏‡∏ô‡∏´‡∏±‡∏ô';
        break;
      case 'Earth':
      case 'Metal':
        nearTermFocus  = t('fortune.focus') || '‡πÇ‡∏´‡∏°‡∏î‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏£‡∏∞‡∏ö‡∏ö: ‡πÄ‡∏î‡πà‡∏ô‡∏á‡∏≤‡∏ô‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥/‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á';
        nearTermAdvice = strongest === 'Earth'
          ? '‡∏à‡∏±‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏•‡∏∞‡πÄ‡∏á‡∏¥‡∏ô: ‡πÇ‡∏ü‡∏Å‡∏±‡∏™ 1‚Äì2 ‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î'
          : '‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏¥‡πà‡∏á: ‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤ ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô ‡∏™‡∏±‡∏ç‡∏ç‡∏≤ ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πá‡∏Å‡∏≠‡∏±‡∏õ';
        break;
      case 'Water':
        nearTermFocus  = t('fortune.study') || '‡πÇ‡∏´‡∏°‡∏î‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏Å‡πà‡∏≠‡∏ô: ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•-‡∏ó‡∏î‡∏•‡∏≠‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏Å‡πà‡∏≠‡∏ô‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏à‡∏£‡∏¥‡∏á';
        nearTermAdvice = '‡∏î‡∏π-‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö-‡∏ó‡∏î‡∏•‡∏≠‡∏á‡πÅ‡∏ö‡∏ö‡πÄ‡∏•‡πá‡∏Å‡∏Å‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏•‡∏á‡∏ó‡∏∏‡∏ô';
        break;
    }

    const title = {
      overview:     t('reportTitles.overview')     || '‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏î‡∏ß‡∏á',
      fiveElements: t('reportTitles.fiveElements') || '‡∏ò‡∏≤‡∏ï‡∏∏‡∏ó‡∏±‡πâ‡∏á‡∏´‡πâ‡∏≤',
      tenGods:      t('reportTitles.tenGods')      || '‡∏™‡∏¥‡∏ö‡πÄ‡∏ó‡∏û (ÂçÅÁ•û)',
      useful:       t('reportTitles.useful')       || '‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏ò‡∏≤‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏∑‡πâ‡∏≠‡∏´‡∏ô‡∏∏‡∏ô',
      relation:     t('reportTitles.relationship') || '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå',
      career:       t('reportTitles.career')       || '‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏≠‡∏≤‡∏ä‡∏µ‡∏û',
      wealth:       t('reportTitles.wealth')       || '‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô',
      health:       t('reportTitles.health')       || '‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û',
      nearTerm:     t('reportTitles.nearTerm')     || '‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏£‡∏∞‡∏¢‡∏∞‡πÉ‡∏Å‡∏•‡πâ',
      actions:      t('reportTitles.actions')      || '‡πÄ‡∏ä‡πá‡∏Å‡∏•‡∏¥‡∏™‡∏ï‡πå‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏°‡∏∑‡∏≠‡∏ó‡∏≥',
    };

    const parts = [];

    parts.push(`
      <div class="butler-section">
        <h4>1. ${title.overview}</h4>
        <p><strong>${t('reportLabels.dayMaster') || '‡∏ò‡∏≤‡∏ï‡∏∏‡∏ß‡∏±‡∏ô (Êó•‰∏ª)'}:</strong> ${dm || '-'}</p>
        <p>${dmLine}</p>
        ${ctx.unknown ? `<p>${t('report.hourUnknownTip')}</p>` : ''}
      </div>
    `);

    parts.push(`
      <div class="butler-section">
        <h4>2. ${title.fiveElements}</h4>
        <p>${elemLine}</p>
        <p><strong>‡∏ò‡∏≤‡∏ï‡∏∏‡πÄ‡∏î‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î:</strong> ${strongestLabel} &nbsp;&nbsp; <strong>‡∏ò‡∏≤‡∏ï‡∏∏‡∏≠‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î:</strong> ${weakestLabel}</p>
        <p>
          ‡∏ò‡∏≤‡∏ï‡∏∏‡∏ó‡∏µ‡πà ‚Äú‡πÄ‡∏î‡πà‡∏ô‚Äù ‡∏Ñ‡∏∑‡∏≠‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡πÅ‡∏ö‡∏ö‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥
          ‡∏ò‡∏≤‡∏ï‡∏∏‡∏ó‡∏µ‡πà ‚Äú‡∏≠‡πà‡∏≠‡∏ô‚Äù ‡∏Ñ‡∏∑‡∏≠‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß‚Äî‡∏Ñ‡πà‡∏≠‡∏¢‡πÜ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏µ‡∏•‡∏∞‡∏ô‡∏¥‡∏î‡∏à‡∏∞‡∏≠‡∏¢‡∏π‡πà‡∏¢‡∏≤‡∏ß‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
        </p>
      </div>
    `);

    parts.push(`
      <div class="butler-section">
        <h4>3. ${title.tenGods}</h4>
        <p>
          ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏î‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÑ‡∏•‡πà‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏™‡∏¥‡∏ö‡πÄ‡∏ó‡∏û ‡πÅ‡∏ï‡πà‡πÅ‡∏Å‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠
          <strong>‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏≠‡∏Å ¬∑ ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£ ¬∑ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö</strong> ‡πÉ‡∏´‡πâ‡∏™‡∏°‡∏î‡∏∏‡∏•
        </p>
        <p>
          ‡∏ñ‡πâ‡∏≤‡πÄ‡∏´‡∏ô‡∏∑‡πà‡∏≠‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏°‡∏î‡πÅ‡∏£‡∏á ‡∏•‡∏≠‡∏á‡∏ñ‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á: ‚Äú‡∏ó‡∏≥‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏Ñ‡∏£?‚Äù ‡πÅ‡∏•‡∏∞ ‚Äú‡∏â‡∏±‡∏ô‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï‡∏ä‡∏±‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á?‚Äù
        </p>
      </div>
    `);

    parts.push(`
      <div class="butler-section">
        <h4>4. ${title.useful}</h4>
        <p><strong>‡∏ò‡∏≤‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡πÄ‡∏ï‡∏¥‡∏°‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏õ‡∏ï‡πà‡∏≠:</strong> ${supportText}</p>
        <p><strong>‡∏ò‡∏≤‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏à‡∏±‡∏î‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ:</strong> ${restrainText}</p>
        <p><strong>‡∏ò‡∏≤‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏ù‡∏∂‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ:</strong> ${usefulText}</p>
        <p>
          ‚Äú‡∏ò‡∏≤‡∏ï‡∏∏‡πÄ‡∏Å‡∏∑‡πâ‡∏≠‡∏´‡∏ô‡∏∏‡∏ô‚Äù ‡πÄ‡∏≠‡∏≤‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡πÅ‡∏ö‡∏ö‡∏à‡∏±‡∏ö‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ: ‡∏™‡∏µ/‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°/‡∏Å‡∏¥‡∏à‡∏ß‡∏±‡∏ï‡∏£/‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô
          ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å 1 ‡∏ô‡∏¥‡∏™‡∏±‡∏¢‡πÄ‡∏•‡πá‡∏Å‡πÜ ‡πÅ‡∏•‡πâ‡∏ß‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô
        </p>
      </div>
    `);

    parts.push(`
      <div class="butler-section">
        <h4>5. ${title.relation}</h4>
        <p><strong>‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å:</strong> ${rel.traits}</p>
        <p><strong>‡∏Ñ‡∏µ‡∏¢‡πå‡πÉ‡∏´‡πâ‡πÑ‡∏´‡∏•‡∏•‡∏∑‡πà‡∏ô:</strong> ${rel.tips}</p>
        <p><strong>‡πÇ‡∏ô‡πâ‡∏ï‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏á‡∏á‡∏≤‡∏ô:</strong> ${marriage}</p>
        <p>
          ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÅ‡∏Ñ‡πà‡πÇ‡∏£‡πÅ‡∏°‡∏ô‡∏ï‡∏¥‡∏Å ‡πÅ‡∏ï‡πà‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πà‡∏ß‡∏°‡∏°‡∏∑‡∏≠‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß
          ‚Äú‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï + ‡∏Ñ‡∏∏‡∏¢‡∏ï‡∏£‡∏á + ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏ô‡∏¥‡πà‡∏á‚Äù ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏ó‡∏µ‡πà
        </p>
      </div>
    `);

    parts.push(`
      <div class="butler-section">
        <h4>6. ${title.career}</h4>
        <p><strong>${t('reportLabels.suitableCareers') || '‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞'}:</strong> ${career.suitable}</p>
        <p><strong>${t('reportLabels.careerAdvice') || '‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏≠‡∏≤‡∏ä‡∏µ‡∏û'}:</strong> ${career.advice}</p>
        <p>
          ‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå‡∏ó‡∏µ‡πà‡πÇ‡∏ï: <strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∂‡∏Å‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß + ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏ä‡∏¥‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç</strong>
          ‡∏™‡∏£‡πâ‡∏≤‡∏á ‚Äú‡∏´‡∏ô‡∏∂‡πà‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‚Äù ‡∏ó‡∏µ‡πà‡∏Ñ‡∏ô‡∏à‡∏≥‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏Å‡πà‡∏≠‡∏ô
        </p>
      </div>
    `);

    parts.push(`
      <div class="butler-section">
        <h4>7. ${title.wealth}</h4>
        <p><strong>${t('reportLabels.favorableDirections') || '‡∏ó‡∏¥‡∏®‡∏°‡∏á‡∏Ñ‡∏• (‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á)'}:</strong> ${wealthDir}</p>
        <p>
          ‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÅ‡∏Ñ‡πà ‚Äú‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‚Äù ‡πÅ‡∏ï‡πà‡∏Ñ‡∏∑‡∏≠‡∏ß‡∏¥‡∏ô‡∏±‡∏¢‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∏‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á
          ‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏±‡∏Å‡πÉ‡∏´‡πâ‡∏ô‡∏¥‡πà‡∏á‡∏Å‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏û‡∏î‡∏≤‡∏ô‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ
        </p>
        <p>
          ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡∏ô‡∏¢‡∏≤‡∏ß: ‡πÇ‡∏ï‡∏à‡∏≤‡∏Å‡∏ó‡∏±‡∏Å‡∏©‡∏∞√ó‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ñ‡∏∑‡∏≠ ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏∑‡πà‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ö‡∏à‡∏∏‡∏î‡πÅ‡∏Ç‡πá‡∏á
        </p>
      </div>
    `);

    parts.push(`
      <div class="butler-section">
        <h4>8. ${title.health}</h4>
        <p><strong>${t('reportLabels.healthCharacteristics') || '‡∏à‡∏∏‡∏î‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏î‡πâ‡∏≤‡∏ô‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢'}:</strong> ${healthFo}</p>
        <p>
          ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏á‡πà‡∏≤‡∏¢: ‡∏ô‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡∏û‡∏≠ ‡∏Ç‡∏¢‡∏±‡∏ö‡πÄ‡∏ö‡∏≤‡πÜ ‡∏Å‡∏¥‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô
          ‡∏°‡∏µ ‚Äú‡∏ä‡πà‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‚Äù 1 ‡∏≠‡∏¢‡πà‡∏≤‡∏á (‡∏à‡∏î‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å/‡πÄ‡∏î‡∏¥‡∏ô/‡∏™‡∏°‡∏≤‡∏ò‡∏¥/‡∏†‡∏≤‡∏ß‡∏ô‡∏≤) ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡∏ö‡∏≤‡∏•‡∏≤‡∏ô‡∏ã‡πå
        </p>
      </div>
    `);

    parts.push(`
      <div class="butler-section">
        <h4>9. ${title.nearTerm}</h4>
        <p><strong>‡∏ò‡∏µ‡∏°‡∏´‡∏•‡∏±‡∏Å:</strong> ${nearTermFocus}</p>
        <p><strong>${t('reportLabels.analysis') || '‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥'}:</strong> ${nearTermAdvice}</p>
        <p>
          ‡∏ñ‡πâ‡∏≤‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏Å‡∏£‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢ ‡∏≠‡∏¢‡πà‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‚Äî‡∏à‡∏±‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏°‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Å‡πà‡∏≠‡∏ô
          ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏Å‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á
        </p>
      </div>
    `);

    parts.push(`
      <div class="butler-section">
        <h4>10. ${title.actions}</h4>
        <ul class="action-list">
          <li>‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 30 ‡∏ß‡∏±‡∏ô ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç 1 ‡∏≠‡∏¢‡πà‡∏≤‡∏á (‡∏á‡∏≤‡∏ô/‡πÄ‡∏á‡∏¥‡∏ô/‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û) ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡πá‡∏ô‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô</li>
          <li>‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏•‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏î‡πâ‡∏ß‡∏¢ ‚Äú‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‚Äù ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå ‡πÅ‡∏•‡πâ‡∏ß‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ú‡∏ô‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢</li>
          <li>‡πÉ‡∏ä‡πâ‡∏ò‡∏≤‡∏ï‡∏∏‡πÄ‡∏î‡πà‡∏ô (${strongestLabel}) ‡∏ú‡πà‡∏≤‡∏ô‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏° ‡∏Å‡∏¥‡∏à‡∏ß‡∏±‡∏ï‡∏£ ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏ô‡∏£‡∏≠‡∏ö‡∏ï‡∏±‡∏ß</li>
          <li>‡∏ò‡∏≤‡∏ï‡∏∏‡∏≠‡πà‡∏≠‡∏ô (${weakestLabel}) ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏¥‡∏™‡∏±‡∏¢‡πÄ‡∏•‡πá‡∏Å‡πÜ ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏•‡∏∞ 1‚Äì2 ‡∏≠‡∏¢‡πà‡∏≤‡∏á ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏ä‡∏ô‡∏∞‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á</li>
        </ul>
      </div>
    `);

    box.innerHTML = parts.join('\n');
    const sec = $('butlerProfessional');
    if (sec) sec.style.display = 'block';
  };

  /* ===================== GENERATE + UI ===================== */
  function showErr(msg){
    const box=$('error'); if(!box) return;
    box.textContent = msg || t('err.generateFail');
    box.style.display='block';
    setTimeout(()=>{ box.style.display='none'; }, 4000);
  }
  function setGenLoading(v){
    const btn=$('genBtn'), txt=$('genBtnText'), ld=$('genBtnLoading');
    if(btn) btn.disabled=!!v;
    if(txt) txt.style.display=v?'none':'inline';
    if(ld) ld.style.display=v?'inline':'none';
  }

  function generate(){
    const birth = ($('birthdate')?.value||'').trim();
    if(!birth) return showErr(t('err.fillBirthdate'));
    if(!/^\d{4}-\d{2}-\d{2}$/.test(birth)) return showErr(t('err.invalidDate'));

    const [Y,M,D]=birth.split('-').map(n=>parseInt(n,10));
    const unknown = $('timeUnknown')?.checked;
    const timeVal = $('birthtime')?.value || '00:00';
    const hh = parseInt((timeVal.split(':')[0]||'0'),10) || 0;

    setGenLoading(true);
    try{
      const calc = new BaziCalculator();
      const y = calc.yearPillar(Y);
      const m = calc.monthPillar(Y,M,D);
      const d = calc.dayPillar(Y,M,D);
      const h = unknown ? {stem:'-',branch:'-'} : calc.hourPillar(d.stem, hh);

      renderPillars([y.stem+y.branch, m.stem+m.branch, d.stem+d.branch, unknown ? (t('badge.noHour')||'-') : (h.stem+h.branch)]);

      const stems=[y.stem,m.stem,d.stem, unknown? '-' : h.stem];
      const branch=[y.branch,m.branch,d.branch, unknown? '-' : h.branch];
      const rawElems=[calc.stemElem(y.stem),calc.stemElem(m.stem),calc.stemElem(d.stem), unknown? '-' : calc.stemElem(h.stem)];
      const nayin=[calc.nayin(y.stem,y.branch),calc.nayin(m.stem,m.branch),calc.nayin(d.stem,d.branch), unknown? '-' : calc.nayin(h.stem,h.branch)];
      renderTable({stem:stems,branch:branch,element:rawElems,nayin});

      const allElems = [calc.stemElem(y.stem),calc.stemElem(m.stem),calc.stemElem(d.stem)]
        .concat(unknown?[]:[calc.stemElem(h.stem)])
        .concat([calc.branchElem(y.branch),calc.branchElem(m.branch),calc.branchElem(d.branch)])
        .concat(unknown?[]:[calc.branchElem(h.branch)]);

      const counts = {Êú®:0,ÁÅ´:0,Âúü:0,Èáë:0,Ê∞¥:0};
      allElems.forEach(e=>{ if(counts[e]!=null) counts[e]++; });
      const total = Object.values(counts).reduce((a,b)=>a+b,0)||1;
      const pcts = Object.fromEntries(Object.entries(counts).map(([k,v])=>[k, 100*v/total]));
      renderBars(pcts);

      const timeText = unknown ? (t('ui.timeUnknown')||'‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡∏¥‡∏î') :
        (t('ui.hourSuffix')||'{hh}:{mm}')
          .replace('{hh}', String(hh).padStart(2,'0'))
          .replace('{mm}', String(parseInt((timeVal.split(':')[1]||'0'),10)||0).padStart(2,'0'));

      const btxt = (t('ui.birthSummary')||'‡πÄ‡∏Å‡∏¥‡∏î: {y}-{m}-{d} {timeText}')
        .replace('{y}',Y).replace('{m}',M).replace('{d}',D).replace('{timeText}', timeText);

      const bd=$('bazi-date'); if (bd) bd.textContent = btxt;

      const tg = calc.tenGods(d.stem, stems);
      const ctx = { pcts, dayStem: d.stem, tenGods: tg, unknown };
      window.lastCtx = ctx;

      $('result').style.display='block';
    }catch(e){
      console.error(e);
      showErr(t('err.generateFail'));
    } finally {
      setGenLoading(false);
    }
  }

  /* ===================== CLOCK ===================== */
  function tickNow(){
    const box = $('nowBox'); if (!box) return;
    const fmt = new Intl.DateTimeFormat('th-TH', {
      weekday:'short', year:'numeric', month:'2-digit', day:'2-digit',
      hour:'2-digit', minute:'2-digit', hour12:false, timeZone: SG_TZ
    });
    box.textContent = fmt.format(new Date()) + ' (SGT)';
  }
  window.tickNow = tickNow;

  /* ===================== FLOATING GPT CHAT ===================== */
  function initChat(){
    const fab   = $('ssChatFab');
    const panel = $('chatPanel');
    const close = $('chatClose');
    const body  = $('chatBody');
    const input = $('chatInput');
    const send  = $('chatSend');

    if (!fab || !panel || !close || !body || !input || !send) {
      console.warn('[chat] missing elements');
      return;
    }

    let chatHistory = [];

    const open = () => { panel.setAttribute('aria-hidden','false'); setTimeout(()=>input.focus(), 50); };
    const shut = () => { panel.setAttribute('aria-hidden','true'); };
    const toggle = () => {
      const hidden = panel.getAttribute('aria-hidden') !== 'false';
      hidden ? open() : shut();
    };

    fab.addEventListener('click', toggle);
    close.addEventListener('click', shut);

    function pushMsg(text, who='bot'){
      const div = document.createElement('div');
      div.className = who === 'me' ? 'ss-msg me' : 'ss-msg';
      div.textContent = text;
      body.appendChild(div);
      body.scrollTop = body.scrollHeight;
    }

    if (!initChat._welcomed){
      initChat._welcomed = true;
      pushMsg(t('pro.welcome') || '‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö/‡∏Ñ‡πà‡∏∞ ‡∏â‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠‡∏ö‡∏±‡∏ï‡πÄ‡∏•‡∏≠‡∏£‡πå‡∏ã‡∏¥‡∏ô‡πÄ‡∏´‡∏•‡∏µ‡∏¢‡∏ô ¬∑ GPT ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏î ‚Äú‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏≤‡∏à‡∏∑‡πä‡∏≠‚Äù ‡∏Å‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏ñ‡∏≤‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢', 'bot');
    }

    function buildBaziChatContext(){
      const ctx = window.lastCtx || null;
      const name = ($('name')?.value || '').trim();
      const gender = ($('gender')?.value || '').trim();
      const birth = ($('birthdate')?.value || '').trim();
      const timeUnknown = !!$('timeUnknown')?.checked;
      const birthtime = ($('birthtime')?.value || '').trim();

      return { name, gender, birthdate: birth, birthtime: timeUnknown ? '' : birthtime, timeUnknown, chart: ctx };
    }

    function extractReply(json){
      if (!json) return '';
      return (
        json.reply ||
        json.answer ||
        json.content ||
        json.message ||
        json.text ||
        (json.data && (json.data.reply || json.data.content || json.data.text)) ||
        ''
      );
    }

    async function callChatAPI(userText){
      const lang = 'th-TH';
      const ctx = buildBaziChatContext();

      if (!chatHistory.length){
        chatHistory.push({
          role: 'system',
          content:
`‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠ ‚Äú‡∏ö‡∏±‡∏ï‡πÄ‡∏•‡∏≠‡∏£‡πå‡∏ã‡∏¥‡∏ô‡πÄ‡∏´‡∏•‡∏µ‡∏¢‡∏ô ¬∑ GPT‚Äù ‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏õ‡∏≤‡∏à‡∏∑‡πä‡∏≠‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á
- ‡∏†‡∏≤‡∏©‡∏≤: th-TH
- ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏±‡∏á (chart ‡∏ß‡πà‡∏≤‡∏á) ‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏Å‡∏î ‚Äú‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏≤‡∏à‡∏∑‡πä‡∏≠‚Äù ‡∏Å‡πà‡∏≠‡∏ô
- ‡∏ï‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô ‡πÉ‡∏ä‡πâ bullet ‡πÑ‡∏î‡πâ ‡πÄ‡∏ô‡πâ‡∏ô‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á
- ‡∏´‡πâ‡∏≤‡∏°‡πÅ‡∏™‡∏î‡∏á‡πÇ‡∏Ñ‡πâ‡∏î`
        });
      }

      chatHistory.push({ role:'user', content: userText });

      const url = String(API_BASE).replace(/\/$/,'') + CHAT_ENDPOINT;
      const payload = { lang, context: ctx, messages: chatHistory };

      const res = await fetch(url, {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify(payload)
      });

      if (!res.ok) throw new Error(`HTTP ${res.status}`);

      const json = await res.json().catch(()=>null);
      const reply = extractReply(json);

      if (reply) chatHistory.push({ role:'assistant', content: reply });
      return reply || 'Ôºà‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏ß‡πà‡∏≤‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏ä‡∏∑‡πà‡∏≠‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏ó‡∏µ‡πà Worker ‡∏™‡πà‡∏á‡∏Å‡∏•‡∏±‡∏öÔºâ';
    }

    async function sendMsg(){
      const text = (input.value || '').trim();
      if (!text) return;

      input.value = '';
      pushMsg(text, 'me');
      pushMsg('‚Ä¶', 'bot');
      const typingNode = body.lastElementChild;

      try{
        const reply = await callChatAPI(text);
        if (typingNode) typingNode.textContent = reply;
        else pushMsg(reply, 'bot');
      }catch(err){
        console.error('[chat] error', err);
        const msg = '‚ö†Ô∏è ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ GPT ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à API_BASE ‡πÅ‡∏•‡∏∞ /api/chat';
        if (typingNode) typingNode.textContent = msg;
        else pushMsg(msg, 'bot');
      }
    }

    send.addEventListener('click', sendMsg);
    input.addEventListener('keydown', (e)=>{
      if (e.key === 'Enter') sendMsg();
    });
  }

  /* ===================== BOOT ===================== */
  function boot(){
    if (boot._didBoot) return; boot._didBoot = true;

    applyI18n();

    const unk = $('timeUnknown'), bt = $('birthtime');
    if (unk && bt){
      const sync = ()=>{ bt.disabled = !!unk.checked; bt.style.opacity = bt.disabled ? 0.5 : 1; };
      unk.addEventListener('change', sync); sync();
    }

    $('genBtn')?.addEventListener('click', generate);

    initChat();
    tickNow();
  }

  document.addEventListener('DOMContentLoaded', boot);
})();
</script>

<!-- Clock + Birthdate defaults (TH) -->
<script>
(function () {
  const $ = (id) => document.getElementById(id);
  const TZ = 'Asia/Singapore';

  window.applyI18n = (function(prev){
    return function(){
      if (typeof prev === 'function') prev();
      if (typeof window.tickNow === 'function') window.tickNow();
    };
  })(window.applyI18n);

  if (typeof window.tickNow !== 'function') {
    window.tickNow = function tickNow(){
      const box = $('nowBox'); if (!box) return;
      const fmt = new Intl.DateTimeFormat('th-TH', {
        weekday:'short', year:'numeric', month:'2-digit', day:'2-digit',
        hour:'2-digit', minute:'2-digit', hour12:false, timeZone: TZ
      });
      box.textContent = fmt.format(new Date()) + ' (SGT)';
    };
  }

  function initBirthDefaults() {
    const bd = $('birthdate'); const bt = $('birthtime'); const unk = $('timeUnknown');
    const nowSG = new Date(new Date().toLocaleString('th-TH', { timeZone: TZ }));

    if (bd && !bd.value){
      const y=nowSG.getFullYear(), m=String(nowSG.getMonth()+1).padStart(2,'0'), d=String(nowSG.getDate()).padStart(2,'0');
      bd.value = `${y}-${m}-${d}`;
    }

    if (bt){
      const hh=String(nowSG.getHours()).padStart(2,'0'), mm=String(nowSG.getMinutes()).padStart(2,'0');
      if (!bt.value) bt.value = `${hh}:${mm}`;
      const setUnknownState = ()=>{ const isUnknown = !!(unk && unk.checked); bt.disabled = isUnknown; if (isUnknown) bt.value = ''; };
      setUnknownState();
      if (unk && !unk._wired){
        unk._wired = true;
        unk.addEventListener('change', ()=>{
          if (unk.checked){
            bt.disabled = true; bt.value = '';
          } else {
            bt.disabled = false;
            if (!bt.value){
              const n = new Date(new Date().toLocaleString('th-TH',{timeZone:TZ}));
              bt.value = `${String(n.getHours()).padStart(2,'0')}:${String(n.getMinutes()).padStart(2,'0')}`;
            }
          }
        });
      }
    }
  }

  initBirthDefaults();
  if (typeof window.tickNow === 'function') window.tickNow();
  if (!window._clock) window._clock = setInterval(()=>{ try{ window.tickNow(); }catch{} }, 60000);
})();
</script>
</body>
</html>

