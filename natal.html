
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title data-i18n="page_title">å‘½ç†ä¾›é—¨ Â· æœ¬å‘½æ˜Ÿç›˜ï¼ˆå…è´¹æäº¤ï¼‰</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600&family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b0f14; --card:#11161dCC; --line:#1f2a36; --text:#e8edf3; --muted:#98a7b7;
      --brand:#d4af37; --accent:#58b9ff; --radius:14px; --shadow:0 8px 30px rgba(0,0,0,.35); --blur:10px;
    }
    html,body{height:100%} html{font-size:16px}
    @media(min-width:768px){ html{font-size:17px} } @media(min-width:1200px){ html{font-size:18px} }
    body{
      margin:0; color:var(--text);
      background: radial-gradient(1200px 600px at 70% -10%, #16202b 10%, transparent 60%) no-repeat,
                  linear-gradient(180deg,#0b0f14,#0b0f14);
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans SC", Arial, sans-serif;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }
    body::before{
      content:""; position:fixed; inset:0; z-index:-2;
      background:url('assets/images/gate.jpg') center/cover no-repeat;
      filter:brightness(.45) saturate(.9) blur(2px);
    }
    .glow{position:fixed; inset:auto auto 10% -10%; width:45vw; height:45vw; max-width:700px; max-height:700px;
      background:radial-gradient(closest-side, #2a98ff33, transparent 70%); filter:blur(30px); z-index:-1; pointer-events:none;}

    .container{width:100%; max-width:1000px; padding:24px 16px 80px; margin:0 auto;}
    header{position:sticky; top:0; z-index:10; backdrop-filter:saturate(140%) blur(12px);
      background:#0b0f14cc; border-bottom:1px solid #0f1622;}
    .head-inner{display:flex; align-items:center; justify-content:space-between; gap:14px; padding:16px}
    .brand{display:flex; align-items:center; gap:12px;}
    .brand-badge{width:36px; height:36px; border-radius:10px; background:linear-gradient(145deg,#273243,#0e141c);
      display:grid; place-items:center; color:var(--brand); font-weight:700; box-shadow:var(--shadow)}
    .title{font-family:"Noto Serif SC","Noto Serif",serif; font-weight:600; letter-spacing:.02em; font-size:1.1rem}
    .subtitle{color:var(--muted); font-size:.9rem}

    /* è¯­è¨€é€‰æ‹©å™¨ */
    .lang{display:flex; align-items:center; gap:8px}
    .lang label{color:var(--muted); font-size:.9rem}
    .lang select{
      appearance:none; border-radius:10px; border:1px solid #243244; background:#0e1520; color:var(--text);
      padding:10px 34px 10px 12px; font-size:.95rem;
      background-image:url("data:image/svg+xml,%3Csvg width='12' height='8' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%2398a7b7' stroke-width='2' fill='none'/%3E%3C/svg%3E");
      background-repeat:no-repeat; background-position:calc(100% - 12px) 50%;
    }

    .card{background:var(--card); border:1px solid var(--line); border-radius:var(--radius);
      box-shadow:var(--shadow); backdrop-filter: blur(var(--blur)); padding:18px;}
    .section{margin-top:18px}
    .section h2{
      font-family:"Noto Serif SC","Noto Serif",serif; font-weight:600; font-size:1.2rem; margin:0 0 12px;
      display:flex; align-items:center; gap:10px
    }
    .section h2::before{
      content:""; width:8px; height:8px; border-radius:50%; background:var(--accent); box-shadow:0 0 0 4px #58b9ff22
    }

    .row{display:grid; gap:12px}
    @media(min-width:640px){ .row-2{grid-template-columns:1fr 1fr} .row-3{grid-template-columns:1fr 1fr 1fr} }
    input,select,button{
      width:100%; box-sizing:border-box; border-radius:12px; border:1px solid #243244;
      background:#0e1520; color:var(--text); padding:14px 13px; font-size:1rem; outline:none;
    }
    input::placeholder{color:#6f8092}
    select{appearance:none; background-image:url("data:image/svg+xml,%3Csvg width='12' height='8' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%2398a7b7' stroke-width='2' fill='none'/%3E%3C/svg%3E"); background-repeat:no-repeat; background-position:calc(100% - 12px) 50%}

    .btn{
      background:linear-gradient(180deg,#1d2a3a,#101723); border:1px solid #28364a;
      font-weight:600; letter-spacing:.02em; cursor:pointer; transition:transform .05s ease, box-shadow .2s ease, border .2s ease;
    }
    .btn:hover{box-shadow:0 6px 18px rgba(88,185,255,.15), inset 0 1px 0 #2e3c50}
    .btn:active{transform:translateY(1px)}
    .btn[disabled]{opacity:.6; cursor:not-allowed}

    .muted{color:var(--muted)} .error{color:#ff8f8f; margin-top:8px}
    footer{color:#6c7b8c; font-size:.85rem; text-align:center; padding:30px 0}

    /* å ä½æŠ¥å‘Šå¡ç‰‡ */
    .stack{display:grid; gap:12px}
    .pill{border:1px solid #263448; background:#0e1520; border-radius:12px; padding:12px}
    .pill .tag{display:inline-block; font-size:.82rem; padding:3px 8px; border-radius:999px; border:1px solid #2b3a4f; color:#c7d5e6; background:#0b111b}
    .big{font-weight:700}
  </style>
</head>
<body>
  <div class="glow"></div>
  <header>
    <div class="head-inner container">
      <div class="brand">
        <div class="brand-badge">5X</div>
        <div>
          <div class="title" data-i18n="site_title">å‘½ç†ä¾›é—¨ Â· æœ¬å‘½æ˜Ÿç›˜</div>
          <div class="subtitle" data-i18n="site_subtitle">å…è´¹æäº¤ Â· é£æ ¼ä¸é¦–é¡µç»Ÿä¸€ | åç»­å¯å¯¹æ¥æ˜Ÿå†åº“</div>
        </div>
      </div>
      <div class="lang">
        <label for="langSelect" data-i18n="lang_label">è¯­è¨€</label>
        <select id="langSelect" aria-label="Language">
          <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
          <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
          <option value="en">English</option>
          <option value="ja">æ—¥æœ¬èª</option>
          <option value="th">à¹„à¸—à¸¢</option>
          <option value="ms">Bahasa Melayu</option>
        </select>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- è¡¨å• -->
    <section class="card section">
      <h2 data-i18n="form_title">æäº¤å‡ºç”Ÿèµ„æ–™ Â· ç”Ÿæˆæ˜Ÿç›˜</h2>

      <div class="row row-2">
        <input id="name" placeholder="å§“åï¼ˆå¯é€‰ï¼‰" data-i18n-ph="ph_name">
        <select id="gender">
          <option value="" disabled selected data-i18n="ph_gender">é€‰æ‹©æ€§åˆ«</option>
          <option value="male" data-i18n="gender_male">ç”·æ€§</option>
          <option value="female" data-i18n="gender_female">å¥³æ€§</option>
        </select>
      </div>

      <div class="row row-3" style="margin-top:6px">
        <input type="date" id="birth_date" data-i18n-ph="ph_birthdate">
        <input type="time" id="birth_time" data-i18n-ph="ph_birthtime">
        <input type="text" id="birth_place" placeholder="å‡ºç”Ÿåœ°ç‚¹ / Place" data-i18n-ph="ph_place">
      </div>

      <div class="row row-2" style="margin-top:6px">
        <select id="calendar">
          <option value="Gregorian" data-i18n="calendar_g">é˜³å† / Gregorian</option>
          <option value="Lunar" disabled data-i18n="calendar_l">å†œå† / Lunarï¼ˆå³å°†æ”¯æŒï¼‰</option>
        </select>
        <button class="btn" id="btnSubmit" onclick="generateChart()" data-i18n="btn_gen">ç”Ÿæˆæ˜Ÿç›˜</button>
      </div>

      <div class="muted" style="margin-top:6px" data-i18n="hint_tz">
        æç¤ºï¼šé»˜è®¤ä¸œå…«åŒºæ—¶é—´ã€‚åç»­å°†æ”¯æŒåŸå¸‚æ—¶åŒºä¸å¤ä»¤æ—¶è‡ªåŠ¨æ¢ç®—ã€‚
      </div>
      <div class="error" id="error" style="display:none"></div>
    </section>

    <!-- å ä½æŠ¥å‘Š -->
    <section id="preview" style="display:none" class="card section">
      <h2 data-i18n="preview_title">å ä½ç‰ˆæŠ¥å‘Š</h2>
      <div class="stack" id="preview_content"></div>
      <div class="muted" style="margin-top:8px" data-i18n="preview_note">
        å·²è®°å½•ä½ çš„èµ„æ–™ã€‚æ­£å¼æ˜Ÿç›˜ä¸å®«ä½ã€ç›¸ä½ã€è¡Œæ˜Ÿè§£é‡Šå°†åœ¨å¯¹æ¥æ˜Ÿå†åº“åå±•ç¤ºã€‚
      </div>
    <!-- ä¼šå‘˜ä¸“åŒº -->
    <section class="card section">
      <h2 class="group-title" data-i18n="vip_title">ğŸŒ™ ä¼šå‘˜åŒºåŸŸ VIP Segment</h2>
      <div class="columns">
        <div class="list-block">
          <div class="group-title" data-i18n="vip_mingli">ğŸ— å‘½ç†ç©ºé—´ä¸“å±å†…å®¹</div>
          <ul>
            <li data-i18n="vip_love">å§»ç¼˜æ–¹å‘ï¼šæ‹çˆ±ç¼˜åˆ†ã€å©šå§»èµ°åŠ¿</li>
            <li data-i18n="vip_career">äº‹ä¸šæ–¹å‘ï¼šèŒåœºå‘å±•ã€åˆ›ä¸šæ½œåŠ›</li>
            <li data-i18n="vip_wealth">è´¢è¿æ–¹å‘ï¼šè´¢ä½åˆ†æã€ç†è´¢æ—¶æœº</li>
            <li data-i18n="vip_pet">å® ç‰©å‘½ç†ï¼šä¼´ä¾£åŠ¨ç‰©çš„æ€§æ ¼ä¸ç¼˜åˆ†</li>
            <li data-i18n="vip_hepan">åˆç›˜åˆ†æï¼šå©šæœŸæ‹©æ—¥ã€æ–°ç”Ÿæ‹©æ—¶</li>
            <li data-i18n="vip_name">æµ‹ååˆ†æï¼šå…¬å¸åã€å®å®åã€å‘½åæ”¹è¿</li>
            <li data-i18n="vip_fengshui">è´¢ä½åˆç›˜ï¼šä½å®¶ / åŠå…¬å®¤åŠ¨çº¿é…åˆ</li>
          </ul>
        </div>
        <div class="list-block">
          <div class="group-title" data-i18n="vip_xinlian">ğŸŒ™ å¿ƒæ€œç©ºé—´ä¸“å±å†…å®¹</div>
          <ul>
            <li data-i18n="vip_record">çµæ€§è®°å½•ï¼šç…§ç‰‡ã€æ¢¦å¢ƒã€å£°éŸ³ã€æ„¿æœ›ç¥ˆç¥·</li>
            <li data-i18n="vip_course">å‘½ç†è¯¾ç¨‹ï¼šå…«å­— / å¡”ç½— / å æ˜Ÿ / çµæ•° / äººç±»å›¾</li>
            <li data-i18n="vip_memorial">å®¶æ—çºªå¿µç³»ç»Ÿï¼šäº²äººçµæ€§çºªå¿µ & å»¶ç»­</li>
            <li data-i18n="vip_tasks">æ¯å‘¨èƒ½é‡ç»ƒä¹  / ç¥æ˜ä»ªå¼ä»»åŠ¡</li>
            <li data-i18n="vip_shop">èƒ½é‡å•†åŸä¸“å±æŠ˜æ‰£ & å¾¡å®ˆè®¢åˆ¶</li>
          </ul>
        </div>
      </div>

      <div class="group-title" style="margin-top:14px" data-i18n="login_title">ğŸ’ ç™»å…¥ VIP åŠŸèƒ½</div>

      <section class="astro-auth">
        <div class="auth-grid">
          <!-- å·¦ä¾§ï¼šè¾“å…¥ + æ³¨å†Œ/ç™»å½• -->
          <div class="panel">
            <div class="head" data-i18n="panel_login_head">è´¦æˆ·ç™»å½• / æ³¨å†Œ</div>
            <div class="body">
              <div class="row" id="authFields">
            <label for="email" class="sr-only" data-i18n="ph_email">é‚®ç®± Email</label>
            <input
               id="email"
               name="email"
               type="email"
               inputmode="email"
               autocomplete="username"   <!-- ç™»å½•/æ³¨å†Œå»ºè®®ç”¨ usernameï¼Œå¯†ç ç®¡ç†å™¨æ›´å®¹æ˜“é…å¯¹ -->
            <label for="password" class="sr-only" data-i18n="ph_label_password">å¯†ç  Password</label>    
            <input 
               id="password" 
               type="password" 
               autocomplete="new-password" 
               placeholder="å¯†ç  Passwordï¼ˆè‡³å°‘8ä½ï¼Œå«å¤§å°å†™æ•°å­—ç¬¦å·ï¼‰" data-i18n-ph="ph_password" required/>
              </div>
              <div class="spacer"></div>
              <form id="loginForm" class="row one">
                <button class="btn block" id="loginBtn" type="submit" data-i18n="btn_login">ç™»å…¥è´¦æˆ·</button>
              </form>
              <div class="spacer"></div>
              <div class="row one">
                <button class="btn ghost block" id="resetBtn" type="button" data-i18n="btn_reset">ğŸ”‘ é‡è®¾å¯†ç </button>
              </div>
              <div class="spacer"></div>
              <form class="row one" id="registerForm">
                <button class="btn block" id="registerBtn" type="submit" data-i18n="btn_register">æ³¨å†Œè´¦æˆ·</button>
                <div class="muted" data-i18n="note_price">æ³¨å†Œè´¦å·èµ é€ä¸€æ¬¡å…è´¹ä½“éªŒ</div>
                <div class="spacer"></div>
                <div class="error-message" id="authError" style="display:none"></div>
              </form>
            </div>
          </div>

          <!-- å³ä¾§ï¼šä¼šå‘˜ä¸è¿”å› -->
          <div class="panel">
            <div class="head" data-i18n="panel_member_head">ä¼šå‘˜æœåŠ¡</div>
            <div class="body">
              <div class="row one">
                <a class="btn btn-gold block" href="https://yourshopifyshop.com/products/monthly-vip" target="_blank" rel="noopener noreferrer" data-i18n="btn_upgrade">ğŸ’ å‡çº§ä¸º VIPï¼ˆæœˆè´¹ï¼‰</a>
              </div>
              <div class="spacer"></div>
              <div class="row one">
                <a class="btn ghost block" href="https://yourshopifyshop.myshopify.com" target="_blank" rel="noopener noreferrer" data-i18n="btn_backshop">â† è¿”å›å‘½ç†å•†åŸ</a>
              </div>
              <div class="spacer"></div>
              <div class="muted" data-i18n="note_price1">$9.9 / æœˆè´¹ VIPï¼ˆå‘½ç†ç©ºé—´ + å¿ƒæ€œç©ºé—´ + çµæ€§è¯¾ç¨‹ï¼‰</div>
            </div>
          </div>
        </div>
      </section>
    </section>

    <footer>Â© 5XLiving â€¢ Astro Sanctuary</footer>
  </main>

  <!-- ä¼°æ—¶é—´å¼¹çª— -->
  <div class="tw-mask" id="twMask" aria-hidden="true">
    <div class="tw-box" role="dialog" aria-modal="true" aria-labelledby="twTitle">
      <div class="tw-head" id="twTitle">ğŸ§­ ä¼°ä¸€ä¸ªå¤§è‡´å‡ºç”Ÿæ—¶é—´</div>
      <div class="tw-body">
        <div class="muted" style="margin-bottom:8px">é€‰æ‹©ä½ è®°å¾—çš„<strong>å¤§æ¦‚æ—¶æ®µ</strong>ï¼ˆåœ°æ”¯åŒå°æ—¶æ®µï¼‰</div>
        <div class="tw-grid" id="twGrid"></div>
        <div class="muted" style="margin-top:10px;font-size:.9em">
          é€‰æ‹©åç‚¹â€œå¡«å…¥æ—¶é—´â€ï¼Œä¼šç”¨è¯¥æ—¶æ®µçš„ä¸­ä½æ—¶é—´å†™åˆ°ä¸Šæ–¹æ—¶é—´è¾“å…¥æ¡†ï¼Œå¹¶è‡ªåŠ¨å–æ¶ˆâ€œæ—¶é—´ä¸è¯¦â€ã€‚
        </div>
      </div>
      <div class="tw-foot">
        <button class="btn ghost" id="twCancel" type="button">å–æ¶ˆ</button>
        <button class="btn" id="twApply" type="button" disabled>å¡«å…¥æ—¶é—´</button>
      </div>
    </div>
  </div>

<script>

<script>
  // ====== Airtableï¼ˆä¸´æ—¶ç›´è¿ï¼Œç”Ÿäº§è¯·æ”¹åç«¯ä»£ç†ï¼‰======
  const BASE_ID = "apphD4o8Efxs8h0fz";
  const TABLE   = "natal_requests";
  const TOKEN   = "patrciW8c0s9IIT2m.5fa42a27dc796b099b18f118bb640d96f1361a809a2a49d3dfffd2c81acf3553";

  const $ = id => document.getElementById(id);
  const lock = v => { const b=$("btnSubmit"); if(b) b.disabled=v; };
  function showErr(msg){ const e=$("error"); e.textContent=msg; e.style.display="block"; setTimeout(()=>e.style.display='none',4000); }
  function hideErr(){ const e=$("error"); if(e) e.style.display="none"; }
  function safeEmailFilter(s){ return encodeURIComponent(String(s||"").replace(/'/g,"\\'")); } // é¢„ç•™ç”¨
  function log(...a){ console.log("[natal]", ...a); }

  // ---------- ç”Ÿæˆæ˜Ÿç›˜ï¼ˆå†™å…¥ Airtable + å ä½æŠ¥å‘Šï¼‰ ----------
  async function generateChart(){
    hideErr();
    const name  = $("name").value.trim();
    const gender= $("gender").value;
    const date  = $("birth_date").value;
    const time  = $("birth_time").value;
    const place = $("birth_place").value.trim();
    const cal   = $("calendar").value;

    if(!date){ return showErr(t('err_need_birthdate')); }

    lock(true);
    try{
      const url = `https://api.airtable.com/v0/${BASE_ID}/${encodeURIComponent(TABLE)}`;
      const payload = {
        fields:{
          Name: name, Gender: gender, BirthDate: date, BirthTime: time, BirthPlace: place,
          Calendar: cal, SourcePage: "natal.html", CreatedAt: new Date().toISOString()
        }
      };
      log("POST", url, payload);

      const res = await fetch(url, {
        method:"POST",
        headers:{ "Authorization":`Bearer ${TOKEN}`, "Content-Type":"application/json", "Accept":"application/json" },
        body: JSON.stringify(payload)
      });

      let data = null;
      try{ data = await res.json(); }catch{ /* æŸäº›é”™è¯¯ä¸æ˜¯ JSON */ }

      if(!res.ok){
        const tmsg = (data && (data.error?.message || data.message)) || (await res.text());
        throw new Error(t('err_submit_fail') + (tmsg || res.status));
      }

      // å ä½æŠ¥å‘Šæ¸²æŸ“
      renderPreview({ name, gender, date, time, place, cal });
      $("preview").style.display = "block";
      window.scrollTo({ top: $("preview").offsetTop - 10, behavior:"smooth" });
      alert(t('msg_submit_ok'));  // ç»™å‡ºæ˜ç¡®çš„æˆåŠŸåé¦ˆ
    }catch(e){
      showErr(e.message || t('err_submit_fail'));
      console.error(e);
    }finally{
      lock(false);
    }
  }
  // ä¿è¯ inline çš„ onclick="generateChart()" èƒ½æ‰¾åˆ°
  window.generateChart = generateChart;

  function renderPreview(d){
    const wrap = $("preview_content");
    const gtxt = d.gender ? (d.gender==="male" ? t("gender_male") : t("gender_female")) : t("gender_unknown");
    wrap.innerHTML = `
      <div class="pill">
        <span class="tag">${t("pv_basic")}</span>
        <div style="margin-top:6px; line-height:1.8">
          <div><span class="big">${t("pv_name")}ï¼š</span>${d.name || "â€”"}</div>
          <div><span class="big">${t("pv_gender")}ï¼š</span>${gtxt}</div>
          <div><span class="big">${t("pv_birth")}ï¼š</span>${d.date || "â€”"} ${d.time || ""}</div>
          <div><span class="big">${t("pv_place")}ï¼š</span>${d.place || "â€”"}</div>
          <div><span class="big">${t("pv_calendar")}ï¼š</span>${d.cal}</div>
        </div>
      </div>
      <div class="pill">
        <span class="tag">${t("pv_hint")}</span>
        <div style="margin-top:6px; color:#cfd9e6">
          ${t("pv_copy")}
        </div>
      </div>
    `;
  }

  // ---------- å¤šè¯­è¨€ï¼ˆä¸ index åŒé£æ ¼ï¼‰ ----------
  const translations = {
    "zh-CN": {
      page_title:"å‘½ç†ä¾›é—¨ Â· æœ¬å‘½æ˜Ÿç›˜ï¼ˆå…è´¹æäº¤ï¼‰",
      site_title:"å‘½ç†ä¾›é—¨ Â· æœ¬å‘½æ˜Ÿç›˜",
      site_subtitle:"å…è´¹æäº¤ Â· é£æ ¼ä¸é¦–é¡µç»Ÿä¸€ | åç»­å¯å¯¹æ¥æ˜Ÿå†åº“",
      lang_label:"è¯­è¨€",
      form_title:"æäº¤å‡ºç”Ÿèµ„æ–™ Â· ç”Ÿæˆæ˜Ÿç›˜",
      ph_name:"å§“åï¼ˆå¯é€‰ï¼‰",
      ph_gender:"é€‰æ‹©æ€§åˆ«",
      gender_male:"ç”·æ€§", gender_female:"å¥³æ€§", gender_unknown:"â€”",
      ph_birthdate:"å‡ºç”Ÿæ—¥æœŸ", ph_birthtime:"å‡ºç”Ÿæ—¶é—´", ph_place:"å‡ºç”Ÿåœ°ç‚¹ / Place",
      calendar_g:"é˜³å† / Gregorian", calendar_l:"å†œå† / Lunarï¼ˆå³å°†æ”¯æŒï¼‰",
      btn_gen:"ç”Ÿæˆæ˜Ÿç›˜",
      hint_tz:"æç¤ºï¼šé»˜è®¤ä¸œå…«åŒºæ—¶é—´ã€‚åç»­å°†æ”¯æŒåŸå¸‚æ—¶åŒºä¸å¤ä»¤æ—¶è‡ªåŠ¨æ¢ç®—ã€‚",
      preview_title:"å ä½ç‰ˆæŠ¥å‘Š",
      preview_note:"å·²è®°å½•ä½ çš„èµ„æ–™ã€‚æ­£å¼æ˜Ÿç›˜ä¸å®«ä½ã€ç›¸ä½ã€è¡Œæ˜Ÿè§£é‡Šå°†åœ¨å¯¹æ¥æ˜Ÿå†åº“åå±•ç¤ºã€‚",
      pv_basic:"åŸºç¡€ä¿¡æ¯",
      pv_name:"å§“å",
      pv_gender:"æ€§åˆ«",
      pv_birth:"å‡ºç”Ÿ",
      pv_place:"åœ°ç‚¹",
      pv_calendar:"å†æ³•",
      pv_hint:"è¿›åº¦è¯´æ˜",
      pv_copy:"æˆ‘ä»¬å·²ä¿å­˜ä½ çš„èµ„æ–™ç”¨äºç”Ÿæˆæ­£å¼æ˜Ÿç›˜ã€‚å®Œæˆå¯¹æ¥åï¼Œé¡µé¢å°†å±•ç¤ºåäºŒå®«ä½ã€è¡Œæ˜Ÿè½å®«ã€ä¸»è½´ã€ä¸»è¦ç›¸ä½ä¸ç®€è¦è§£è¯»ã€‚",
      err_need_birthdate:"è¯·å¡«å†™å‡ºç”Ÿæ—¥æœŸ",
      err_submit_fail:"æäº¤å¤±è´¥ï¼š",
      msg_submit_ok:"å·²æ”¶åˆ°èµ„æ–™ï¼ˆæµ‹è¯•å­˜æ¡£ï¼‰ï¼Œæ„Ÿè°¢æäº¤ï¼"
    },
    "zh-TW": {
      page_title:"å‘½ç†ä¾›é–€ Â· æœ¬å‘½æ˜Ÿç›¤ï¼ˆå…è²»æäº¤ï¼‰",
      site_title:"å‘½ç†ä¾›é–€ Â· æœ¬å‘½æ˜Ÿç›¤",
      site_subtitle:"å…è²»æäº¤ Â· èˆ‡é¦–é åŒé¢¨æ ¼ | å¾ŒçºŒå¯ä¸²æ¥æ˜Ÿæ›†åº«",
      lang_label:"èªè¨€",
      form_title:"æäº¤å‡ºç”Ÿè³‡æ–™ Â· ç”Ÿæˆæ˜Ÿç›¤",
      ph_name:"å§“åï¼ˆå¯é¸ï¼‰",
      ph_gender:"é¸æ“‡æ€§åˆ¥",
      gender_male:"ç”·æ€§", gender_female:"å¥³æ€§", gender_unknown:"â€”",
      ph_birthdate:"å‡ºç”Ÿæ—¥æœŸ", ph_birthtime:"å‡ºç”Ÿæ™‚é–“", ph_place:"å‡ºç”Ÿåœ°é» / Place",
      calendar_g:"é™½æ›† / Gregorian", calendar_l:"è¾²æ›† / Lunarï¼ˆå³å°‡æ”¯æ´ï¼‰",
      btn_gen:"ç”Ÿæˆæ˜Ÿç›¤",
      hint_tz:"æç¤ºï¼šé è¨­æ±å…«å€æ™‚é–“ã€‚å¾ŒçºŒå°‡æ”¯æ´åŸå¸‚æ™‚å€èˆ‡å¤ä»¤æ™‚æ›ç®—ã€‚",
      preview_title:"å ä½ç‰ˆå ±å‘Š",
      preview_note:"å·²è¨˜éŒ„ä½ çš„è³‡æ–™ã€‚æ­£å¼æ˜Ÿç›¤èˆ‡å®®ä½ã€ç›¸ä½ã€è¡Œæ˜Ÿè§£è®€å°‡åœ¨ä¸²æ¥æ˜Ÿæ›†åº«å¾Œå±•ç¤ºã€‚",
      pv_basic:"åŸºç¤è³‡è¨Š", pv_name:"å§“å", pv_gender:"æ€§åˆ¥", pv_birth:"å‡ºç”Ÿ", pv_place:"åœ°é»", pv_calendar:"æ›†æ³•",
      pv_hint:"é€²åº¦èªªæ˜", pv_copy:"æˆ‘å€‘å·²ä¿å­˜ä½ çš„è³‡æ–™ä»¥ç”Ÿæˆæ­£å¼æ˜Ÿç›¤ã€‚å®Œæˆä¸²æ¥å¾Œï¼Œå°‡å±•ç¤ºåäºŒå®®ã€è¡Œæ˜Ÿè½å®®ã€ä¸»è»¸ã€ä¸»è¦ç›¸ä½èˆ‡è§£è®€ã€‚",
      err_need_birthdate:"è«‹å¡«å¯«å‡ºç”Ÿæ—¥æœŸ",
      err_submit_fail:"æäº¤å¤±æ•—ï¼š",
      msg_submit_ok:"å·²æ”¶åˆ°è³‡æ–™ï¼ˆæ¸¬è©¦å­˜æª”ï¼‰ï¼Œæ„Ÿè¬æäº¤ï¼"
    },
    "en": {
      page_title:"Bazi Gate Â· Natal Chart (Free Submit)",
      site_title:"Natal Chart Â· Astro Portal",
      site_subtitle:"Free submission Â· Unified style | Ephemeris integration coming",
      lang_label:"Language",
      form_title:"Enter Birth Data Â· Generate Chart",
      ph_name:"Name (optional)",
      ph_gender:"Select gender",
      gender_male:"Male", gender_female:"Female", gender_unknown:"â€”",
      ph_birthdate:"Birth date", ph_birthtime:"Birth time", ph_place:"Place of birth",
      calendar_g:"Gregorian", calendar_l:"Lunar (soon)",
      btn_gen:"Generate Chart",
      hint_tz:"Hint: assumes UTC+8 for now. City timezone & DST will be supported later.",
      preview_title:"Preview (Placeholder)",
      preview_note:"Your data is saved. Houses/planets/aspects will appear once ephemeris is connected.",
      pv_basic:"Basic Info", pv_name:"Name", pv_gender:"Gender", pv_birth:"Birth", pv_place:"Place", pv_calendar:"Calendar",
      pv_hint:"Progress", pv_copy:"We'll generate a full chart after ephemeris hookup: 12 houses, planets, angles, major aspects.",
      err_need_birthdate:"Please enter your birth date",
      err_submit_fail:"Submit failed: ",
      msg_submit_ok:"Received (test log). Thank you!"
    },
    "ja": {
      page_title:"å››æŸ±é–€ Â· ãƒã‚¤ã‚¿ãƒ«ï¼ˆç„¡æ–™é€ä¿¡ï¼‰",
      site_title:"ãƒã‚¤ã‚¿ãƒ«ãƒãƒ£ãƒ¼ãƒˆ",
      site_subtitle:"ç„¡æ–™é€ä¿¡ Â· çµ±ä¸€ãƒ‡ã‚¶ã‚¤ãƒ³ | æ˜Ÿæš¦é€£æºäºˆå®š",
      lang_label:"è¨€èª",
      form_title:"å‡ºç”Ÿãƒ‡ãƒ¼ã‚¿å…¥åŠ› Â· ãƒãƒ£ãƒ¼ãƒˆç”Ÿæˆ",
      ph_name:"æ°åï¼ˆä»»æ„ï¼‰",
      ph_gender:"æ€§åˆ¥ã‚’é¸æŠ",
      gender_male:"ç”·æ€§", gender_female:"å¥³æ€§", gender_unknown:"â€”",
      ph_birthdate:"èª•ç”Ÿæ—¥", ph_birthtime:"å‡ºç”Ÿæ™‚åˆ»", ph_place:"å‡ºç”Ÿåœ°",
      calendar_g:"ã‚°ãƒ¬ã‚´ãƒªã‚ªæš¦", calendar_l:"æ—§æš¦ï¼ˆæº–å‚™ä¸­ï¼‰",
      btn_gen:"ç”Ÿæˆã™ã‚‹",
      hint_tz:"æ³¨ï¼šç¾åœ¨ã¯UTC+8æƒ³å®šã€‚éƒ½å¸‚ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³/DSTã«å¾Œæ—¥å¯¾å¿œã€‚",
      preview_title:"ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼è¡¨ç¤º",
      preview_note:"ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã—ã¾ã—ãŸã€‚ãƒã‚¦ã‚¹/æƒ‘æ˜Ÿ/ã‚¢ã‚¹ãƒšã‚¯ãƒˆã¯é€£æºå¾Œã«è¡¨ç¤ºã—ã¾ã™ã€‚",
      pv_basic:"åŸºæœ¬æƒ…å ±", pv_name:"æ°å", pv_gender:"æ€§åˆ¥", pv_birth:"å‡ºç”Ÿ", pv_place:"å ´æ‰€", pv_calendar:"æš¦",
      pv_hint:"é€²æ—", pv_copy:"æ˜Ÿæš¦é€£æºå¾Œã€12ãƒã‚¦ã‚¹/æƒ‘æ˜Ÿ/è»¸/ä¸»è¦ã‚¢ã‚¹ãƒšã‚¯ãƒˆã‚’è¡¨ç¤ºã—ã¾ã™ã€‚",
      err_need_birthdate:"èª•ç”Ÿæ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„",
      err_submit_fail:"é€ä¿¡å¤±æ•—ï¼š",
      msg_submit_ok:"å—ã‘å–ã‚Šã¾ã—ãŸï¼ˆãƒ†ã‚¹ãƒˆä¿å­˜ï¼‰ã€‚ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚"
    },
    "th": {
      page_title:"à¸”à¸§à¸‡à¸à¸³à¹€à¸™à¸´à¸” Â· à¸ªà¹ˆà¸‡à¸Ÿà¸£à¸µ",
      site_title:"à¸”à¸§à¸‡à¸à¸³à¹€à¸™à¸´à¸” (Natal Chart)",
      site_subtitle:"à¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸Ÿà¸£à¸µ Â· à¸ªà¹„à¸•à¸¥à¹Œà¹€à¸”à¸µà¸¢à¸§à¸à¸±à¸šà¸«à¸™à¹‰à¸²à¹à¸£à¸ | à¸ˆà¸°à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸à¸²à¸™à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸”à¸§à¸‡à¸”à¸²à¸§à¸ à¸²à¸¢à¸«à¸¥à¸±à¸‡",
      lang_label:"à¸ à¸²à¸©à¸²",
      form_title:"à¸à¸£à¸­à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸à¸´à¸” Â· à¸ªà¸£à¹‰à¸²à¸‡à¸”à¸§à¸‡",
      ph_name:"à¸Šà¸·à¹ˆà¸­ (à¹„à¸¡à¹ˆà¸šà¸±à¸‡à¸„à¸±à¸š)",
      ph_gender:"à¹€à¸¥à¸·à¸­à¸à¹€à¸à¸¨",
      gender_male:"à¸Šà¸²à¸¢", gender_female:"à¸«à¸à¸´à¸‡", gender_unknown:"â€”",
      ph_birthdate:"à¸§à¸±à¸™à¹€à¸à¸´à¸”", ph_birthtime:"à¹€à¸§à¸¥à¸²à¹€à¸à¸´à¸”", ph_place:"à¸ªà¸–à¸²à¸™à¸—à¸µà¹ˆà¹€à¸à¸´à¸”",
      calendar_g:"à¹€à¸à¸£à¸à¸­à¹€à¸£à¸µà¸¢à¸™", calendar_l:"à¸ˆà¸±à¸™à¸—à¸£à¸„à¸•à¸´ (à¹€à¸£à¹‡à¸§à¹† à¸™à¸µà¹‰)",
      btn_gen:"à¸ªà¸£à¹‰à¸²à¸‡à¸”à¸§à¸‡",
      hint_tz:"à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸: à¸•à¸­à¸™à¸™à¸µà¹‰à¸–à¸·à¸­à¸§à¹ˆà¸² UTC+8 à¸à¹ˆà¸­à¸™ à¸ˆà¸°à¸£à¸­à¸‡à¸£à¸±à¸šà¹‚à¸‹à¸™à¹€à¸§à¸¥à¸²à¹€à¸¡à¸·à¸­à¸‡à¹à¸¥à¸° DST à¸ à¸²à¸¢à¸«à¸¥à¸±à¸‡",
      preview_title:"à¸£à¸²à¸¢à¸‡à¸²à¸™à¸Šà¸±à¹ˆà¸§à¸„à¸£à¸²à¸§",
      preview_note:"à¸šà¸±à¸™à¸—à¸¶à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹à¸¥à¹‰à¸§ à¸ˆà¸°à¹à¸ªà¸”à¸‡à¹€à¸£à¸·à¸­à¸™à¸”à¸²à¸§/à¸”à¸²à¸§à¹€à¸„à¸£à¸²à¸°à¸«à¹Œ/à¹à¸‡à¹ˆà¸¡à¸¸à¸¡à¹€à¸¡à¸·à¹ˆà¸­à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸à¸²à¸™à¸”à¸²à¸§",
      pv_basic:"à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸à¸·à¹‰à¸™à¸à¸²à¸™", pv_name:"à¸Šà¸·à¹ˆà¸­", pv_gender:"à¹€à¸à¸¨", pv_birth:"à¸§à¸±à¸™à¹€à¸§à¸¥à¸²à¹€à¸à¸´à¸”", pv_place:"à¸ªà¸–à¸²à¸™à¸—à¸µà¹ˆ", pv_calendar:"à¸›à¸à¸´à¸—à¸´à¸™",
      pv_hint:"à¸„à¸§à¸²à¸¡à¸„à¸·à¸šà¸«à¸™à¹‰à¸²", pv_copy:"à¸«à¸¥à¸±à¸‡à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸à¸²à¸™à¸”à¸²à¸§ à¸ˆà¸°à¸¡à¸µ 12 à¹€à¸£à¸·à¸­à¸™ à¸”à¸²à¸§à¹€à¸„à¸£à¸²à¸°à¸«à¹Œ à¸¡à¸¸à¸¡à¸ªà¸³à¸„à¸±à¸ à¹à¸¥à¸°à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢",
      err_need_birthdate:"à¸à¸£à¸¸à¸“à¸²à¸à¸£à¸­à¸à¸§à¸±à¸™à¹€à¸à¸´à¸”",
      err_submit_fail:"à¸ªà¹ˆà¸‡à¹„à¸¡à¹ˆà¸ªà¸³à¹€à¸£à¹‡à¸ˆ: ",
      msg_submit_ok:"à¸£à¸±à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹à¸¥à¹‰à¸§ (à¸—à¸”à¸ªà¸­à¸šà¸šà¸±à¸™à¸—à¸¶à¸) à¸‚à¸­à¸šà¸„à¸¸à¸“!"
    },
    "ms": {
      page_title:"Carta Kelahiran Â· Hantar Percuma",
      site_title:"Carta Kelahiran",
      site_subtitle:"Hantar data percuma Â· Gaya seragam | Integrasi efemeris akan datang",
      lang_label:"Bahasa",
      form_title:"Isi Data Kelahiran Â· Jana Carta",
      ph_name:"Nama (pilihan)",
      ph_gender:"Pilih jantina",
      gender_male:"Lelaki", gender_female:"Perempuan", gender_unknown:"â€”",
      ph_birthdate:"Tarikh lahir", ph_birthtime:"Masa lahir", ph_place:"Tempat lahir",
      calendar_g:"Gregorian", calendar_l:"Lunar (segera)",
      btn_gen:"Jana Carta",
      hint_tz:"Nota: andaikan UTC+8 à¸Šà¸±à¹ˆà¸§à¸„à¸£à¸²à¸§. Sokong zon waktu & DST kemudian.",
      preview_title:"Laporan Sementara",
      preview_note:"Data anda disimpan. Rumah, planet, aspek akan dipaparkan selepas integrasi efemeris.",
      pv_basic:"Maklumat Asas", pv_name:"Nama", pv_gender:"Jantina", pv_birth:"Kelahiran", pv_place:"Tempat", pv_calendar:"Kalendar",
      pv_hint:"Kemajuan", pv_copy:"Selepas integrasi, akan ada 12 rumah, planet, sudut dan aspek utama.",
      err_need_birthdate:"Masukkan tarikh lahir",
      err_submit_fail:"Hantar gagal: ",
      msg_submit_ok:"Diterima (log ujian). Terima kasih!"
    }
  };

  const LANG_KEY = "site_lang";
  function getLang(){ return localStorage.getItem(LANG_KEY) || document.documentElement.lang || "zh-CN"; }
  function setLang(code){ localStorage.setItem(LANG_KEY, code); document.documentElement.lang = code; }
  function t(key){
    const L = translations[getLang()] || translations["zh-CN"];
    return L[key] || (translations["zh-CN"][key] || key);
  }
  function applyI18n(){
    document.querySelectorAll("[data-i18n]").forEach(el=>{
      const key = el.getAttribute("data-i18n");
      el.textContent = t(key);
    });
    document.querySelectorAll("[data-i18n-ph]").forEach(el=>{
      const key = el.getAttribute("data-i18n-ph");
      el.setAttribute("placeholder", t(key));
    });
    // æ›´æ–°æµè§ˆå™¨æ ‡ç­¾
    document.title = t("page_title");
  }

  (function init(){
    // è¯­è¨€
    const select = $("langSelect");
    const current = getLang();
    if(select){ select.value = current; select.addEventListener("change", ()=>{ setLang(select.value); applyI18n(); }); }
    applyI18n();

    // é»˜è®¤æ—¥æœŸç»™ä»Šå¤©ï¼ˆé¿å…æ§ä»¶ä¸ºç©ºï¼‰
    if($("birth_date") && !$("birth_date").value){
      $("birth_date").value = new Date().toISOString().split("T")[0];
    }

    // åˆå§‹æŒ‰é’®å¯ç”¨
    lock(false);
    log("ready");
  })();
</script>
</body>
</html>


