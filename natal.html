<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="description" content="5XLiving æœ¬å‘½æ˜Ÿç›˜ï¼šè¾“å…¥å‡ºç”Ÿæ—¥æœŸã€æ—¶é—´å’Œåœ°ç‚¹ï¼Œè·å¾—ä¸ªæ€§åŒ–è§£è¯»ã€‚">
  <meta name="theme-color" content="#0b0f14">
  <link rel="preconnect" href="https://throbbing-lab-1440.hello5xliving.workers.dev" crossorigin>
  <title>æœ¬å‘½æ˜Ÿç›˜ Â· Natal Chart | 5XLiving</title>
  <link rel="icon" href="data:,">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600&family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root{ --bg:#0b0f14; --card:#11161dcc; --line:#1f2a36; --text:#e8edf3; --muted:#98a7b7; --brand:#d4af37; --gold:#d4af37; --gold2:#f2d27a; --accent:#58b9ff; --radius:14px; --shadow:0 8px 30px rgba(0,0,0,.35) }
    html,body{height:100%}
    body{ margin:0; color:var(--text); background: radial-gradient(1200px 600px at 70% -10%, #16202b 10%, transparent 60%) no-repeat, linear-gradient(180deg,#0b0f14,#0b0f14); font-family: Inter,system-ui,-apple-system,"Noto Sans SC","Segoe UI",Roboto,Arial,sans-serif; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale }
    body::before{ content:""; position:fixed; inset:0; z-index:-2; background:#090d13 url('') center/cover no-repeat; filter:brightness(.45) saturate(.9) blur(2px) }
    .container{ max-width:1100px; margin:0 auto; padding:24px 16px 80px }

    /* â€”â€” ç»Ÿä¸€å¤´éƒ¨ â€”â€” */
    .site-header{ position:sticky; top:0; z-index:10; background:#0b0f14cc; border-bottom:1px solid #0f1622; backdrop-filter:saturate(140%) blur(12px) }
    .head-inner{ display:flex; align-items:center; justify-content:space-between; gap:14px; padding:14px 16px }
    .brand{ display:flex; align-items:center; gap:10px; text-decoration:none; color:var(--text) }
    .brand-badge{ display:inline-grid; place-items:center; width:34px; height:34px; border-radius:8px; background:linear-gradient(180deg,#0e1520,#0b1018); border:1px solid #2a3546; box-shadow:0 4px 14px rgba(0,0,0,.35); font-weight:800; color:#ffe084 }
    .title{ font-family:"Noto Serif SC","Noto Serif",serif; font-weight:600; letter-spacing:.02em; font-size:1.1rem; line-height:1.25 }
    .title a{ color:inherit; text-decoration:none }
    .title a:hover{ text-decoration:underline; text-underline-offset:3px }
    .now{ color:#9bb0c3; font-size:.9rem }
    .lang{ display:flex; align-items:center; gap:8px }
    .lang label{ white-space:nowrap; color:var(--muted) }
    .lang select{ appearance:none; min-width:170px; border-radius:10px; border:1px solid #243244; background:#0e1520; color:#e8edf3; padding:10px 34px 10px 12px; font-size:.95rem; background-image:url("data:image/svg+xml,%3Csvg width='12' height='8' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%2398a7b7' stroke-width='2' fill='none'/%3E%3C/svg%3E"); background-repeat:no-repeat; background-position:calc(100% - 12px) 50% }
    @media (max-width:520px){ .title{font-size:1rem} .lang select{min-width:140px} }

    /* â€”â€” é¡µé¢ç»“æ„ â€”â€” */
    .h1{ margin:12px 0 6px; color:#ffe084; font-weight:800; font-size:1.8rem }
    .sub{ color:var(--muted) }
    .card{ background:var(--card); border:1px solid var(--line); border-radius:var(--radius); box-shadow:var(--shadow); backdrop-filter:blur(10px); padding:18px; margin:16px 0 }
    .row{ display:grid; gap:12px; grid-template-columns:1fr }
    @media(min-width:760px){ .row.cols-2{grid-template-columns:1fr 1fr} .row.cols-3{grid-template-columns:1fr 1fr 1fr} }
    label.muted{ display:block; margin-bottom:4px }
    input,select{ width:100%; box-sizing:border-box; border-radius:12px; border:1px solid #243244; background:#0e1520; color:var(--text); padding:12px 12px; font-size:15px; outline:none }
    input::placeholder{ color:#6f8092 }
    .btn{ display:inline-grid; place-items:center; padding:12px 16px; border-radius:12px; border:1px solid #e6c76e; background:linear-gradient(180deg,#fff9e6,#e6c76e); color:#191919; font-weight:800; cursor:pointer }
    .btn[disabled]{ opacity:.6; cursor:not-allowed }
    .btn.ghost{ background:transparent; color:var(--gold2); border:1px solid rgba(212,175,55,.45); box-shadow:none }

    /* â€”â€” æŠ¥å‘Šæ ·å¼ â€”â€” */
    .report{ margin-top:12px; display:grid; gap:10px }
    .report .sec{ padding:12px; border:1px solid var(--line); background:#0e1520; border-radius:12px }
    .report .sec h3{ margin:0 0 6px; color:#f2d27a; font-size:1.05rem }
    .report p,.report li{ line-height:1.7 }

    /* â€”â€” Butler & Chat â€”â€” */
    .ss-chat-fab{ position:fixed; right:18px; bottom:18px; z-index:50; width:56px; height:56px; border-radius:50%; background:linear-gradient(180deg,#fff9e6,#e6c76e); color:#191919; display:grid; place-items:center; font-weight:800; box-shadow:0 8px 30px rgba(0,0,0,.35); cursor:pointer; border:1px solid #e6c76e }
    .ss-chat-panel{ position:fixed; right:18px; bottom:88px; z-index:50; width:min(460px,92vw); display:none; background:#0e1520; border:1px solid #243244; border-radius:14px; box-shadow:var(--shadow) }
    .ss-chat-head{ display:flex; align-items:center; justify-content:space-between; padding:10px 12px; border-bottom:1px solid #243244 }
    .ss-chat-title{ font-weight:700 }
    .ss-close{ cursor:pointer; opacity:.8 }
    .ss-chat-body{ max-height:300px; overflow:auto; padding:10px 12px }
    .ss-msg{ padding:8px 10px; background:#0f1624; border:1px solid #243244; border-radius:10px; margin:6px 0; max-width:80% }
    .ss-msg.me{ margin-left:auto; background:#132033 }
    .ss-chat-input{ display:flex; align-items:center; gap:8px; padding:10px 12px; border-top:1px solid #243244 }
    .ss-chat-input input{ flex:1 1 auto; min-width:0 }
    .ss-chat-input .btn,.ss-chat-input button{ flex:0 0 auto; width:auto !important; white-space:nowrap; padding:10px 14px }

    /* â€”â€” ä¼šå‘˜åŒº â€”â€” */
    .columns{ display:grid; gap:12px; grid-template-columns:1fr }
    @media(min-width:900px){ .columns{ grid-template-columns:1fr 1fr } }
    .list-block{ border:1px solid #263448; background:#0e1520; border-radius:12px; padding:16px }
    .list-block ul{ margin:.2rem 0 0; padding-left:1.1rem }
    .group-title{ font-size:1.05rem; color:#ffe084; margin:6px 0 14px }
    .astro-auth{ max-width:980px; margin:28px auto; padding:20px 18px; background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.01)); border:1px solid rgba(212,175,55,.22); border-radius:14px; box-shadow:0 18px 50px rgba(0,0,0,.35) }
    .auth-grid{ display:grid; gap:18px; grid-template-columns:1.2fr .8fr }
    @media(max-width:860px){ .auth-grid{ grid-template-columns:1fr } }
    .panel{ background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.01)); border:1px solid rgba(212,175,55,.22); border-radius:14px; box-shadow:0 10px 30px rgba(0,0,0,.35) }
    .panel .head{ padding:16px 18px; border-bottom:1px solid rgba(212,175,55,.22); color:var(--gold); font-weight:700; letter-spacing:.3px }
    .panel .body{ padding:18px }
    .spacer{ height:12px }
    footer{ color:#6c7b8c; font-size:.85rem; text-align:center; padding:30px 0 }

    .sr-only{ position:absolute!important; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0 }
    #gpt-drawer, #gpt-drawer[hidden], #gpt-drawer>summary{ display:none!important }
  </style>
</head>
<body>
  <!-- ç»Ÿä¸€å¤´éƒ¨ -->
  <header class="site-header">
    <div class="head-inner container">
      <a class="brand" href="https://astro.5xliving.com/" target="_self">
        <span class="brand-badge">5X</span>
        <span class="title">5xLiving Â· <span data-i18n="page_title">æœ¬å‘½æ˜Ÿç›˜è§£æ</span></span>
      </a>
      <div class="now" id="nowBox" aria-live="polite"></div>
      <div class="lang">
        <label for="langSelect" class="muted" data-i18n="lang_label">è¯­è¨€</label>
        <select id="langSelect" aria-label="Language">
          <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
          <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
          <option value="en">English</option>
          <option value="ja">æ—¥æœ¬èª</option>
          <option value="th">à¹„à¸—à¸¢</option>
          <option value="ms">Bahasa Melayu</option>
        </select>
      </div>
    </div>
  </header>

  <main class="container">
    <h1 class="h1" data-i18n="page_title">æœ¬å‘½æ˜Ÿç›˜è§£æ</h1>

    <!-- è¡¨å•åŒºåŸŸ -->
    <section class="card">
      <form id="chartForm" novalidate>
        <div class="row cols-3">
          <div>
            <label class="muted" for="name" data-i18n="label_name">å§“åï¼ˆå¯é€‰ï¼‰</label>
            <input id="name" type="text" data-i18n-ph="ph_name" placeholder="ä½ çš„ç§°å‘¼ï¼ˆç”¨äºä¸ªæ€§åŒ–ï¼‰" />
          </div>
          <div>
            <label class="muted" for="gender" data-i18n="gender_label">æ€§åˆ«</label>
            <select id="gender">
              <option value="u" data-i18n="opt_gender_confidential">ä¸é€éœ²</option>
              <option value="m" data-i18n="opt_gender_male">ç”·æ€§</option>
              <option value="f" data-i18n="opt_gender_female">å¥³æ€§</option>
            </select>
          </div>
          <div>
            <label class="muted" for="place" data-i18n="label_place">å‡ºç”Ÿåœ°ç‚¹ ï¼ˆå¿…å¡«ï¼‰</label>
            <input id="place" type="text" required placeholder="åŸå¸‚æˆ–åæ ‡ï¼Œå¦‚ï¼šTaipei / 25.03,121.56" pattern="^(.{2,}|-?\d{1,2}(\.\d+)?,\s*-?\d{1,3}(\.\d+)?)$" title="è¾“å…¥åŸå¸‚åæˆ–åæ ‡ï¼Œå¦‚ Taipei æˆ– 25.03,121.56"/>
          </div>
        </div>
        <div class="row cols-3" style="margin-top:10px">
          <div>
            <label class="muted" for="birthdate" data-i18n="label_birthdate">å‡ºç”Ÿæ—¥æœŸ</label>
            <input id="birthdate" type="date" required />
          </div>
          <div>
            <label class="muted" for="birthtime" data-i18n="label_birthtime">å‡ºç”Ÿæ—¶é—´</label>
            <input id="birthtime" type="time" value="12:00" step="60" />
          </div>
          <div style="display:flex;align-items:flex-end;gap:10px">
            <button id="genBtn" class="btn" type="submit" data-i18n="btn_generate">ç”Ÿæˆæ˜Ÿç›˜</button>
          </div>
        </div>
      </form>
    </section>

    <!-- ç»“æœåŒºåŸŸ -->
    <section id="result" class="card" style="display:none">
      <h2 style="margin:0 0 10px;color:var(--gold)" data-i18n="chart_title">ä½ çš„æœ¬å‘½æŠ¥å‘Š</h2>
      <div id="chartSummary" class="muted"></div>
      <div id="chartReport" class="report"></div>
    </section>

    <!-- ä¼šå‘˜ä¸“åŒº -->
    <section class="card section">
      <h2 class="group-title" data-i18n="vip_title">ğŸŒ™ ä¼šå‘˜åŒºåŸŸ VIP Segment</h2>
      <div class="columns">
        <div class="list-block">
          <div class="group-title" data-i18n="vip_mingli">ğŸ— å‘½ç†ç©ºé—´ä¸“å±å†…å®¹</div>
          <ul>
            <li data-i18n="vip_love">å§»ç¼˜æ–¹å‘ï¼šæ‹çˆ±ç¼˜åˆ†ã€å©šå§»èµ°åŠ¿</li>
            <li data-i18n="vip_career">äº‹ä¸šæ–¹å‘ï¼šèŒåœºå‘å±•ã€åˆ›ä¸šæ½œåŠ›</li>
            <li data-i18n="vip_wealth">è´¢è¿æ–¹å‘ï¼šè´¢ä½åˆ†æã€ç†è´¢æ—¶æœº</li>
            <li data-i18n="vip_pet">å® ç‰©å‘½ç†ï¼šä¼´ä¾£åŠ¨ç‰©çš„æ€§æ ¼ä¸ç¼˜åˆ†</li>
            <li data-i18n="vip_hepan">åˆç›˜åˆ†æï¼šå©šæœŸæ‹©æ—¥ã€æ–°ç”Ÿæ‹©æ—¶</li>
            <li data-i18n="vip_name">æµ‹ååˆ†æï¼šå…¬å¸åã€å®å®åã€å‘½åæ”¹è¿</li>
            <li data-i18n="vip_fengshui">è´¢ä½åˆç›˜ï¼šä½å®¶ / åŠå…¬å®¤åŠ¨çº¿é…åˆ</li>
          </ul>
        </div>
        <div class="list-block">
          <div class="group-title" data-i18n="vip_xinlian">ğŸŒ™ å¿ƒæ€œç©ºé—´ä¸“å±å†…å®¹</div>
          <ul>
            <li data-i18n="vip_record">çµæ€§è®°å½•ï¼šç…§ç‰‡ã€æ¢¦å¢ƒã€å£°éŸ³ã€æ„¿æœ›ç¥ˆç¥·</li>
            <li data-i18n="vip_course">å‘½ç†è¯¾ç¨‹ï¼šå…«å­— / å¡”ç½— / å æ˜Ÿ / çµæ•° / äººç±»å›¾</li>
            <li data-i18n="vip_memorial">å®¶æ—çºªå¿µç³»ç»Ÿï¼šäº²äººçµæ€§çºªå¿µ & å»¶ç»­</li>
            <li data-i18n="vip_tasks">æ¯å‘¨èƒ½é‡ç»ƒä¹  / ç¥æ˜ä»ªå¼ä»»åŠ¡</li>
            <li data-i18n="vip_shop">èƒ½é‡å•†åŸä¸“å±æŠ˜æ‰£ & å¾¡å®ˆè®¢åˆ¶</li>
          </ul>
        </div>
      </div>

      <div class="group-title" style="margin-top:14px" data-i18n="login_title">ğŸ’ ç™»å…¥ VIP åŠŸèƒ½</div>

      <section class="astro-auth">
        <div class="auth-grid">
          <div class="panel">
            <div class="head" data-i18n="panel_login_head">è´¦æˆ·ç™»å½• / æ³¨å†Œ</div>
            <div class="body">
              <div class="row" id="authFields" style="display:none">
                <label for="email" class="sr-only" data-i18n="ph_email">é‚®ç®± Email</label>
                <input id="email" name="email" type="email" inputmode="email" autocomplete="username" placeholder="é‚®ç®± Email" />
                <label for="password" class="sr-only" data-i18n="ph_label_password">å¯†ç  Password</label>
                <input id="password" type="password" autocomplete="new-password" placeholder="å¯†ç  Passwordï¼ˆè‡³å°‘8ä½ï¼Œå«å¤§å°å†™æ•°å­—ç¬¦å·ï¼‰" data-i18n-ph="ph_password" />
              </div>
              <div class="spacer"></div>
              <form id="loginForm" class="row one">
                <button class="btn block" id="loginBtn" type="submit" data-i18n="btn_login">ç™»å…¥è´¦æˆ·</button>
              </form>
              <div class="spacer"></div>
              <div class="row one">
                <button class="btn ghost block" id="resetBtn" type="button" data-i18n="btn_reset">ğŸ”‘ é‡è®¾å¯†ç </button>
              </div>
              <div class="spacer"></div>
              <form class="row one" id="registerForm">
                <button class="btn block" id="registerBtn" type="submit" data-i18n="btn_register">æ³¨å†Œè´¦æˆ·</button>
                <div class="muted" data-i18n="note_price">æ³¨å†Œè´¦å·èµ é€ä¸€æ¬¡å…è´¹ä½“éªŒ</div>
                <div class="spacer"></div>
                <div class="error-message" id="authError" style="display:none"></div>
              </form>
            </div>
          </div>
          <div class="panel">
            <div class="head" data-i18n="panel_member_head">ä¼šå‘˜æœåŠ¡</div>
            <div class="body">
              <div class="row one">
                <a class="btn btn-gold block" href="https://yourshopifyshop.com/products/monthly-vip" target="_blank" rel="noopener noreferrer" data-i18n="btn_upgrade">ğŸ’ å‡çº§ä¸º VIPï¼ˆæœˆè´¹ï¼‰</a>
              </div>
              <div class="spacer"></div>
              <div class="row one">
                <a class="btn ghost block" href="https://yourshopifyshop.myshopify.com" target="_blank" rel="noopener noreferrer" data-i18n="btn_backshop">â† è¿”å›å‘½ç†å•†åŸ</a>
              </div>
              <div class="spacer"></div>
              <div class="muted" data-i18n="note_price1">$9.9 / æœˆè´¹ VIPï¼ˆå‘½ç†ç©ºé—´ + å¿ƒæ€œç©ºé—´ + çµæ€§è¯¾ç¨‹ï¼‰</div>
            </div>
          </div>
        </div>
      </section>
    </section>

    <footer>Â© 5XLiving â€¢ Astro Sanctuary</footer>
  </main>

    <!-- Xinlian Butler Â· æµ®åŠ¨èŠå¤©çª— -->
  <div class="ss-chat-fab" id="ssChatFab" role="button" aria-label="Chat with Xinlian Butler">
    AI
  </div>

  <div class="ss-chat-panel" id="ssChatPanel" aria-label="Xinlian Butler Chat">
    <div class="ss-chat-head">
      <div class="ss-chat-title">å¿ƒæ€œç®¡å®¶ Â· Xinlian Butler</div>
      <div class="ss-close" id="ssChatClose" aria-label="Close chat">âœ•</div>
    </div>
    <div class="ss-chat-body" id="ssChatBody">
      <div class="ss-msg">
        å—¨ï¼Œæˆ‘æ˜¯å¿ƒæ€œç®¡å®¶ã€‚<br>
        ä½ å¯ä»¥æŠŠåˆšåˆšç”Ÿæˆçš„æ˜Ÿç›˜é—®é¢˜ã€æ„Ÿæƒ…/äº‹ä¸š/è´¢å¯Œæ–¹å‘ï¼Œæˆ–æ˜¯ä½ ç°åœ¨æœ€åœ¨æ„çš„ä¸€ä»¶äº‹æ‰“ç»™æˆ‘ï¼Œæˆ‘ä»¬ä¸€èµ·çœ‹ä¸€çœ‹ã€‚
      </div>
    </div>
    <div class="ss-chat-input">
      <input
        id="ssChatInput"
        type="text"
        placeholder="æƒ³é—®ä»€éº¼ï¼Ÿä¾‹å¦‚ï¼šå¸®æˆ‘çœ‹ä¸€ä¸‹æˆ‘è¿™å¼ æ˜Ÿç›˜çš„æ„Ÿæƒ…æ–¹å‘"
      />
      <button class="btn" id="ssChatSend" type="button">å‘é€</button>
    </div>
  </div>

<script>
  // âš ï¸ æ”¹æˆä½ è‡ªå·±çš„ Worker åŸŸåï¼ˆä¸è¦åŠ  /api/chatï¼‰
  window.API_BASE = 'https://throbbing-lab-1440.hello5xliving.workers.dev';
</script>
  
<script>
(function(){
  'use strict';

  /* ========================= i18n æ–‡æ¡ˆï¼ˆä¿ç•™ UI æ–‡æ¡ˆï¼‰ ========================= */
  const I18N = {
    'zh-CN':{
      page_title:'æœ¬å‘½æ˜Ÿç›˜è§£æ',
      lang_label:'è¯­è¨€',

      label_name:'å§“åï¼ˆå¯é€‰ï¼‰',
      ph_name:'ä½ çš„ç§°å‘¼ï¼ˆç”¨äºä¸ªæ€§åŒ–ï¼‰',
      gender_label:'æ€§åˆ«',
      opt_gender_confidential:'ä¸é€éœ²',
      opt_gender_male:'ç”·æ€§',
      opt_gender_female:'å¥³æ€§',
      label_place:'å‡ºç”Ÿåœ°ç‚¹ ï¼ˆå¿…å¡«ï¼‰',
      label_birthdate:'å‡ºç”Ÿæ—¥æœŸ',
      label_birthtime:'å‡ºç”Ÿæ—¶é—´',
      btn_generate:'ç”Ÿæˆæ˜Ÿç›˜',
      chart_title:'ä½ çš„æœ¬å‘½æŠ¥å‘Š',

      section_overview:'æ¦‚è§ˆ',
      section_sun:'å¤ªé˜³æ˜Ÿåº§',
      section_energy:'èƒ½é‡æç¤º',
      section_action:'æœ¬å‘¨å¯æ‰§è¡Œæ¸…å•',

      vip_title:'ğŸŒ™ ä¼šå‘˜åŒºåŸŸ VIP Segment',
      vip_mingli:'ğŸ— å‘½ç†ç©ºé—´ä¸“å±å†…å®¹',
      vip_love:'å§»ç¼˜æ–¹å‘ï¼šæ‹çˆ±ç¼˜åˆ†ã€å©šå§»èµ°åŠ¿',
      vip_career:'äº‹ä¸šæ–¹å‘ï¼šèŒåœºå‘å±•ã€åˆ›ä¸šæ½œåŠ›',
      vip_wealth:'è´¢è¿æ–¹å‘ï¼šè´¢ä½åˆ†æã€ç†è´¢æ—¶æœº',
      vip_pet:'å® ç‰©å‘½ç†ï¼šä¼´ä¾£åŠ¨ç‰©çš„æ€§æ ¼ä¸ç¼˜åˆ†',
      vip_hepan:'åˆç›˜åˆ†æï¼šå©šæœŸæ‹©æ—¥ã€æ–°ç”Ÿæ‹©æ—¶',
      vip_name:'æµ‹ååˆ†æï¼šå…¬å¸åã€å®å®åã€å‘½åæ”¹è¿',
      vip_fengshui:'è´¢ä½åˆç›˜ï¼šä½å®¶ / åŠå…¬å®¤åŠ¨çº¿é…åˆ',

      vip_xinlian:'ğŸŒ™ å¿ƒæ€œç©ºé—´ä¸“å±å†…å®¹',
      vip_record:'çµæ€§è®°å½•ï¼šç…§ç‰‡ã€æ¢¦å¢ƒã€å£°éŸ³ã€æ„¿æœ›ç¥ˆç¥·',
      vip_course:'å‘½ç†è¯¾ç¨‹ï¼šå…«å­— / å¡”ç½— / å æ˜Ÿ / çµæ•° / äººç±»å›¾',
      vip_memorial:'å®¶æ—çºªå¿µç³»ç»Ÿï¼šäº²äººçµæ€§çºªå¿µ & å»¶ç»­',
      vip_tasks:'æ¯å‘¨èƒ½é‡ç»ƒä¹  / ç¥æ˜ä»ªå¼ä»»åŠ¡',
      vip_shop:'èƒ½é‡å•†åŸä¸“å±æŠ˜æ‰£ & å¾¡å®ˆè®¢åˆ¶',

      login_title:'ğŸ’ ç™»å…¥ VIP åŠŸèƒ½',
      panel_login_head:'è´¦æˆ·ç™»å½• / æ³¨å†Œ',
      ph_email:'é‚®ç®± Email',
      ph_label_password:'å¯†ç  Password',
      ph_password:'å¯†ç  Passwordï¼ˆè‡³å°‘8ä½ï¼Œå«å¤§å°å†™æ•°å­—ç¬¦å·ï¼‰',
      btn_login:'ç™»å…¥è´¦æˆ·',
      btn_reset:'ğŸ”‘ é‡è®¾å¯†ç ',
      btn_register:'æ³¨å†Œè´¦æˆ·',
      note_price:'æ³¨å†Œè´¦å·èµ é€ä¸€æ¬¡å…è´¹ä½“éªŒ',
      panel_member_head:'ä¼šå‘˜æœåŠ¡',
      btn_upgrade:'ğŸ’ å‡çº§ä¸º VIPï¼ˆæœˆè´¹ï¼‰',
      btn_backshop:'â† è¿”å›å‘½ç†å•†åŸ',
      note_price1:'$9.9 / æœˆè´¹ VIPï¼ˆå‘½ç†ç©ºé—´ + å¿ƒæ€œç©ºé—´ + çµæ€§è¯¾ç¨‹ï¼‰',

      alert_fill:'è¯·è¡¥å…¨ã€Œå‡ºç”Ÿæ—¥æœŸã€ä¸ã€Œå‡ºç”Ÿåœ°ç‚¹ã€ã€‚',
      disclaimer:'ï¼Šå½“å‰ä»…ç¤ºæ„å¤ªé˜³æ˜Ÿåº§ï¼›å®Œæ•´å‘½ç›˜éœ€ä½¿ç”¨å‡ºç”Ÿåœ°ä¸ç²¾ç¡®æ—¶åˆ»è®¡ç®—ã€‚',
      // action_1/2/3 å¯ä»¥ç•™ç€ï¼Œä½†æˆ‘ä»¬ä¸å†ç”¨å®ƒä»¬ä½œä¸ºæŠ¥å‘Šå†…å®¹
      action_1:'ä»Šå¤©ä¸ºè‡ªå·±é¢„ç•™ 25 åˆ†é’Ÿå®‰é™æ—¶é—´ï¼Œå›é¡¾è¿™ä¸€å¹´çš„æˆé•¿ã€‚',
      action_2:'å†™ä¸‹ 3 ä»¶ä½ æƒ³åœ¨æ¥ä¸‹æ¥ 30 å¤©é€æ­¥æ¨è¿›çš„å°ç›®æ ‡ã€‚',
      action_3:'æŒ‘ä¸€ä½é‡è¦çš„äººï¼Œå‘ä¸€å¥çœŸè¯šçš„æ„Ÿè°¢æˆ–é—®å€™ã€‚',

      sun_label:'ä½ çš„å¤ªé˜³æ˜Ÿåº§ï¼š'
    },

    'zh-TW':{
      page_title:'æœ¬å‘½æ˜Ÿç›¤è§£æ',
      lang_label:'èªè¨€',
      label_name:'å§“åï¼ˆé¸å¡«ï¼‰',
      ph_name:'ä½ çš„ç¨±å‘¼ï¼ˆç”¨æ–¼å€‹äººåŒ–ï¼‰',
      gender_label:'æ€§åˆ¥',
      opt_gender_confidential:'ä¸é€éœ²',
      opt_gender_male:'ç”·æ€§',
      opt_gender_female:'å¥³æ€§',
      label_place:'å‡ºç”Ÿåœ°é»ï¼ˆå¿…å¡«ï¼‰',
      label_birthdate:'å‡ºç”Ÿæ—¥æœŸ',
      label_birthtime:'å‡ºç”Ÿæ™‚é–“',
      btn_generate:'ç”Ÿæˆæ˜Ÿç›¤',
      chart_title:'ä½ çš„æœ¬å‘½å ±å‘Š',

      section_overview:'ç¸½è¦½',
      section_sun:'å¤ªé™½æ˜Ÿåº§',
      section_energy:'èƒ½é‡æç¤º',
      section_action:'æœ¬é€±å¯è¡Œå‹•æ¸…å–®',

      vip_title:'ğŸŒ™ æœƒå“¡å€åŸŸ VIP Segment',
      vip_mingli:'ğŸ— å‘½ç†ç©ºé–“å°ˆå±¬å…§å®¹',
      vip_love:'å§»ç·£æ–¹å‘ï¼šæˆ€æ„›ç·£åˆ†ã€å©šå§»èµ°å‹¢',
      vip_career:'äº‹æ¥­æ–¹å‘ï¼šè·å ´ç™¼å±•ã€å‰µæ¥­æ½›åŠ›',
      vip_wealth:'è²¡é‹æ–¹å‘ï¼šè²¡ä½åˆ†æã€ç†è²¡æ™‚æ©Ÿ',
      vip_pet:'å¯µç‰©å‘½ç†ï¼šä¼´ä¾¶å‹•ç‰©çš„æ€§æ ¼èˆ‡ç·£åˆ†',
      vip_hepan:'åˆç›¤åˆ†æï¼šå©šæœŸæ“‡æ—¥ã€æ–°ç”Ÿæ“‡æ™‚',
      vip_name:'æ¸¬ååˆ†æï¼šå…¬å¸åã€å¯¶å¯¶åã€æ”¹åé–‹é‹',
      vip_fengshui:'è²¡ä½åˆç›¤ï¼šä½å®¶ / è¾¦å…¬å®¤å‹•ç·šæ­é…',

      vip_xinlian:'ğŸŒ™ å¿ƒæ†ç©ºé–“å°ˆå±¬å…§å®¹',
      vip_record:'éˆæ€§ç´€éŒ„ï¼šç…§ç‰‡ã€å¤¢å¢ƒã€è²éŸ³ã€é¡˜æœ›ç¥ˆç¦±',
      vip_course:'å‘½ç†èª²ç¨‹ï¼šå…«å­— / å¡”ç¾… / å æ˜Ÿ / éˆæ•¸ / äººé¡åœ–',
      vip_memorial:'å®¶æ—ç´€å¿µç³»çµ±ï¼šè¦ªäººéˆæ€§ç´€å¿µèˆ‡å»¶çºŒ',
      vip_tasks:'æ¯é€±èƒ½é‡ç·´ç¿’ / ç¥æ˜å„€å¼ä»»å‹™',
      vip_shop:'èƒ½é‡å•†åŸå°ˆå±¬æŠ˜æ‰£èˆ‡å¾¡å®ˆè¨‚è£½',

      login_title:'ğŸ’ ç™»å…¥ VIP åŠŸèƒ½',
      panel_login_head:'å¸³è™Ÿç™»å…¥ / è¨»å†Š',
      ph_email:'ä¿¡ç®± Email',
      ph_label_password:'å¯†ç¢¼ Password',
      ph_password:'å¯†ç¢¼ Passwordï¼ˆè‡³å°‘ 8 ç¢¼ï¼Œå«å¤§å°å¯«èˆ‡æ•¸å­—ç¬¦è™Ÿï¼‰',
      btn_login:'ç™»å…¥å¸³è™Ÿ',
      btn_reset:'ğŸ”‘ é‡è¨­å¯†ç¢¼',
      btn_register:'è¨»å†Šå¸³è™Ÿ',
      note_price:'è¨»å†Šå¸³è™Ÿè´ˆé€ä¸€æ¬¡å…è²»é«”é©—',
      panel_member_head:'æœƒå“¡æœå‹™',
      btn_upgrade:'ğŸ’ å‡ç´šç‚º VIPï¼ˆæœˆè²»ï¼‰',
      btn_backshop:'â† è¿”å›å‘½ç†å•†åŸ',
      note_price1:'$9.9 / æœˆè²» VIPï¼ˆå‘½ç†ç©ºé–“ + å¿ƒæ†ç©ºé–“ + éˆæ€§èª²ç¨‹ï¼‰',

      alert_fill:'è«‹å…ˆå¡«å¯«ã€Œå‡ºç”Ÿæ—¥æœŸã€èˆ‡ã€Œå‡ºç”Ÿåœ°é»ã€ã€‚',
      disclaimer:'ï¼Šç›®å‰åƒ…é¡¯ç¤ºå¤ªé™½æ˜Ÿåº§ç¤ºæ„ï¼›å®Œæ•´å‘½ç›¤éœ€æ­é…å‡ºç”Ÿåœ°èˆ‡ç²¾ç¢ºæ™‚é–“è¨ˆç®—ã€‚',
      action_1:'ä»Šå¤©é ç•™ 25 åˆ†é˜å®‰éœæ™‚é–“ï¼Œå›é¡§é€™ä¸€å¹´çš„æˆé•·ã€‚',
      action_2:'å¯«ä¸‹ 3 ä»¶ä½ æƒ³åœ¨æ¥ä¸‹ä¾† 30 å¤©é€æ­¥å®Œæˆçš„å°ç›®æ¨™ã€‚',
      action_3:'æŒ‘ä¸€ä½é‡è¦çš„äººï¼Œå‚³ä¸€å¥çœŸèª çš„æ„Ÿè¬æˆ–å•å€™ã€‚',

      sun_label:'ä½ çš„å¤ªé™½æ˜Ÿåº§ï¼š'
    },

    'en':{
      page_title:'Natal Chart Reading',
      lang_label:'Language',
      label_name:'Name (optional)',
      ph_name:'Your name (for personalization)',
      gender_label:'Gender',
      opt_gender_confidential:'Prefer not to say',
      opt_gender_male:'Male',
      opt_gender_female:'Female',
      label_place:'Birth place (required)',
      label_birthdate:'Date of birth',
      label_birthtime:'Time of birth',
      btn_generate:'Generate chart',
      chart_title:'Your natal report',

      section_overview:'Overview',
      section_sun:'Sun sign',
      section_energy:'Energy notes',
      section_action:'Action checklist',

      vip_title:'ğŸŒ™ VIP Area',
      vip_mingli:'ğŸ— Destiny Space Â· Members only',
      vip_love:'Love & marriage: patterns and timing',
      vip_career:'Career: development & entrepreneurship potential',
      vip_wealth:'Wealth: money flow & timing',
      vip_pet:'Pets: soul companions & bonding',
      vip_hepan:'Synastry: relationship & newborn timing',
      vip_name:'Naming: business / baby / rename for luck',
      vip_fengshui:'Wealth + feng shui: home / office flow',

      vip_xinlian:'ğŸŒ™ Xinlian Space Â· Members only',
      vip_record:'Soul records: photos, dreams, voice notes, wishes',
      vip_course:'Courses: Bazi / Tarot / Astrology / Numerology / Human Design',
      vip_memorial:'Family memorial: honoring loved ones',
      vip_tasks:'Weekly practices / ritual tasks',
      vip_shop:'Energy shop discounts & custom charms',

      login_title:'ğŸ’ VIP Login',
      panel_login_head:'Account login / Sign up',
      ph_email:'Email',
      ph_label_password:'Password',
      ph_password:'Password (min 8 chars, mixed case & symbols)',
      btn_login:'Log in',
      btn_reset:'ğŸ”‘ Reset password',
      btn_register:'Create account',
      note_price:'Sign up to receive one free reading credit',
      panel_member_head:'Membership',
      btn_upgrade:'ğŸ’ Upgrade to VIP (monthly)',
      btn_backshop:'â† Back to metaphysics shop',
      note_price1:'$9.9 / month VIP (Destiny Space + Xinlian Space + courses)',

      alert_fill:'Please fill in both "date of birth" and "birth place".',
      disclaimer:'*Currently shows Sun sign only; a full chart needs exact birth place and precise time.',
      action_1:'Block 25 minutes of quiet time today to reflect on your past year.',
      action_2:'Write down 3 small goals you want to move in the next 30 days.',
      action_3:'Send one genuine thank-you or check-in message to someone important.',

      sun_label:'Your Sun sign:'
    },

    'ja':{
      page_title:'æœ¬å‘½ãƒãƒ£ãƒ¼ãƒˆé‘‘å®š',
      lang_label:'è¨€èª',
      label_name:'ãŠåå‰ï¼ˆä»»æ„ï¼‰',
      ph_name:'è¡¨ç¤ºç”¨ã®ãŠåå‰',
      gender_label:'æ€§åˆ¥',
      opt_gender_confidential:'å›ç­”ã—ãªã„',
      opt_gender_male:'ç”·æ€§',
      opt_gender_female:'å¥³æ€§',
      label_place:'å‡ºç”Ÿåœ°ï¼ˆå¿…é ˆï¼‰',
      label_birthdate:'ç”Ÿå¹´æœˆæ—¥',
      label_birthtime:'å‡ºç”Ÿæ™‚åˆ»',
      btn_generate:'ãƒãƒ£ãƒ¼ãƒˆã‚’ä½œæˆ',
      chart_title:'ã‚ãªãŸã®æœ¬å‘½ãƒ¬ãƒãƒ¼ãƒˆ',

      section_overview:'æ¦‚è¦',
      section_sun:'å¤ªé™½æ˜Ÿåº§',
      section_energy:'ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ¡ãƒ¢',
      section_action:'ä»Šé€±ã®è¡Œå‹•ãƒªã‚¹ãƒˆ',

      vip_title:'ğŸŒ™ ä¼šå“¡ã‚¨ãƒªã‚¢ VIP Segment',
      vip_mingli:'ğŸ— å‘½ç†ã‚¹ãƒšãƒ¼ã‚¹ä¼šå“¡å°‚ç”¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„',
      vip_love:'æ‹æ„›ãƒ»çµå©šã®æµã‚Œã¨ã‚¿ã‚¤ãƒŸãƒ³ã‚°',
      vip_career:'ä»•äº‹ãƒ»ã‚­ãƒ£ãƒªã‚¢ãƒ»èµ·æ¥­ã®å¯èƒ½æ€§',
      vip_wealth:'ãŠé‡‘ã®æµã‚Œã¨ãƒãƒ£ãƒ³ã‚¹',
      vip_pet:'ãƒšãƒƒãƒˆã¨ã®ç¸ã¨æ€§æ ¼',
      vip_hepan:'ç›¸æ€§ãƒ»çµå©šæ—¥ãƒ»å‡ºç”£ã‚¿ã‚¤ãƒŸãƒ³ã‚°',
      vip_name:'ä¼šç¤¾åãƒ»å‘½åãƒ»æ”¹åã®é‘‘å®š',
      vip_fengshui:'ä½å±… / ã‚ªãƒ•ã‚£ã‚¹å‹•ç·šã¨è²¡ä½',

      vip_xinlian:'ğŸŒ™ å¿ƒæ†ã‚¹ãƒšãƒ¼ã‚¹ä¼šå“¡å°‚ç”¨',
      vip_record:'å†™çœŸãƒ»å¤¢ãƒ»éŸ³å£°ãƒ»é¡˜ã„ã”ã¨ã®è¨˜éŒ²',
      vip_course:'å‘½ç†è¬›åº§ï¼šå››æŸ±æ¨å‘½ / ã‚¿ãƒ­ãƒƒãƒˆ / å æ˜Ÿè¡“ ãªã©',
      vip_memorial:'å®¶æ—ãƒ¡ãƒ¢ãƒªã‚¢ãƒ«ãƒ»å…ˆç¥–ä¾›é¤Š',
      vip_tasks:'æ¯é€±ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ¯ãƒ¼ã‚¯ / å„€å¼ã‚¿ã‚¹ã‚¯',
      vip_shop:'ã‚¨ãƒŠã‚¸ãƒ¼ã‚°ãƒƒã‚ºå‰²å¼•ãƒ»ãŠå®ˆã‚Š',

      login_title:'ğŸ’ VIP ãƒ­ã‚°ã‚¤ãƒ³',
      panel_login_head:'ãƒ­ã‚°ã‚¤ãƒ³ / æ–°è¦ç™»éŒ²',
      ph_email:'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹',
      ph_label_password:'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰',
      ph_password:'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆ8æ–‡å­—ä»¥ä¸Šãƒ»è‹±æ•°è¨˜å·ï¼‰',
      btn_login:'ãƒ­ã‚°ã‚¤ãƒ³',
      btn_reset:'ğŸ”‘ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å†è¨­å®š',
      btn_register:'ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç™»éŒ²',
      note_price:'ç™»éŒ²ã§ç„¡æ–™ã‚»ãƒƒã‚·ãƒ§ãƒ³ 1 å›åˆ†ã‚’ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆ',
      panel_member_head:'ä¼šå“¡ã‚µãƒ¼ãƒ“ã‚¹',
      btn_upgrade:'ğŸ’ VIPï¼ˆæœˆé¡ï¼‰ã«ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰',
      btn_backshop:'â† ã‚·ãƒ§ãƒƒãƒ—ã«æˆ»ã‚‹',
      note_price1:'æœˆé¡ $9.9ï¼ˆå‘½ç†ã‚¹ãƒšãƒ¼ã‚¹ + å¿ƒæ†ã‚¹ãƒšãƒ¼ã‚¹ + è¬›åº§ï¼‰',

      alert_fill:'ã€Œç”Ÿå¹´æœˆæ—¥ã€ã¨ã€Œå‡ºç”Ÿåœ°ã€ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚',
      disclaimer:'ï¼Šç¾åœ¨ã¯å¤ªé™½æ˜Ÿåº§ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ã¿è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚æ­£ç¢ºãªé‘‘å®šã«ã¯å‡ºç”Ÿåœ°ã¨æ­£ç¢ºãªæ™‚åˆ»ãŒå¿…è¦ã§ã™ã€‚',
      action_1:'ä»Šæ—¥ã¯ 25 åˆ†ã ã‘é™ã‹ãªæ™‚é–“ã‚’ã¨ã‚Šã€ã“ã®ä¸€å¹´ã‚’ãµã‚Šè¿”ã£ã¦ã¿ã¾ã—ã‚‡ã†ã€‚',
      action_2:'ä»Šå¾Œ 30 æ—¥ã§å°‘ã—ãšã¤é€²ã‚ãŸã„å°ã•ãªç›®æ¨™ã‚’ 3 ã¤æ›¸ãå‡ºã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚',
      action_3:'å¤§åˆ‡ãªäººã«ã€æ„Ÿè¬ã‚„è¿‘æ³ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ 1 é€šé€ã£ã¦ã¿ã¾ã—ã‚‡ã†ã€‚',

      sun_label:'ã‚ãªãŸã®å¤ªé™½æ˜Ÿåº§ï¼š'
    },

    'th':{
      page_title:'à¸”à¸§à¸‡à¸à¸³à¹€à¸™à¸´à¸” Â· Natal Chart',
      lang_label:'à¸ à¸²à¸©à¸²',
      label_name:'à¸Šà¸·à¹ˆà¸­ (à¹„à¸¡à¹ˆà¸šà¸±à¸‡à¸„à¸±à¸š)',
      ph_name:'à¸Šà¸·à¹ˆà¸­à¸ªà¸³à¸«à¸£à¸±à¸šà¹ƒà¸Šà¹‰à¹ƒà¸™à¸£à¸²à¸¢à¸‡à¸²à¸™',
      gender_label:'à¹€à¸à¸¨',
      opt_gender_confidential:'à¹„à¸¡à¹ˆà¸£à¸°à¸šà¸¸',
      opt_gender_male:'à¸Šà¸²à¸¢',
      opt_gender_female:'à¸«à¸à¸´à¸‡',
      label_place:'à¸ªà¸–à¸²à¸™à¸—à¸µà¹ˆà¹€à¸à¸´à¸” (à¸ˆà¸³à¹€à¸›à¹‡à¸™)',
      label_birthdate:'à¸§à¸±à¸™à¹€à¸à¸´à¸”',
      label_birthtime:'à¹€à¸§à¸¥à¸²à¹€à¸à¸´à¸”',
      btn_generate:'à¸ªà¸£à¹‰à¸²à¸‡à¸”à¸§à¸‡à¸à¸³à¹€à¸™à¸´à¸”',
      chart_title:'à¸£à¸²à¸¢à¸‡à¸²à¸™à¸”à¸§à¸‡à¸à¸³à¹€à¸™à¸´à¸”à¸‚à¸­à¸‡à¸„à¸¸à¸“',

      section_overview:'à¸ à¸²à¸à¸£à¸§à¸¡',
      section_sun:'à¸£à¸²à¸¨à¸µà¸­à¸²à¸—à¸´à¸•à¸¢à¹Œ',
      section_energy:'à¸à¸¥à¸±à¸‡à¸‡à¸²à¸™à¸›à¸£à¸°à¸ˆà¸³à¸•à¸±à¸§',
      section_action:'à¹€à¸Šà¹‡à¸à¸¥à¸´à¸ªà¸•à¹Œà¸à¸²à¸£à¸¥à¸‡à¸¡à¸·à¸­à¸—à¸³',

      vip_title:'ğŸŒ™ à¸à¸·à¹‰à¸™à¸—à¸µà¹ˆà¸ªà¸¡à¸²à¸Šà¸´à¸ VIP',
      vip_mingli:'ğŸ— à¹€à¸™à¸·à¹‰à¸­à¸«à¸²à¸à¸´à¹€à¸¨à¸©à¸”à¹‰à¸²à¸™à¹‚à¸«à¸£à¸²à¸¨à¸²à¸ªà¸•à¸£à¹Œ',
      vip_love:'à¸„à¸§à¸²à¸¡à¸£à¸±à¸à¹à¸¥à¸°à¸à¸²à¸£à¹à¸•à¹ˆà¸‡à¸‡à¸²à¸™',
      vip_career:'à¸à¸²à¸£à¸‡à¸²à¸™à¹à¸¥à¸°à¸¨à¸±à¸à¸¢à¸ à¸²à¸à¹ƒà¸™à¸à¸²à¸£à¸ªà¸£à¹‰à¸²à¸‡à¸˜à¸¸à¸£à¸à¸´à¸ˆ',
      vip_wealth:'à¸à¸²à¸£à¹€à¸‡à¸´à¸™à¹à¸¥à¸°à¸ˆà¸±à¸‡à¸«à¸§à¸°à¹‚à¸­à¸à¸²à¸ª',
      vip_pet:'à¸”à¸§à¸‡à¸ªà¸±à¸•à¸§à¹Œà¹€à¸¥à¸µà¹‰à¸¢à¸‡à¹à¸¥à¸°à¸ªà¸²à¸¢à¸ªà¸±à¸¡à¸à¸±à¸™à¸˜à¹Œ',
      vip_hepan:'à¸”à¸§à¸‡à¸„à¸¹à¹ˆ / à¸§à¸±à¸™à¹à¸•à¹ˆà¸‡à¸‡à¸²à¸™ / à¹€à¸§à¸¥à¸²à¹€à¸à¸´à¸”à¸šà¸¸à¸•à¸£',
      vip_name:'à¸•à¸±à¹‰à¸‡à¸Šà¸·à¹ˆà¸­à¸šà¸£à¸´à¸©à¸±à¸— / à¹€à¸”à¹‡à¸ / à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸Šà¸·à¹ˆà¸­',
      vip_fengshui:'à¸®à¸§à¸‡à¸ˆà¸¸à¹‰à¸¢à¸šà¹‰à¸²à¸™à¹à¸¥à¸°à¸—à¸µà¹ˆà¸—à¸³à¸‡à¸²à¸™à¹€à¸à¸µà¹ˆà¸¢à¸§à¸à¸±à¸šà¹‚à¸Šà¸„à¸¥à¸²à¸ ',

      vip_xinlian:'ğŸŒ™ à¸à¸·à¹‰à¸™à¸—à¸µà¹ˆà¸ˆà¸´à¸•à¸§à¸´à¸à¸à¸²à¸“ Xinlian',
      vip_record:'à¸šà¸±à¸™à¸—à¸¶à¸à¸£à¸¹à¸› à¸„à¸§à¸²à¸¡à¸à¸±à¸™ à¹€à¸ªà¸µà¸¢à¸‡ à¹à¸¥à¸°à¸„à¸³à¸­à¸˜à¸´à¸©à¸à¸²à¸™',
      vip_course:'à¸„à¸­à¸£à¹Œà¸ª: à¸”à¸§à¸‡à¸ˆà¸µà¸™, à¹à¸—à¹‚à¸£à¸•à¹Œ, à¹‚à¸«à¸£à¸²à¸¨à¸²à¸ªà¸•à¸£à¹Œ à¸¯à¸¥à¸¯',
      vip_memorial:'à¸à¸·à¹‰à¸™à¸—à¸µà¹ˆà¸£à¸°à¸¥à¸¶à¸à¸–à¸¶à¸‡à¸„à¸™à¸—à¸µà¹ˆà¸¥à¹ˆà¸§à¸‡à¸¥à¸±à¸š',
      vip_tasks:'à¸ à¸²à¸£à¸à¸´à¸ˆà¸à¸¥à¸±à¸‡à¸‡à¸²à¸™à¸›à¸£à¸°à¸ˆà¸³à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œ / à¸à¸´à¸˜à¸µà¸à¸£à¸£à¸¡',
      vip_shop:'à¸ªà¹ˆà¸§à¸™à¸¥à¸”à¸à¸´à¹€à¸¨à¸©à¹à¸¥à¸°à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸£à¸²à¸‡à¹€à¸‰à¸à¸²à¸°à¸ªà¸¡à¸²à¸Šà¸´à¸',

      login_title:'ğŸ’ à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š VIP',
      panel_login_head:'à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š / à¸ªà¸¡à¸±à¸„à¸£à¸ªà¸¡à¸²à¸Šà¸´à¸',
      ph_email:'à¸­à¸µà¹€à¸¡à¸¥',
      ph_label_password:'à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™',
      ph_password:'à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™ (à¸­à¸¢à¹ˆà¸²à¸‡à¸™à¹‰à¸­à¸¢ 8 à¸•à¸±à¸§à¸­à¸±à¸à¸©à¸£)',
      btn_login:'à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š',
      btn_reset:'ğŸ”‘ à¸£à¸µà¹€à¸‹à¹‡à¸•à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™',
      btn_register:'à¸ªà¸¡à¸±à¸„à¸£à¸ªà¸¡à¸²à¸Šà¸´à¸',
      note_price:'à¸ªà¸¡à¸±à¸„à¸£à¹ƒà¸«à¸¡à¹ˆà¸£à¸±à¸šà¸ªà¸´à¸—à¸˜à¸´à¹Œà¸”à¸¹à¸”à¸§à¸‡à¸Ÿà¸£à¸µ 1 à¸„à¸£à¸±à¹‰à¸‡',
      panel_member_head:'à¸šà¸£à¸´à¸à¸²à¸£à¸ªà¸¡à¸²à¸Šà¸´à¸',
      btn_upgrade:'ğŸ’ à¸­à¸±à¸›à¹€à¸à¸£à¸”à¹€à¸›à¹‡à¸™ VIP (à¸£à¸²à¸¢à¹€à¸”à¸·à¸­à¸™)',
      btn_backshop:'â† à¸à¸¥à¸±à¸šà¹„à¸›à¸¢à¸±à¸‡à¸£à¹‰à¸²à¸™à¸„à¹‰à¸²',
      note_price1:'VIP à¸£à¸²à¸¢à¹€à¸”à¸·à¸­à¸™ $9.9 (à¸”à¸§à¸‡ + Xinlian + à¸„à¸­à¸£à¹Œà¸ª)',

      alert_fill:'à¸à¸£à¸¸à¸“à¸²à¸à¸£à¸­à¸à¸—à¸±à¹‰à¸‡ "à¸§à¸±à¸™à¹€à¸à¸´à¸”" à¹à¸¥à¸° "à¸ªà¸–à¸²à¸™à¸—à¸µà¹ˆà¹€à¸à¸´à¸”"',
      disclaimer:'*à¸‚à¸“à¸°à¸™à¸µà¹‰à¹à¸ªà¸”à¸‡à¹€à¸à¸µà¸¢à¸‡à¸£à¸²à¸¨à¸µà¸­à¸²à¸—à¸´à¸•à¸¢à¹Œ à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¸„à¸£à¹ˆà¸²à¸§ à¹† à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™ à¸”à¸§à¸‡à¹€à¸•à¹‡à¸¡à¸•à¹‰à¸­à¸‡à¹ƒà¸Šà¹‰à¸ªà¸–à¸²à¸™à¸—à¸µà¹ˆà¹à¸¥à¸°à¹€à¸§à¸¥à¸²à¹€à¸à¸´à¸”à¸—à¸µà¹ˆà¹à¸¡à¹ˆà¸™à¸¢à¸³',
      action_1:'à¸à¸±à¸™à¹€à¸§à¸¥à¸²à¹€à¸‡à¸µà¸¢à¸š à¹† 25 à¸™à¸²à¸—à¸µà¸§à¸±à¸™à¸™à¸µà¹‰à¹€à¸à¸·à¹ˆà¸­à¸—à¸šà¸—à¸§à¸™à¸›à¸µà¸—à¸µà¹ˆà¸œà¹ˆà¸²à¸™à¸¡à¸²',
      action_2:'à¹€à¸‚à¸µà¸¢à¸™à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢à¹€à¸¥à¹‡à¸ à¹† 3 à¸‚à¹‰à¸­à¸—à¸µà¹ˆà¸­à¸¢à¸²à¸à¸‚à¸¢à¸±à¸šà¸ à¸²à¸¢à¹ƒà¸™ 30 à¸§à¸±à¸™',
      action_3:'à¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸‚à¸­à¸šà¸„à¸¸à¸“à¸«à¸£à¸·à¸­à¸—à¸±à¸à¸—à¸²à¸¢à¸ˆà¸£à¸´à¸‡à¹ƒà¸ˆà¹ƒà¸«à¹‰à¹ƒà¸„à¸£à¸ªà¸±à¸à¸„à¸™à¸«à¸™à¸¶à¹ˆà¸‡',

      sun_label:'à¸£à¸²à¸¨à¸µà¸­à¸²à¸—à¸´à¸•à¸¢à¹Œà¸‚à¸­à¸‡à¸„à¸¸à¸“à¸„à¸·à¸­:'
    },

    'ms':{
      page_title:'Carta Natal',
      lang_label:'Bahasa',
      label_name:'Nama (pilihan)',
      ph_name:'Nama anda (untuk laporan)',
      gender_label:'Jantina',
      opt_gender_confidential:'Tidak mahu nyatakan',
      opt_gender_male:'Lelaki',
      opt_gender_female:'Perempuan',
      label_place:'Tempat lahir (wajib)',
      label_birthdate:'Tarikh lahir',
      label_birthtime:'Masa lahir',
      btn_generate:'Jana carta',
      chart_title:'Laporan carta natal anda',

      section_overview:'Ringkasan',
      section_sun:'Tanda Matahari',
      section_energy:'Nota tenaga',
      section_action:'Senarai tindakan',

      vip_title:'ğŸŒ™ Ruang Ahli VIP',
      vip_mingli:'ğŸ— Kandungan khas ruang takdir',
      vip_love:'Cinta & perkahwinan: corak dan masa',
      vip_career:'Kerjaya: perkembangan & potensi bisnes',
      vip_wealth:'Wang & peluang kewangan',
      vip_pet:'Haiwan peliharaan & ikatan jiwa',
      vip_hepan:'Synastry: hubungan & masa kelahiran anak',
      vip_name:'Nama syarikat / bayi / tukar nama untuk tuah',
      vip_fengshui:'Feng shui rezeki: rumah / pejabat',

      vip_xinlian:'ğŸŒ™ Ruang Xinlian',
      vip_record:'Rekod jiwa: gambar, mimpi, audio, doa',
      vip_course:'Kursus: Bazi / Tarot / Astrologi / Numerologi / Human Design',
      vip_memorial:'Sistem memorial keluarga',
      vip_tasks:'Latihan tenaga mingguan / tugasan ritual',
      vip_shop:'Diskaun kedai tenaga & azimat khas',

      login_title:'ğŸ’ Log masuk VIP',
      panel_login_head:'Log masuk / Daftar akaun',
      ph_email:'Emel',
      ph_label_password:'Kata laluan',
      ph_password:'Kata laluan (min 8 aksara, campuran)',
      btn_login:'Log masuk',
      btn_reset:'ğŸ”‘ Tetap semula kata laluan',
      btn_register:'Daftar akaun',
      note_price:'Daftar dan dapatkan satu sesi bacaan percuma',
      panel_member_head:'Perkhidmatan ahli',
      btn_upgrade:'ğŸ’ Naik taraf ke VIP (bulanan)',
      btn_backshop:'â† Kembali ke kedai',
      note_price1:'VIP $9.9 / bulan (Ruang Takdir + Xinlian + Kursus)',

      alert_fill:'Sila lengkapkan "tarikh lahir" dan "tempat lahir".',
      disclaimer:'*Buat masa ini hanya menunjukkan tanda Matahari; carta penuh memerlukan tempat dan masa lahir yang tepat.',
      action_1:'Peruntukkan 25 minit waktu tenang hari ini untuk menilai kembali setahun yang lalu.',
      action_2:'Tulis 3 matlamat kecil yang ingin digerakkan dalam 30 hari akan datang.',
      action_3:'Hantar satu mesej terima kasih atau sapaan jujur kepada seseorang yang penting.',

      sun_label:'Tanda Matahari anda:'
    }
  };

  /* ========================= å·¥å…·å‡½æ•° ========================= */
  const gid = id => document.getElementById(id);
  const qs  = (sel, root=document) => root.querySelector(sel);

  function getLang(){
    const sel = gid('langSelect');
    return sel?.value || 'zh-CN';
  }

  function t(key){
    const lang = getLang();
    return (I18N[lang] && I18N[lang][key]) || (I18N['zh-CN'][key] || key);
  }

  function esc(s){
    return String(s ?? '')
      .replace(/&/g,'&amp;')
      .replace(/</g,'&lt;')
      .replace(/>/g,'&gt;');
  }

  function applyI18n(){
    const lang = getLang();
    document.documentElement.lang = lang;

    document.querySelectorAll('[data-i18n]').forEach(el=>{
      const key = el.getAttribute('data-i18n');
      const val = t(key);
      if(val != null) el.textContent = val;
    });

    document.querySelectorAll('[data-i18n-ph]').forEach(el=>{
      const key = el.getAttribute('data-i18n-ph');
      const val = t(key);
      if(val != null) el.setAttribute('placeholder', val);
    });

    const baseTitle = '5XLiving';
    document.title = t('page_title') + ' | ' + baseTitle;
  }

  /* ========================= å¤´éƒ¨æ—¶é’Ÿ ========================= */
  function startNowClock(){
    const box = gid('nowBox');
    if(!box) return;
    const pad = n => (n<10 ? '0'+n : ''+n);
    function tick(){
      const now = new Date();
      const y = now.getFullYear();
      const m = pad(now.getMonth()+1);
      const d = pad(now.getDate());
      const hh = pad(now.getHours());
      const mm = pad(now.getMinutes());
      const ss = pad(now.getSeconds());
      box.textContent = `${y}-${m}-${d} ${hh}:${mm}:${ss} SGT`;
    }
    tick();
    setInterval(tick, 1000);
  }

  /* ========================= æ˜Ÿåº§ & å…ƒç´ ï¼ˆä¿ç•™ï¼‰ ========================= */
  const SIGN_LIST = [
    { key:'Aries',       start:[3,21], end:[4,19],  el:'fire',
      name:{'zh-CN':'ç™½ç¾Šåº§','zh-TW':'ç‰¡ç¾Šåº§','en':'Aries','ja':'ç‰¡ç¾Šåº§','th':'à¹€à¸¡à¸©','ms':'Aries'} },
    { key:'Taurus',      start:[4,20], end:[5,20],  el:'earth',
      name:{'zh-CN':'é‡‘ç‰›åº§','zh-TW':'é‡‘ç‰›åº§','en':'Taurus','ja':'ç‰¡ç‰›åº§','th':'à¸à¸¤à¸©à¸ ','ms':'Taurus'} },
    { key:'Gemini',      start:[5,21], end:[6,21],  el:'air',
      name:{'zh-CN':'åŒå­åº§','zh-TW':'é›™å­åº§','en':'Gemini','ja':'åŒå­åº§','th':'à¹€à¸¡à¸–à¸¸à¸™','ms':'Gemini'} },
    { key:'Cancer',      start:[6,22], end:[7,22],  el:'water',
      name:{'zh-CN':'å·¨èŸ¹åº§','zh-TW':'å·¨èŸ¹åº§','en':'Cancer','ja':'èŸ¹åº§','th':'à¸à¸£à¸à¸','ms':'Cancer'} },
    { key:'Leo',         start:[7,23], end:[8,22],  el:'fire',
      name:{'zh-CN':'ç‹®å­åº§','zh-TW':'ç…å­åº§','en':'Leo','ja':'ç…å­åº§','th':'à¸ªà¸´à¸‡à¸«à¹Œ','ms':'Leo'} },
    { key:'Virgo',       start:[8,23], end:[9,22],  el:'earth',
      name:{'zh-CN':'å¤„å¥³åº§','zh-TW':'è™•å¥³åº§','en':'Virgo','ja':'ä¹™å¥³åº§','th':'à¸à¸±à¸™à¸¢à¹Œ','ms':'Virgo'} },
    { key:'Libra',       start:[9,23], end:[10,23], el:'air',
      name:{'zh-CN':'å¤©ç§¤åº§','zh-TW':'å¤©ç§¤åº§','en':'Libra','ja':'å¤©ç§¤åº§','th':'à¸•à¸¸à¸¥','ms':'Libra'} },
    { key:'Scorpio',     start:[10,24],end:[11,22], el:'water',
      name:{'zh-CN':'å¤©èåº§','zh-TW':'å¤©è åº§','en':'Scorpio','ja':'è åº§','th':'à¸à¸´à¸ˆà¸´à¸','ms':'Scorpio'} },
    { key:'Sagittarius', start:[11,23],end:[12,21], el:'fire',
      name:{'zh-CN':'å°„æ‰‹åº§','zh-TW':'å°„æ‰‹åº§','en':'Sagittarius','ja':'å°„æ‰‹åº§','th':'à¸˜à¸™à¸¹','ms':'Sagittarius'} },
    { key:'Capricorn',   start:[12,22],end:[1,19],  el:'earth',
      name:{'zh-CN':'æ‘©ç¾¯åº§','zh-TW':'é­”ç¾¯åº§','en':'Capricorn','ja':'å±±ç¾Šåº§','th':'à¸¡à¸±à¸‡à¸à¸£','ms':'Capricorn'} },
    { key:'Aquarius',    start:[1,20], end:[2,18],  el:'air',
      name:{'zh-CN':'æ°´ç“¶åº§','zh-TW':'æ°´ç“¶åº§','en':'Aquarius','ja':'æ°´ç“¶åº§','th':'à¸à¸¸à¸¡à¸ à¹Œ','ms':'Aquarius'} },
    { key:'Pisces',      start:[2,19], end:[3,20],  el:'water',
      name:{'zh-CN':'åŒé±¼åº§','zh-TW':'é›™é­šåº§','en':'Pisces','ja':'é­šåº§','th':'à¸¡à¸µà¸™','ms':'Pisces'} }
  ];

  function inRange(m,d,[sm,sd],[em,ed]){
    if (sm < em || (sm === em && sd <= ed)) {
      return (m > sm || (m === sm && d >= sd)) &&
             (m < em || (m === em && d <= ed));
    } else {
      return (m > sm || (m === sm && d >= sd)) ||
             (m < em || (m === em && d <= ed));
    }
  }

  function getSunSign(dateStr){
    const dt = new Date(dateStr);
    if (Number.isNaN(dt.getTime())) return SIGN_LIST[11];
    const m = dt.getMonth() + 1;
    const d = dt.getDate();
    return SIGN_LIST.find(s => inRange(m,d,s.start,s.end)) || SIGN_LIST[11];
  }

  /* ========================= section æ ‡é¢˜ï¼ˆä¾›å‰ç«¯ + AI å…±ç”¨ï¼‰ ========================= */
  function getSectionTitles(lang){
    return {
      persona:
        lang === 'en' ? 'Personality Portrait' :
        lang === 'ja' ? 'æ€§æ ¼ç”»åƒ' :
        lang === 'th' ? 'à¸ à¸²à¸à¸£à¸§à¸¡à¸šà¸¸à¸„à¸¥à¸´à¸' :
        lang === 'ms' ? 'Potret keperibadian' :
        'æ€§æ ¼ç”»åƒ',
      relation:
        lang === 'en' ? 'Relationships & Communication' :
        lang === 'ja' ? 'äººé–“é–¢ä¿‚ã¨ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³' :
        lang === 'th' ? 'à¸„à¸§à¸²à¸¡à¸ªà¸±à¸¡à¸à¸±à¸™à¸˜à¹Œà¹à¸¥à¸°à¸à¸²à¸£à¸ªà¸·à¹ˆà¸­à¸ªà¸²à¸£' :
        lang === 'ms' ? 'Hubungan & komunikasi' :
        'å…³ç³»ä¸æ²Ÿé€š',
      career:
        lang === 'en' ? 'Career & Wealth Direction' :
        lang === 'ja' ? 'ä»•äº‹ã¨è±Šã‹ã•ã®æ–¹å‘æ€§' :
        lang === 'th' ? 'à¸—à¸´à¸¨à¸—à¸²à¸‡à¸‡à¸²à¸™à¹à¸¥à¸°à¸—à¸£à¸±à¸à¸¢à¹Œ' :
        lang === 'ms' ? 'Arah kerjaya & kewangan' :
        'äº‹ä¸šä¸è´¢å¯Œèµ°å‘',
      energy: t('section_energy'),
      action: t('section_action')
    };
  }

  /* ========================= è¡¨å• & æŠ¥å‘Š ========================= */
  let lastModel = null;

  function readForm(){
    const name  = (gid('name')?.value || '').trim();
    const place = (gid('place')?.value || '').trim();
    const date  = gid('birthdate')?.value || '';
    const time  = gid('birthtime')?.value || '';
    const gender = gid('gender')?.value || 'u';
    return { name, place, date, time, gender };
  }

  function renderHeaderSummary(model){
    const box = gid('chartSummary');
    if(!box) return;
    const namePart = model.name ? (model.name + ' Â· ') : '';
    const timePart = model.time || '';
    const placePart = model.place ? (' @ ' + model.place) : '';
    box.textContent = `${namePart}${model.date} ${timePart}${placePart}`;
  }

  function getApiBase(){
    const raw = (typeof window.API_BASE === 'string' && window.API_BASE.trim())
      ? window.API_BASE.trim()
      : '';
    if (!raw) {
      console.warn('[natal] API_BASE not configured. Set window.API_BASE before this script.');
      return '';
    }
    return raw.replace(/\/+$/,'');
  }

  async function loadNatalSections(model, sign){
    const lang = getLang();
    const base = getApiBase();
    const titles = getSectionTitles(lang);

    const secSunExtra = gid('secSunExtra');
    const secPersona  = gid('secPersona');
    const secRelation = gid('secRelation');
    const secCareer   = gid('secCareer');
    const secEnergy   = gid('secEnergy');
    const secAction   = gid('secAction');

    const errMsg = (
      lang === 'en' ? 'Connection seems unstable, please try again later.' :
      lang === 'ja' ? 'æ¥ç¶šãŒä¸å®‰å®šãªã‚ˆã†ã§ã™ã€‚å°‘ã—æ™‚é–“ã‚’ãŠã„ã¦å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚' :
      lang === 'th' ? 'à¸à¸²à¸£à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­à¸‚à¸±à¸”à¸‚à¹‰à¸­à¸‡ à¸¥à¸­à¸‡à¹ƒà¸«à¸¡à¹ˆà¸­à¸µà¸à¸„à¸£à¸±à¹‰à¸‡à¸ à¸²à¸¢à¸«à¸¥à¸±à¸‡à¸™à¸°à¸„à¸°' :
      lang === 'ms' ? 'Sambungan tidak stabil, sila cuba lagi kemudian.' :
      'ç›®å‰è¿çº¿æœ‰ç‚¹ä¸ç¨³å®šï¼Œä½ å¯ä»¥ç¨åå†è¯•ä¸€æ¬¡ã€‚'
    );

    if (!base) {
      const msg = (
        lang === 'en'
          ? 'System not fully configured (API_BASE missing).'
          : 'ç³»ç»Ÿå°šæœªå®Œæˆé…ç½®ï¼ˆç¼ºå°‘ API_BASEï¼‰ã€‚'
      );
      if (secPersona)  secPersona.innerHTML  = `<h3>${esc(titles.persona)}</h3><p class="muted">${esc(msg)}</p>`;
      if (secRelation) secRelation.innerHTML = `<h3>${esc(titles.relation)}</h3><p class="muted">${esc(msg)}</p>`;
      if (secCareer)   secCareer.innerHTML   = `<h3>${esc(titles.career)}</h3><p class="muted">${esc(msg)}</p>`;
      if (secEnergy)   secEnergy.innerHTML   = `<h3>${esc(titles.energy)}</h3><p class="muted">${esc(msg)}</p>`;
      if (secAction)   secAction.innerHTML   = `<h3>${esc(titles.action)}</h3><p class="muted">${esc(msg)}</p>`;
      return;
    }

    try{
      const payload = {
        user: model.name || 'natal_guest',
        prompt: JSON.stringify({
          type:  'natal-main',
          lang,
          meta:{
            name:   model.name || '',
            date:   model.date,
            time:   model.time || '',
            place:  model.place || '',
            gender: model.gender || 'u',
            signKey:    sign.key,
            signCn:     sign.name['zh-CN'] || sign.key,
            signEn:     sign.name['en'] || sign.key,
            element:    sign.el
          }
        })
      };

      console.log('[natal] calling worker', base + '/api/chat');
      const res = await fetch(base + '/api/chat', {
        method:'POST',
        headers:{ 'Content-Type':'application/json' },
        body: JSON.stringify(payload)
      });

      console.log('[natal] worker status', res.status);
      if (!res.ok) throw new Error('bad_status_' + res.status);

      const data = await res.json();
      console.log('[natal] worker payload', data);

      const sections = (data && data.sections) || {};
      const sunText      = sections.sun || '';
      const personaText  = sections.persona  || errMsg;
      const relationText = sections.relation || errMsg;
      const careerText   = sections.career   || errMsg;
      const energyText   = sections.energy   || '';
      const actions      = sections.actions;

      if (secSunExtra && sunText){
        secSunExtra.innerHTML = esc(sunText).replace(/\n/g,'<br>');
      }

      if (secPersona){
        secPersona.innerHTML =
          `<h3>${esc(titles.persona)}</h3><p>${esc(personaText).replace(/\n/g,'<br>')}</p>`;
      }
      if (secRelation){
        secRelation.innerHTML =
          `<h3>${esc(titles.relation)}</h3><p>${esc(relationText).replace(/\n/g,'<br>')}</p>`;
      }
      if (secCareer){
        secCareer.innerHTML =
          `<h3>${esc(titles.career)}</h3><p>${esc(careerText).replace(/\n/g,'<br>')}</p>`;
      }
      if (secEnergy){
        const body = energyText
          ? `<p>${esc(energyText).replace(/\n/g,'<br>')}</p>`
          : `<p class="muted">${esc(errMsg)}</p>`;
        secEnergy.innerHTML = `<h3>${esc(titles.energy)}</h3>${body}`;
      }

      if (secAction){
        let listHtml = '';
        if (Array.isArray(actions) && actions.length){
          listHtml = '<ul>' +
            actions.map(a => `<li>${esc(a)}</li>`).join('') +
            '</ul>';
        } else if (typeof actions === 'string' && actions.trim()){
          listHtml = `<p>${esc(actions).replace(/\n/g,'<br>')}</p>`;
        } else {
          listHtml = `<p class="muted">${esc(errMsg)}</p>`;
        }
        secAction.innerHTML = `<h3>${esc(titles.action)}</h3>${listHtml}`;
      }

    }catch(e){
      console.error('[natal] worker error:', e);
      if (secPersona)  secPersona.innerHTML  = `<h3>${esc(titles.persona)}</h3><p class="muted">${esc(errMsg)}</p>`;
      if (secRelation) secRelation.innerHTML = `<h3>${esc(titles.relation)}</h3><p class="muted">${esc(errMsg)}</p>`;
      if (secCareer)   secCareer.innerHTML   = `<h3>${esc(titles.career)}</h3><p class="muted">${esc(errMsg)}</p>`;
      if (secEnergy)   secEnergy.innerHTML   = `<h3>${esc(titles.energy)}</h3><p class="muted">${esc(errMsg)}</p>`;
      if (secAction)   secAction.innerHTML   = `<h3>${esc(titles.action)}</h3><p class="muted">${esc(errMsg)}</p>`;
    }
  }

  function renderReport(model){
    const result = gid('result');
    const wrap   = gid('chartReport');
    if(!wrap || !result) return;

    const lang = getLang();
    const sign = getSunSign(model.date);
    const L = key => t(key);

    // å­˜ç»™ Butler ç”¨
    const meta = {
      name:   model.name || '',
      date:   model.date,
      time:   model.time || '',
      place:  model.place || '',
      gender: model.gender || 'u',
      signKey: sign.key,
      signCn:  sign.name['zh-CN'] || sign.key,
      signEn:  sign.name['en']   || sign.key,
      element: sign.el
    };
    model.meta = meta;
    window.lastModel = model;
    lastModel = model;

    const overviewTitle = esc(L('section_overview'));
    const sunTitle      = esc(L('section_sun'));
    const energyTitle   = esc(L('section_energy'));
    const actionTitle   = esc(L('section_action'));
    const sunLabel      = esc(L('sun_label'));
    const disclaimer    = esc(L('disclaimer'));
    const signNameCn    = esc(sign.name['zh-CN'] || sign.key);

    const genderMap = {
      'zh-CN':{m:'ç”·æ€§',f:'å¥³æ€§',u:'â€”'},
      'zh-TW':{m:'ç”·æ€§',f:'å¥³æ€§',u:'â€”'},
      'en':   {m:'Male',f:'Female',u:'â€”'},
      'ja':   {m:'ç”·æ€§',f:'å¥³æ€§',u:'â€”'},
      'th':   {m:'à¸Šà¸²à¸¢',f:'à¸«à¸à¸´à¸‡',u:'â€”'},
      'ms':   {m:'Lelaki',f:'Perempuan',u:'â€”'}
    };
    const gPack = genderMap[lang] || genderMap['zh-CN'];
    const genderLabel = gPack[model.gender] || gPack.u;

    const titles = getSectionTitles(lang);
    const loadingText = (
      lang === 'en' ? 'Loading AI readingâ€¦' :
      lang === 'ja' ? 'AI ãƒªãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’èª­ã¿è¾¼ã¿ä¸­â€¦' :
      lang === 'th' ? 'à¸à¸³à¸¥à¸±à¸‡à¹‚à¸«à¸¥à¸”à¸„à¸³à¸—à¸³à¸™à¸²à¸¢à¸ˆà¸²à¸ AIâ€¦' :
      lang === 'ms' ? 'Memuat bacaan AIâ€¦' :
      'æ­£åœ¨è½½å…¥ AI è§£è¯»â€¦'
    );

    const overviewHtml = `
      <div class="sec">
        <h3>${overviewTitle}</h3>
        <p>${esc(model.name || '')}${model.name ? ' Â· ' : ''}${esc(model.date)} ${esc(model.time || '')}${model.place ? (' @ ' + esc(model.place)) : ''}</p>
        <p class="muted" style="opacity:.8">${disclaimer}</p>
      </div>`;

    const sunHtml = `
      <div class="sec">
        <h3>${sunTitle}</h3>
        <p>${sunLabel} <b>${signNameCn}</b></p>
        <p class="muted">${genderLabel !== 'â€”' ? ('Gender / æ€§åˆ«ï¼š' + esc(genderLabel)) : ''}</p>
        <div id="secSunExtra" class="muted" style="margin-top:6px;"></div>
      </div>`;

    const personaHtml = `
      <div class="sec" id="secPersona">
        <h3>${esc(titles.persona)}</h3>
        <p class="muted">${esc(loadingText)}</p>
      </div>`;

    const relationHtml = `
      <div class="sec" id="secRelation">
        <h3>${esc(titles.relation)}</h3>
        <p class="muted">${esc(loadingText)}</p>
      </div>`;

    const careerHtml = `
      <div class="sec" id="secCareer">
        <h3>${esc(titles.career)}</h3>
        <p class="muted">${esc(loadingText)}</p>
      </div>`;

    const energyHtml = `
      <div class="sec" id="secEnergy">
        <h3>${energyTitle}</h3>
        <p class="muted">${esc(loadingText)}</p>
      </div>`;

    const actionHtml = `
      <div class="sec" id="secAction">
        <h3>${actionTitle}</h3>
        <p class="muted">${esc(loadingText)}</p>
      </div>`;

    wrap.innerHTML =
      overviewHtml +
      sunHtml +
      personaHtml +
      relationHtml +
      careerHtml +
      energyHtml +
      actionHtml;

    result.style.display = 'block';

    // ğŸ”® è¿™é‡ŒçœŸæ­£ä¸¢ç»™ AI æ¸²æŸ“
    loadNatalSections(model, sign);
  }

  /* ========================= å¿ƒæ€œç®¡å®¶ Â· èŠå¤©æµ®çª—ï¼ˆä¿ç•™ï¼Œåªæ”¹ç”¨ metaï¼‰ ========================= */
  function initButlerChat(){
    const fab    = gid('ssChatFab');
    const panel  = gid('ssChatPanel');
    const close  = gid('ssChatClose');
    const input  = gid('ssChatInput');
    const send   = gid('ssChatSend');
    const body   = gid('ssChatBody');

    if (!fab || !panel || !input || !send || !body) return;

    function showPanel(){
      panel.style.display = 'block';
      fab.style.display = 'grid';
      input.focus();
    }
    function hidePanel(){
      panel.style.display = 'none';
      fab.style.display = 'grid';
    }

    fab.addEventListener('click', showPanel);
    close.addEventListener('click', hidePanel);

    function appendMsg(text, isMe){
      const div = document.createElement('div');
      div.className = 'ss-msg' + (isMe ? ' me' : '');
      div.innerHTML = esc(text).replace(/\n/g, '<br>');
      body.appendChild(div);
      body.scrollTop = body.scrollHeight;
    }

    async function handleSend(){
      const text = input.value.trim();
      if (!text) return;

      appendMsg(text, true);
      input.value = '';

      const thinking = document.createElement('div');
      thinking.className = 'ss-msg';
      thinking.textContent = 'â€¦thinking';
      body.appendChild(thinking);
      body.scrollTop = body.scrollHeight;

      try {
        const ctx  = (window.lastModel && window.lastModel.meta) || {};
        const lang = getLang();
        const payload = {
          user: ctx.name || 'natal_guest',
          prompt: JSON.stringify({
            type: 'natal-butler',
            lang,
            sign: ctx.signKey || ctx.sunSign || null,
            meta: ctx,
            question: text
          })
        };

        const base = getApiBase();
        if (!base) throw new Error('no_api_base');

        const res = await fetch(base + '/api/chat', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });

        let reply = (
          lang === 'en'
            ? 'Connection seems unstable, please try again later.'
            : 'ç›®å‰è¿çº¿æœ‰ç‚¹ä¸ç¨³å®šï¼Œä½ å¯ä»¥ç¨åå†è¯•ä¸€æ¬¡ã€‚'
        );

        if (res.ok) {
          const data = await res.json();
          if (data && data.reply) reply = data.reply;
        }

        if (thinking.parentNode) body.removeChild(thinking);
        appendMsg(reply, false);

      } catch (e) {
        console.error('[butler] error', e);
        if (thinking.parentNode) body.removeChild(thinking);
        const msg = (
          getLang() === 'en'
            ? 'Connection seems unstable, please try again later.'
            : 'ç›®å‰è¿çº¿æœ‰ç‚¹ä¸ç¨³å®šï¼Œä½ å¯ä»¥ç¨åå†è¯•ä¸€æ¬¡ã€‚'
        );
        appendMsg(msg, false);
      }
    }

    send.addEventListener('click', handleSend);
    input.addEventListener('keydown', e => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        handleSend();
      }
    });
  }

  /* ========================= è¡¨å•æäº¤å¤„ç† ========================= */
  function handleGenerate(evt){
    if (evt && evt.preventDefault) evt.preventDefault();

    const model = readForm();
    if (!model.date || !model.place) {
      alert(t('alert_fill'));
      return;
    }

    lastModel = model;
    window.lastModel = model;

    renderHeaderSummary(model);
    renderReport(model);
  }

  /* ========================= åˆå§‹åŒ– ========================= */
  document.addEventListener('DOMContentLoaded', ()=>{
    const langSel = gid('langSelect');
    if(langSel){
      const saved = localStorage.getItem('natal_lang');
      if(saved && Array.from(langSel.options).some(o=>o.value===saved)){
        langSel.value = saved;
      }
      langSel.addEventListener('change', ()=>{
        localStorage.setItem('natal_lang', langSel.value);
        applyI18n();
        if(lastModel){
          renderHeaderSummary(lastModel);
          renderReport(lastModel);
        }
      });
    }

    applyI18n();
    startNowClock();

    const dateInput = gid('birthdate');
    const timeInput = gid('birthtime');
    const now = new Date();
    const pad = n => (n<10 ? '0'+n : ''+n);
    if(dateInput && !dateInput.value){
      dateInput.value = now.toISOString().split('T')[0];
    }
    if(timeInput && !timeInput.value){
      const hh = pad(now.getHours());
      const mm = pad(now.getMinutes());
      timeInput.value = `${hh}:${mm}`;
    }

    const form = gid('chartForm');
    if(form){
      form.addEventListener('submit', handleGenerate);
    }

    initButlerChat();
  });
})();
</script>
</body>
</html>
























