<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8" />
<title>å¡”ç½—ç‰Œå åœ Â· Tarot</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600&family=Inter:wght@400;600&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0b0f14; --card:#11161dcc; --line:#1f2a36; --text:#e8edf3; --muted:#98a7b7;
  --brand:#d4af37; --gold:#d4af37; --gold2:#f2d27a; --accent:#58b9ff;
  --radius:14px; --shadow:0 8px 30px rgba(0,0,0,.35);
  --card-w:128px; --card-h:212px; --gap:14px;
}
@media (max-width:640px){
  :root{ --card-w:100px; --card-h:168px; --gap:10px; }
}

html,body{height:100%}
body{
  margin:0; color:var(--text);
  background: radial-gradient(1200px 600px at 70% -10%, #16202b 10%, transparent 60%) no-repeat,
              linear-gradient(180deg,#0b0f14,#0b0f14);
  font-family: Inter,system-ui,-apple-system,"Noto Sans SC","Segoe UI",Roboto,Arial,sans-serif;
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  overflow-x: hidden;
}
body::before{
  content:"";
  position:fixed;
  inset:0;
  z-index:-2;
  background: linear-gradient(rgba(11, 15, 20, 0.85), rgba(11, 15, 20, 0.9)), 
              radial-gradient(circle at 20% 80%, rgba(212, 175, 55, 0.1) 0%, transparent 50%),
              radial-gradient(circle at 80% 20%, rgba(88, 185, 255, 0.05) 0%, transparent 50%);
}

/* å…¨å±€å®¹å™¨ï¼ˆå†…å®¹åŒºï¼‰ */
.container{
  max-width:1100px;
  margin:0 auto;
  padding:24px 16px 80px;
}

/* â€”â€” å¤´éƒ¨ï¼ˆç»Ÿä¸€æ ·å¼ï¼‰ â€”â€” */
.site-header{
  position:sticky;
  top:0;
  z-index:10;
  background:#0b0f14cc;
  border-bottom:1px solid #0f1622;
  backdrop-filter:saturate(140%) blur(12px);
  transition: all 0.3s ease;
}
.site-header.scrolled{
  background: rgba(11, 15, 20, 0.95);
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
}
.head-inner{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:14px;
  padding:14px 16px;
}

.brand{
  display:flex; align-items:center; gap:10px;
  text-decoration:none; color:var(--text);
}
.brand-badge{
  display:inline-grid; place-items:center;
  width:34px; height:34px; border-radius:8px;
  background:linear-gradient(180deg,#0e1520,#0b1018);
  border:1px solid #2a3546;
  box-shadow:0 4px 14px rgba(0,0,0,.35);
  font-weight:800; color:#ffe084;
  transition: all 0.3s ease;
}
.brand:hover .brand-badge{
  transform: rotate(15deg);
  box-shadow: 0 6px 20px rgba(212, 175, 55, 0.3);
}
.title{
  font-family:"Noto Serif SC","Noto Serif",serif !important;
  font-weight:600 !important;
  letter-spacing:.02em;
  font-size:1.1rem !important;
  line-height:1.25;
}
.brand:hover .title{ color: var(--gold); }

.lang{
  display:flex; align-items:center; gap:8px;
}
.lang label{
  white-space:nowrap; color:var(--muted); margin-right:4px;
}
.lang select{
  appearance:none; 
  min-width:170px; 
  border-radius:10px; 
  border:1px solid #243244; 
  background:#0e1520; 
  color:var(--text); 
  padding:10px 34px 10px 12px; 
  font-size:.95rem; 
  background-image:url("data:image/svg+xml,%3Csvg width='12' height='8' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%2398a7b7' stroke-width='2' fill='none'/%3E%3C/svg%3E"); 
  background-repeat:no-repeat; 
  background-position:calc(100% - 12px) 50%;
  transition: all 0.3s ease;
}
.lang select:focus{
  outline:none;
  border-color: var(--gold);
  box-shadow:0 0 0 2px rgba(212,175,55,.2);
}
@media (max-width:520px){
  .title{font-size:1rem}
  .lang select{min-width:140px}
}

/* ===== Tarot ä¸»ä½“å®¹å™¨ï¼šç”¨â€œå¡ç‰‡ + containerâ€ç»„åˆ ===== */
.app{
  position:relative;
  max-width:1100px;
  margin:0 auto;
  padding:24px 16px 40px;
  box-sizing:border-box;
}
.app::before{
  content:"";
  position:absolute;
  inset:0;
  border-radius:var(--radius);
  background:#11161dcc;
  border:1px solid #1f2a36;
  box-shadow:var(--shadow);
  z-index:-1;
}

/* æ ‡é¢˜ç»Ÿä¸€é£æ ¼ï¼ˆåŒ energyï¼‰ */
.h1{
  margin:12px 0 6px;
  color:#ffe084;
  font-weight:800;
  font-size:1.8rem;
  text-align:center;
}
.h2{
  font-weight:800;
  color:#ffe084;
  margin:0 0 10px;
}
.sub{color:var(--muted); text-align:center;}

/* é€šç”¨å¡ç‰‡ä¸å¸ƒå±€ï¼ˆåŒ energyï¼‰ */
.card{
  background:#11161dcc;
  border:1px solid #1f2a36;
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  backdrop-filter:blur(10px);
  padding:18px;
  margin:16px 0;
}
.row{
  display:grid;
  gap:12px;
  grid-template-columns:1fr;
}
@media(min-width:760px){
  .row.cols-2{grid-template-columns:1fr 1fr}
  .row.cols-3{grid-template-columns:1fr 1fr 1fr}
}
label.muted{
  display:block;
  margin-bottom:4px;
  color:#98a7b7;
}
input,select,textarea{
  width:100%;
  box-sizing:border-box;
  border-radius:12px;
  border:1px solid #243244;
  background:#0e1520;
  color:#e8edf3;
  padding:12px;
  font-size:15px;
  outline:none;
}
textarea{min-height:96px}
input::placeholder,textarea::placeholder{color:#6f8092}

/* æŒ‰é’®ç»Ÿä¸€é£æ ¼ */
.btn{
  display:inline-grid;
  place-items:center;
  padding:12px 16px;
  border-radius:12px;
  border:1px solid #e6c76e;
  background:linear-gradient(180deg,#fff9e6,#e6c76e);
  color:#191919;
  font-weight:800;
  cursor:pointer;
  text-decoration:none;
  font-size:15px;
}
.btn.secondary,
.btn.ghost{
  background:#101826;
  color:#ffe084;
  border-color:#3a3f47;
}
.btn[disabled]{opacity:.6;cursor:not-allowed}
.btn.block{
  width:100%;
  text-align:center;
}

.muted{color:#98a7b7}
.error{color:#ff8b8b}

/* ===== Tarot æ§ä»¶åŒº ===== */
.controls{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  margin:16px 0 12px;
  justify-content:center;
  background:#0f141d;
  border-radius:12px;
  border:1px solid #1f2a36;
  padding:10px 12px;
}
.controls input{
  flex:1;
  min-width:220px;
}
.controls input,
.controls select{
  padding:12px;
  background:#0e1520;
  border-color:#243244;
}
.controls button{
  position:relative;
  overflow:hidden;
}
.controls button::before{
  content:"";
  position:absolute;
  top:0;
  left:-100%;
  width:100%;
  height:100%;
  background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);
  transition:all .6s;
}
.controls button:hover::before{left:100%}
.q{
  margin:10px 0 12px;
  font-weight:600;
  color:var(--muted);
  text-align:center;
  min-height:24px;
}

/* æŠ½ç‰Œè¿›åº¦æ¡ */
.progress-bar{
  width:100%;
  max-width:360px;
  height:4px;
  border-radius:999px;
  background:#151a25;
  overflow:hidden;
  margin:0 auto 12px;
}
.progress-fill{
  width:0;
  height:100%;
  background:linear-gradient(90deg,#f2d27a,#e6c76e);
  transition:width .2s ease-out;
}

/* Tarot æŠ½ç‰ŒæŒ‰é’®é‡Œçš„å°åœˆåœˆï¼ˆç”¨ idï¼Œé¿å…å’Œ energy çš„ .loading å†²çªï¼‰ */
#btnLoading{
  display:inline-block;
  width:20px;
  height:20px;
  border:3px solid rgba(255,255,255,.3);
  border-radius:50%;
  border-top-color:var(--gold);
  animation:spin 1s ease-in-out infinite;
}
@keyframes spin{to{transform:rotate(360deg);}}

/* ===== Tarot ç‰Œé˜µæ¿ & ç‰Œé¢ ===== */
.board{
  display:grid;
  gap:var(--gap);
  justify-content:center;
  align-content:start;
  margin:20px 0 4px;
  transition:all .5s ease;
  padding:10px 4px 4px;
}

/* åªå½±å“ç‰Œé˜µé‡Œçš„ cardï¼Œä¸å¹²æ‰°å…¶ä»– .card */
.board .card{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:6px;
  text-align:center;
  background:var(--card);
  border:1px solid var(--line);
  border-radius:var(--radius);
  padding:10px 10px 12px;
  box-shadow:var(--shadow);
  width:calc(var(--card-w) + 20px);
  transition:all .3s ease;
  position:relative;
  overflow:hidden;
}
.board .card::before{
  content:"";
  position:absolute;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:linear-gradient(135deg,rgba(212,175,55,.05) 0%,transparent 50%);
  opacity:0;
  transition:opacity .3s ease;
}
.board .card:hover::before{opacity:1}
.board .card:hover{
  transform:translateY(-5px);
  border-color:rgba(212,175,55,.5);
  box-shadow:0 12px 30px rgba(0,0,0,.5);
}
.board .imgwrap{
  width:var(--card-w);
  height:var(--card-h);
  border-radius:10px;
  overflow:hidden;
  background:#000;
  display:grid;
  place-items:center;
  border:1px solid #34455a;
  transition:all .3s ease;
}
.board .card:hover .imgwrap{border-color:var(--gold);}
.board .card-img{
  display:block;
  width:100%;
  height:100%;
  object-fit:cover;
  transition:all .5s ease;
}
.board .card:hover .card-img{transform:scale(1.05);}
.board .cap{font-weight:700}
.board .mean{font-size:.92rem;color:var(--muted)}

/* ç‰Œé˜µå¸ƒå±€ */
.board.spread-1{grid-template-columns:repeat(1,max-content)}
.board.spread-3{grid-template-columns:repeat(3,max-content)}
.board.spread-5{
  display:grid;
  grid-template-columns:repeat(3,max-content);
  grid-template-rows:auto auto auto;
  grid-template-areas:
    "top top top"
    "left center right"
    "bottom bottom bottom";
  gap:20px;
}
.board.spread-5 .pos-top{grid-area:top}
.board.spread-5 .pos-left{grid-area:left}
.board.spread-5 .pos-center{grid-area:center}
.board.spread-5 .pos-right{grid-area:right}
.board.spread-5 .pos-bottom{grid-area:bottom}

.board.spread-10{gap:var(--gap)}
.board.spread-10 .row{
  display:grid;
  gap:var(--gap);
  justify-content:center;
}
.board.spread-10 .row-1{grid-template-columns:repeat(3,max-content)}
.board.spread-10 .row-2{grid-template-columns:repeat(3,max-content)}
.board.spread-10 .row-3{grid-template-columns:repeat(4,max-content)}

.card-drawn{
  animation:drawCard .5s ease forwards;
}
@keyframes drawCard{
  0%{transform:translateY(-20px) rotate(-5deg);opacity:0;}
  100%{transform:translateY(0) rotate(0);opacity:1;}
}

/* Tooltip å…³æ‰ */
.tooltip{display:none}

/* è§£è¯»é¢æ¿ï¼ˆæ²¿ç”¨ energy å¡ç‰‡é£æ ¼ï¼‰ */
.panel{
  margin-top:16px;
  padding:18px;
  border:1px solid var(--line);
  background:#0f1420;
  border-radius:12px;
  box-shadow:var(--shadow);
}
.panel:hover{
  border-color:rgba(212,175,55,.3);
}

/* ===== VIP åŒºåŸŸï¼ˆæ²¿ç”¨ç»Ÿä¸€å¡ç‰‡ + gridï¼‰ ===== */
.card.section{
  width:100%;
  max-width:1100px;
  margin:26px auto 48px;
  padding:18px 16px 20px;
  box-sizing:border-box;
}
.card.section .group-title{
  font-weight:800;
  color:#ffe084;
  margin:0 0 8px;
}
.card.section .columns{
  display:grid;
  grid-template-columns:repeat(2,minmax(0,1fr));
  gap:16px;
  margin-top:12px;
}
.card.section .list-block{
  border-radius:12px;
  border:1px solid #1f2a36;
  background:#0f141d;
  padding:14px 16px;
}
.card.section .list-block ul{
  list-style:none;
  margin:6px 0 0;
  padding:0;
}
.card.section .list-block li{
  margin:.25rem 0;
  font-size:.95rem;
  color:var(--muted);
  line-height:1.6;
}

/* VIP æŒ‰é’®å®½åº¦ & å±…ä¸­ */
.card.section .btn.block{
  width:100%;
  max-width:360px;
  margin:8px auto 0;
}
.card.section .btn.ghost.block{
  max-width:360px;
  margin:8px auto 10px;
}

/* VIP æ ‡é¢˜è¡Œ */
.group-title{
  max-width:1100px;
  margin:28px auto 10px;
  padding:0 16px;
  box-sizing:border-box;
  font-weight:800;
  color:#ffe084;
  font-size:1.05rem;
}

/* VIP ç™»å½•åŒºä¸»ä½“ */
.astro-auth{
  max-width:1100px;
  margin:0 auto 40px;
  padding:0 16px;
  box-sizing:border-box;
}
.astro-auth .auth-grid{
  display:grid;
  grid-template-columns:repeat(2,minmax(0,1fr));
  gap:16px;
}
.astro-auth .panel{
  background:#11161dcc;
  border-radius:14px;
  border:1px solid #1f2a36;
  box-shadow:0 8px 30px rgba(0,0,0,.35);
  padding:16px 18px 18px;
}
.astro-auth .panel .head{
  font-size:0.95rem;
  font-weight:800;
  color:#ffe084;
  padding-bottom:8px;
  margin-bottom:10px;
  border-bottom:1px solid #1f2a36;
}
.astro-auth .panel .body{
  display:flex;
  flex-direction:column;
  gap:12px;
}
.astro-auth .panel .row.one{
  display:flex;
  flex-direction:column;
  gap:10px;
}
.astro-auth input[type="email"],
.astro-auth input[type="password"]{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:1px solid #243244;
  background:#0e1520;
  color:#e8edf3;
  font-size:15px;
  box-sizing:border-box;
}
.astro-auth input[type="email"]::placeholder,
.astro-auth input[type="password"]::placeholder{
  color:#6f8092;
}
.astro-auth input[type="email"]:focus,
.astro-auth input[type="password"]:focus{
  outline:none;
  border-color:#d4af37;
  box-shadow:0 0 0 2px rgba(212,175,55,.2);
}
.astro-auth .btn.block{
  display:inline-block;
  width:100%;
  max-width:100%;      /* kill the 360px limit from .card.section .btn.block */
  margin-left:0;
  margin-right:0;      /* remove the "auto" centering */
  padding:11px 16px;
  border-radius:999px;
  text-align:center;
  font-weight:800;
  border:1px solid #e6c76e;
  background:linear-gradient(180deg,#fff9e6,#e6c76e);
  color:#191919;
  box-shadow:0 6px 20px rgba(230,199,110,.35);
}
.astro-auth .btn.block:hover{
  transform:translateY(-1px);
  box-shadow:0 10px 24px rgba(230,199,110,.45);
}
.astro-auth .btn.ghost.block{
  background:transparent;
  border-color:#273245;
  color:#e8edf3;
  box-shadow:none;
}
.astro-auth .btn.ghost.block:hover{
  border-color:#d4af37;
  background:rgba(212,175,55,.08);
}
.error-message{
  color:#ff7b7b;
  font-size:0.85rem;
}
@media (max-width:768px){
  .astro-auth .auth-grid{
    grid-template-columns:1fr;
  }
}

/* ===== æ— éšœç¢ & å·¥å…· ===== */
.sr-only{
  position:absolute!important;
  width:1px;
  height:1px;
  padding:0;
  margin:-1px;
  overflow:hidden;
  clip:rect(0,0,0,0);
  white-space:nowrap;
  border:0;
}
.btn-row{
  display:flex;
  align-items:stretch;
  gap:10px;
  width:100%;
  box-sizing:border-box;
}
.btn-row .btn{
  flex:1 1 0;
  width:auto!important;
  max-width:100%;
  box-sizing:border-box;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
.btn-row .btn-block{
  display:flex;
  width:auto!important;
}

/* ===== Chatï¼ˆå®Œå…¨è·Ÿ energy ä¸€æ ·ï¼‰ ===== */
.ss-chat-fab{
  position:fixed;
  right:18px;
  bottom:18px;
  z-index:50;
  width:56px;
  height:56px;
  border-radius:50%;
  background:linear-gradient(180deg,#fff9e6,#e6c76e);
  color:#191919;
  display:grid;
  place-items:center;
  font-weight:800;
  box-shadow:0 8px 30px rgba(0,0,0,.35);
  cursor:pointer;
  border:1px solid #e6c76e;
}
.ss-chat-panel{
  position:fixed;
  right:18px;
  bottom:88px;
  z-index:50;
  width:min(460px,92vw);
  display:none;
  flex-direction:column;
  background:#0e1520;
  border:1px solid #243244;
  border-radius:14px;
  box-shadow:var(--shadow);
}
.ss-chat-panel[aria-hidden="false"]{
  display:flex;
}
.ss-chat-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:10px 12px;
  border-bottom:1px solid #243244;
}
.ss-chat-title{font-weight:700}
.ss-chat-body{
  max-height:300px;
  overflow:auto;
  padding:10px 12px;
  display:flex;
  flex-direction:column;
  gap:8px;
}
.ss-msg{
  padding:8px 10px;
  background:#0f1624;
  border:1px solid #243244;
  border-radius:10px;
  margin:6px 0;
  max-width:80%;
  font-size:.9rem;
  line-height:1.6;
}
.ss-msg.me{
  margin-left:auto;
  background:#132033;
}
.ss-chat-input{
  display:flex;
  align-items:center;
  gap:8px;
  padding:10px 12px;
  border-top:1px solid #243244;
}
.ss-chat-input input{
  flex:1 1 auto;
  min-width:0;
}

/* AI æ–‡å†…æ ‡é¢˜ä¸åˆ—è¡¨ï¼ˆé¢„ç•™ç»™ä»¥å Tarot AI æ–‡æœ¬ç”¨ï¼‰ */
#aiText, #energyText{
  white-space:normal;
  line-height:1.7;
}
#aiText h3.ai-head, #energyText h3.ai-head{
  color:#ffe084;
  font-weight:800;
  font-size:1.05rem;
  margin:14px 0 8px;
}
#aiText ul, #aiText ol, #energyText ul, #energyText ol{
  margin:.2rem 0 .6rem 1.2rem;
  padding-left:1.1rem;
}
#aiText li, #energyText li{margin:.25rem 0;}
#aiText ol li::marker{font-weight:700;}

/* å°å±å¹•å¸ƒå±€ä¼˜åŒ– */
@media (max-width:768px){
  .board.spread-5{
    grid-template-columns:1fr;
    grid-template-rows:auto;
    grid-template-areas:
      "top"
      "left"
      "center"
      "right"
      "bottom";
    gap:10px;
  }
  .controls{
    flex-direction:column;
  }
  .controls input,
  .controls select,
  .controls button{
    min-width:100%;
  }
}

/* é¡µè„š */
footer{
  color:#6c7b8c;
  font-size:.85rem;
  text-align:center;
  padding:30px 0;
}
</style>
</head>
<body>
  <header class="site-header">
    <div class="head-inner container">
      <a class="brand" href="https://astro.5xliving.com" target="_self" rel="nofollow">
        <span class="brand-badge">5X</span>
        <span class="title">
          <span data-i18n="brand">5xLiving Â· Soul Sanctuary</span>
        </span>
      </a>

      <div class="lang">
        <label for="langSelect" class="muted" data-i18n="lang_label">è¯­è¨€</label>
        <select id="langSelect" aria-label="Language">
          <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
          <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
          <option value="en-US">English</option>
          <option value="ja-JP">æ—¥æœ¬èª</option>
          <option value="th-TH">à¹„à¸—à¸¢</option>
          <option value="ms-MY">Bahasa Melayu</option>
        </select>
      </div>
    </div>
  </header>

  <main>
    <div class="app">
      <h1 class="h1" data-i18n="page_title">å¡”ç½—ç‰Œå åœ</h1>
      
      <div class="controls">
        <input id="question"
               placeholder="è¯·è¾“å…¥ä½ çš„é—®é¢˜ï¼ˆå¿…å¡«ï¼Œå†³å®šè§£è¯»æ–¹å‘ï¼‰"
               data-i18n-placeholder="q_ph" />
        <select id="spread">
          <option value="1" data-i18n="s1">å•å¼ </option>
          <option value="3" data-i18n="s3">ä¸‰å¼ ï¼ˆè¿‡å» / ç°åœ¨ / æœªæ¥ï¼‰</option>
          <option value="5" data-i18n="s5">åå­—æ’æ³•ï¼ˆ5å¼ ï¼‰</option>
          <option value="10" data-i18n="s10">å‡¯å°”ç‰¹åå­—ï¼ˆ10å¼ ï¼‰</option>
        </select>
        <button id="go" data-i18n="draw_btn">
          <span id="btnText">æŠ½ç‰Œ</span>
          <span id="btnLoading" class="loading" style="display:none"></span>
        </button>
      </div>

      <div id="qdisplay" class="q muted" data-i18n="tip_focus">
        ï¼ˆæç¤ºï¼šè¾“å…¥é—®é¢˜ä¼šè®©è§£è¯»æ›´èšç„¦ï¼‰
      </div>
      
      <div class="progress-bar" id="progressBar" style="display:none">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      
      <div id="board" class="board"></div>

      <div id="reading" class="panel" style="display:none">
        <h3 style="margin:0 0 8px;font-weight:800" data-i18n="reading_title">è§£è¯»ä¸å»ºè®®</h3>
        <div id="readingText"></div>
        <div class="panel muted" style="margin-top:12px" data-i18n="disclaimer">
          è¯´æ˜ï¼šå¡”ç½—ä¸ºæŒ‡å¼•å·¥å…·ï¼ŒéåŒ»å­¦/æ³•å¾‹/é‡‘èå»ºè®®ï¼Œè¯·ä»¥ç†æ€§åˆ¤æ–­ä¸è‡ªæˆ‘æ„æ„¿ä¸ºå…ˆã€‚
        </div>
        <div style="margin-top:12px; display:flex; gap:8px; justify-content:flex-end;">
          <button class="btn" id="saveReading">ä¿å­˜è§£è¯»</button>
          <button class="btn ghost" id="shareReading">åˆ†äº«</button>
        </div>
      </div>
    </div>

  <!-- ä¼šå‘˜ä¸“åŒºï¼ˆåŸæ ·ä¿ç•™ï¼‰ -->
  <section class="card section">
    <h2 class="group-title" data-i18n="vip_title">ğŸŒ™ ä¼šå‘˜åŒºåŸŸ VIP Segment</h2>
    <div class="columns">
      <div class="list-block">
        <div class="group-title" data-i18n="vip_mingli">ğŸ— å‘½ç†ç©ºé—´ä¸“å±å†…å®¹</div>
        <ul>
          <li data-i18n="vip_love">å§»ç¼˜æ–¹å‘ï¼šæ‹çˆ±ç¼˜åˆ†ã€å©šå§»èµ°åŠ¿</li>
          <li data-i18n="vip_career">äº‹ä¸šæ–¹å‘ï¼šèŒåœºå‘å±•ã€åˆ›ä¸šæ½œåŠ›</li>
          <li data-i18n="vip_wealth">è´¢è¿æ–¹å‘ï¼šè´¢ä½åˆ†æã€ç†è´¢æ—¶æœº</li>
          <li data-i18n="vip_pet">å® ç‰©å‘½ç†ï¼šä¼´ä¾£åŠ¨ç‰©çš„æ€§æ ¼ä¸ç¼˜åˆ†</li>
          <li data-i18n="vip_hepan">åˆç›˜åˆ†æï¼šå©šæœŸæ‹©æ—¥ã€æ–°ç”Ÿæ‹©æ—¶</li>
          <li data-i18n="vip_name">æµ‹ååˆ†æï¼šå…¬å¸åã€å®å®åã€å‘½åæ”¹è¿</li>
          <li data-i18n="vip_fengshui">è´¢ä½åˆç›˜ï¼šä½å®¶ / åŠå…¬å®¤åŠ¨çº¿é…åˆ</li>
        </ul>
      </div>
      <div class="list-block">
        <div class="group-title" data-i18n="vip_xinlian">ğŸŒ™ å¿ƒæ€œç©ºé—´ä¸“å±å†…å®¹</div>
        <ul>
          <li data-i18n="vip_record">çµæ€§è®°å½•ï¼šç…§ç‰‡ã€æ¢¦å¢ƒã€å£°éŸ³ã€æ„¿æœ›ç¥ˆç¥·</li>
          <li data-i18n="vip_course">å‘½ç†è¯¾ç¨‹ï¼šå…«å­— / å¡”ç½— / å æ˜Ÿ / çµæ•° / äººç±»å›¾</li>
          <li data-i18n="vip_memorial">å®¶æ—çºªå¿µç³»ç»Ÿï¼šäº²äººçµæ€§çºªå¿µ & å»¶ç»­</li>
          <li data-i18n="vip_tasks">æ¯å‘¨èƒ½é‡ç»ƒä¹  / ç¥æ˜ä»ªå¼ä»»åŠ¡</li>
          <li data-i18n="vip_shop">èƒ½é‡å•†åŸä¸“å±æŠ˜æ‰£ & å¾¡å®ˆè®¢åˆ¶</li>
        </ul>
      </div>
    </div>

    <div class="group-title" style="margin-top:14px" data-i18n="login_title">ğŸ’ ç™»å…¥ VIP åŠŸèƒ½</div>

    <section class="astro-auth">
      <div class="auth-grid">
        <!-- å·¦ä¾§ï¼šè¾“å…¥ + æ³¨å†Œ/ç™»å½• -->
        <div class="panel">
          <div class="head" data-i18n="panel_login_head">è´¦æˆ·ç™»å½• / æ³¨å†Œ</div>
          <div class="body">
            <div class="row" id="authFields">
              <label for="email" class="sr-only" data-i18n="ph_email">é‚®ç®± Email</label>
              <input
                id="email"
                name="email"
                type="email"
                inputmode="email"
                autocomplete="username"
                placeholder=""
                data-i18n-ph="ph_email"
                required
              />
              <label for="password" class="sr-only" data-i18n="ph_label_password">å¯†ç  Password</label>
              <input
                id="password"
                name="password"
                type="password"
                autocomplete="current-password"
                placeholder="å¯†ç  Passwordï¼ˆè‡³å°‘8ä½ï¼Œå«å¤§å°å†™æ•°å­—ç¬¦å·ï¼‰"
                data-i18n-ph="ph_password"
                required
              />
            </div>
            <div class="spacer"></div>
            <form id="loginForm" class="row one">
              <button class="btn block" id="loginBtn" type="submit" data-i18n="btn_login">ç™»å…¥è´¦æˆ·</button>
            </form>
            <div class="spacer"></div>
            <div class="row one">
              <button class="btn ghost block" id="resetBtn" type="button" data-i18n="btn_reset">ğŸ”‘ é‡è®¾å¯†ç </button>
            </div>
            <div class="spacer"></div>
            <form class="row one" id="registerForm">
              <button class="btn block" id="registerBtn" type="submit" data-i18n="btn_register">æ³¨å†Œè´¦æˆ·</button>
              <div class="muted" data-i18n="note_price">æ³¨å†Œè´¦å·èµ é€ä¸€æ¬¡å…è´¹ä½“éªŒ</div>
              <div class="spacer"></div>
              <div class="error-message" id="authError" style="display:none"></div>
            </form>
          </div>
        </div>

        <!-- å³ä¾§ï¼šä¼šå‘˜ä¸è¿”å› -->
        <div class="panel">
          <div class="head" data-i18n="panel_member_head">ä¼šå‘˜æœåŠ¡</div>
          <div class="body">
            <div class="row one">
              <a class="btn btn-gold block" href="https://yourshopifyshop.com/products/monthly-vip" target="_blank" rel="noopener noreferrer" data-i18n="btn_upgrade">ğŸ’ å‡çº§ä¸º VIPï¼ˆæœˆè´¹ï¼‰</a>
            </div>
            <div class="spacer"></div>
            <div class="row one">
              <a class="btn ghost block" href="https://yourshopifyshop.myshopify.com" target="_blank" rel="noopener noreferrer" data-i18n="btn_backshop">â† è¿”å›å‘½ç†å•†åŸ</a>
            </div>
            <div class="spacer"></div>
            <div class="muted" data-i18n="note_price1">$9.9 / æœˆè´¹ VIPï¼ˆå‘½ç†ç©ºé—´ + å¿ƒæ€œç©ºé—´ + çµæ€§è¯¾ç¨‹ï¼‰</div>
          </div>
        </div>
      </div>
    </section>
  </section>

  <footer>Â© 5XLiving â€¢ Astro Sanctuary</footer>
</main>
</body>
          
<!-- GPT / å¿ƒæ€œç®¡å®¶ï¼ˆç»Ÿä¸€æµ®çª—ï¼‰ -->
<button class="ss-chat-fab" id="ssChatFab" type="button" aria-label="å¿ƒæ€œç®¡å®¶">
  <span data-i18n="chat_fab">é—®</span>
</button>
<div class="ss-chat-panel" id="chatPanel" aria-hidden="true">
  <div class="ss-chat-head">
    <div class="ss-chat-title" id="chatTitle">å¿ƒæ€œç®¡å®¶ Â· GPT</div>
    <div class="ss-close" id="chatClose">âœ•</div>
  </div>
  <div class="ss-chat-body" id="chatBody">
    <div class="ss-msg">
      <div class="meta">å¿ƒæ€œç®¡å®¶</div>
      ä½ å¥½ï¼æˆ‘æ˜¯ä½ çš„å¡”ç½—è§£è¯»åŠ©æ‰‹ï¼Œå¯ä»¥å¸®ä½ åˆ†æç‰Œé¢å«ä¹‰æˆ–è§£ç­”ç›¸å…³é—®é¢˜ã€‚
    </div>
  </div>
  <div class="ss-chat-input">
    <input id="chatInput" placeholder="è¾“å…¥é—®é¢˜â€¦"/>
    <button class="btn" id="chatSend">å‘é€</button>
  </div>
</div>

<script>
// 1) æŠŠä½ åŸæ¥é‚£æ•´å¨ I18N å¯¹è±¡è´´åœ¨è¿™é‡Œ
//   ï¼ˆå†…å®¹ä¸è¦æ”¹ï¼Œåªæ˜¯æ¬å®¶åˆ°æœ€ä¸Šé¢ï¼‰
const I18N = {
  /* === è¿™é‡Œè´´ä½ åŸæ¥çš„ zh-CN, zh-TW, en-US, ja-JP, th-TH, ms-MY é…ç½® === */
};



document.addEventListener('DOMContentLoaded', function () {
  /* ===== é€šç”¨å°å·¥å…· ===== */
  const FALLBACK = 'zh-CN';
  const $  = s => document.querySelector(s);
  const $$ = s => Array.from(document.querySelectorAll(s));
  const rnd = n => Math.floor(Math.random()*n);

  // th / ms åªæœ‰éƒ¨åˆ†å­—æ®µï¼Œç”¨è‹±æ–‡è¡¥é½
  function withFallback(lang){
    const raw = I18N[lang] || I18N[FALLBACK];
    const base = JSON.parse(JSON.stringify(raw));
    const en = I18N['en-US'];
    ['pos','suits','ranks','majors','tags','domainAdvice'].forEach(k=>{
      if (base[k] == null) base[k] = en[k];
    });
    return base;
  }

  function detectLang(){
    const nav = (navigator.language || '').toLowerCase();
    if (nav.startsWith('zh-tw')) return 'zh-TW';
    if (nav.startsWith('zh'))    return 'zh-CN';
    if (nav.startsWith('ja'))    return 'ja-JP';
    if (nav.startsWith('th'))    return 'th-TH';
    if (nav.startsWith('ms'))    return 'ms-MY';
    if (nav.startsWith('en'))    return 'en-US';
    return FALLBACK;
  }

  // ä½ çš„ select ç”¨ zh-CN / zh-TW / en / ja / th / msï¼Œéœ€è¦åšæ˜ å°„
  const LANG_MAP = {
    'zh-CN':'zh-CN',
    'zh-TW':'zh-TW',
    'en':'en-US',
    'ja':'ja-JP',
    'th':'th-TH',
    'ms':'ms-MY'
  };
  const REVERSE_LANG_MAP = {
    'zh-CN':'zh-CN',
    'zh-TW':'zh-TW',
    'en-US':'en',
    'ja-JP':'ja',
    'th-TH':'th',
    'ms-MY':'ms'
  };

  let CUR = detectLang();

  function t(path, dflt=''){
    const pack = withFallback(CUR);
    const parts = path.split('.');
    let node = pack;
    for (const p of parts){
      if (!node) break;
      node = node[p];
    }
    return node == null ? dflt : node;
  }

  /* ===== é™æ€ UIï¼šæ ‡é¢˜ / å åœæ§ä»¶ / VIP æ–‡æ¡ˆ ===== */
  function applyStaticUI(){
    // å“ç‰Œæ ‡é¢˜
    const titleElement = document.querySelector('.title');
    if (titleElement) {
      const brandText = t('ui.brand','5xLiving Â· Soul Sanctuary');
      const brandSpan = titleElement.querySelector('[data-i18n="brand"]');
      if (brandSpan) brandSpan.textContent = brandText;
      else titleElement.textContent = brandText;
    }

    // è¯­è¨€ label
    const langLabel = document.querySelector('.lang label');
    if (langLabel) langLabel.textContent = t('ui.label_lang','è¯­è¨€');

    // H1 æ ‡é¢˜
    const pageTitle = document.querySelector('[data-i18n="page_title"]');
    if (pageTitle) pageTitle.textContent = t('ui.page_title');

    // æŠ½ç‰ŒæŒ‰é’®æ–‡å­—
    const goBtn = $('#go');
    if (goBtn){
      const btnText = $('#btnText');
      if (btnText) btnText.textContent = t('ui.draw_btn','æŠ½ç‰Œ');
    }

    // æ’é˜µæ–‡æ¡ˆ
    const spread = $('#spread');
    if (spread){
      if (spread.options[0]) spread.options[0].textContent = t('ui.s1');
      if (spread.options[1]) spread.options[1].textContent = t('ui.s3');
      if (spread.options[2]) spread.options[2].textContent = t('ui.s5');
      if (spread.options[3]) spread.options[3].textContent = t('ui.s10');
    }

    // é—®é¢˜ placeholder
    const qInput = $('#question');
    if (qInput){
      qInput.setAttribute('placeholder', t('ui.q_ph'));
    }

    // å…è´£å£°æ˜
    const disc = $('[data-i18n="disclaimer"]');
    if (disc) disc.textContent = t('ui.disclaimer');

    // VIP åŒºå—å„ç§æ–‡æ¡ˆ
    const map = [
      ['login_title','login_title'],
      ['panel_login_head','panel_login_head'],
      ['panel_member_head','panel_member_head'],
      ['btn_login','btn_login'],
      ['btn_reset','btn_reset'],
      ['btn_register','btn_register'],
      ['btn_upgrade','btn_upgrade'],
      ['btn_backshop','btn_backshop'],
      ['note_price','note_price'],
      ['note_price1','note_price1'],
      ['vip_title','vip_title'],
      ['vip_mingli','vip_mingli'],
      ['vip_xinlian','vip_xinlian'],
      ['vip_love','vip_love'],
      ['vip_career','vip_career'],
      ['vip_wealth','vip_wealth'],
      ['vip_pet','vip_pet'],
      ['vip_hepan','vip_hepan'],
      ['vip_name','vip_name'],
      ['vip_fengshui','vip_fengshui'],
      ['vip_record','vip_record'],
      ['vip_course','vip_course'],
      ['vip_memorial','vip_memorial'],
      ['vip_tasks','vip_tasks'],
      ['vip_shop','vip_shop']
    ];
    map.forEach(([key,path])=>{
      const el = document.querySelector(`[data-i18n="${key}"]`);
      if (el) el.innerHTML = t(path);
    });

    const email = $('#email');
    if (email) email.placeholder = t('ph_email');
    const pwd = $('#password');
    if (pwd) pwd.placeholder = t('ph_password');
  }

  /* ===== Tarot ç‰Œåº“ ===== */
  const SUITS  = ['wands','cups','swords','pentacles'];
  const RANKS  = ['ace','2','3','4','5','6','7','8','9','10','page','knight','queen','king'];
  const MAJORS = Array.from({length:22},(_,i)=>i);
  const IMG_BASE = '/img/tarot';

  function buildDeck(){
    const deck = [];
    MAJORS.forEach(i => {
      deck.push({id:`major_${String(i).padStart(2,'0')}`, group:'major', idx:i});
    });
    SUITS.forEach(s=>{
      RANKS.forEach(r=>{
        deck.push({id:`${s}_${r}`,group:'minor',suit:s,rank:r});
      });
    });
    return deck;
  }
  const DECK = buildDeck();

  function draw(n){
    const pool = [...DECK];
    const picks = [];
    for (let i=0;i<n;i++){
      const idx = rnd(pool.length);
      const card = pool.splice(idx,1)[0];
      card.reversed = Math.random() < 0.5;
      picks.push(card);
    }
    return picks;
  }

  function imgFor(card){
    return `${IMG_BASE}/${card.id}.webp`;
  }

  function dataPack(){
    return withFallback(CUR);
  }

  function cardName(card){
    const pack = dataPack();
    if (card.group === 'major'){
      return pack.majors[card.idx][0];
    }
    const s = pack.suits[card.suit];
    const r = pack.ranks[card.rank] || card.rank.toUpperCase();
    return `${s.name}${r}`;
  }

  function previewLine(card){
    const pack = dataPack();
    if (card.group === 'major'){
      const row = pack.majors[card.idx];
      return `${row[1]} Â· ${row[2]}`;
    }
    const s    = pack.suits[card.suit];
    const tone = pack.ranks.tone[card.rank];
    return `${s.name}ï¼ˆ${s.domain}ï¼‰Â· ${tone}`;
  }

  function posLabel(key){
    const pack = dataPack();
    return pack.pos[key] || key;
  }

  function tagFor(rev){
    const pack = dataPack();
    return rev ? pack.tags.reversed : pack.tags.upright;
  }

  function escapeHTML(s){
    return (s||'').replace(/[&<>"']/g, m => ({
      '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'
    }[m]));
  }

  function cardNode(card, cls, posKey, index){
    const div = document.createElement('div');
    div.className = `card ${cls || ''}`;
    div.dataset.cardId = card.id;
    div.dataset.reversed = card.reversed ? 'true':'false';
    div.style.animationDelay = `${index*0.08}s`;
    div.classList.add('card-drawn');

    const wrap = document.createElement('div');
    wrap.className = 'imgwrap';
    if (card.reversed) wrap.style.transform = 'rotate(180deg)';

    const img = document.createElement('img');
    img.className = 'card-img';
    img.src = imgFor(card);
    img.alt = cardName(card);
    img.onerror = () =>{
      img.onerror = null;
      img.src = `${IMG_BASE}/back.webp`;
    };
    wrap.appendChild(img);

    const cap = document.createElement('div');
    cap.className = 'cap';
    cap.textContent = `ã€${posLabel(posKey)}ã€‘${cardName(card)}ï¼ˆ${tagFor(card.reversed)}ï¼‰`;

    const mean = document.createElement('div');
    mean.className = 'mean';
    mean.textContent = previewLine(card);

    div.appendChild(wrap);
    div.appendChild(cap);
    div.appendChild(mean);
    return div;
  }

  const SPREADS = {
    1:{layout:'spread-1',positions:[{key:'single'}]},
    3:{layout:'spread-3',positions:[
      {key:'past'},{key:'present'},{key:'future'}
    ]},
    5:{layout:'spread-5',positions:[
      {key:'top',cls:'pos-top'},
      {key:'left',cls:'pos-left'},
      {key:'center',cls:'pos-center'},
      {key:'right',cls:'pos-right'},
      {key:'bottom',cls:'pos-bottom'}
    ]},
    10:{layout:'spread-10',positions:[
      {key:'p1'},{key:'p2'},{key:'p3'},{key:'p4'},{key:'p5'},
      {key:'p6'},{key:'p7'},{key:'p8'},{key:'p9'},{key:'p10'}
    ]}
  };

  function renderBoard(n, cards){
    const board = $('#board');
    if (!board) return;
    board.className = 'board';
    const conf = SPREADS[n];
    if (!conf){
      board.innerHTML = '';
      return;
    }
    board.classList.add(conf.layout);

    if (n === 10){
      board.innerHTML = `
        <div class="row row-1"></div>
        <div class="row row-2"></div>
        <div class="row row-3"></div>`;
      const rows  = $$('#board .row');
      const slots = [3,3,4];
      let k = 0;
      slots.forEach((count,rowi)=>{
        for (let j=0;j<count;j++){
          const c      = cards[k];
          const posKey = conf.positions[k].key;
          rows[rowi].appendChild(cardNode(c, `c${k+1}`, posKey, k));
          k++;
        }
      });
    }else{
      board.innerHTML = '';
      cards.forEach((c,i)=>{
        const pos = conf.positions[i];
        board.appendChild(cardNode(c, `c${i+1} ${pos.cls||''}`, pos.key, i));
      });
    }
  }

  function renderReading(question, n, cards){
    const pack = dataPack();
    const posKeys =
      n===10 ? ['p1','p2','p3','p4','p5','p6','p7','p8','p9','p10'] :
      n===5  ? ['top','left','center','right','bottom'] :
      n===3  ? ['past','present','future'] :
               ['single'];

    const domAdv = pack.domainAdvice.general;
    const seg = cards.map((card,i)=>{
      const title = `ã€${posLabel(posKeys[i])}ã€‘${cardName(card)}ï¼ˆ${tagFor(card.reversed)}ï¼‰`;
      const arch  = previewLine(card);
      const line  = (card.group === 'major')
        ? (card.reversed ? domAdv.majorRev : domAdv.majorOk)
        : (domAdv[card.suit] || domAdv.majorOk);
      return `
        <div style="margin:8px 0 12px">
          <div style="font-weight:700">${title}</div>
          <div class="muted" style="margin:4px 0">${arch}</div>
          <ul style="margin:6px 0 0 18px">
            <li>${line}</li>
          </ul>
        </div>`;
    }).join('');

    const you  = pack.ui.you || 'You';
    const read = pack.ui.reading || 'Reading';
    const qTxt = question || pack.ui.no_q || '';

    return `
      <div class="chat">
        <div class="msg user">
          <div class="meta">${you}</div>${escapeHTML(qTxt)}
        </div>
        <div class="msg assistant">
          <div class="meta">${read}</div>
          ${seg}
          <hr style="border:0;border-top:1px solid #273245;margin:12px 0">
          ${pack.nextSteps || ''}
        </div>
      </div>`;
  }

  /* ===== ç»‘å®š DOM å…ƒç´  ===== */
  const langSel         = $('#langSelect');
  const spreadSel       = $('#spread');
  const qInput          = $('#question');
  const qDisplay        = $('#qdisplay');
  const readingPanel    = $('#reading');
  const readingText     = $('#readingText');
  const goBtn           = $('#go');
  const btnText         = $('#btnText');
  const btnLoading      = $('#btnLoading');
  const progressBar     = $('#progressBar');
  const progressFill    = $('#progressFill');
  const saveReadingBtn  = $('#saveReading');
  const shareReadingBtn = $('#shareReading');

  // åˆå§‹åŒ–è¯­è¨€ä¸‹æ‹‰é€‰
  if (langSel){
    const initial = REVERSE_LANG_MAP[CUR] || CUR;
    langSel.value = initial;
    langSel.addEventListener('change', ()=>{
      const raw = langSel.value;
      const key = LANG_MAP[raw] || raw;
      CUR = I18N[key] ? key : FALLBACK;
      applyStaticUI();
      const picks = window.__LAST_PICKS;
      if (picks){
        const n = parseInt(spreadSel.value,10) || picks.length;
        renderBoard(n, picks);
        const q = qInput ? (qInput.value || '') : '';
        if (readingText) readingText.innerHTML = renderReading(q, n, picks);
        if (readingPanel) readingPanel.style.display = 'block';
      }
    });
  }

  // é—®é¢˜è¾“å…¥ â†’ æç¤ºæ–‡å­—
  if (qInput && qDisplay){
    qInput.addEventListener('input', ()=>{
      if (qInput.value){
        if (['en-US','th-TH','ms-MY'].includes(CUR)){
          qDisplay.textContent = 'Question: ' + qInput.value;
        }else{
          qDisplay.textContent = 'é—®é¢˜ï¼š' + qInput.value;
        }
      }else{
        qDisplay.textContent = t('ui.tip_focus');
      }
    });
  }

  // æŠ½ç‰ŒæŒ‰é’®
  if (goBtn){
    goBtn.addEventListener('click', ()=>{
      const n = parseInt(spreadSel.value,10) || 1;

      if (btnText)    btnText.style.display    = 'none';
      if (btnLoading) btnLoading.style.display = 'inline-block';
      if (progressBar)progressBar.style.display= 'block';

      let progress = 0;
      const timer = setInterval(()=>{
        progress += 5;
        if (progressFill) progressFill.style.width = progress + '%';

        if (progress >= 100){
          clearInterval(timer);
          const picks = draw(n);
          window.__LAST_PICKS = picks;

          renderBoard(n, picks);
          const q = qInput ? (qInput.value || t('ui.no_q')) : t('ui.no_q');
          const html = renderReading(q, n, picks);
          if (readingText)  readingText.innerHTML = html;
          if (readingPanel) readingPanel.style.display = 'block';

          if (btnText)     btnText.style.display    = 'inline-block';
          if (btnLoading)  btnLoading.style.display = 'none';
          if (progressBar) progressBar.style.display= 'none';
          if (progressFill)progressFill.style.width = '0%';

          if (readingPanel){
            readingPanel.scrollIntoView({behavior:'smooth',block:'start'});
          }
        }
      },50);
    });
  }

  // ä¿å­˜è§£è¯»ï¼ˆlocalStorage demoï¼‰
  if (saveReadingBtn){
    saveReadingBtn.addEventListener('click', ()=>{
      const question = qInput ? (qInput.value || t('ui.no_q')) : t('ui.no_q');
      const spreadTxt= spreadSel ? spreadSel.options[spreadSel.selectedIndex].textContent : '';
      const content  = readingText ? readingText.innerHTML : '';
      const data = {
        question,
        spread: spreadTxt,
        content,
        date: new Date().toISOString()
      };
      localStorage.setItem('lastTarotReading', JSON.stringify(data));
      alert('è§£è¯»å·²ä¿å­˜åˆ°æœ¬åœ°æµè§ˆå™¨ï¼ˆlocalStorageï¼‰');
    });
  }

  // åˆ†äº«
  if (shareReadingBtn){
    shareReadingBtn.addEventListener('click', ()=>{
      const question = qInput ? (qInput.value || t('ui.no_q')) : t('ui.no_q');
      if (navigator.share){
        navigator.share({
          title:'å¡”ç½—ç‰Œå åœç»“æœ',
          text:`æˆ‘çš„å¡”ç½—ç‰Œå åœé—®é¢˜ï¼š${question}`,
          url:window.location.href
        }).catch(()=>{});
      }else{
        alert('å½“å‰æµè§ˆå™¨ä¸æ”¯æŒç³»ç»Ÿåˆ†äº«ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶ç½‘å€ã€‚');
      }
    });
  }

  // å¤´éƒ¨æ»šåŠ¨æ•ˆæœ
  window.addEventListener('scroll', ()=>{
    const header = document.querySelector('.site-header');
    if (!header) return;
    if (window.scrollY > 50) header.classList.add('scrolled');
    else header.classList.remove('scrolled');
  });

  /* ===== å¿ƒæ€œç®¡å®¶æµ®çª—ï¼ˆä¿æŒä½ åŸæ¥çš„ç®€ç‰ˆé€»è¾‘ï¼‰ ===== */
  const chatFab   = $('#chatFab');
  const chatPanel = $('#chatPanel');
  const chatClose = $('#chatClose');
  const chatInput = $('#chatInput');
  const chatSend  = $('#chatSend');
  const chatBody  = $('#chatBody');

  function addMsg(who,text){
    if (!chatBody) return;
    const div = document.createElement('div');
    div.className = 'ss-msg' + (who === 'You' ? ' me' : '');
    div.innerHTML = `<div class="meta">${who}</div>` + escapeHTML(text);
    chatBody.appendChild(div);
    chatBody.scrollTop = chatBody.scrollHeight;
  }

  function sendGPT(text){
    addMsg('å¿ƒæ€œç®¡å®¶','æ­£åœ¨åˆ†ææ‚¨çš„å¡”ç½—ç‰Œè§£è¯»...');
    setTimeout(()=>{
      const responses = [
        'æ ¹æ®æ‚¨çš„ç‰Œé¢ï¼Œæˆ‘å»ºè®®æ‚¨å…³æ³¨å†…åœ¨çš„å¹³è¡¡ä¸å’Œè°ã€‚',
        'è¿™å¼ ç‰Œæç¤ºæ‚¨éœ€è¦æ›´å¤šçš„è€å¿ƒå’Œç­‰å¾…æ—¶æœºã€‚',
        'ä»ç‰Œé¢æ¥çœ‹ï¼Œç°åœ¨æ˜¯é‡‡å–è¡ŒåŠ¨çš„å¥½æ—¶æœºã€‚',
        'æ‚¨çš„é—®é¢˜ä¸æƒ…æ„Ÿå…³ç³»æœ‰å…³ï¼Œå»ºè®®å¤šæ²Ÿé€šè¡¨è¾¾ã€‚',
        'è¿™å¼ ç‰Œè±¡å¾ç€æ–°çš„å¼€å§‹å’Œæœºé‡ï¼Œè¯·ä¿æŒå¼€æ”¾å¿ƒæ€ã€‚'
      ];
      const r = responses[Math.floor(Math.random()*responses.length)];
      addMsg('å¿ƒæ€œç®¡å®¶', r);
    }, 1500);
  }

  if (chatFab){
    chatFab.addEventListener('click', ()=>{
      if (chatPanel){
        chatPanel.setAttribute('aria-hidden','false');
        if (chatInput) chatInput.focus();
      }
    });
  }
  if (chatClose){
    chatClose.addEventListener('click', ()=>{
      if (chatPanel) chatPanel.setAttribute('aria-hidden','true');
    });
  }
  if (chatSend){
    chatSend.addEventListener('click', ()=>{
      const v = chatInput ? (chatInput.value||'').trim() : '';
      if (!v) return;
      chatInput.value = '';
      addMsg('You', v);
      sendGPT(v);
    });
  }
  if (chatInput){
    chatInput.addEventListener('keydown', e=>{
      if (e.key === 'Enter'){
        e.preventDefault();
        if (chatSend) chatSend.click();
      }
    });
  }
  document.addEventListener('click', e=>{
    if (!chatPanel || chatPanel.getAttribute('aria-hidden') === 'true') return;
    if (!chatPanel.contains(e.target) && !chatFab.contains(e.target)){
      chatPanel.setAttribute('aria-hidden','true');
    }
  });

  // åˆæ¬¡æ¸²æŸ“
  applyStaticUI();
});
</script>
</body>
</html>
