
<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>命理供门 Index</title>
  <style>
    body::before {
      content: "";
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.6);
      background-image: url('assets/images/gate.jpg');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      z-index: -1;
      pointer-events: none;
    }

    body {
      margin: 0;
      padding: 0;
      overflow-x: hidden;
      color: #d4af37;
      font-family: 'Noto Serif', serif;
      text-align: center;
    }

    .container1, .container2, .container3, .container4 {
      max-width: 480px;
      margin: 30px auto;
      padding: 32px 20px;
      background-color: rgba(0, 0, 0, 0.2);
      border: 1px solid #d4af37;
      border-radius: 12px;
    }

    h1 { font-size: 2.4rem; margin-top: 40px; }

    .grid {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 14px;
      margin-top: 10px;
    }

    .grid a {
      display: inline-block;
      background: #222;
      color: #d4af37;
      padding: 14px 24px;
      border-radius: 6px;
      text-decoration: none;
      font-size: 1rem;
      min-width: 300px;
    }

    .gold-button {
      background-color: #d4af37;
      color: #000;
      padding: 12px 24px;
      margin: 10px;
      border: none;
      border-radius: 6px;
      font-size: 1rem;
      text-decoration: none;
      display: inline-block;
    }

    form {
      margin-top: 20px;
    }

    input {
      padding: 10px;
      margin: 5px;
      border-radius: 5px;
      border: none;
      font-size: 1rem;
    }

    button {
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      background-color: #ffd700;
      color: #000;
      font-size: 1rem;
      border: 1px solid #d4af37;
      cursor: pointer;
    }

    ul { text-align: center; padding-left: 20px; }
    li { margin: 8px 0; }

    @media screen and (max-width: 480px) {
      h1 { font-size: 2rem; }
      .grid a { font-size: 1rem; padding: 14px 20px; min-width: 90%; }
    }
  </style>
</head>
<body>

  <h1>命理供门 Soul Portal</h1>

  <div class="container1">
    <h2>🌀 免费体验区 Free Segment</h2>
    <div class="grid">
      <a href="bazi.html">八字命理分析</a>
      <a href="natal.html">本命星盘分析</a>
      <a href="life_path.html">灵数分析</a>
      <a href="tarot.html">塔罗指引分析</a>
      <a href="kyuusei.html">九星气学分析</a>
      <a href="energy.html">能量类型分析</a>
      <a href="vedic_astrology.html">印度命理吠陀占星</a>
    </div>
  </div>

  <div class="container2" style="display:none;">
    <h2>🗝 Members Segment - 年费会员内容预览</h2>
    <ul>
      <li>姻缘方向：恋爱缘分、婚姻走势</li>
      <li>事业方向：职场发展、创业潜力</li>
      <li>财运方向：财位分析、理财时机</li>
      <li>宠物命理：伴侣动物的性格与缘分</li>
      <li>合盘分析：婚期择日、新生择时</li>
      <li>测名分析：公司名、宝宝名、命名改运</li>
      <li>财位合盘：住家 / 办公室动线配合</li>
    </ul>
  </div>

  <div class="container3" style="display:none;">
    <h2>🌙 VIP Segment - 心怜空间专属内容</h2>
    <ul>
      <li>🧘‍♀️ 灵性记录：照片、梦境、声音、愿望祈祷</li>
      <li>📘 命理课程：八字 / 灵性 / 占星全解锁</li>
      <li>📖 家族纪念系统：亲人灵性纪念 & 延续</li>
      <li>🔮 每周能量练习 / 神明仪式任务</li>
      <li>🛍️ 能量商城专属折扣 & 御守订制</li>
    </ul>
  </div>

  <div class="container4">
    <h2>💎 加入会员解锁命理功能</h2>
    <p>$9.9 / 年费会员（命理解盘全部开放）<br>$9.9 / 月费 VIP（心怜空间 + 灵性课程）</p>
    <a class="gold-button" href="https://yourshopifyshop.com/products/yearly-member">立即注册年费会员</a>
    <a class="gold-button" href="https://yourshopifyshop.com/products/monthly-vip">升级为月费 VIP</a>

<div style="display: flex; flex-wrap: wrap; justify-content: space-between; gap: 20px;">
  <div style="flex: 1; min-width: 240px;">
    <h3>登入账户 Login</h3>
    <form onsubmit="return handleLogin(event)">
      <input type="email" id="email" placeholder="邮箱 Email" required>
      <input type="password" id="password" placeholder="密码 Password" required>
      <button type="submit">登入账户</button>
    </form>
  </div>

  <div style="flex: 1; min-width: 240px;">
  <h3>🔐 重设密码 Reset Password</h3>
  <form onsubmit="return handleReset(event)">
    <input type="email" id="resetEmail" placeholder="邮箱 Email" required>
    <input type="password" id="newPassword" placeholder="新密码 New Password" required>
    <button type="submit">重设密码</button>
  </form>
</div>

  <div id="status" style="margin-top:20px;"></div>
  
  <script>
    const API_KEY = "patCNZisIV0Yl7Rnf.bd657624e4227d8133ffee4466ad48e083d210e3f406938a70edacf3c3c9f6fd";
    const BASE_ID = "apphD4o8Efxs8h0fz";
    const TABLE_NAME = "Members";

    async function handleLogin(event) {
      event.preventDefault();
      const email = document.getElementById("email").value.trim();
      const password = document.getElementById("password").value.trim();
      const status = document.getElementById("status");

      if (!email || !password) {
        status.textContent = "請輸入 Email 和 密碼";
        return;
      }

      status.textContent = "登入中...";

      const formula = `LOWER({Email})='${email.toLowerCase()}'`;
      const url = `https://api.airtable.com/v0/${BASE_ID}/${TABLE_NAME}?filterByFormula=${encodeURIComponent(formula)}`;


      try {
        const res = await fetch(url, {
          headers: {
            Authorization: "Bearer " + API_KEY
          }
        });

        const data = await res.json();

        if (!data.records || data.records.length === 0) {
          status.textContent = "查無此帳號";
          return;
        }

const member = data.records[0].fields;
const today = new Date().toISOString().split("T")[0];
const expire = member["Expired Date"]?.split("T")[0] || "1900-01-01";

if (member.Password !== password) {
  status.textContent = "密碼錯誤";
  return;
}

if (today > expire) {
  status.textContent = "會員已過期";
  return;
}

// 儲存登入資料
localStorage.setItem("membership", member.membership);
localStorage.setItem("email", member.email);
localStorage.setItem("name", member.name || "");

if (level === "vip") {
  window.location.href = "vip_soul_sanctuary.html";
} else if (level === "yearly") {
  window.location.href = "member_astro_report.html";
} else if (level === "guest") {
  window.location.href = "guest_preview.html";
} else {
  status.textContent = `未知會員等級（${member.membership}），請聯繫客服`;
}

      } catch (err) {
        console.error(err);
        status.textContent = "登入失敗，請稍後再試";
      }
    }
  </script>
</body>
</html>
