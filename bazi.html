<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>å…«å­—å‘½ç† Â· 5XLiving</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <link rel="icon" href="data:,">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600&family=Inter:wght@400;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#0b0f14; --card:#11161dcc; --line:#1f2a36; --text:#e8edf3; --muted:#98a7b7;
      --brand:#d4af37; --gold:#d4af37; --gold2:#f2d27a; --accent:#58b9ff;
      --radius:14px; --shadow:0 8px 30px rgba(0,0,0,.35);
    }
    html,body{height:100%}
    body{
      margin:0; color:var(--text); background: radial-gradient(1200px 600px at 70% -10%, #16202b 10%, transparent 60%) no-repeat, linear-gradient(180deg,#0b0f14,#0b0f14);
      font-family: Inter,system-ui,-apple-system,"Noto Sans SC","Segoe UI",Roboto,Arial,sans-serif;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }
    body::before{content:""; position:fixed; inset:0; z-index:-2; background:url('assets/images/gate.jpg') center/cover no-repeat; filter:brightness(.45) saturate(.9) blur(2px)}
    .container{max-width:1100px;margin:0 auto;padding:24px 16px 80px}
    header{position:sticky;top:0;z-index:10;background:#0b0f14cc;border-bottom:1px solid #0f1622;backdrop-filter:saturate(140%) blur(12px)}
    .head-inner{display:flex;align-items:center;justify-content:space-between;gap:14px;padding:16px}
    .title{font-family:"Noto Serif SC",serif;font-weight:700;letter-spacing:.02em}
    .subtitle{color:var(--muted);font-size:.9rem}
    .lang{display:flex;align-items:center;gap:8px}
    .lang select{
      appearance:none;border-radius:10px;border:1px solid #243244;background:#0e1520;color:var(--text);
      padding:10px 34px 10px 12px;font-size:.95rem;
      background-image:url("data:image/svg+xml,%3Csvg width='12' height='8' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%2398a7b7' stroke-width='2' fill='none'/%3E%3C/svg%3E");
      background-repeat:no-repeat;background-position:calc(100% - 12px) 50%;
    }

    .section{margin-top:18px}
    .card{background:var(--card);border:1px solid var(--line);border-radius:var(--radius);box-shadow:var(--shadow);backdrop-filter:blur(10px);padding:18px;margin:16px 0}
    .h2{font-size:1.2rem;margin:0 0 12px;font-weight:800;color:#ffe084;display:flex;gap:8px;align-items:center}
    .h2::before{content:"";width:4px;height:18px;background:var(--brand);border-radius:2px}

    .row{display:grid;gap:12px}
    @media(min-width:760px){.row.cols-3{grid-template-columns:1fr 1fr 1fr}.row.cols-2{grid-template-columns:1fr 1fr}}

    input,select{
      width:100%;box-sizing:border-box;border-radius:12px;border:1px solid #243244;background:#0e1520;color:var(--text);
      padding:12px 12px;font-size:15px;outline:none;
    }
    input::placeholder{color:#6f8092}
    .btn{display:inline-grid;place-items:center;padding:12px 16px;border-radius:12px;border:1px solid #e6c76e;background:linear-gradient(180deg,#fff9e6,#e6c76e);color:#191919;font-weight:800;cursor:pointer}
    .btn:hover{transform:translateY(-1px);box-shadow:0 10px 22px rgba(230,199,110,.5)}
    .btn[disabled]{opacity:.6;cursor:not-allowed}
    .btn.ghost{background:transparent;color:var(--gold2);border:1px solid rgba(212,175,55,.45);box-shadow:none}
    .btn.block{display:block;width:100%}

    .pillars{display:grid;grid-template-columns:repeat(4,1fr);gap:10px}
    .pillar{background:#0f1624;border:1px solid #253245;border-radius:12px;padding:14px 10px;text-align:center}
    .pillar .tit{color:#9aa3b2;font-size:.85rem;margin-bottom:6px}
    .pillar .gz{font-size:1.5rem;font-weight:800;color:var(--gold2)}

    .bazi-table{width:100%;border-collapse:collapse;margin-top:12px;background:#0f1624;border-radius:8px;overflow:hidden}
    .bazi-table th,.bazi-table td{padding:10px 12px;border:1px solid #253245;text-align:center}
    .bazi-table th{background:rgba(212,175,55,.1);color:var(--gold2)}

    .bar{height:10px;background:#0d1420;border:1px solid #233146;border-radius:999px;overflow:hidden;margin:6px 0}
    .bar i{display:block;height:100%;background:linear-gradient(90deg,#ffe084,#f2d27a);width:0}
    .bar-row{display:grid;grid-template-columns:60px 1fr 60px;gap:10px;align-items:center}
    .error-message{background:rgba(255,90,95,.1);border:1px solid #ff5a5f;border-radius:8px;padding:10px;display:none}
    .badge-warn{display:inline-block;padding:2px 8px;margin-left:6px;border:1px solid #ffb84d;border-radius:999px;color:#ffb84d;font-size:.82rem}
    .muted{color:var(--muted)}

    /* â€”â€” å‡ºç”Ÿæ—¶é—´ï¼šæ—¶é—´è¾“å…¥ + â€œä¸è¯¦â€åŒä¸€è¡Œ â€”â€” */
    .time-row{display:flex;align-items:center;gap:10px}
    .time-row .time-unknown{display:flex;align-items:center;gap:6px;white-space:nowrap}
    .btn-mini{padding:8px 10px;border-radius:10px}
    /* â€”â€” éšè—â€œä¼°æ—¶é—´â€æŒ‰é’®ï¼šä»…å‹¾é€‰ä¸è¯¦æ—¶å¼¹çª— â€”â€” */
    #guessTimeBtn{display:none !important; visibility:hidden !important;}

    /* â€”â€” å³ä¸‹è§’å¿ƒæ€œç®¡å®¶ï¼ˆé—®ï¼‰ â€”â€” */
    .ss-chat-fab{
      position:fixed;right:18px;bottom:18px;z-index:50;width:56px;height:56px;border-radius:50%;
      background:linear-gradient(180deg,#fff9e6,#e6c76e);color:#191919;display:grid;place-items:center;font-weight:800;
      box-shadow:0 8px 30px rgba(0,0,0,.35);cursor:pointer;border:1px solid #e6c76e
    }
    .ss-chat-panel{
      position:fixed;right:18px;bottom:88px;z-index:50;width:min(460px,92vw);display:none;
      background:#0e1520;border:1px solid #243244;border-radius:14px;box-shadow:var(--shadow)
    }
    .ss-chat-head{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-bottom:1px solid #243244}
    .ss-chat-title{font-weight:700}
    .ss-close{cursor:pointer;opacity:.8}
    .ss-chat-body{max-height:300px;overflow:auto;padding:10px 12px}
    .ss-msg{padding:8px 10px;background:#0f1624;border:1px solid #243244;border-radius:10px;margin:6px 0;max-width:80%}
    .ss-msg.me{margin-left:auto;background:#132033}
/* èŠå¤©è¾“å…¥è¡Œï¼šè¾“å…¥æ¡†æ’‘æ»¡ã€æŒ‰é’®æŒ‰å†…å®¹è‡ªé€‚åº” */
.ss-chat-input{
  display:flex; align-items:center; gap:8px;
  padding:10px 12px; border-top:1px solid #243244;
}
.ss-chat-input input{
  flex:1 1 auto; min-width:0;
}
.ss-chat-input .btn,
.ss-chat-input button{
  flex:0 0 auto;
  width:auto !important;
  white-space:nowrap;
  padding:10px 14px;
}

    /* â€”â€” ä¼šå‘˜åŒºå¸ƒå±€ â€”â€” */
    .columns{display:grid;gap:12px;grid-template-columns:1fr}
    @media(min-width:900px){ .columns{grid-template-columns:1fr 1fr} }
    .list-block{border:1px solid #263448;background:#0e1520;border-radius:12px;padding:16px}
    .list-block ul{margin:.2rem 0 0;padding-left:1.1rem}
    .group-title{font-size:1.05rem;color:#ffe084;margin:6px 0 14px}
    .astro-auth{max-width:980px;margin:28px auto;padding:20px 18px;background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.01));border:1px solid rgba(212,175,55,.22);border-radius:14px;box-shadow:0 18px 50px rgba(0,0,0,.35)}
    .auth-grid{display:grid;gap:18px;grid-template-columns:1.2fr .8fr}
    @media(max-width:860px){ .auth-grid{grid-template-columns:1fr} }
    .panel{background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.01));border:1px solid rgba(212,175,55,.22);border-radius:14px;box-shadow:0 10px 30px rgba(0,0,0,.35)}
    .panel .head{padding:16px 18px;border-bottom:1px solid rgba(212,175,55,.22);color:var(--gold);font-weight:700;letter-spacing:.3px}
    .panel .body{padding:18px}
    .spacer{height:12px}
    footer{color:#6c7b8c;font-size:.85rem;text-align:center;padding:30px 0}

    /* â€”â€” åªä¿ç•™ä¸€ä¸ª GPT çª—å£ï¼šéšè—ç»“æœåŒºçš„ GPT æŠ½å±‰ â€”â€” */
    #gpt-drawer, #gpt-drawer[hidden], #gpt-drawer>summary{display:none !important}

    /* â€”â€” ä¼°æ—¶é—´å¼¹çª— â€”â€” */
    .tw-mask{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;align-items:center;justify-content:center;z-index:60}
    .tw-box{width:min(560px,94vw);background:#0e1520;border:1px solid #243244;border-radius:14px;box-shadow:var(--shadow)}
    .tw-head{padding:12px 14px;border-bottom:1px solid #243244;font-weight:700}
    .tw-body{padding:14px}
    .tw-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px}
    .tw-btn{padding:10px;border:1px solid #243244;border-radius:12px;background:#0f1624;color:var(--text);cursor:pointer}
    .tw-btn.active{border-color:var(--gold2);box-shadow:0 0 0 2px rgba(212,175,55,.25) inset}
    .tw-foot{display:flex;gap:10px;justify-content:flex-end;padding:12px 14px;border-top:1px solid #243244}
    /* ä¿®å¤ï¼šGrid å­é¡¹å…è®¸æ”¶ç¼©ï¼Œé¿å…å†…å®¹æŠŠé¢æ¿æ’‘ç ´ */
.auth-grid > * { min-width: 0; }
.panel .body .row.one > * { min-width: 0; }

/* è®©ä¼šå‘˜æŒ‰é’®åœ¨çª„å®½åº¦ä¸‹èƒ½æ¢è¡Œã€å±…ä¸­ä¸”ä¸æº¢å‡º */
.panel .body .btn {
  display: flex;               /* æ”¹ä¸º flex æ›´ç¨³ */
  align-items: center;
  justify-content: center;
  text-align: center;
  white-space: normal;         /* å…è®¸æ¢è¡Œ */
  line-height: 1.2;
  word-break: break-word;      /* å¤šè¯­è¨€/é•¿è¯å¯æ–­è¡Œ */
}

/* å—çº§æŒ‰é’®ç¡®ä¿å æ»¡å®¹å™¨ä¸”ä¸è¶…å‡º */
.btn.block { display:block; width:100%; box-sizing:border-box; }

/* å¯é€‰ï¼šå¦‚æœä»æœ‰è½»å¾®ä½ç§»ï¼Œé™åˆ¶æº¢å‡º */
.panel .body { overflow: hidden; }

.panel .body .btn { padding: 10px 14px; }    
    /* === è¡¨å•ç½‘æ ¼ï¼šå¤§å± 3 åˆ—ï¼Œçª„å± 1 åˆ— === */
.row{display:grid;gap:12px;grid-template-columns:1fr;}        /* é»˜è®¤ 1 åˆ— */
.row > *{min-width:0;}                                         /* é˜²æ­¢å­é¡¹æŠŠå®¹å™¨æ’‘çˆ† */
@media (min-width:760px){
  .row.cols-3{grid-template-columns:1fr 1fr 1fr;}              /* ä¸‰åˆ— */
}

/* æ ‡ç­¾æ›´ç´§å‡‘ */
label.muted{display:block;margin-bottom:4px}

/* æŒ‰é’®ä¸è¦ 100% å®½ */
#genBtn{width:auto !important}
.gen-wrap{display:flex;align-items:flex-end;justify-content:flex-end}

/* æ—¶é—´è¾“å…¥ä¸â€œä¸è¯¦â€å¹¶æ’ã€ç´§å‡‘ */
.time-row{display:flex;align-items:center;gap:10px}
.time-row input[type="time"]{
  width:auto !important; flex:0 0 160px; min-width:140px;
}
.time-row .time-unknown{white-space:nowrap}
    .title a{ color: inherit; text-decoration: none; }
.title a:hover{ text-decoration: underline; text-underline-offset: 3px; }
    /* â€”â€” ç»Ÿä¸€å¤´éƒ¨ â€”â€” */
.site-header{
  position:sticky; top:0; z-index:10;
  background:#0b0f14cc;
  border-bottom:1px solid #0f1622;
  backdrop-filter:saturate(140%) blur(12px);
}
.head-inner{display:flex; align-items:center; justify-content:space-between; gap:14px; padding:14px 16px}

/* å“ç‰ŒåŒºï¼šå¾½ç«  + æ ‡é¢˜ */
.brand{display:flex; align-items:center; gap:10px; text-decoration:none; color:var(--text)}
.brand-badge{
  display:inline-grid; place-items:center;
  width:34px; height:34px; border-radius:8px;
  background:linear-gradient(180deg,#0e1520,#0b1018);
  border:1px solid #2a3546; box-shadow:0 4px 14px rgba(0,0,0,.35);
  font-weight:800; color:#ffe084;
}
.title{font-family:"Noto Serif SC",serif; font-weight:700; letter-spacing:.02em}

/* è¯­è¨€é€‰æ‹©ï¼šé˜²æ­¢â€œè¯­è¨€â€ç«–æ’ã€ä¸ç¬¬ä¸€å¼ ä¸€è‡´ */
.lang{display:flex; align-items:center; gap:8px}
.lang label{white-space:nowrap; color:var(--muted); margin-right:4px}
.lang select{
  appearance:none; min-width:170px;
  border-radius:10px; border:1px solid #243244;
  background:#0e1520; color:var(--text);
  padding:10px 34px 10px 12px; font-size:.95rem;
  background-image:url("data:image/svg+xml,%3Csvg width='12' height='8' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%2398a7b7' stroke-width='2' fill='none'/%3E%3C/svg%3E");
  background-repeat:no-repeat; background-position:calc(100% - 12px) 50%;
}

@media (max-width:520px){
  .title{font-size:1rem}
  .lang select{min-width:140px}
}
/* ä¸ Index ä¿æŒä¸€è‡´çš„æ ¹å­—å·ï¼ˆä¼šå½±å“ rem è®¡ç®—ï¼‰ */
html { font-size: 16px; }
@media (min-width: 768px){ html { font-size: 17px; } }
@media (min-width: 1200px){ html { font-size: 18px; } }

/* æ ‡é¢˜ç”¨ Noto Serif SCï¼›å­—å·/å­—é‡ä¸ Index å®Œå…¨ä¸€è‡´ */
.site-header .brand .title,
.site-header .title{
  font-family: "Noto Serif SC","Noto Serif",serif !important;
  font-weight: 600 !important;
  letter-spacing: .02em;
  font-size: 1.1rem !important;
  line-height: 1.25;
}    
  </style>
</head>
<body>
<header class="site-header">
  <div class="head-inner container">
    <!-- å“ç‰Œï¼šç‚¹å‡»å›åˆ°â€œå…«å­—ç®€è¯„â€æœ¬é¡µ -->
<a class="brand" href="https://astro.5xliving.com/" target="_self">
  <span class="brand-badge">5X</span>
  <span class="title">
    5xLiving Â· <span data-i18n="title_bazi_brief">å…«å­—ç®€è¯„</span>
  </span>
</a>

    <div class="lang">
      <label for="langSelect" class="muted" data-i18n="lang_label">è¯­è¨€</label>
      <select id="langSelect" aria-label="Language">
          <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
          <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
          <option value="en">English</option>
          <option value="ja">æ—¥æœ¬èª</option>
          <option value="th">à¹„à¸—à¸¢</option>
          <option value="ms">Bahasa Melayu</option>
      </select>
    </div>
  </div>
</header>

  <main class="container">
    <section class="card">
<div class="h2" data-i18n="title_quickcalc">å…«å­—å‘½ç† Â· å¿«é€Ÿæ’ç›˜</div>

<div class="row cols-3">
  <div>
    <label class="muted" data-i18n="label_name">å§“åï¼ˆå¯é€‰ï¼‰</label>
    <input id="name" placeholder="ä½ çš„ç§°å‘¼ï¼ˆç”¨äºä¸ªæ€§åŒ–ï¼‰" data-i18n-ph="ph_name" />
  </div>
  <div>
    <label class="muted" data-i18n="gender_label">æ€§åˆ«</label>
     <select id="gender">
     <option value="" data-i18n="opt_gender_confidential">ä¸é€éœ²</option>
     <option value="male" data-i18n="opt_gender_male">ç”·æ€§</option>
     <option value="female" data-i18n="opt_gender_female">å¥³æ€§</option>
    </select>
  </div>
  <div>
    <label class="muted" data-i18n="label_calendar">å†æ³•</label>
     <select id="calendar">
     <option value="gregorian" data-i18n="opt_cal_gregorian">é˜³å†</option>
     <option value="lunar" data-i18n="opt_cal_lunar">å†œå†</option>
    </select>
  </div>
</div>

<div class="row cols-3" style="margin-top:10px">
  <div>
    <label class="muted" data-i18n="label_birthdate">å‡ºç”Ÿæ—¥æœŸ</label>
    <input type="date" id="birthdate" />
  </div>

  <div>
    <label class="muted" data-i18n="label_birthtime">å‡ºç”Ÿæ—¶é—´</label>
    <div class="time-row">
     <input type="time" id="birthtime" value="12:00" />
     <label class="muted time-unknown">
     <input type="checkbox" id="timeUnknown" />
     <span data-i18n="cb_time_unknown">å‡ºç”Ÿæ—¶é—´ä¸è¯¦</span>
      </label>
    </div>
  </div>

  <div class="gen-wrap">
    <button class="btn" id="genBtn">
      <span id="genBtnText" data-i18n="btn_generate_chart">ç”Ÿæˆå…«å­—</span>
      <span id="genBtnLoading" style="display:none">è®¡ç®—ä¸­...</span>
      </div>
</div>

      <div id="error" class="error-message"></div>
    </section>

    <section id="result" style="display:none;">
      <div class="card">
        <div class="h2">æ‚¨çš„ç”Ÿè¾°å…«å­—å‘½ç›˜</div>
        <div class="pillars" id="bazi-pillars"></div>
        <div class="muted" id="bazi-date" style="margin-top:6px"></div>

        <table class="bazi-table">
          <thead><tr><th></th><th>å¹´æŸ±</th><th>æœˆæŸ±</th><th>æ—¥æŸ±</th><th>æ—¶æŸ±</th></tr></thead>
          <tbody>
            <tr><td>å¤©å¹²</td><td id="year-stem">-</td><td id="month-stem">-</td><td id="day-stem">-</td><td id="hour-stem">-</td></tr>
            <tr><td>åœ°æ”¯</td><td id="year-branch">-</td><td id="month-branch">-</td><td id="day-branch">-</td><td id="hour-branch">-</td></tr>
            <tr><td>äº”è¡Œ</td><td id="year-element">-</td><td id="month-element">-</td><td id="day-element">-</td><td id="hour-element">-</td></tr>
            <tr><td>çº³éŸ³</td><td id="year-nayin">-</td><td id="month-nayin">-</td><td id="day-nayin">-</td><td id="hour-nayin">-</td></tr>
          </tbody>
        </table>
      </div>

      <div class="card">
        <div class="h2" data-i18n="rpt_sec_elements_title">äº”è¡Œèƒ½é‡åˆ†æ</div>
        <div class="bar-row"><span data-i18n="el_wood">æœ¨</span><div class="bar"><i id="bar-æœ¨"></i></div><span id="pct-æœ¨">0%</span></div>
        <div class="bar-row"><span data-i18n="el_fire">ç«</span><div class="bar"><i id="bar-ç«"></i></div><span id="pct-ç«">0%</span></div>
        <div class="bar-row"><span data-i18n="el_earth">åœŸ</span><div class="bar"><i id="bar-åœŸ"></i></div><span id="pct-åœŸ">0%</span></div>
        <div class="bar-row"><span data-i18n="el_metal">é‡‘</span><div class="bar"><i id="bar-é‡‘"></i></div><span id="pct-é‡‘">0%</span></div>
        <div class="bar-row"><span data-i18n="el_water">æ°´</span><div class="bar"><i id="bar-æ°´"></i></div><span id="pct-æ°´">0%</span></div>
        <div id="bazi-elements-balance" class="muted" style="margin-top:8px"></div>
      </div>
    </section>

    <!-- ä¼šå‘˜ä¸“åŒº -->
    <section class="card section">
      <h2 class="group-title" data-i18n="vip_title">ğŸŒ™ ä¼šå‘˜åŒºåŸŸ VIP Segment</h2>
      <div class="columns">
        <div class="list-block">
          <div class="group-title" data-i18n="vip_mingli">ğŸ— å‘½ç†ç©ºé—´ä¸“å±å†…å®¹</div>
          <ul>
            <li data-i18n="vip_love">å§»ç¼˜æ–¹å‘ï¼šæ‹çˆ±ç¼˜åˆ†ã€å©šå§»èµ°åŠ¿</li>
            <li data-i18n="vip_career">äº‹ä¸šæ–¹å‘ï¼šèŒåœºå‘å±•ã€åˆ›ä¸šæ½œåŠ›</li>
            <li data-i18n="vip_wealth">è´¢è¿æ–¹å‘ï¼šè´¢ä½åˆ†æã€ç†è´¢æ—¶æœº</li>
            <li data-i18n="vip_pet">å® ç‰©å‘½ç†ï¼šä¼´ä¾£åŠ¨ç‰©çš„æ€§æ ¼ä¸ç¼˜åˆ†</li>
            <li data-i18n="vip_hepan">åˆç›˜åˆ†æï¼šå©šæœŸæ‹©æ—¥ã€æ–°ç”Ÿæ‹©æ—¶</li>
            <li data-i18n="vip_name">æµ‹ååˆ†æï¼šå…¬å¸åã€å®å®åã€å‘½åæ”¹è¿</li>
            <li data-i18n="vip_fengshui">è´¢ä½åˆç›˜ï¼šä½å®¶ / åŠå…¬å®¤åŠ¨çº¿é…åˆ</li>
          </ul>
        </div>
        <div class="list-block">
          <div class="group-title" data-i18n="vip_xinlian">ğŸŒ™ å¿ƒæ€œç©ºé—´ä¸“å±å†…å®¹</div>
          <ul>
            <li data-i18n="vip_record">çµæ€§è®°å½•ï¼šç…§ç‰‡ã€æ¢¦å¢ƒã€å£°éŸ³ã€æ„¿æœ›ç¥ˆç¥·</li>
            <li data-i18n="vip_course">å‘½ç†è¯¾ç¨‹ï¼šå…«å­— / å¡”ç½— / å æ˜Ÿ / çµæ•° / äººç±»å›¾</li>
            <li data-i18n="vip_memorial">å®¶æ—çºªå¿µç³»ç»Ÿï¼šäº²äººçµæ€§çºªå¿µ & å»¶ç»­</li>
            <li data-i18n="vip_tasks">æ¯å‘¨èƒ½é‡ç»ƒä¹  / ç¥æ˜ä»ªå¼ä»»åŠ¡</li>
            <li data-i18n="vip_shop">èƒ½é‡å•†åŸä¸“å±æŠ˜æ‰£ & å¾¡å®ˆè®¢åˆ¶</li>
          </ul>
        </div>
      </div>

      <div class="group-title" style="margin-top:14px" data-i18n="login_title">ğŸ’ ç™»å…¥ VIP åŠŸèƒ½</div>

      <section class="astro-auth">
        <div class="auth-grid">
          <!-- å·¦ä¾§ï¼šè¾“å…¥ + æ³¨å†Œ/ç™»å½• -->
          <div class="panel">
            <div class="head" data-i18n="panel_login_head">è´¦æˆ·ç™»å½• / æ³¨å†Œ</div>
            <div class="body">
              
              <div class="row" id="authFields">
                <label for="email" class="sr-only" data-i18n="ph_email">é‚®ç®± Email</label>
                <input
                  id="email"
                  name="email"
                  type="email"
                  inputmode="email"
                  autocomplete="username" />
                <!-- ç™»å½•/æ³¨å†Œå»ºè®®ç”¨ usernameï¼Œå¯†ç ç®¡ç†å™¨æ›´å®¹æ˜“é…å¯¹ -->

                <label for="password" class="sr-only" data-i18n="ph_label_password">å¯†ç  Password</label>
                <input 
                  id="password" 
                  type="password" 
                  autocomplete="new-password" 
                  placeholder="å¯†ç  Passwordï¼ˆè‡³å°‘8ä½ï¼Œå«å¤§å°å†™æ•°å­—ç¬¦å·ï¼‰" data-i18n-ph="ph_password" required/>
              </div>

            
              <div class="spacer"></div>
              <form id="loginForm" class="row one">
                <button class="btn block" id="loginBtn" type="submit" data-i18n="btn_login">ç™»å…¥è´¦æˆ·</button>
              </form>
              <div class="spacer"></div>
              <div class="row one">
                <button class="btn ghost block" id="resetBtn" type="button" data-i18n="btn_reset">ğŸ”‘ é‡è®¾å¯†ç </button>
              </div>
              <div class="spacer"></div>
              <form class="row one" id="registerForm">
                <button class="btn block" id="registerBtn" type="submit" data-i18n="btn_register">æ³¨å†Œè´¦æˆ·</button>
                <div class="muted" data-i18n="note_price">æ³¨å†Œè´¦å·èµ é€ä¸€æ¬¡å…è´¹ä½“éªŒ</div>
                <div class="spacer"></div>
                <div class="error-message" id="authError" style="display:none"></div>
              </form>
            </div>
          </div>

          <!-- å³ä¾§ï¼šä¼šå‘˜ä¸è¿”å› -->
          <div class="panel">
            <div class="head" data-i18n="panel_member_head">ä¼šå‘˜æœåŠ¡</div>
            <div class="body">
              <div class="row one">
                <a class="btn btn-gold block" href="https://yourshopifyshop.com/products/monthly-vip" target="_blank" rel="noopener noreferrer" data-i18n="btn_upgrade">ğŸ’ å‡çº§ä¸º VIPï¼ˆæœˆè´¹ï¼‰</a>
              </div>
              <div class="spacer"></div>
              <div class="row one">
                <a class="btn ghost block" href="https://yourshopifyshop.myshopify.com" target="_blank" rel="noopener noreferrer" data-i18n="btn_backshop">â† è¿”å›å‘½ç†å•†åŸ</a>
              </div>
              <div class="spacer"></div>
              <div class="muted" data-i18n="note_price1">$9.9 / æœˆè´¹ VIPï¼ˆå‘½ç†ç©ºé—´ + å¿ƒæ€œç©ºé—´ + çµæ€§è¯¾ç¨‹ï¼‰</div>
            </div>
          </div>
        </div>
      </section>
    </section>

    <footer>Â© 5XLiving â€¢ Astro Sanctuary</footer>
  </main>

  <!-- ä¼°æ—¶é—´å¼¹çª— -->
  <div class="tw-mask" id="twMask" aria-hidden="true">
    <div class="tw-box" role="dialog" aria-modal="true" aria-labelledby="twTitle">
      <div class="tw-head" id="twTitle">ğŸ§­ ä¼°ä¸€ä¸ªå¤§è‡´å‡ºç”Ÿæ—¶é—´</div>
      <div class="tw-body">
        <div class="muted" style="margin-bottom:8px">é€‰æ‹©ä½ è®°å¾—çš„<strong>å¤§æ¦‚æ—¶æ®µ</strong>ï¼ˆåœ°æ”¯åŒå°æ—¶æ®µï¼‰</div>
        <div class="tw-grid" id="twGrid"></div>
        <div class="muted" style="margin-top:10px;font-size:.9em">
          é€‰æ‹©åç‚¹â€œå¡«å…¥æ—¶é—´â€ï¼Œä¼šç”¨è¯¥æ—¶æ®µçš„ä¸­ä½æ—¶é—´å†™åˆ°ä¸Šæ–¹æ—¶é—´è¾“å…¥æ¡†ï¼Œå¹¶è‡ªåŠ¨å–æ¶ˆâ€œæ—¶é—´ä¸è¯¦â€ã€‚
        </div>
      </div>
      <div class="tw-foot">
        <button class="btn ghost" id="twCancel" type="button">å–æ¶ˆ</button>
        <button class="btn" id="twApply" type="button" disabled>å¡«å…¥æ—¶é—´</button>
      </div>
    </div>
  </div>

<script>
(function(){  
'use strict';

/* =====================================
   Xinlian Butler + å…«å­—æ’ç›˜ï¼ˆæ•´åˆç‰ˆï¼‰
   - ä¿ç•™åŸæœ‰å…«å­—è®¡ç®—/æŠ¥å‘Š
   - æ¥å…¥ Butler æ™ºèƒ½è§£è¯»å¡ç‰‡ï¼ˆå¤šè¯­è¨€/èŠ¯ç‰‡/VIP é”å®šï¼‰
   - æ–°å¢ zh-TW æ–‡æ¡ˆ
   - å³ä¸‹è§’ Butler Chat æ‚¬æµ®çƒ
   ===================================== */

/* ================== åŸºç¡€é…ç½®/å·¥å…· ================== */
const API_BASE = 'https://throbbing-lab-1440.hello5xliving.workers.dev';
const LANG_KEY = 'site_lang';

const $ = (id) => document.getElementById(id);
const qs = (s, root = document) => root.querySelector(s);

function showErr(msg) {
  const e = $('error');
  if (!e) return;
  e.textContent = msg;
  e.style.display = 'block';
  setTimeout(() => {
    e.style.display = 'none';
  }, 5000);
}
function hideErr() {
  const e = $('error');
  if (!e) return;
  e.style.display = 'none';
  e.textContent = '';
}
function showAuthErr(msg) {
  const e = $('authError');
  if (!e) return;
  e.textContent = msg;
  e.style.display = 'block';
  setTimeout(() => {
    e.style.display = 'none';
  }, 5000);
}
function hideAuthErr() {
  const e = $('authError');
  if (!e) return;
  e.style.display = 'none';
  e.textContent = '';
}
function lock(el, v) {
  if (el) el.disabled = v;
}
function strongPwd(pw) {
  return (
    pw.length >= 8 &&
    /[A-Z]/.test(pw) &&
    /[a-z]/.test(pw) &&
    /[0-9]/.test(pw) &&
    /[^A-Za-z0-9]/.test(pw)
  );
}
function setText(id, v) {
  const el = $(id);
  if (el) el.textContent = v;
}
function setBar(el, pct) {
  if (el) el.style.width = Math.max(0, Math.min(100, pct)) + '%';
}

/* ================== å¤šè¯­è¨€ï¼ˆæ‰©å±•ï¼šå« zh-TW + Butler è¯æ¡ï¼‰ ================== */
const translations = {
  'zh-CN': {
    lang_label: 'è¯­è¨€',
    btn_register: 'æ³¨å†Œè´¦æˆ·',
    btn_login: 'ç™»å…¥è´¦æˆ·',
    btn_reset: 'ğŸ”‘ é‡è®¾å¯†ç ',
    note_price: 'æ³¨å†Œè´¦å·èµ é€ä¸€æ¬¡å…è´¹ä½“éªŒ',
    note_price1: '$9.9 / æœˆè´¹ VIPï¼ˆå‘½ç†ç©ºé—´ + å¿ƒæ€œç©ºé—´ + çµæ€§è¯¾ç¨‹ï¼‰',

    err_need_ep: 'è¯·è¾“å…¥é‚®ç®±ä¸å¯†ç ',
    err_pwd_rule: 'å¯†ç è‡³å°‘8ä½ï¼Œéœ€åŒ…å«å¤§å†™/å°å†™/æ•°å­—/ç‰¹æ®Šç¬¦å·',
    err_no_account: 'è´¦æˆ·ä¸å­˜åœ¨ï¼Œè¯·å…ˆæ³¨å†Œ',
    err_wrong_pwd: 'å¯†ç é”™è¯¯',
    err_expired: 'ä¼šå‘˜å·²è¿‡æœŸï¼Œè¯·ç»­è´¹',
    err_login_fail: 'ç™»å…¥å¤±è´¥ï¼š',
    err_register_fail: 'æ³¨å†Œå¤±è´¥ï¼š',
    err_email_empty: 'é‚®ç®±ä¸èƒ½ä¸ºç©º',
    err_pwd_empty: 'å¯†ç ä¸èƒ½ä¸ºç©º',
    err_reset_fail: 'é‡è®¾å¯†ç å¤±è´¥ï¼š',
    err_network: 'ç½‘ç»œå¼‚å¸¸',
    err_busy: 'æœåŠ¡æš‚æ—¶ç¹å¿™ï¼Œè¯·ç¨åé‡è¯•ã€‚',

    prompt_email: 'è¯·è¾“å…¥æ³¨å†Œé‚®ç®±ï¼š',
    prompt_newpwd: 'è¯·è¾“å…¥æ–°å¯†ç ï¼ˆè‡³å°‘8ä½ï¼Œå«å¤§å°å†™ã€æ•°å­—ã€ç¬¦å·ï¼‰ï¼š',

    btn_upgrade: 'ğŸ’ å‡çº§ä¸º VIPï¼ˆæœˆè´¹ï¼‰',
    btn_backshop: 'â† è¿”å›å‘½ç†å•†åŸ',

    vip_title: 'ğŸŒ™ ä¼šå‘˜åŒºåŸŸ VIP Segment',
    vip_mingli: 'ğŸ— å‘½ç†ç©ºé—´ä¸“å±å†…å®¹',
    vip_xinlian: 'ğŸŒ™ å¿ƒæ€œç©ºé—´ä¸“å±å†…å®¹',
    vip_love: 'å§»ç¼˜æ–¹å‘ï¼šæ‹çˆ±ç¼˜åˆ†ã€å©šå§»èµ°åŠ¿',
    vip_career: 'äº‹ä¸šæ–¹å‘ï¼šèŒåœºå‘å±•ã€åˆ›ä¸šæ½œåŠ›',
    vip_wealth: 'è´¢è¿æ–¹å‘ï¼šè´¢ä½åˆ†æã€ç†è´¢æ—¶æœº',
    vip_pet: 'å® ç‰©å‘½ç†ï¼šä¼´ä¾£åŠ¨ç‰©çš„æ€§æ ¼ä¸ç¼˜åˆ†',
    vip_hepan: 'åˆç›˜åˆ†æï¼šå©šæœŸæ‹©æ—¥ã€æ–°ç”Ÿæ‹©æ—¶',
    vip_name: 'æµ‹ååˆ†æï¼šå…¬å¸åã€å®å®åã€å‘½åæ”¹è¿',
    vip_fengshui: 'è´¢ä½åˆç›˜ï¼šä½å®¶ / åŠå…¬å®¤åŠ¨çº¿é…åˆ',
    vip_record: 'çµæ€§è®°å½•ï¼šç…§ç‰‡ã€æ¢¦å¢ƒã€å£°éŸ³ã€æ„¿æœ›ç¥ˆç¥·',
    vip_course: 'å‘½ç†è¯¾ç¨‹ï¼šå…«å­— / å¡”ç½— / å æ˜Ÿ / çµæ•° / äººç±»å›¾',
    vip_memorial: 'å®¶æ—çºªå¿µç³»ç»Ÿï¼šäº²äººçµæ€§çºªå¿µ & å»¶ç»­',
    vip_tasks: 'æ¯å‘¨èƒ½é‡ç»ƒä¹  / ç¥æ˜ä»ªå¼ä»»åŠ¡',
    vip_shop: 'èƒ½é‡å•†åŸä¸“å±æŠ˜æ‰£ & å¾¡å®ˆè®¢åˆ¶',
    login_title: 'ğŸ’ ç™»å…¥ VIP åŠŸèƒ½',

    chat_fab: 'é—®',
    chat_placeholder: 'è¯·é—®æ‚¨æƒ³äº†è§£ä»€ä¹ˆï¼Ÿï¼ˆå¦‚ï¼šå¦‚ä½•å¼€å§‹å…è´¹ä½“éªŒï¼‰',
    chat_send: 'å‘é€',
    butler_chat_title: 'å¿ƒæ€œç®¡å®¶ Â· Chat',

    msg_reset_ok: 'å¯†ç å·²æˆåŠŸæ›´æ–°ï¼Œè¯·ç”¨æ–°å¯†ç é‡æ–°ç™»å…¥ã€‚',

    ph_email: 'é‚®ç®± Email',
    ph_password: 'å¯†ç  Passwordï¼ˆè‡³å°‘8ä½ï¼Œå«å¤§å°å†™æ•°å­—ç¬¦å·ï¼‰',
    ph_label_password: 'å¯†ç  Password',

    title_quickcalc: 'å…«å­—å‘½ç† Â· å¿«é€Ÿæ’ç›˜',
    title_bazi_brief: 'å…«å­—ç®€è¯„',
    label_name: 'å§“åï¼ˆå¯é€‰ï¼‰',
    ph_name: 'ä½ çš„ç§°å‘¼ï¼ˆç”¨äºä¸ªæ€§åŒ–ï¼‰',
    gender_label: 'æ€§åˆ«',
    label_calendar: 'å†æ³•',
    label_birthdate: 'å‡ºç”Ÿæ—¥æœŸ',
    label_birthtime: 'å‡ºç”Ÿæ—¶é—´',
    cb_time_unknown: 'å‡ºç”Ÿæ—¶é—´ä¸è¯¦',
    btn_generate_chart: 'ç”Ÿæˆå…«å­—',
    panel_login_head: 'è´¦æˆ·ç™»å½• / æ³¨å†Œ',
    panel_member_head: 'ä¼šå‘˜æœåŠ¡',

    // ä¸‹æ‹‰é¡¹ï¼ˆæ€§åˆ« / å†æ³•ï¼‰
    opt_gender_confidential: 'ä¸é€éœ²',
    opt_gender_male: 'ç”·æ€§',
    opt_gender_female: 'å¥³æ€§',
    opt_cal_gregorian: 'é˜³å†',
    opt_cal_lunar: 'å†œå†',

    elements_balance_tpl: 'äº”è¡Œä¸­{max}å…ƒç´ æœ€å¼ºï¼Œ{min}å…ƒç´ æœ€å¼±ã€‚',

    // â€”â€” Butler / Report keysï¼ˆä¸­æ–‡ï¼‰ â€”â€”
    butler_title: 'å¿ƒæ€œç®¡å®¶ Â· è§£è¯»',
    day_master: 'æ—¥ä¸»',
    chart_strength: 'å‘½å±€',
    season: 'å­£èŠ‚',
    wuxing_distribution: 'äº”è¡Œåˆ†å¸ƒ',
    note: 'æ³¨æ„',
    time_unknown_checked: 'å·²å‹¾é€‰â€œå‡ºç”Ÿæ—¶é—´ä¸è¯¦â€',
    hour_pillar_excluded: 'æœªçº³å…¥æ—¶æŸ±',
    hint: 'æç¤º',
    no_hour_tip: 'æ— æ—¶æŸ±ï¼Œå»ºè®®ä»…ä½œå‚è€ƒã€‚',
    dev_strategy: 'å‘å±•ç­–ç•¥ï¼š',
    useful_elements: 'å–œç”¨å…ƒç´ ï¼š',
    lucky_colors: 'å¹¸è¿é¢œè‰²ï¼š',
    lucky_directions: 'é€‚åˆæ–¹ä½ï¼š',
    strength_strong: 'åå¼º',
    strength_weak: 'åå¼±',
    strength_balanced: 'å¹³è¡¡',

    // â€”â€” Butler AI èŠ¯ç‰‡ â€”â€”
    chip_career: 'äº‹ä¸šè§£è¯»',
    chip_love: 'æ„Ÿæƒ…å…³ç³»',
    chip_money: 'è´¢åŠ¡å»ºè®®',
    chip_list: 'æœ¬å‘¨æ‰§è¡Œæ¸…å•',
    chip_30d: '30å¤©è®¡åˆ’',
    q_career: 'ç»§ç»­è§£è¯»äº‹ä¸šä¸å›¢é˜Ÿåä½œ',
    q_love: 'è¯´è¯´æ„Ÿæƒ…ä¸é•¿æœŸå…³ç³»',
    q_money: 'ç»™æˆ‘è´¢åŠ¡ä¹ æƒ¯ã€ç›²åŒºä¸æ”¹å–„å»ºè®®',
    q_list: 'ç»™æˆ‘ä¸€ä»½æœ¬å‘¨å¯æ‰§è¡Œæ¸…å•',
    q_30d: 'ä¸ºæˆ‘å®šä¸€ä¸ª30å¤©æˆé•¿è®¡åˆ’',
    vip_tip: 'ğŸ”’ VIP è§£é”åå¯æŸ¥çœ‹å®Œæ•´è§£è¯»',
    vip_sub: 'åŒ…å«ã€Œäº‹ä¸š/è´¢å¯Œ/æ‰§è¡Œæ¸…å•/æ¸©æŸ”æé†’ã€å…¨éƒ¨ç« èŠ‚ä¸æŒç»­è¿½é—®',
    btn_unlock: 'ç«‹å³è§£é”',

    // æŠ¥å‘Šåˆ†æ®µ
    rpt_free_title: 'å…è´¹ç®€æŠ¥',
    rpt_pillars_label: 'å››æŸ±',
    rpt_daymaster_label: 'æ—¥ä¸»',
    rpt_season_label: 'å­£èŠ‚',
    rpt_chart_label: 'å‘½å±€',
    rpt_strategy_label: 'ç­–ç•¥',
    rpt_wuxing_label: 'äº”è¡Œåˆ†å¸ƒ',
    rpt_strongest_word: 'åæ—º',
    rpt_weakest_word: 'åå¼±',
    rpt_absent_prefix: 'ç¼ºï¼š',
    rpt_fav_avoid_template: 'å–œç”¨ï¼š{fav}ï½œå¿Œï¼š{avoid}',
    rpt_balance_focus_label: 'è°ƒè¡¡è¦ç‚¹',
    rpt_time_hint: 'æç¤ºï¼šå‡ºç”Ÿæ—¶é—´ä¸è¯¦ï¼Œæœªçº³å…¥æ—¶æŸ±ï¼Œä»…ä¾›å‚è€ƒã€‚',
    rpt_time_unknown: 'æ—¶é—´ä¸è¯¦',
    rpt_sec_overview_title: 'ä¸€ã€å‘½ç›˜æ€»è§ˆ',
    rpt_sec_elements_title: 'äºŒã€äº”è¡Œèƒ½é‡åˆ†æ',
    rpt_sec_traits_title: 'ä¸‰ã€æ€§æ ¼ä¸å¤©èµ‹',
    rpt_traits_intro: 'ä¾æ®æ—¥ä¸»ã€å­£èŠ‚ä¸å¼ºå¼±ç»™å‡ºæ ¸å¿ƒæ€§æ ¼æ ‡ç­¾ï¼ˆæ¨¡æ¿åŒ–å ä½ï¼‰ã€‚',
    rpt_traits_adv: 'ä¼˜åŠ¿èƒ½é‡ï¼šæ‰§è¡Œ / åˆ›é€  / å­¦ä¹ ï¼ˆæ¨¡æ¿åŒ–å ä½ï¼‰ã€‚',
    rpt_traits_chal: 'æ½œåœ¨æŒ‘æˆ˜ï¼šèŠ‚å¥ / è¾¹ç•Œ / è¿‡çŠ¹ä¸åŠï¼ˆæ¨¡æ¿åŒ–å ä½ï¼‰ã€‚',
    rpt_sec_structure_title: 'å››ã€æ ¼å±€ä¸å–œå¿Œ',
    rpt_structure_line_template: 'å–œç”¨ï¼š{fav}ï¼›å¿Œè®³ï¼š{avoid}',
    rpt_sec_career_title: 'äº”ã€äº‹ä¸šä¸å‘å±•ï¼ˆå…è´¹è¯•è¯»ï¼‰',
    rpt_career_fields_placeholder: 'é€‚åˆé¢†åŸŸï¼šç»“åˆå–œç”¨ä¸æ°”è´¨ï¼ˆæ¨¡æ¿åŒ–å ä½ï¼‰ã€‚',
    rpt_dev_strategy_prefix: 'å‘å±•ç­–ç•¥ï¼š',
    rpt_sec_love_title: 'å…­ã€æ„Ÿæƒ…ä¸å…³ç³»ï¼ˆå…è´¹è¯•è¯»ï¼‰',
    rpt_love_placeholder: 'æ²Ÿé€šèŠ‚å¥ä¸è¾¹ç•Œå»ºè®®ï¼ˆæ¨¡æ¿åŒ–å ä½ï¼‰ã€‚',
    rpt_sec_wealth_title: 'ä¸ƒã€è´¢å¯Œä¸ç†è´¢ï¼ˆå…è´¹è¯•è¯»ï¼‰',
    rpt_wealth_suggestion_template: 'ç†è´¢å»ºè®®ï¼šä»¥ {fav} ä¸ºä¸»è°ƒï¼Œç¨³ä¸­æ±‚è¿›ã€‚',
    rpt_sec_health_title: 'å…«ã€å¥åº·ä¸ä½œæ¯',
    rpt_health_placeholder_template: 'å›´ç»•æœ€å¼±äº”è¡Œï¼ˆ{weak}ï¼‰åšä½œæ¯ä¸ç¯å¢ƒä¼˜åŒ–ï¼ˆæ¨¡æ¿åŒ–å ä½ï¼‰ã€‚',
    rpt_sec_env_title: 'ä¹ã€ç¯å¢ƒä¸è‰²å½©',
    rpt_env_placeholder: 'æœ‰åˆ©æ–¹ä½ä¸é…è‰²éšå–œç”¨ï¼ˆæ¨¡æ¿åŒ–å ä½ï¼‰ã€‚',
    rpt_strategy_drain: 'æ³„ç§€/åˆ¶åŒ–',
    rpt_strategy_support: 'ç”Ÿæ‰¶/è¡¥åŠ©',
    rpt_strategy_balance: 'è°ƒå’Œ'
  },

  // â€”â€” ç¹ä½“ï¼ˆæ–°åŠ ï¼‰ â€”â€”
  'zh-TW': {
    lang_label: 'èªè¨€',
    btn_register: 'è¨»å†Šå¸³è™Ÿ',
    btn_login: 'ç™»å…¥å¸³è™Ÿ',
    btn_reset: 'ğŸ”‘ é‡è¨­å¯†ç¢¼',
    note_price: 'è¨»å†Šå¸³è™Ÿè´ˆé€ä¸€æ¬¡å…è²»é«”é©—',
    note_price1: '$9.9ï¼æœˆ VIPï¼ˆå‘½ç†ç©ºé–“ï¼‹å¿ƒæ†ç©ºé–“ï¼‹éˆæ€§èª²ç¨‹ï¼‰',

    err_need_ep: 'è«‹è¼¸å…¥é›»å­éƒµä»¶èˆ‡å¯†ç¢¼',
    err_pwd_rule: 'å¯†ç¢¼è‡³å°‘ 8 ç¢¼ï¼Œéœ€åŒ…å«å¤§å°å¯«ã€æ•¸å­—ã€ç¬¦è™Ÿ',
    err_no_account: 'æŸ¥ç„¡å¸³è™Ÿï¼Œè«‹å…ˆè¨»å†Š',
    err_wrong_pwd: 'å¯†ç¢¼ä¸æ­£ç¢º',
    err_expired: 'æœƒå“¡å·²åˆ°æœŸï¼Œè«‹çºŒè²»',
    err_login_fail: 'ç™»å…¥å¤±æ•—ï¼š',
    err_register_fail: 'è¨»å†Šå¤±æ•—ï¼š',
    err_email_empty: 'é›»å­éƒµä»¶ä¸èƒ½ç‚ºç©º',
    err_pwd_empty: 'å¯†ç¢¼ä¸èƒ½ç‚ºç©º',
    err_reset_fail: 'é‡è¨­å¤±æ•—ï¼š',
    err_network: 'ç¶²è·¯ç•°å¸¸',
    err_busy: 'æœå‹™ç¹å¿™ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚',

    prompt_email: 'è«‹è¼¸å…¥è¨»å†Šä¿¡ç®±ï¼š',
    prompt_newpwd: 'è«‹è¼¸å…¥æ–°å¯†ç¢¼ï¼ˆè‡³å°‘ 8 ç¢¼ï¼Œå«å¤§å°å¯«/æ•¸å­—/ç¬¦è™Ÿï¼‰ï¼š',

    btn_upgrade: 'ğŸ’ å‡ç´šç‚º VIPï¼ˆæœˆè²»ï¼‰',
    btn_backshop: 'â† è¿”å›å‘½ç†å•†åŸ',

    vip_title: 'ğŸŒ™ æœƒå“¡å€åŸŸ VIP Segment',
    vip_mingli: 'ğŸ— å‘½ç†ç©ºé–“å°ˆå±¬å…§å®¹',
    vip_xinlian: 'ğŸŒ™ å¿ƒæ†ç©ºé–“å°ˆå±¬å…§å®¹',
    vip_love: 'å§»ç·£æ–¹å‘ï¼šæˆ€æ„›ç·£åˆ†ã€å©šå§»èµ°å‹¢',
    vip_career: 'äº‹æ¥­æ–¹å‘ï¼šè·å ´ç™¼å±•ã€å‰µæ¥­æ½›åŠ›',
    vip_wealth: 'è²¡é‹æ–¹å‘ï¼šè²¡ä½åˆ†æã€ç†è²¡æ™‚æ©Ÿ',
    vip_pet: 'å¯µç‰©å‘½ç†ï¼šä¼´ä¾¶å‹•ç‰©çš„æ€§æ ¼èˆ‡ç·£åˆ†',
    vip_hepan: 'åˆç›¤åˆ†æï¼šå©šæœŸæ“‡æ—¥ã€æ–°ç”Ÿæ“‡æ™‚',
    vip_name: 'æ¸¬ååˆ†æï¼šå…¬å¸åã€å¯¶å¯¶åã€å‘½åæ”¹é‹',
    vip_fengshui: 'è²¡ä½åˆç›¤ï¼šä½å®¶ï¼è¾¦å…¬å®¤å‹•ç·šé…åˆ',
    vip_record: 'éˆæ€§è¨˜éŒ„ï¼šç…§ç‰‡ã€å¤¢å¢ƒã€è²éŸ³ã€é¡˜æœ›ç¥ˆç¦±',
    vip_course: 'å‘½ç†èª²ç¨‹ï¼šå…«å­—ï¼å¡”ç¾…ï¼å æ˜Ÿï¼éˆæ•¸ï¼äººé¡åœ–',
    vip_memorial: 'å®¶æ—ç´€å¿µç³»çµ±ï¼šè¦ªäººéˆæ€§ç´€å¿µï¼†å»¶çºŒ',
    vip_tasks: 'æ¯é€±èƒ½é‡ç·´ç¿’ï¼ç¥æ˜å„€å¼ä»»å‹™',
    vip_shop: 'èƒ½é‡å•†åŸå°ˆå±¬æŠ˜æ‰£ï¼†å¾¡å®ˆè¨‚è£½',
    login_title: 'ğŸ’ ç™»å…¥ VIP åŠŸèƒ½',

    chat_fab: 'å•',
    chat_placeholder: 'æƒ³äº†è§£ä»€éº¼ï¼Ÿï¼ˆå¦‚ï¼šå¦‚ä½•é–‹å§‹å…è²»é«”é©—ï¼‰',
    chat_send: 'å‚³é€',
    butler_chat_title: 'å¿ƒæ€œç®¡å®¶ Â· Chat',

    msg_reset_ok: 'å·²æ›´æ–°å¯†ç¢¼ï¼Œè«‹ä»¥æ–°å¯†ç¢¼ç™»å…¥ã€‚',

    ph_email: 'é›»å­éƒµä»¶',
    ph_password: 'å¯†ç¢¼ï¼ˆè‡³å°‘ 8 ç¢¼ï¼Œå«å¤§å°å¯«/æ•¸å­—/ç¬¦è™Ÿï¼‰',
    ph_label_password: 'å¯†ç¢¼',

    title_quickcalc: 'å…«å­—å‘½ç† Â· å¿«é€Ÿæ’ç›¤',
    title_bazi_brief: 'å…«å­—ç°¡è©•',
    label_name: 'å§“åï¼ˆé¸å¡«ï¼‰',
    ph_name: 'ä½ çš„ç¨±å‘¼ï¼ˆç”¨æ–¼å€‹äººåŒ–ï¼‰',
    gender_label: 'æ€§åˆ¥',
    label_calendar: 'æ›†æ³•',
    label_birthdate: 'å‡ºç”Ÿæ—¥æœŸ',
    label_birthtime: 'å‡ºç”Ÿæ™‚é–“',
    cb_time_unknown: 'å‡ºç”Ÿæ™‚é–“ä¸è©³',
    btn_generate_chart: 'ç”Ÿæˆå…«å­—',
    panel_login_head: 'å¸³è™Ÿç™»å…¥ï¼è¨»å†Š',
    panel_member_head: 'æœƒå“¡æœå‹™',

    opt_gender_confidential: 'ä¸é€éœ²',
    opt_gender_male: 'ç”·æ€§',
    opt_gender_female: 'å¥³æ€§',
    opt_cal_gregorian: 'é™½æ›†',
    opt_cal_lunar: 'è¾²æ›†',

    elements_balance_tpl: 'äº”è¡Œä¸­{max}å…ƒç´ æœ€å¼·ï¼Œ{min}å…ƒç´ æœ€å¼±ã€‚',

    butler_title: 'å¿ƒæ€œç®¡å®¶ Â· è§£è®€',

    chip_career: 'äº‹æ¥­è§£è®€',
    chip_love: 'æ„Ÿæƒ…é—œä¿‚',
    chip_money: 'è²¡å‹™å»ºè­°',
    chip_list: 'æœ¬é€±åŸ·è¡Œæ¸…å–®',
    chip_30d: '30å¤©è¨ˆç•«',
    q_career: 'ç¹¼çºŒè§£è®€äº‹æ¥­èˆ‡åœ˜éšŠå”ä½œ',
    q_love: 'èªªèªªæ„Ÿæƒ…èˆ‡é•·æœŸé—œä¿‚',
    q_money: 'çµ¦æˆ‘è²¡å‹™ç¿’æ…£ã€ç›²é»èˆ‡æ”¹å–„å»ºè­°',
    q_list: 'çµ¦æˆ‘ä¸€ä»½æœ¬é€±å¯åŸ·è¡Œæ¸…å–®',
    q_30d: 'ç‚ºæˆ‘è¨‚ä¸€å€‹30å¤©æˆé•·è¨ˆç•«',
    vip_tip: 'ğŸ”’ å‡ç´š VIP ä»¥æŸ¥çœ‹å®Œæ•´è§£è®€',
    vip_sub: 'åŒ…å«ã€Œäº‹æ¥­ï¼è²¡å¯Œï¼åŸ·è¡Œæ¸…å–®ï¼æº«æŸ”æé†’ã€æ‰€æœ‰ç« ç¯€èˆ‡æŒçºŒè¿½å•',
    btn_unlock: 'ç«‹å³è§£é–',

    rpt_free_title: 'å…è²»ç°¡å ±',
    rpt_pillars_label: 'å››æŸ±',
    rpt_daymaster_label: 'æ—¥ä¸»',
    rpt_season_label: 'å­£ç¯€',
    rpt_chart_label: 'å‘½å±€',
    rpt_strategy_label: 'ç­–ç•¥',
    rpt_wuxing_label: 'äº”è¡Œåˆ†ä½ˆ',
    rpt_strongest_word: 'åæ—º',
    rpt_weakest_word: 'åå¼±',
    rpt_absent_prefix: 'ç¼ºï¼š',
    rpt_balance_focus_label: 'èª¿è¡¡è¦é»',
    rpt_time_hint: 'æç¤ºï¼šå‡ºç”Ÿæ™‚é–“ä¸è©³ï¼Œæœªç´å…¥æ™‚æŸ±ï¼Œåƒ…ä¾›åƒè€ƒã€‚',
    rpt_time_unknown: 'æ™‚é–“ä¸è©³',
    rpt_sec_overview_title: 'ä¸€ã€å‘½ç›¤ç¸½è¦½',
    rpt_sec_elements_title: 'äºŒã€äº”è¡Œèƒ½é‡åˆ†æ',
    rpt_sec_traits_title: 'ä¸‰ã€æ€§æ ¼èˆ‡å¤©è³¦',
    rpt_traits_intro: 'ä¾æ“šæ—¥ä¸»ã€å­£ç¯€èˆ‡å¼·å¼±çµ¦å‡ºæ ¸å¿ƒæ€§æ ¼æ¨™ç±¤ï¼ˆå ä½ï¼‰ã€‚',
    rpt_traits_adv: 'å„ªå‹¢èƒ½é‡ï¼šåŸ·è¡Œï¼å‰µé€ ï¼å­¸ç¿’ï¼ˆå ä½ï¼‰ã€‚',
    rpt_traits_chal: 'æ½›åœ¨æŒ‘æˆ°ï¼šç¯€å¥ï¼é‚Šç•Œï¼éçŒ¶ä¸åŠï¼ˆå ä½ï¼‰ã€‚',
    rpt_sec_structure_title: 'å››ã€æ ¼å±€èˆ‡å–œå¿Œ',
    rpt_structure_line_template: 'å–œç”¨ï¼š{fav}ï¼›å¿Œè«±ï¼š{avoid}',
    rpt_sec_career_title: 'äº”ã€äº‹æ¥­èˆ‡ç™¼å±•ï¼ˆè©¦è®€ï¼‰',
    rpt_career_fields_placeholder: 'é©åˆé ˜åŸŸï¼ˆå ä½ï¼‰ã€‚',
    rpt_dev_strategy_prefix: 'ç™¼å±•ç­–ç•¥ï¼š',
    rpt_sec_love_title: 'å…­ã€æ„Ÿæƒ…èˆ‡é—œä¿‚ï¼ˆè©¦è®€ï¼‰',
    rpt_love_placeholder: 'æºé€šç¯€å¥èˆ‡é‚Šç•Œå»ºè­°ï¼ˆå ä½ï¼‰ã€‚',
    rpt_sec_wealth_title: 'ä¸ƒã€è²¡å¯Œèˆ‡ç†è²¡ï¼ˆè©¦è®€ï¼‰',
    rpt_wealth_suggestion_template: 'ç†è²¡å»ºè­°ï¼šä»¥ {fav} ç‚ºä¸»èª¿ï¼Œç©©ä¸­æ±‚é€²ã€‚',
    rpt_sec_health_title: 'å…«ã€å¥åº·èˆ‡ä½œæ¯',
    rpt_health_placeholder_template: 'åœç¹æœ€å¼±äº”è¡Œï¼ˆ{weak}ï¼‰åšä½œæ¯èˆ‡ç’°å¢ƒå„ªåŒ–ï¼ˆå ä½ï¼‰ã€‚',
    rpt_sec_env_title: 'ä¹ã€ç’°å¢ƒèˆ‡è‰²å½©',
    rpt_env_placeholder: 'æœ‰åˆ©æ–¹ä½èˆ‡é…è‰²éš¨å–œç”¨ï¼ˆå ä½ï¼‰ã€‚',
    rpt_strategy_drain: 'æ´©ç§€/åˆ¶åŒ–',
    rpt_strategy_support: 'ç”Ÿæ‰¶/è£œåŠ©',
    rpt_strategy_balance: 'èª¿å’Œ'
  },

  'en': {
    lang_label: 'Language',
    btn_register: 'Create Account',
    btn_login: 'Log in',
    btn_reset: 'ğŸ”‘ Reset Password',
    note_price: 'New account gets one free trial.',
    note_price1: '$9.9 / month Â· VIP (Astro + Soul + Courses)',

    err_need_ep: 'Enter email and password',
    err_pwd_rule: 'Password must be 8+ and include upper/lowercase, number, symbol',
    err_no_account: 'Account not found. Please register first.',
    err_wrong_pwd: 'Incorrect password',
    err_expired: 'Membership expired. Please renew.',
    err_login_fail: 'Login failed: ',
    err_register_fail: 'Registration failed: ',
    err_email_empty: 'Email cannot be empty',
    err_pwd_empty: 'Password cannot be empty',
    err_reset_fail: 'Password reset failed: ',
    err_network: 'Network error',
    err_busy: 'Service is busy. Please try again later.',

    prompt_email: 'Enter your registered email:',
    prompt_newpwd: 'Enter a new password (8+, upper/lower/digit/symbol):',

    btn_upgrade: 'ğŸ’ Upgrade to VIP (Monthly)',
    btn_backshop: 'â† Back to Store',

    vip_title: 'ğŸŒ™ VIP Segment',
    vip_mingli: 'ğŸ— Astro Sanctuary Â· Exclusive',
    vip_xinlian: 'ğŸŒ™ Soul Sanctuary Â· Exclusive',
    vip_love: 'Love: Dating Fate, Marriage Trend',
    vip_career: 'Career: Workplace, Entrepreneurship',
    vip_wealth: 'Wealth: Wealth Position, Timing',
    vip_pet: 'Pet Destiny: Temperament & Bond',
    vip_hepan: 'Synastry: Wedding Dates, Birthtime',
    vip_name: 'Name Reading: Company/Baby/Renaming',
    vip_fengshui: 'Wealth & Layout: Home / Office',
    vip_record: 'Spiritual Logs: Photos, Dreams, Voice, Prayers',
    vip_course: 'Courses: Bazi / Tarot / Astrology / Numerology / Human Design',
    vip_memorial: 'Family Memorial: Spiritual Archive & Legacy',
    vip_tasks: 'Weekly Energy Practices / Divine Ritual Tasks',
    vip_shop: 'Store Discounts & Omamori',
    login_title: 'ğŸ’ VIP Login',

    chat_fab: 'Chat',
    chat_placeholder: 'What would you like to know? (e.g., how to start the free trial)',
    chat_send: 'Send',
    butler_chat_title: 'Xinlian Butler Â· Chat',

    msg_reset_ok: 'Password updated. Please log in with the new one.',

    ph_email: 'Email',
    ph_password: 'Password (8+, upper/lower/digit/symbol)',
    ph_label_password: 'Password',

    title_quickcalc: 'Bazi Â· Quick Chart',
    title_bazi_brief: 'Bazi Quick Reading',
    label_name: 'Name (optional)',
    ph_name: 'Your name (for personalization)',
    gender_label: 'Gender',
    label_calendar: 'Calendar',
    label_birthdate: 'Birth Date',
    label_birthtime: 'Birth Time',
    cb_time_unknown: 'Birth time unknown',
    btn_generate_chart: 'Generate Chart',
    panel_login_head: 'Account Login / Sign-up',
    panel_member_head: 'Membership Services',

    opt_gender_confidential: 'Confidential',
    opt_gender_male: 'Male',
    opt_gender_female: 'Female',
    opt_cal_gregorian: 'Gregorian',
    opt_cal_lunar: 'Lunar',

    elements_balance_tpl: 'Strongest: {max} Â· Weakest: {min}',

    butler_title: 'Xinlian Butler Â· Insight',

    chip_career: 'Career',
    chip_love: 'Relationships',
    chip_money: 'Money Advice',
    chip_list: 'Weekly To-Dos',
    chip_30d: '30-Day Plan',
    q_career: 'Continue with career and teamwork insights',
    q_love: 'Talk about love and long-term relationships',
    q_money: 'Give me money habits, blind spots and improvements',
    q_list: 'Give me an actionable list for this week',
    q_30d: 'Make me a 30-day growth plan',
    vip_tip: 'ğŸ”’ Unlock VIP to read the full analysis',
    vip_sub: 'Includes all sections: Career / Wealth / Action List / Gentle Reminder, plus follow-ups',
    btn_unlock: 'Unlock now',

    rpt_free_title: 'Free Summary',
    rpt_pillars_label: 'Pillars',
    rpt_daymaster_label: 'Day Master',
    rpt_season_label: 'Season',
    rpt_chart_label: 'Chart',
    rpt_strategy_label: 'Strategy',
    rpt_wuxing_label: 'Five Elements',
    rpt_strongest_word: 'strongest',
    rpt_weakest_word: 'weakest',
    rpt_absent_prefix: 'Absent: ',
    rpt_balance_focus_label: 'Balance focus',
    rpt_time_hint: 'Note: birth time unknown; hour pillar excludedâ€”use as reference only.',
    rpt_time_unknown: 'Unknown time',
    rpt_sec_overview_title: '1) Overview',
    rpt_sec_elements_title: '2) Element Analysis',
    rpt_sec_traits_title: '3) Traits & Talents',
    rpt_traits_intro: 'Core trait tags based on DM, season, and strength (placeholder).',
    rpt_traits_adv: 'Advantages: Execution / Creativity / Learning (placeholder).',
    rpt_traits_chal: 'Challenges: Pace / Boundaries (placeholder).',
    rpt_sec_structure_title: '4) Structure & Preferences',
    rpt_structure_line_template: 'Favorable: {fav}; Avoid: {avoid}',
    rpt_sec_career_title: '5) Career (sample)',
    rpt_career_fields_placeholder: 'Suitable fields (placeholder).',
    rpt_dev_strategy_prefix: 'Development strategy: ',
    rpt_sec_love_title: '6) Love (sample)',
    rpt_love_placeholder: 'Communication tempo & boundaries (placeholder).',
    rpt_sec_wealth_title: '7) Wealth (sample)',
    rpt_wealth_suggestion_template: 'Wealth tip: prefer flows aligned with {fav}.',
    rpt_sec_health_title: '8) Health',
    rpt_health_placeholder_template: 'Care for weakest element: {weak}.',
    rpt_sec_env_title: '9) Environment & Colors',
    rpt_env_placeholder: 'Favorable directions & palette follow your favorable elements.',
    rpt_strategy_drain: 'Drain/Control',
    rpt_strategy_support: 'Support/Nourish',
    rpt_strategy_balance: 'Balance'
  },

  'ja': {
    lang_label: 'è¨€èª',
    btn_register: 'ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ',
    btn_login: 'ãƒ­ã‚°ã‚¤ãƒ³',
    btn_reset: 'ğŸ”‘ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ãƒªã‚»ãƒƒãƒˆ',
    note_price: 'æ–°è¦ç™»éŒ²ã§ç„¡æ–™ä½“é¨“ã‚’1å›ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆ',
    note_price1: '$9.9ï¼æœˆ VIPï¼ˆå‘½ç†ã‚¹ãƒšãƒ¼ã‚¹ï¼‹å¿ƒæ€œã‚¹ãƒšãƒ¼ã‚¹ï¼‹ã‚¹ãƒ”ãƒªãƒãƒ¥ã‚¢ãƒ«è¬›åº§ï¼‰',

    err_need_ep: 'ãƒ¡ãƒ¼ãƒ«ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„',
    err_pwd_rule: 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯8æ–‡å­—ä»¥ä¸Šã§ã€å¤§æ–‡å­—/å°æ–‡å­—/æ•°å­—/è¨˜å·ã‚’å«ã‚ã¦ãã ã•ã„',
    err_no_account: 'ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚å…ˆã«ç™»éŒ²ã—ã¦ãã ã•ã„',
    err_wrong_pwd: 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“',
    err_expired: 'ä¼šå“¡æœŸé™ãŒåˆ‡ã‚Œã¾ã—ãŸã€‚æ›´æ–°ã—ã¦ãã ã•ã„',
    err_login_fail: 'ãƒ­ã‚°ã‚¤ãƒ³å¤±æ•—ï¼š',
    err_register_fail: 'ç™»éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸï¼š',
    err_email_empty: 'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„',
    err_pwd_empty: 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„',
    err_reset_fail: 'ãƒªã‚»ãƒƒãƒˆã«å¤±æ•—ï¼š',
    err_network: 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼',
    err_busy: 'æ··ã¿åˆã£ã¦ã„ã¾ã™ã€‚ã—ã°ã‚‰ãã—ã¦ã‹ã‚‰ãŠè©¦ã—ãã ã•ã„ã€‚',

    prompt_email: 'ç™»éŒ²ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼š',
    prompt_newpwd: 'æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ï¼ˆ8æ–‡å­—ä»¥ä¸Šãƒ»å¤§/å°/æ•°å­—/è¨˜å·ï¼‰ï¼š',

    btn_upgrade: 'ğŸ’ VIPï¼ˆæœˆé¡ï¼‰ã«ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰',
    btn_backshop: 'â† ã‚¹ãƒˆã‚¢ã«æˆ»ã‚‹',

    vip_title: 'ğŸŒ™ VIP ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ',
    vip_mingli: 'ğŸ— å‘½ç†ã‚¹ãƒšãƒ¼ã‚¹ï¼ˆä¼šå“¡å°‚ç”¨ï¼‰',
    vip_xinlian: 'ğŸŒ™ å¿ƒæ€œã‚¹ãƒšãƒ¼ã‚¹ï¼ˆä¼šå“¡å°‚ç”¨ï¼‰',
    vip_love: 'ç¸çµã³ï¼šæ‹æ„›é‹ãƒ»çµå©šé‹',
    vip_career: 'ã‚­ãƒ£ãƒªã‚¢ï¼šè·å ´ç™ºå±•ãƒ»èµ·æ¥­ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«',
    vip_wealth: 'è²¡é‹ï¼šè²¡ä½åˆ†æãƒ»ã‚¿ã‚¤ãƒŸãƒ³ã‚°',
    vip_pet: 'ãƒšãƒƒãƒˆå‘½ç†ï¼šæ€§æ ¼ã¨ã”ç¸',
    vip_hepan: 'åˆç›¤ï¼šçµå©šæ—¥ãƒ»å‡ºç”Ÿæ™‚åˆ»',
    vip_name: 'å‘½åé‘‘å®šï¼šç¤¾åãƒ»èµ¤ã¡ã‚ƒã‚“åãƒ»æ”¹å',
    vip_fengshui: 'è²¡ä½ã¨ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼šä½å±… / ã‚ªãƒ•ã‚£ã‚¹',
    vip_record: 'ã‚¹ãƒ”ãƒªãƒãƒ¥ã‚¢ãƒ«è¨˜éŒ²ï¼šå†™çœŸãƒ»å¤¢ãƒ»å£°ãƒ»ç¥ˆã‚Š',
    vip_course: 'è¬›åº§ï¼šå…«å­— / ã‚¿ãƒ­ãƒƒãƒˆ / å æ˜Ÿ / æ•°ç§˜ / ãƒ’ãƒ¥ãƒ¼ãƒãƒ³ãƒ‡ã‚¶ã‚¤ãƒ³',
    vip_memorial: 'å®¶æ—ãƒ¡ãƒ¢ãƒªã‚¢ãƒ«ï¼šéœŠçš„ã‚¢ãƒ¼ã‚«ã‚¤ãƒ– & ç¶™æ‰¿',
    vip_tasks: 'æ¯é€±ã®ã‚¨ãƒŠã‚¸ãƒ¼ãƒ¯ãƒ¼ã‚¯ / ç¥äº‹ã‚¿ã‚¹ã‚¯',
    vip_shop: 'ã‚¹ãƒˆã‚¢å‰²å¼• & å¾¡å®ˆã‚Š',
    login_title: 'ğŸ’ VIP ãƒ­ã‚°ã‚¤ãƒ³',

    chat_fab: 'å•',
    chat_placeholder: 'ä½•ã‚’çŸ¥ã‚ŠãŸã„ã§ã™ã‹ï¼Ÿï¼ˆä¾‹ï¼šç„¡æ–™ä½“é¨“ã®å§‹ã‚æ–¹ï¼‰',
    chat_send: 'é€ä¿¡',
    butler_chat_title: 'å¿ƒæ€œãƒãƒˆãƒ©ãƒ¼ Â· ãƒãƒ£ãƒƒãƒˆ',

    msg_reset_ok: 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„ã€‚',

    ph_email: 'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹',
    ph_password: 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆ8æ–‡å­—ä»¥ä¸Šãƒ»å¤§/å°/æ•°å­—/è¨˜å·ï¼‰',
    ph_label_password: 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰',

    title_quickcalc: 'å…«å­— Â· ã‚¯ã‚¤ãƒƒã‚¯ãƒãƒ£ãƒ¼ãƒˆ',
    title_bazi_brief: 'å…«å­—ç°¡è©•',
    label_name: 'åå‰ï¼ˆä»»æ„ï¼‰',
    ph_name: 'ã‚ãªãŸã®å‘¼ç§°ï¼ˆãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºç”¨ï¼‰',
    gender_label: 'æ€§åˆ¥',
    label_calendar: 'æš¦æ³•',
    label_birthdate: 'ç”Ÿå¹´æœˆæ—¥',
    label_birthtime: 'å‡ºç”Ÿæ™‚é–“',
    cb_time_unknown: 'å‡ºç”Ÿæ™‚é–“ãŒä¸æ˜',
    btn_generate_chart: 'å‘½ç›¤ã‚’ç”Ÿæˆ',
    panel_login_head: 'ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ ãƒ­ã‚°ã‚¤ãƒ³ / ç™»éŒ²',
    panel_member_head: 'ä¼šå“¡ã‚µãƒ¼ãƒ“ã‚¹',

    opt_gender_confidential: 'éå…¬é–‹',
    opt_gender_male: 'ç”·æ€§',
    opt_gender_female: 'å¥³æ€§',
    opt_cal_gregorian: 'å¤ªé™½æš¦',
    opt_cal_lunar: 'æ—§æš¦',

    elements_balance_tpl: '{max}ãŒæœ€ã‚‚å¼·ãã€{min}ãŒæœ€ã‚‚å¼±ã„ã€‚',

    butler_title: 'å¿ƒæ€œãƒãƒˆãƒ©ãƒ¼ Â· ã‚¤ãƒ³ã‚µã‚¤ãƒˆ',

    chip_career: 'ã‚­ãƒ£ãƒªã‚¢',
    chip_love: 'äººé–“é–¢ä¿‚',
    chip_money: 'ãŠé‡‘ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹',
    chip_list: 'ä»Šé€±ã®ã‚¿ã‚¹ã‚¯',
    chip_30d: '30æ—¥ãƒ—ãƒ©ãƒ³',
    q_career: 'ã‚­ãƒ£ãƒªã‚¢ã‚„ãƒãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®æ´å¯Ÿã‚’ç¶šã‘ã¦',
    q_love: 'æ‹æ„›ã‚„é•·æœŸçš„ãªé–¢ä¿‚ã«ã¤ã„ã¦',
    q_money: 'é‡‘éŠ­ç¿’æ…£ãƒ»ç›²ç‚¹ãƒ»æ”¹å–„æ¡ˆã‚’æ•™ãˆã¦',
    q_list: 'ä»Šé€±ã®å®Ÿè¡Œãƒªã‚¹ãƒˆã‚’ä½œã£ã¦',
    q_30d: '30æ—¥é–“ã®æˆé•·ãƒ—ãƒ©ãƒ³ã‚’ä½œã£ã¦',
    vip_tip: 'ğŸ”’ VIPã§å…¨æ–‡è¡¨ç¤ºã‚’è§£æ”¾',
    vip_sub: 'ã‚­ãƒ£ãƒªã‚¢ï¼é‡‘éŠ­ï¼è¡Œå‹•ãƒªã‚¹ãƒˆï¼å„ªã—ã„ãƒªãƒã‚¤ãƒ³ãƒ‰ã®å…¨ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼‹è¿½è³ªå•',
    btn_unlock: 'ä»Šã™ãè§£æ”¾',

    rpt_free_title: 'ç„¡æ–™ã‚µãƒãƒªãƒ¼',
    rpt_pillars_label: 'å››æŸ±',
    rpt_daymaster_label: 'æ—¥ä¸»',
    rpt_season_label: 'å­£ç¯€',
    rpt_chart_label: 'ãƒãƒ£ãƒ¼ãƒˆ',
    rpt_strategy_label: 'æˆ¦ç•¥',
    rpt_wuxing_label: 'äº”è¡Œ',
    rpt_strongest_word: 'ãŒæœ€å¼·',
    rpt_weakest_word: 'ãŒæœ€å¼±',
    rpt_absent_prefix: 'æ¬ ï¼š',
    rpt_balance_focus_label: 'ãƒãƒ©ãƒ³ã‚¹ã®ç„¦ç‚¹',
    rpt_time_hint: 'æ³¨ï¼šå‡ºç”Ÿæ™‚é–“ä¸æ˜ã®ãŸã‚æ™‚æŸ±ã¯é™¤å¤–ã€‚å‚è€ƒã¨ã—ã¦ã”åˆ©ç”¨ãã ã•ã„ã€‚',
    rpt_time_unknown: 'æ™‚é–“ä¸æ˜',
    rpt_sec_overview_title: '1ï¼‰æ¦‚è¦',
    rpt_sec_elements_title: '2ï¼‰äº”è¡Œã®åˆ†æ',
    rpt_sec_traits_title: '3ï¼‰æ€§è³ªã¨æ‰èƒ½',
    rpt_traits_intro: 'æ—¥ä¸»ãƒ»å­£ç¯€ãƒ»å¼·å¼±ã«åŸºã¥ãã‚³ã‚¢ç‰¹æ€§ã‚¿ã‚°ï¼ˆãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ï¼‰ã€‚',
    rpt_traits_adv: 'å¼·ã¿ï¼šå®Ÿè¡Œ / ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ“ãƒ†ã‚£ / å­¦ç¿’ï¼ˆãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ï¼‰ã€‚',
    rpt_traits_chal: 'èª²é¡Œï¼šãƒšãƒ¼ã‚¹ / å¢ƒç•Œ / è¡Œãéãï¼ˆãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ï¼‰ã€‚',
    rpt_sec_structure_title: '4ï¼‰æ ¼å±€ã¨å–œå¿Œ',
    rpt_structure_line_template: 'æœ‰åˆ©ï¼š{fav}ï¼›ä¸åˆ©ï¼š{avoid}',
    rpt_sec_career_title: '5ï¼‰ã‚­ãƒ£ãƒªã‚¢ï¼ˆè©¦èª­ï¼‰',
    rpt_career_fields_placeholder: 'é©æ€§åˆ†é‡ï¼ˆãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ï¼‰ã€‚',
    rpt_dev_strategy_prefix: 'ç™ºå±•æˆ¦ç•¥ï¼š',
    rpt_sec_love_title: '6ï¼‰æ‹æ„›ï¼ˆè©¦èª­ï¼‰',
    rpt_love_placeholder: 'ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ†ãƒ³ãƒã¨å¢ƒç•Œï¼ˆãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ï¼‰ã€‚',
    rpt_sec_wealth_title: '7ï¼‰è²¡é‹ï¼ˆè©¦èª­ï¼‰',
    rpt_wealth_suggestion_template: 'è³‡ç”£ã‚¢ãƒ‰ãƒã‚¤ã‚¹ï¼š{fav}ã‚’åŸºèª¿ã«ã€å …å®Ÿã«ã€‚',
    rpt_sec_health_title: '8ï¼‰å¥åº·ã¨ç”Ÿæ´»',
    rpt_health_placeholder_template: 'æœ€å¼±ã®äº”è¡Œï¼ˆ{weak}ï¼‰ã‚’æ„è­˜ã—ãŸç”Ÿæ´»ã¨ç’°å¢ƒæœ€é©åŒ–ï¼ˆãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ï¼‰ã€‚',
    rpt_sec_env_title: '9ï¼‰ç’°å¢ƒã¨è‰²å½©',
    rpt_env_placeholder: 'å‰æ–¹ä½ã¨é…è‰²ã¯å–œç”¨ã«å¾“ã„ã¾ã™ã€‚',
    rpt_strategy_drain: 'æ´©ã‚‰ã™/åˆ¶å¾¡',
    rpt_strategy_support: 'æ‰¶ã‘ã‚‹/è£œåŠ©',
    rpt_strategy_balance: 'èª¿å’Œ'
  },

  'th': {
    lang_label: 'à¸ à¸²à¸©à¸²',
    btn_register: 'à¸ªà¸¡à¸±à¸„à¸£à¸šà¸±à¸à¸Šà¸µ',
    btn_login: 'à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š',
    btn_reset: 'ğŸ”‘ à¸£à¸µà¹€à¸‹à¹‡à¸•à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™',
    note_price: 'à¸ªà¸¡à¸±à¸„à¸£à¹ƒà¸«à¸¡à¹ˆà¸£à¸±à¸šà¸ªà¸´à¸—à¸˜à¸´à¹Œà¸—à¸”à¸¥à¸­à¸‡à¸Ÿà¸£à¸µ 1 à¸„à¸£à¸±à¹‰à¸‡',
    note_price1: '$9.9 / à¹€à¸”à¸·à¸­à¸™ Â· VIP (à¹‚à¸«à¸£à¸²à¸¨à¸²à¸ªà¸•à¸£à¹Œ + à¸ˆà¸´à¸•à¸§à¸´à¸à¸à¸²à¸“ + à¸„à¸­à¸£à¹Œà¸ªà¹€à¸£à¸µà¸¢à¸™)',

    err_need_ep: 'à¸à¸£à¸¸à¸“à¸²à¸à¸£à¸­à¸à¸­à¸µà¹€à¸¡à¸¥à¹à¸¥à¸°à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™',
    err_pwd_rule:
      'à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™à¸­à¸¢à¹ˆà¸²à¸‡à¸™à¹‰à¸­à¸¢ 8 à¸•à¸±à¸§ à¸•à¹‰à¸­à¸‡à¸¡à¸µà¸•à¸±à¸§à¸à¸´à¸¡à¸à¹Œà¹ƒà¸«à¸à¹ˆ/à¹€à¸¥à¹‡à¸ à¸•à¸±à¸§à¹€à¸¥à¸‚ à¹à¸¥à¸°à¸ªà¸±à¸à¸¥à¸±à¸à¸©à¸“à¹Œ',
    err_no_account: 'à¹„à¸¡à¹ˆà¸à¸šà¸šà¸±à¸à¸Šà¸µ à¸à¸£à¸¸à¸“à¸²à¸ªà¸¡à¸±à¸„à¸£à¸à¹ˆà¸­à¸™',
    err_wrong_pwd: 'à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™à¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡',
    err_expired: 'à¸ªà¸¡à¸²à¸Šà¸´à¸à¸«à¸¡à¸”à¸­à¸²à¸¢à¸¸ à¸à¸£à¸¸à¸“à¸²à¸•à¹ˆà¸­à¸­à¸²à¸¢à¸¸',
    err_login_fail: 'à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸šà¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§: ',
    err_register_fail: 'à¸ªà¸¡à¸±à¸„à¸£à¸ªà¸¡à¸²à¸Šà¸´à¸à¹„à¸¡à¹ˆà¸ªà¸³à¹€à¸£à¹‡à¸ˆ: ',
    err_email_empty: 'à¸­à¸µà¹€à¸¡à¸¥à¸«à¹‰à¸²à¸¡à¸§à¹ˆà¸²à¸‡',
    err_pwd_empty: 'à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™à¸«à¹‰à¸²à¸¡à¸§à¹ˆà¸²à¸‡',
    err_reset_fail: 'à¸£à¸µà¹€à¸‹à¹‡à¸•à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™à¹„à¸¡à¹ˆà¸ªà¸³à¹€à¸£à¹‡à¸ˆ: ',
    err_network: 'à¹€à¸„à¸£à¸·à¸­à¸‚à¹ˆà¸²à¸¢à¸œà¸´à¸”à¸à¸¥à¸²à¸”',
    err_busy: 'à¸£à¸°à¸šà¸šà¸«à¸™à¸²à¹à¸™à¹ˆà¸™ à¹‚à¸›à¸£à¸”à¸¥à¸­à¸‡à¹ƒà¸«à¸¡à¹ˆà¸ à¸²à¸¢à¸«à¸¥à¸±à¸‡',

    prompt_email: 'à¸à¸£à¸¸à¸“à¸²à¸à¸£à¸­à¸à¸­à¸µà¹€à¸¡à¸¥à¸—à¸µà¹ˆà¸ªà¸¡à¸±à¸„à¸£à¹„à¸§à¹‰:',
    prompt_newpwd:
      'à¸à¸£à¸­à¸à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™à¹ƒà¸«à¸¡à¹ˆ (à¸­à¸¢à¹ˆà¸²à¸‡à¸™à¹‰à¸­à¸¢ 8 à¸•à¸±à¸§ à¸¡à¸µà¸•à¸±à¸§à¸à¸´à¸¡à¸à¹Œà¹ƒà¸«à¸à¹ˆ/à¹€à¸¥à¹‡à¸ à¸•à¸±à¸§à¹€à¸¥à¸‚ à¹à¸¥à¸°à¸ªà¸±à¸à¸¥à¸±à¸à¸©à¸“à¹Œ):',

    btn_upgrade: 'ğŸ’ à¸­à¸±à¸›à¹€à¸à¸£à¸”à¹€à¸›à¹‡à¸™ VIP (à¸£à¸²à¸¢à¹€à¸”à¸·à¸­à¸™)',
    btn_backshop: 'â† à¸à¸¥à¸±à¸šà¹„à¸›à¸¢à¸±à¸‡à¸£à¹‰à¸²à¸™à¸„à¹‰à¸²',

    vip_title: 'ğŸŒ™ à¹‚à¸‹à¸™à¸ªà¸¡à¸²à¸Šà¸´à¸ VIP',
    vip_mingli: 'ğŸ— à¸«à¹‰à¸­à¸‡à¹‚à¸«à¸£à¸²à¸¨à¸²à¸ªà¸•à¸£à¹Œ Â· à¹€à¸‰à¸à¸²à¸°à¸ªà¸¡à¸²à¸Šà¸´à¸',
    vip_xinlian: 'ğŸŒ™ à¸«à¹‰à¸­à¸‡à¸ˆà¸´à¸•à¸§à¸´à¸à¸à¸²à¸“ Â· à¹€à¸‰à¸à¸²à¸°à¸ªà¸¡à¸²à¸Šà¸´à¸',
    vip_love: 'à¸„à¸§à¸²à¸¡à¸£à¸±à¸: à¸”à¸§à¸‡à¸„à¸§à¸²à¸¡à¸£à¸±à¸ à¹à¸™à¸§à¹‚à¸™à¹‰à¸¡à¸à¸²à¸£à¹à¸•à¹ˆà¸‡à¸‡à¸²à¸™',
    vip_career: 'à¸à¸²à¸£à¸‡à¸²à¸™: à¹€à¸ªà¹‰à¸™à¸—à¸²à¸‡à¸­à¸²à¸Šà¸µà¸/à¸œà¸¹à¹‰à¸›à¸£à¸°à¸à¸­à¸šà¸à¸²à¸£',
    vip_wealth: 'à¸à¸²à¸£à¹€à¸‡à¸´à¸™: à¸—à¸³à¹€à¸¥à¸—à¸£à¸±à¸à¸¢à¹Œ à¹€à¸§à¸¥à¸²à¹€à¸«à¸¡à¸²à¸°à¸ªà¸¡',
    vip_pet: 'à¸”à¸§à¸‡à¸ªà¸±à¸•à¸§à¹Œà¹€à¸¥à¸µà¹‰à¸¢à¸‡: à¸™à¸´à¸ªà¸±à¸¢ & à¸„à¸§à¸²à¸¡à¸œà¸¹à¸à¸à¸±à¸™',
    vip_hepan: 'à¸”à¸§à¸‡à¸„à¸¹à¹ˆ/à¸¤à¸à¸©à¹Œ: à¸§à¸±à¸™à¹à¸•à¹ˆà¸‡à¸‡à¸²à¸™ à¹€à¸§à¸¥à¸²à¹€à¸à¸´à¸”à¸—à¸²à¸£à¸',
    vip_name: 'à¸•à¸±à¹‰à¸‡à¸Šà¸·à¹ˆà¸­: à¸šà¸£à¸´à¸©à¸±à¸—/à¸—à¸²à¸£à¸/à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸Šà¸·à¹ˆà¸­',
    vip_fengshui: 'à¸®à¸§à¸‡à¸ˆà¸¸à¹‰à¸¢à¸—à¸£à¸±à¸à¸¢à¹Œ: à¸šà¹‰à¸²à¸™ / à¸ªà¸³à¸™à¸±à¸à¸‡à¸²à¸™',
    vip_record: 'à¸šà¸±à¸™à¸—à¸¶à¸à¸—à¸²à¸‡à¸ˆà¸´à¸•à¸§à¸´à¸à¸à¸²à¸“: à¸£à¸¹à¸› à¸à¸±à¸™ à¹€à¸ªà¸µà¸¢à¸‡ à¸„à¸³à¸­à¸˜à¸´à¸©à¸à¸²à¸™',
    vip_course:
      'à¸„à¸­à¸£à¹Œà¸ªà¹€à¸£à¸µà¸¢à¸™: à¸›à¸²à¸ˆà¸·à¹ˆà¸­ / à¸—à¸²à¹‚à¸£à¸•à¹Œ / à¹‚à¸«à¸£à¸²à¸¨à¸²à¸ªà¸•à¸£à¹Œ / à¸•à¸±à¸§à¹€à¸¥à¸‚ / à¸®à¸´à¸§à¹à¸¡à¸™à¸”à¸µà¹„à¸‹à¸™à¹Œ',
    vip_memorial: 'à¸šà¸±à¸™à¸—à¸¶à¸à¸„à¸£à¸­à¸šà¸„à¸£à¸±à¸§: à¸­à¸™à¸¸à¸ªà¸£à¸“à¹Œà¸§à¸´à¸à¸à¸²à¸“ & à¸¡à¸£à¸”à¸à¹ƒà¸ˆ',
    vip_tasks: 'à¸à¸²à¸£à¸à¸¶à¸à¸à¸¥à¸±à¸‡à¸£à¸²à¸¢à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œ / à¸à¸´à¸˜à¸µà¸à¸£à¸£à¸¡à¹€à¸—à¸',
    vip_shop: 'à¸ªà¹ˆà¸§à¸™à¸¥à¸”à¸£à¹‰à¸²à¸™à¸„à¹‰à¸² & à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸£à¸²à¸‡',
    login_title: 'ğŸ’ à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š VIP',

    chat_fab: 'à¸–à¸²à¸¡',
    chat_placeholder: 'à¸­à¸¢à¸²à¸à¸—à¸£à¸²à¸šà¹€à¸£à¸·à¹ˆà¸­à¸‡à¹ƒà¸”? (à¹€à¸Šà¹ˆà¸™ à¹€à¸£à¸´à¹ˆà¸¡à¸—à¸”à¸¥à¸­à¸‡à¸Ÿà¸£à¸µà¸­à¸¢à¹ˆà¸²à¸‡à¹„à¸£)',
    chat_send: 'à¸ªà¹ˆà¸‡',
    butler_chat_title: 'à¸œà¸¹à¹‰à¸Šà¹ˆà¸§à¸¢à¸‹à¸´à¸™à¹€à¸«à¸¥à¸µà¸¢à¸™ Â· à¹à¸Šà¸•',

    msg_reset_ok: 'à¸­à¸±à¸›à¹€à¸”à¸•à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™à¹à¸¥à¹‰à¸§ à¸à¸£à¸¸à¸“à¸²à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸šà¸”à¹‰à¸§à¸¢à¸£à¸«à¸±à¸ªà¹ƒà¸«à¸¡à¹ˆ',

    ph_email: 'à¸­à¸µà¹€à¸¡à¸¥',
    ph_password:
      'à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™ (â‰¥8 à¸•à¸±à¸§ à¸£à¸§à¸¡à¸•à¸±à¸§à¸à¸´à¸¡à¸à¹Œà¹ƒà¸«à¸à¹ˆ/à¹€à¸¥à¹‡à¸ à¸•à¸±à¸§à¹€à¸¥à¸‚ à¸ªà¸±à¸à¸¥à¸±à¸à¸©à¸“à¹Œ)',
    ph_label_password: 'à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™',

    title_quickcalc: 'à¸›à¸²à¸ˆà¸·à¹ˆà¸­ Â· à¸„à¸³à¸™à¸§à¸“à¸”à¹ˆà¸§à¸™',
    title_bazi_brief: 'à¸›à¸²à¸ˆà¸·à¹ˆà¸­à¹à¸šà¸šà¸¢à¹ˆà¸­',
    label_name: 'à¸Šà¸·à¹ˆà¸­ (à¹„à¸¡à¹ˆà¸šà¸±à¸‡à¸„à¸±à¸š)',
    ph_name: 'à¸Šà¸·à¹ˆà¸­à¸„à¸¸à¸“ (à¹€à¸à¸·à¹ˆà¸­à¸›à¸£à¸±à¸šà¹ƒà¸«à¹‰à¹€à¸«à¸¡à¸²à¸°à¸ªà¹ˆà¸§à¸™à¸šà¸¸à¸„à¸„à¸¥)',
    gender_label: 'à¹€à¸à¸¨',
    label_calendar: 'à¸›à¸à¸´à¸—à¸´à¸™',
    label_birthdate: 'à¸§à¸±à¸™à¹€à¸à¸´à¸”',
    label_birthtime: 'à¹€à¸§à¸¥à¸²à¹€à¸à¸´à¸”',
    cb_time_unknown: 'à¹„à¸¡à¹ˆà¸—à¸£à¸²à¸šà¹€à¸§à¸¥à¸²à¹€à¸à¸´à¸”',
    btn_generate_chart: 'à¸ªà¸£à¹‰à¸²à¸‡à¸”à¸§à¸‡',
    panel_login_head: 'à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š / à¸ªà¸¡à¸±à¸„à¸£à¸ªà¸¡à¸²à¸Šà¸´à¸',
    panel_member_head: 'à¸šà¸£à¸´à¸à¸²à¸£à¸ªà¸¡à¸²à¸Šà¸´à¸',

    opt_gender_confidential: 'à¹„à¸¡à¹ˆà¸£à¸°à¸šà¸¸',
    opt_gender_male: 'à¸Šà¸²à¸¢',
    opt_gender_female: 'à¸«à¸à¸´à¸‡',
    opt_cal_gregorian: 'à¸ªà¸¸à¸£à¸´à¸¢à¸„à¸•à¸´',
    opt_cal_lunar: 'à¸ˆà¸±à¸™à¸—à¸£à¸„à¸•à¸´',

    elements_balance_tpl: 'à¹€à¸”à¹ˆà¸™à¸ªà¸¸à¸”: {max} Â· à¸­à¹ˆà¸­à¸™à¸ªà¸¸à¸”: {min}',

    butler_title: 'à¸œà¸¹à¹‰à¸Šà¹ˆà¸§à¸¢à¸‹à¸´à¸™à¹€à¸«à¸¥à¸µà¸¢à¸™ Â· à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œ',

    chip_career: 'à¸à¸²à¸£à¸‡à¸²à¸™',
    chip_love: 'à¸„à¸§à¸²à¸¡à¸ªà¸±à¸¡à¸à¸±à¸™à¸˜à¹Œ',
    chip_money: 'à¸„à¸³à¹à¸™à¸°à¸™à¸³à¸à¸²à¸£à¹€à¸‡à¸´à¸™',
    chip_list: 'à¸£à¸²à¸¢à¸à¸²à¸£à¸—à¸³à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œà¸™à¸µà¹‰',
    chip_30d: 'à¹à¸œà¸™ 30 à¸§à¸±à¸™',
    q_career: 'à¸Šà¹ˆà¸§à¸¢à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œà¸à¸²à¸£à¸‡à¸²à¸™à¹à¸¥à¸°à¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™à¹€à¸›à¹‡à¸™à¸—à¸µà¸¡à¸•à¹ˆà¸­',
    q_love: 'à¸à¸¹à¸”à¸–à¸¶à¸‡à¸„à¸§à¸²à¸¡à¸£à¸±à¸à¹à¸¥à¸°à¸„à¸§à¸²à¸¡à¸ªà¸±à¸¡à¸à¸±à¸™à¸˜à¹Œà¸£à¸°à¸¢à¸°à¸¢à¸²à¸§',
    q_money: 'à¸šà¸­à¸à¸™à¸´à¸ªà¸±à¸¢à¸à¸²à¸£à¹€à¸‡à¸´à¸™ à¸ˆà¸¸à¸”à¸šà¸­à¸” à¹à¸¥à¸°à¹à¸™à¸§à¸—à¸²à¸‡à¸›à¸£à¸±à¸šà¸›à¸£à¸¸à¸‡',
    q_list: 'à¸‚à¸­à¸£à¸²à¸¢à¸à¸²à¸£à¸›à¸à¸´à¸šà¸±à¸•à¸´à¹„à¸”à¹‰à¸ˆà¸£à¸´à¸‡à¸ªà¸³à¸«à¸£à¸±à¸šà¸ªà¸±à¸›à¸”à¸²à¸«à¹Œà¸™à¸µà¹‰',
    q_30d: 'à¸§à¸²à¸‡à¹à¸œà¸™à¸à¸±à¸’à¸™à¸² 30 à¸§à¸±à¸™à¹ƒà¸«à¹‰à¸‰à¸±à¸™',
    vip_tip: 'ğŸ”’ à¸›à¸¥à¸”à¸¥à¹‡à¸­à¸ VIP à¹€à¸à¸·à¹ˆà¸­à¸­à¹ˆà¸²à¸™à¸‰à¸šà¸±à¸šà¹€à¸•à¹‡à¸¡',
    vip_sub:
      'à¸£à¸§à¸¡à¸—à¸¸à¸à¸«à¸±à¸§à¸‚à¹‰à¸­: à¸‡à¸²à¸™ / à¸à¸²à¸£à¹€à¸‡à¸´à¸™ / à¸£à¸²à¸¢à¸à¸²à¸£à¸¥à¸‡à¸¡à¸·à¸­à¸—à¸³ / à¸„à¸³à¹€à¸•à¸·à¸­à¸™à¸­à¹ˆà¸­à¸™à¹‚à¸¢à¸™ à¹à¸¥à¸°à¸à¸²à¸£à¸–à¸²à¸¡à¸•à¹ˆà¸­',
    btn_unlock: 'à¸›à¸¥à¸”à¸¥à¹‡à¸­à¸à¸—à¸±à¸™à¸—à¸µ',

    rpt_free_title: 'à¸ªà¸£à¸¸à¸›à¸Ÿà¸£à¸µ',
    rpt_pillars_label: 'à¹€à¸ªà¸²',
    rpt_daymaster_label: 'Day Master',
    rpt_season_label: 'à¸¤à¸”à¸¹à¸à¸²à¸¥',
    rpt_chart_label: 'à¸”à¸§à¸‡à¸Šà¸°à¸•à¸²',
    rpt_strategy_label: 'à¸à¸¥à¸¢à¸¸à¸—à¸˜à¹Œ',
    rpt_wuxing_label: 'à¸˜à¸²à¸•à¸¸à¸—à¸±à¹‰à¸‡à¸«à¹‰à¸²',
    rpt_strongest_word: 'à¹€à¸”à¹ˆà¸™à¸ªà¸¸à¸”',
    rpt_weakest_word: 'à¸­à¹ˆà¸­à¸™à¸ªà¸¸à¸”',
    rpt_absent_prefix: 'à¸‚à¸²à¸”: ',
    rpt_balance_focus_label: 'à¸ˆà¸¸à¸”à¹‚à¸Ÿà¸à¸±à¸ªà¸à¸²à¸£à¸–à¹ˆà¸§à¸‡à¸”à¸¸à¸¥',
    rpt_time_hint:
      'à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸: à¹„à¸¡à¹ˆà¸—à¸£à¸²à¸šà¹€à¸§à¸¥à¸²à¹€à¸à¸´à¸” à¹„à¸¡à¹ˆà¸£à¸§à¸¡à¹€à¸ªà¸²à¹€à¸§à¸¥à¸² â€” à¹ƒà¸Šà¹‰à¸­à¹‰à¸²à¸‡à¸­à¸´à¸‡à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™',
    rpt_time_unknown: 'à¹„à¸¡à¹ˆà¸—à¸£à¸²à¸šà¹€à¸§à¸¥à¸²',
    rpt_sec_overview_title: '1) à¸ à¸²à¸à¸£à¸§à¸¡',
    rpt_sec_elements_title: '2) à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œà¸˜à¸²à¸•à¸¸',
    rpt_sec_traits_title: '3) à¸šà¸¸à¸„à¸¥à¸´à¸ & à¸„à¸§à¸²à¸¡à¸–à¸™à¸±à¸”',
    rpt_traits_intro:
      'à¹à¸—à¹‡à¸à¸šà¸¸à¸„à¸¥à¸´à¸à¸«à¸¥à¸±à¸à¸ˆà¸²à¸ DM à¸¤à¸”à¸¹à¸à¸²à¸¥ à¹à¸¥à¸°à¸„à¸§à¸²à¸¡à¹à¸‚à¹‡à¸‡à¹à¸£à¸‡ (à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡).',
    rpt_traits_adv: 'à¸à¸¥à¸±à¸‡à¹€à¸”à¹ˆà¸™: à¸¥à¸‡à¸¡à¸·à¸­à¸—à¸³ / à¸ªà¸£à¹‰à¸²à¸‡à¸ªà¸£à¸£à¸„à¹Œ / à¹€à¸£à¸µà¸¢à¸™à¸£à¸¹à¹‰ (à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡).',
    rpt_traits_chal: 'à¸„à¸§à¸²à¸¡à¸—à¹‰à¸²à¸—à¸²à¸¢: à¸ˆà¸±à¸‡à¸«à¸§à¸° / à¸‚à¸­à¸šà¹€à¸‚à¸• (à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡).',
    rpt_sec_structure_title: '4) à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡ & à¸„à¸§à¸²à¸¡à¸Šà¸­à¸š',
    rpt_structure_line_template: 'à¹€à¸à¸·à¹‰à¸­à¸«à¸™à¸¸à¸™: {fav}; à¸«à¸¥à¸µà¸à¹€à¸¥à¸µà¹ˆà¸¢à¸‡: {avoid}',
    rpt_sec_career_title: '5) à¸à¸²à¸£à¸‡à¸²à¸™ (à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡)',
    rpt_career_fields_placeholder: 'à¸ªà¸²à¸¢à¸‡à¸²à¸™à¸—à¸µà¹ˆà¹€à¸«à¸¡à¸²à¸° (à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡).',
    rpt_dev_strategy_prefix: 'à¸à¸¥à¸¢à¸¸à¸—à¸˜à¹Œà¸à¸±à¸’à¸™à¸²: ',
    rpt_sec_love_title: '6) à¸„à¸§à¸²à¸¡à¸£à¸±à¸ (à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡)',
    rpt_love_placeholder: 'à¸ˆà¸±à¸‡à¸«à¸§à¸°à¸à¸²à¸£à¸ªà¸·à¹ˆà¸­à¸ªà¸²à¸£ & à¸‚à¸­à¸šà¹€à¸‚à¸• (à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡).',
    rpt_sec_wealth_title: '7) à¸à¸²à¸£à¹€à¸‡à¸´à¸™ (à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡)',
    rpt_wealth_suggestion_template: 'à¸—à¸´à¸›à¸à¸²à¸£à¹€à¸‡à¸´à¸™: à¹€à¸­à¸™à¹€à¸­à¸µà¸¢à¸‡à¸•à¸²à¸¡ {fav}.',
    rpt_sec_health_title: '8) à¸ªà¸¸à¸‚à¸ à¸²à¸',
    rpt_health_placeholder_template: 'à¸”à¸¹à¹à¸¥à¸˜à¸²à¸•à¸¸à¸—à¸µà¹ˆà¸­à¹ˆà¸­à¸™à¸—à¸µà¹ˆà¸ªà¸¸à¸”: {weak}.',
    rpt_sec_env_title: '9) à¸ªà¸´à¹ˆà¸‡à¹à¸§à¸”à¸¥à¹‰à¸­à¸¡ & à¸ªà¸µà¸ªà¸±à¸™',
    rpt_env_placeholder:
      'à¸—à¸´à¸¨à¹à¸¥à¸°à¹‚à¸—à¸™à¸ªà¸µà¸—à¸µà¹ˆà¸ªà¹ˆà¸‡à¹€à¸ªà¸£à¸´à¸¡à¸ªà¸­à¸”à¸„à¸¥à¹‰à¸­à¸‡à¸à¸±à¸šà¸˜à¸²à¸•à¸¸à¹€à¸à¸·à¹‰à¸­à¸«à¸™à¸¸à¸™.',
    rpt_strategy_drain: 'à¸£à¸°à¸šà¸²à¸¢/à¸„à¸§à¸šà¸„à¸¸à¸¡',
    rpt_strategy_support: 'à¹€à¸ªà¸£à¸´à¸¡/à¹€à¸à¸·à¹‰à¸­à¸«à¸™à¸¸à¸™',
    rpt_strategy_balance: 'à¸–à¹ˆà¸§à¸‡à¸”à¸¸à¸¥'
  },

  'ms': {
    lang_label: 'Bahasa',
    btn_register: 'Daftar Akaun',
    btn_login: 'Log Masuk',
    btn_reset: 'ğŸ”‘ Tetapkan Semula Kata Laluan',
    note_price: 'Daftar akaun baharu untuk satu percubaan percuma',
    note_price1:
      '$9.9 / bulan Â· VIP (Ruang Astro + Soul Sanctuary + Kursus)',

    err_need_ep: 'Masukkan emel dan kata laluan',
    err_pwd_rule:
      'Kata laluan mestilah 8+ aksara serta ada huruf besar/kecil, nombor, simbol',
    err_no_account: 'Akaun tidak ditemui. Sila daftar dahulu.',
    err_wrong_pwd: 'Kata laluan tidak sah',
    err_expired: 'Keahlian tamat tempoh. Sila perbaharui.',
    err_login_fail: 'Gagal log masuk: ',
    err_register_fail: 'Gagal mendaftar: ',
    err_email_empty: 'Emel tidak boleh kosong',
    err_pwd_empty: 'Kata laluan tidak boleh kosong',
    err_reset_fail: 'Tetapan semula gagal: ',
    err_network: 'Ralat rangkaian',
    err_busy: 'Perkhidmatan sibuk. Cuba lagi kemudian.',

    prompt_email: 'Masukkan emel berdaftar anda:',
    prompt_newpwd:
      'Masukkan kata laluan baharu (8+, huruf besar/kecil/nombor/simbol):',

    btn_upgrade: 'ğŸ’ Naik Taraf ke VIP (Bulanan)',
    btn_backshop: 'â† Kembali ke Kedai',

    vip_title: 'ğŸŒ™ Segmen VIP',
    vip_mingli: 'ğŸ— Ruang Astro Â· Eksklusif',
    vip_xinlian: 'ğŸŒ™ Soul Sanctuary Â· Eksklusif',
    vip_love: 'Cinta: Jodoh & Arah Perkahwinan',
    vip_career: 'Kerjaya: Perkembangan & Usahawan',
    vip_wealth: 'Kekayaan: Kedudukan Harta & Masa',
    vip_pet: 'Nasib Haiwan: Perangai & Ikatan',
    vip_hepan: 'Keserasian: Wedding Dates, Birthtime',
    vip_name: 'Analisis Nama: Syarikat/Bayi/Penamaan Semula',
    vip_fengshui: 'Kedudukan Harta & Susun Atur: Rumah / Pejabat',
    vip_record: 'Log Spiritual: Foto, Mimpi, Audio, Doa',
    vip_course:
      'Kursus: Bazi / Tarot / Astrologi / Numerologi / Human Design',
    vip_memorial: 'Peringatan Keluarga: Arkib Rohani & Legasi',
    vip_tasks: 'Amalan Tenaga Mingguan / Tugas Ritual',
    vip_shop: 'Diskaun Kedai & Omamori',
    login_title: 'ğŸ’ Sign in for VIP features',

    chat_fab: 'Chat',
    chat_placeholder:
      'Apa yang anda ingin tahu? (cth: cara mula percubaan percuma)',
    chat_send: 'Hantar',
    butler_chat_title: 'Xinlian Butler Â· Chat',

    msg_reset_ok: 'Kata laluan dikemas kini. Log masuk dengan yang baharu.',

    ph_email: 'Emel',
    ph_password:
      'Kata Laluan (8+, huruf besar/kecil/nombor/simbol)',
    ph_label_password: 'Kata Laluan',

    title_quickcalc: 'Bazi Â· Carta Pantas',
    title_bazi_brief: 'Bazi Â· Ringkasan',
    label_name: 'Nama (pilihan)',
    ph_name: 'Nama anda (untuk personalisasi)',
    gender_label: 'Jantina',
    label_calendar: 'Kalendar',
    label_birthdate: 'Tarikh Lahir',
    label_birthtime: 'Masa Lahir',
    cb_time_unknown: 'Masa lahir tidak diketahui',
    btn_generate_chart: 'Jana Carta',
    panel_login_head: 'Log Masuk / Daftar Akaun',
    panel_member_head: 'Perkhidmatan Keahlian',

    opt_gender_confidential: 'Rahsia',
    opt_gender_male: 'Lelaki',
    opt_gender_female: 'Perempuan',
    opt_cal_gregorian: 'Gregorian',
    opt_cal_lunar: 'Lunar',

    elements_balance_tpl: 'Terkuat: {max} Â· Terlemah: {min}',

    butler_title: 'Xinlian Butler Â· Insight',

    chip_career: 'Kerjaya',
    chip_love: 'Hubungan',
    chip_money: 'Nasihat Kewangan',
    chip_list: 'Senarai Mingguan',
    chip_30d: 'Pelan 30 Hari',
    q_career: 'Teruskan dengan wawasan kerjaya dan kerja berpasukan',
    q_love: 'Bincang cinta dan hubungan jangka panjang',
    q_money: 'Berikan tabiat kewangan, titik buta dan penambahbaikan',
    q_list: 'Berikan senarai tindakan minggu ini',
    q_30d: 'Buat pelan perkembangan 30 hari',
    vip_tip: 'ğŸ”’ Buka VIP untuk melihat analisis penuh',
    vip_sub:
      'Termasuk semua seksyen: Kerjaya / Kekayaan / Senarai Tindakan / Peringatan Lembut + soalan susulan',
    btn_unlock: 'Buka sekarang',

    rpt_free_title: 'Ringkasan Percuma',
    rpt_pillars_label: 'Empat Tiang',
    rpt_daymaster_label: 'Day Master',
    rpt_season_label: 'Musim',
    rpt_chart_label: 'Carta',
    rpt_strategy_label: 'Strategi',
    rpt_wuxing_label: 'Lima Unsur',
    rpt_strongest_word: 'paling kuat',
    rpt_weakest_word: 'paling lemah',
    rpt_absent_prefix: 'Tiada: ',
    rpt_balance_focus_label: 'Fokus keseimbangan',
    rpt_time_hint:
      'Nota: masa lahir tidak diketahui; tiang jam dikecualikan â€” rujukan sahaja.',
    rpt_time_unknown: 'Masa tidak diketahui',
    rpt_sec_overview_title: '1) Gambaran Umum',
    rpt_sec_elements_title: '2) Analisis Unsur',
    rpt_sec_traits_title: '3) Sifat & Bakat',
    rpt_traits_intro:
      'Tag sifat teras berdasarkan DM, musim, dan kekuatan (placeholder).',
    rpt_traits_adv:
      'Kelebihan: Pelaksanaan / Kreativiti / Pembelajaran (placeholder).',
    rpt_traits_chal: 'Cabaran: Tempo / Sempadan / Berlebihan (placeholder).',
    rpt_sec_structure_title: '4) Struktur & Kecenderungan',
    rpt_structure_line_template: 'Baik: {fav}; Elak: {avoid}',
    rpt_sec_career_title: '5) Kerjaya (contoh)',
    rpt_career_fields_placeholder: 'Bidang yang sesuai (placeholder).',
    rpt_dev_strategy_prefix: 'Strategi pembangunan: ',
    rpt_sec_love_title: '6) Cinta (contoh)',
    rpt_love_placeholder: 'Tempo komunikasi & sempadan (placeholder).',
    rpt_sec_wealth_title: '7) Kekayaan (contoh)',
    rpt_wealth_suggestion_template:
      'Tip kekayaan: utamakan aliran yang sejajar dengan {fav}.',
    rpt_sec_health_title: '8) Kesihatan',
    rpt_health_placeholder_template: 'Jaga unsur paling lemah: {weak}.',
    rpt_sec_env_title: '9) Persekitaran & Warna',
    rpt_env_placeholder: 'Arah & palet yang baik mengikuti unsur pilihan anda.',
    rpt_strategy_drain: 'Leraikan/Kawal',
    rpt_strategy_support: 'Sokong/Perkuat',
    rpt_strategy_balance: 'Seimbangkan'
  }
};

const BUTLER_LANG_NAME = {
  'zh-CN': 'Simplified Chinese',
  'zh-TW': 'Traditional Chinese',
  en: 'English',
  ja: 'Japanese',
  th: 'Thai',
  ms: 'Malay'
};

function getLang() {
  const saved = localStorage.getItem(LANG_KEY);
  if (saved && translations[saved]) return saved;
  const raw = (navigator.language || 'zh-CN').replace('_', '-');
  const map = {
    zh: 'zh-CN',
    'zh-CN': 'zh-CN',
    'zh-SG': 'zh-CN',
    'zh-TW': 'zh-TW',
    'zh-HK': 'zh-TW',
    en: 'en',
    'en-US': 'en',
    'en-GB': 'en',
    'en-AU': 'en',
    ja: 'ja',
    'ja-JP': 'ja',
    th: 'th',
    ms: 'ms'
  };
  return map[raw] || 'zh-CN';
}
function setLang(code) {
  localStorage.setItem(LANG_KEY, code);
  document.documentElement.lang = code;
}
function t(key) {
  const L = translations[getLang()] || translations['zh-CN'];
  return L[key] || translations['zh-CN'][key] || key;
}

function applyI18n() {
  document.querySelectorAll('[data-i18n]').forEach((el) => {
    const key = el.getAttribute('data-i18n');
    const val = t(key);
    if (val != null) el.textContent = val;
  });
  document.querySelectorAll('[data-i18n-ph]').forEach((el) => {
    const key = el.getAttribute('data-i18n-ph');
    const val = t(key);
    if (val != null) el.setAttribute('placeholder', val);
  });
}
function applyChatI18n() {
  const fab = $('ssChatFab');
  const inp = $('ssChatInput');
  const btn = $('ssChatSend');
  const title = qs('.ss-chat-title');
  if (fab) fab.textContent = t('chat_fab');
  if (inp) inp.placeholder = t('chat_placeholder');
  if (btn) btn.textContent = t('chat_send');
  if (title) title.textContent = t('butler_chat_title');
}
function initLangUI() {
  const sel = document.getElementById('langSelect');
  if (!sel) return;
  const current = getLang();
  sel.value = current;
  document.documentElement.lang = current;
  applyI18n();
  applyChatI18n();

  sel.addEventListener('change', () => {
    setLang(sel.value);
    applyI18n();
    applyChatI18n();
    // åˆ‡æ¢è¯­è¨€åï¼šé‡æ¸²æŠ¥å‘Š + Butler
    rerenderReportsIfAny();
    rerunButlerIfAny();
  });
}

/* ================== å…«å­—è®¡ç®—å™¨ï¼ˆç®€åŒ–ï¼‰ ================== */
class BaziCalculator {
  constructor() {
    this.HEAVENLY_STEMS = [
      'ç”²',
      'ä¹™',
      'ä¸™',
      'ä¸',
      'æˆŠ',
      'å·±',
      'åºš',
      'è¾›',
      'å£¬',
      'ç™¸'
    ];
    this.EARTHLY_BRANCHES = [
      'å­',
      'ä¸‘',
      'å¯…',
      'å¯',
      'è¾°',
      'å·³',
      'åˆ',
      'æœª',
      'ç”³',
      'é…‰',
      'æˆŒ',
      'äº¥'
    ];
    this.ZODIAC = [
      'é¼ ',
      'ç‰›',
      'è™',
      'å…”',
      'é¾™',
      'è›‡',
      'é©¬',
      'ç¾Š',
      'çŒ´',
      'é¸¡',
      'ç‹—',
      'çŒª'
    ];
    this.NAYIN = [
      'æµ·ä¸­é‡‘',
      'ç‚‰ä¸­ç«',
      'å¤§æ—æœ¨',
      'è·¯æ—åœŸ',
      'å‰‘é”‹é‡‘',
      'å±±å¤´ç«',
      'æ¶§ä¸‹æ°´',
      'åŸå¤´åœŸ',
      'ç™½èœ¡é‡‘',
      'æ¨æŸ³æœ¨',
      'æ³‰ä¸­æ°´',
      'å±‹ä¸ŠåœŸ',
      'éœ¹é›³ç«',
      'æ¾æŸæœ¨',
      'é•¿æµæ°´',
      'ç ‚çŸ³é‡‘',
      'å±±ä¸‹ç«',
      'å¹³åœ°æœ¨',
      'å£ä¸ŠåœŸ',
      'é‡‘ç®”é‡‘',
      'ä½›ç¯ç«',
      'å¤©æ²³æ°´',
      'å¤§é©¿åœŸ',
      'é’—é’é‡‘',
      'æ¡‘æŸ˜æœ¨',
      'å¤§æºªæ°´',
      'æ²™ä¸­åœŸ',
      'å¤©ä¸Šç«',
      'çŸ³æ¦´æœ¨',
      'å¤§æµ·æ°´'
    ];
  }
  calculateYearPillar(year) {
    const s = (year - 4) % 10,
      b = (year - 4) % 12;
    return {
      stem: this.HEAVENLY_STEMS[(s + 10) % 10],
      branch: this.EARTHLY_BRANCHES[(b + 12) % 12],
      zodiac: this.ZODIAC[(b + 12) % 12]
    };
  }
  solarMonthIndex(y, m, d) {
    const mmdd = m * 100 + d;
    const gates = [
      [106, 12],
      [204, 1],
      [306, 2],
      [405, 3],
      [506, 4],
      [606, 5],
      [707, 6],
      [808, 7],
      [908, 8],
      [1008, 9],
      [1107, 10],
      [1207, 11]
    ];
    let idx = 11;
    for (const [thr, val] of gates) if (mmdd >= thr) idx = val;
    const branchBy = {
      1: 'å¯…',
      2: 'å¯',
      3: 'è¾°',
      4: 'å·³',
      5: 'åˆ',
      6: 'æœª',
      7: 'ç”³',
      8: 'é…‰',
      9: 'æˆŒ',
      10: 'äº¥',
      11: 'å­',
      12: 'ä¸‘'
    };
    return { index: idx, branch: branchBy[idx] };
  }
  calculateMonthPillar(year, month, day) {
    const { index, branch } = this.solarMonthIndex(year, month, day);
    const yStemIdx = this.HEAVENLY_STEMS.indexOf(
      this.calculateYearPillar(year).stem
    );
    const startMap = { 0: 2, 1: 4, 2: 6, 3: 8, 4: 0, 5: 2, 6: 4, 7: 6, 8: 8, 9: 0 };
    const stemIdx = (startMap[yStemIdx] + (index - 1)) % 10;
    return { stem: this.HEAVENLY_STEMS[stemIdx], branch };
  }
  calculateDayPillar(year, month, day) {
    const baseUTC = Date.UTC(1900, 0, 31);
    const targetUTC = Date.UTC(year, month - 1, day);
    const dayDiff = Math.floor((targetUTC - baseUTC) / 86400000);
    const stemIdx = (0 + dayDiff) % 10;
    const branchIdx = (4 + dayDiff) % 12;
    return {
      stem: this.HEAVENLY_STEMS[(stemIdx + 10) % 10],
      branch: this.EARTHLY_BRANCHES[(branchIdx + 12) % 12]
    };
  }
  calculateHourPillar(dayStem, hour) {
    const branchMap = {
      23: 'å­',
      0: 'å­',
      1: 'ä¸‘',
      2: 'ä¸‘',
      3: 'å¯…',
      4: 'å¯…',
      5: 'å¯',
      6: 'å¯',
      7: 'è¾°',
      8: 'è¾°',
      9: 'å·³',
      10: 'å·³',
      11: 'åˆ',
      12: 'åˆ',
      13: 'æœª',
      14: 'æœª',
      15: 'ç”³',
      16: 'ç”³',
      17: 'é…‰',
      18: 'é…‰',
      19: 'æˆŒ',
      20: 'æˆŒ',
      21: 'äº¥',
      22: 'äº¥'
    };
    const startMap = { 0: 0, 1: 2, 2: 4, 3: 6, 4: 8, 5: 0, 6: 2, 7: 4, 8: 6, 9: 8 };
    const dayIdx = this.HEAVENLY_STEMS.indexOf(dayStem);
    const hourIndex = Math.floor((hour + 1) / 2) % 12;
    const stemIdx = (startMap[dayIdx] + hourIndex) % 10;
    return { stem: this.HEAVENLY_STEMS[stemIdx], branch: branchMap[hour] };
  }
  getElement(stem, branch) {
    const s = {
      ç”²: 'æœ¨',
      ä¹™: 'æœ¨',
      ä¸™: 'ç«',
      ä¸: 'ç«',
      æˆŠ: 'åœŸ',
      å·±: 'åœŸ',
      åºš: 'é‡‘',
      è¾›: 'é‡‘',
      å£¬: 'æ°´',
      ç™¸: 'æ°´'
    };
    const b = {
      å­: 'æ°´',
      ä¸‘: 'åœŸ',
      å¯…: 'æœ¨',
      å¯: 'æœ¨',
      è¾°: 'åœŸ',
      å·³: 'ç«',
      åˆ: 'ç«',
      æœª: 'åœŸ',
      ç”³: 'é‡‘',
      é…‰: 'é‡‘',
      æˆŒ: 'åœŸ',
      äº¥: 'æ°´'
    };
    return `${s[stem]}${b[branch]}`;
  }
  getNayin(stem, branch) {
    const si = this.HEAVENLY_STEMS.indexOf(stem),
      bi = this.EARTHLY_BRANCHES.indexOf(branch);
    return this.NAYIN[(si * 2 + bi) % this.NAYIN.length];
  }
  getStemElement(stem) {
    return (
      {
        ç”²: 'æœ¨',
        ä¹™: 'æœ¨',
        ä¸™: 'ç«',
        ä¸: 'ç«',
        æˆŠ: 'åœŸ',
        å·±: 'åœŸ',
        åºš: 'é‡‘',
        è¾›: 'é‡‘',
        å£¬: 'æ°´',
        ç™¸: 'æ°´'
      }[stem]
    );
  }
  getBranchElement(branch) {
    return (
      {
        å­: 'æ°´',
        ä¸‘: 'åœŸ',
        å¯…: 'æœ¨',
        å¯: 'æœ¨',
        è¾°: 'åœŸ',
        å·³: 'ç«',
        åˆ: 'ç«',
        æœª: 'åœŸ',
        ç”³: 'é‡‘',
        é…‰: 'é‡‘',
        æˆŒ: 'åœŸ',
        äº¥: 'æ°´'
      }[branch]
    );
  }
  calculateBazi(year, month, day, hour = 12, timeUnknown = false) {
    const yearP = this.calculateYearPillar(year),
      monthP = this.calculateMonthPillar(year, month, day),
      dayP = this.calculateDayPillar(year, month, day);
    const hourP = timeUnknown
      ? { stem: 'ï¼Ÿ', branch: 'ï¼Ÿ' }
      : this.calculateHourPillar(dayP.stem, hour);
    const dayElement = this.getStemElement(dayP.stem);
    const pillars = { year: yearP, month: monthP, day: { ...dayP, element: dayElement }, hour: hourP };
    const cnt = { æœ¨: 0, ç«: 0, åœŸ: 0, é‡‘: 0, æ°´: 0 };
    (timeUnknown ? [yearP, monthP, dayP] : [yearP, monthP, dayP, hourP]).forEach((p) => {
      if (p.stem && p.stem !== 'ï¼Ÿ') cnt[this.getStemElement(p.stem)] += 1;
      if (p.branch && p.branch !== 'ï¼Ÿ') cnt[this.getBranchElement(p.branch)] += 1;
    });
    const total = Object.values(cnt).reduce((a, b) => a + b, 0) || 1;
    const pct = {
      wood: (cnt['æœ¨'] / total) * 100,
      fire: (cnt['ç«'] / total) * 100,
      earth: (cnt['åœŸ'] / total) * 100,
      metal: (cnt['é‡‘'] / total) * 100,
      water: (cnt['æ°´'] / total) * 100
    };
    return { pillars, counts: cnt, percents: pct, timeUnknown };
  }
}
const baziCalculator = new BaziCalculator();

/* ================== è§„åˆ™/æ¸²æŸ“ ================== */
function renderPillars(root, p, timeUnknown = false) {
  if (!root) return;
  root.innerHTML = '';
  [
    ['å¹´æŸ±', p.year],
    ['æœˆæŸ±', p.month],
    ['æ—¥æŸ±', p.day],
    ['æ—¶æŸ±', p.hour]
  ].forEach(([tit, v]) => {
    const u = tit === 'æ—¶æŸ±' && timeUnknown;
    const stem = u ? 'ï¼Ÿ' : v.stem,
      branch = u ? 'ï¼Ÿ' : v.branch;
    const div = document.createElement('div');
    div.className = 'pillar';
    div.innerHTML = `<div class="tit">${tit}</div><div class="gz">${stem}${branch}</div>`;
    root.appendChild(div);
  });
}
function displayClassicArea(p, timeUnknown) {
  const ge = (s, b) => baziCalculator.getElement(s, b),
    ny = (s, b) => baziCalculator.getNayin(s, b);
  setText('year-stem', p.year.stem);
  setText('year-branch', p.year.branch);
  setText('month-stem', p.month.stem);
  setText('month-branch', p.month.branch);
  setText('day-stem', p.day.stem);
  setText('day-branch', p.day.branch);
  setText('hour-stem', timeUnknown ? 'ï¼Ÿ' : p.hour.stem);
  setText('hour-branch', timeUnknown ? 'ï¼Ÿ' : p.hour.branch);
  const setIf = (id, val) => {
    const el = $(id);
    if (el) el.textContent = val;
  };
  setIf('year-element', ge(p.year.stem, p.year.branch));
  setIf('month-element', ge(p.month.stem, p.month.branch));
  setIf('day-element', ge(p.day.stem, p.day.branch));
  setIf('hour-element', timeUnknown ? 'æœªçŸ¥' : ge(p.hour.stem, p.hour.branch));
  setIf('year-nayin', ny(p.year.stem, p.year.branch));
  setIf('month-nayin', ny(p.month.stem, p.month.branch));
  setIf('day-nayin', ny(p.day.stem, p.day.branch));
  setIf('hour-nayin', timeUnknown ? 'æœªçŸ¥' : ny(p.hour.stem, p.hour.branch));
}
function judgeStrength(dayGan, monthZhi, cnt) {
  const STEM_ELEM = {
    ç”²: 'æœ¨',
    ä¹™: 'æœ¨',
    ä¸™: 'ç«',
    ä¸: 'ç«',
    æˆŠ: 'åœŸ',
    å·±: 'åœŸ',
    åºš: 'é‡‘',
    è¾›: 'é‡‘',
    å£¬: 'æ°´',
    ç™¸: 'æ°´'
  };
  const SEASON_BY_MONTH_BRANCH = {
    å¯…: 'æ˜¥',
    å¯: 'æ˜¥',
    è¾°: 'æ˜¥',
    å·³: 'å¤',
    åˆ: 'å¤',
    æœª: 'å¤',
    ç”³: 'ç§‹',
    é…‰: 'ç§‹',
    æˆŒ: 'ç§‹',
    äº¥: 'å†¬',
    å­: 'å†¬',
    ä¸‘: 'å†¬'
  };
  const dmEl = STEM_ELEM[dayGan],
    season = SEASON_BY_MONTH_BRANCH[monthZhi] || '-';
  let score = 0;
  if (
    (season === 'æ˜¥' && 'æœ¨ç«'.includes(dmEl)) ||
    (season === 'å¤' && 'ç«åœŸ'.includes(dmEl)) ||
    (season === 'ç§‹' && dmEl === 'é‡‘') ||
    (season === 'å†¬' && dmEl === 'æ°´')
  )
    score += 2;
  score += (cnt[dmEl] || 0) * 1.2;
  const mark = score >= 3 ? 'åå¼º' : score <= 1 ? 'åå¼±' : 'å¹³è¡¡';
  const focus = mark === 'åå¼º' ? 'æ³„ç§€/åˆ¶åŒ–' : mark === 'åå¼±' ? 'ç”Ÿæ‰¶/è¡¥åŠ©' : 'è°ƒå’Œ';
  return { season, mark, focus };
}
function chooseUseful(strength, dmElem) {
  if (strength === 'åå¼º')
    return {
      strategy: 'æ³„ç§€/åˆ¶åŒ–',
      useful: {
        æœ¨: ['ç«', 'åœŸ', 'é‡‘'],
        ç«: ['åœŸ', 'é‡‘', 'æ°´'],
        åœŸ: ['é‡‘', 'æ°´', 'æœ¨'],
        é‡‘: ['æ°´', 'æœ¨', 'ç«'],
        æ°´: ['æœ¨', 'ç«', 'åœŸ']
      }[dmElem],
      avoid: [dmElem]
    };
  if (strength === 'åå¼±')
    return {
      strategy: 'ç”Ÿæ‰¶/è¡¥åŠ©',
      useful: { æœ¨: ['æœ¨', 'æ°´'], ç«: ['ç«', 'æœ¨'], åœŸ: ['åœŸ', 'ç«'], é‡‘: ['é‡‘', 'åœŸ'], æ°´: ['æ°´', 'é‡‘'] }[dmElem],
      avoid: []
    };
  return { strategy: 'è°ƒå’Œ', useful: ['æœ¨', 'ç«', 'åœŸ', 'é‡‘', 'æ°´'], avoid: [] };
}

/* ================== å¤šè¯­è¨€å¸®åŠ©ï¼ˆæŠ¥å‘Šç”¨ï¼‰ ================== */
const EL_CHAR_TO_KEY = { æœ¨: 'wood', ç«: 'fire', åœŸ: 'earth', é‡‘: 'metal', æ°´: 'water' };
function ELABEL() {
  return {
    wood: t('el_wood') || 'æœ¨',
    fire: t('el_fire') || 'ç«',
    earth: t('el_earth') || 'åœŸ',
    metal: t('el_metal') || 'é‡‘',
    water: t('el_water') || 'æ°´'
  };
}
function elCharsToLocale(arr) {
  const L = ELABEL();
  return (arr || []).map((ch) => L[EL_CHAR_TO_KEY[ch]] || ch);
}
function listJoin(arr) {
  const lang = (getLang() || '').toLowerCase();
  const sep = lang.startsWith('zh') ? 'ã€' : ', ';
  return (arr || []).filter(Boolean).join(sep);
}
function seasonName(s) {
  const map = {
    æ˜¥: translations[getLang()]?.season_spring || 'æ˜¥',
    å¤: translations[getLang()]?.season_summer || 'å¤',
    ç§‹: translations[getLang()]?.season_autumn || 'ç§‹',
    å†¬: translations[getLang()]?.season_winter || 'å†¬'
  };
  return map[s] || translations[getLang()]?.season_generic || 'å­£èŠ‚å¯¹å‘½å±€æœ‰ä¸€å®šå½±å“';
}
function strategyName(s) {
  const L = translations[getLang()] || translations['zh-CN'];
  const map = { 'æ³„ç§€/åˆ¶åŒ–': L.rpt_strategy_drain || 'æ³„ç§€/åˆ¶åŒ–', 'ç”Ÿæ‰¶/è¡¥åŠ©': L.rpt_strategy_support || 'ç”Ÿæ‰¶/è¡¥åŠ©', è°ƒå’Œ: L.rpt_strategy_balance || 'è°ƒå’Œ' };
  return map[s] || s;
}

/* ============ æŠ¥å‘Šï¼šå…è´¹ + å¯ŒæŠ¥å‘Šï¼ˆç»´æŒåŸåŠŸèƒ½ï¼‰ ============ */
function buildFreeReportHTML({ pillars, percents, st, adv, timeUnknown }) {
  const E = ELABEL();
  const entries = Object.entries(percents || {});
  const strongestK = entries.reduce((a, b) => (a[1] > b[1] ? a : b), ['wood', 0])[0];
  const weakestK = entries.reduce((a, b) => (a[1] < b[1] ? a : b), ['wood', 0])[0];
  const strongest = E[strongestK] || '';
  const weakest = E[weakestK] || '';
  const absents = Object.keys(percents || {})
    .filter((k) => Math.round(percents[k] || 0) === 0)
    .map((k) => E[k])
    .filter(Boolean);
  const fmt = (k) => `${E[k]} ${Math.round(percents[k] || 0)}%`;
  const lang = (getLang() || '').toLowerCase();
  const sep = lang.startsWith('zh') ? 'ã€€' : ' Â· ';
  const line = ['wood', 'fire', 'earth', 'metal', 'water'].map(fmt).join(sep);

  const favLoc = elCharsToLocale(adv?.useful || []);
  const avoidLoc = elCharsToLocale(adv?.avoid || []);
  const favText = favLoc.length ? listJoin(favLoc) : lang.startsWith('zh') ? 'â€”' : 'â€”';
  const avoidText = avoidLoc.length ? listJoin(avoidLoc) : lang.startsWith('zh') ? 'â€”' : 'â€”';

  const hourTxt = timeUnknown ? t('rpt_time_unknown') : pillars.hour.stem + pillars.hour.branch;
  const dmElemKey = EL_CHAR_TO_KEY[pillars.day.element] || 'wood';
  const dmElemName = E[dmElemKey];
  const stName = strategyName(st.focus);

  const favAvoidLine = t('rpt_fav_avoid_template').replace('{fav}', favText).replace('{avoid}', avoidText);
  const absStr = absents.length
    ? (lang.startsWith('zh')
        ? `ï¼ˆ${t('rpt_absent_prefix')}${listJoin(absents)}ï¼‰`
        : ` (${t('rpt_absent_prefix')}${listJoin(absents)})`)
    : '';

  return `
    <div class="xl-card" style="margin-top:12px;padding:16px;border-radius:10px;background:var(--card);box-shadow:var(--shadow);">
      <h3 style="margin:0 0 8px;color:var(--brand)">${t('rpt_free_title')}</h3>
      <p style="margin:6px 0;">${t('rpt_pillars_label')}ï¼š<strong>${pillars.year.stem}${pillars.year.branch} ${pillars.month.stem}${pillars.month.branch} ${pillars.day.stem}${pillars.day.branch} ${hourTxt}</strong></p>
      <p style="margin:6px 0;">${t('rpt_daymaster_label')}ï¼š<strong>${pillars.day.stem}</strong>ï¼ˆ<strong>${dmElemName}</strong>ï¼‰ï½œ${t('rpt_season_label')}ï¼š<strong>${seasonName(st.season) || '-'}</strong>ï½œ${t('rpt_chart_label')}ï¼š<strong>${t('strength_' + (st.mark === 'åå¼º' ? 'strong' : st.mark === 'åå¼±' ? 'weak' : 'balanced'))}</strong> Â· <strong>${t('rpt_strategy_label')}ï¼š${stName}</strong></p>
      <p style="margin:8px 0;">${t('rpt_wuxing_label')}ï¼š${line}</p>
      <p style="margin:4px 0;"><strong>${strongest}</strong>${t('rpt_strongest_word')}ï¼›<strong>${weakest}</strong>${t('rpt_weakest_word')}ã€‚${absStr}</p>
      <ul style="margin:6px 0 0 18px;line-height:1.6">
        <li>${favAvoidLine}</li>
        <li>${t('rpt_balance_focus_label')}ï¼š${stName}</li>
      </ul>
      ${timeUnknown ? `<p class="muted" style="margin-top:6px;">${t('rpt_time_hint')}</p>` : ''}
    </div>`;
}

function buildRichReportHTML({ pillars, percents, st, adv, timeUnknown }) {
  const E = ELABEL();
  const lang = (getLang() || '').toLowerCase();
  const sep = lang.startsWith('zh') ? '' : ' ';
  const line = ['wood', 'fire', 'earth', 'metal', 'water']
    .map((k) => `${E[k]}${sep}${Math.round(percents[k] || 0)}%`)
    .join(lang.startsWith('zh') ? ' ' : ' Â· ');

  const entries = Object.entries(percents || {});
  const strongestK = entries.reduce((a, b) => (a[1] > b[1] ? a : b), ['wood', 0])[0];
  const weakestK = entries.reduce((a, b) => (a[1] < b[1] ? a : b), ['wood', 0])[0];
  const strongest = E[strongestK] || 'â€”';
  const weakest = E[weakestK] || 'â€”';
  const absentsArr = Object.keys(percents || {})
    .filter((k) => Math.round(percents[k] || 0) === 0)
    .map((k) => E[k]);
  const absentsStr = absentsArr.length
    ? lang.startsWith('zh')
      ? `ï¼ˆ${t('rpt_absent_prefix')}${listJoin(absentsArr)}ï¼‰`
      : ` (${t('rpt_absent_prefix')}${listJoin(absentsArr)})`
    : '';

  const favLoc = elCharsToLocale(adv?.useful || []);
  const avoidLoc = elCharsToLocale(adv?.avoid || []);
  const favList = favLoc.length ? listJoin(favLoc) : lang.startsWith('zh') ? 'â€”' : 'â€”';
  const avoidList = avoidLoc.length ? listJoin(avoidLoc) : lang.startsWith('zh') ? 'â€”' : 'â€”';

  const hourTxt = timeUnknown ? t('rpt_time_unknown') : pillars.hour.stem + pillars.hour.branch;
  const dmElemKey = EL_CHAR_TO_KEY[pillars.day.element] || 'wood';
  const dmElemName = E[dmElemKey];
  const stName = strategyName(st.focus);

  return `
    <section class="card" style="padding:20px;">
      <h3 style="margin-top:0;color:var(--brand)">${t('rpt_sec_overview_title')}</h3>
      <div style="display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px;font-size:14px;">
        <div>${t('rpt_pillars_label')}ï¼š<strong>${pillars.year.stem}${pillars.year.branch} ${pillars.month.stem}${pillars.month.branch} ${pillars.day.stem}${pillars.day.branch} ${hourTxt}</strong></div>
        <div>${t('rpt_daymaster_label')}ï¼š<strong>${pillars.day.stem}</strong>ï¼ˆ<strong>${dmElemName}</strong>ï¼‰</div>
        <div>${t('rpt_season_label')}ï¼š<strong>${seasonName(st.season) || '-'}</strong></div>
        <div>${t('rpt_chart_label')}ï¼š<strong>${t('strength_' + (st.mark === 'åå¼º' ? 'strong' : st.mark === 'åå¼±' ? 'weak' : 'balanced'))}</strong> Â· ${t('rpt_strategy_label')}ï¼š<strong>${stName}</strong></div>
      </div>
    </section>

    <section class="card" style="padding:20px;">
      <h3 style="margin-top:0;color:var(--brand)">${t('rpt_sec_elements_title')}</h3>
      <div style="font-size:14px;">${line}</div>
      <p style="margin:10px 0 0;"><strong>${strongest}</strong>${t('rpt_strongest_word')}ï¼›<strong>${weakest}</strong>${t('rpt_weakest_word')}ã€‚${absentsStr}</p>
      <ul style="margin:10px 0 0 18px;line-height:1.6">
        <li>${t('useful_elements')}${listJoin(favLoc)}</li>
        <li>${t('rpt_balance_focus_label')}ï¼š${stName}</li>
      </ul>
      ${timeUnknown ? `<p class="muted" style="margin-top:8px;">${t('rpt_time_hint')}</p>` : ''}
    </section>

    <section class="card" style="padding:20px;">
      <h3 style="margin-top:0;color:var(--brand)">${t('rpt_sec_traits_title')}</h3>
      <p style="margin:8px 0;">${t('rpt_traits_intro')}</p>
      <p style="margin:8px 0;">${t('rpt_traits_adv')}</p>
      <p style="margin:8px 0;">${t('rpt_traits_chal')}</p>
    </section>

    <section class="card" style="padding:20px;">
      <h3 style="margin-top:0;color:var(--brand)">${t('rpt_sec_structure_title')}</h3>
      <p style="margin:8px 0;">${t('rpt_structure_line_template').replace('{fav}', favList).replace('{avoid}', avoidList)}</p>
    </section>

    <section class="card" style="padding:20px;">
      <h3 style="margin-top:0;color:var(--brand)">${t('rpt_sec_career_title')}</h3>
      <p style="margin:8px 0;">${t('rpt_career_fields_placeholder')}</p>
      <p style="margin:8px 0;">${t('rpt_dev_strategy_prefix')}${stName}ï¼ŒSOP</p>
    </section>

    <section class="card" style="padding:20px;">
      <h3 style="margin-top:0;color:var(--brand)">${t('rpt_sec_love_title')}</h3>
      <p style="margin:8px 0;">${t('rpt_love_placeholder')}</p>
    </section>

    <section class="card" style="padding:20px;">
      <h3 style="margin-top:0;color:var(--brand)">${t('rpt_sec_wealth_title')}</h3>
      <p style="margin:8px 0;">${t('rpt_wealth_suggestion_template').replace('{fav}', favList)}</p>
    </section>

    <section class="card" style="padding:20px;">
      <h3 style="margin-top:0;color:var(--brand)">${t('rpt_sec_health_title')}</h3>
      <p style="margin:8px 0;">${t('rpt_health_placeholder_template').replace('{weak}', weakest)}</p>
    </section>

    <section class="card" style="padding:20px;">
      <h3 style="margin-top:0;color:var(--brand)">${t('rpt_sec_env_title')}</h3>
      <p style="margin:8px 0;">${t('rpt_env_placeholder')}</p>
    </section>

    <div id="butler-anchor"></div>
  `;
}

function buildButlerHTML() {
  return `
    <div id="assistant-panel" class="xl-card"
         style="margin-top:12px;padding:16px;border-radius:10px;background:var(--card);box-shadow:var(--shadow);">
      <h3 class="butler-title" style="margin:0 0 8px;color:var(--brand)" data-i18n="butler_title">${t('butler_title')}</h3>
      <div id="assistant-analysis"></div>
      <div id="assistant-advice" style="margin-top:8px"></div>
    </div>`;
}

function mountExtensionsIntoResult({ pillars, percents, st, adv, timeUnknown }) {
  const resultEl = $('result');
  if (!resultEl) return;

  let freeNode = $('xl-free-report');
  if (!freeNode) {
    freeNode = document.createElement('div');
    freeNode.id = 'xl-free-report';
    resultEl.appendChild(freeNode);
  }
  freeNode.innerHTML = buildFreeReportHTML({ pillars, percents, st, adv, timeUnknown });
}

function relocateButlerPanel() {
  const panel = document.getElementById('assistant-panel');
  const anchor = document.getElementById('butler-anchor');
  if (panel && anchor && anchor.parentNode) {
    anchor.parentNode.insertBefore(panel, anchor.nextSibling);
  }
}

function mountRichReport({ pillars, percents, st, adv, timeUnknown }) {
  let host = document.getElementById('rich-report');
  if (!host) {
    host = document.createElement('div');
    host.id = 'rich-report';
    const result = document.getElementById('result');
    if (result) result.appendChild(host);
  }
  host.innerHTML = buildRichReportHTML({ pillars, percents, st, adv, timeUnknown });
}

/* ================== Butler AI å¡ç‰‡ï¼ˆèŠ¯ç‰‡/é”å®š/å¤šè¯­è¨€ï¼‰ ================== */
(function injectAiStyle() {
  const old = document.getElementById('ai-style');
  if (old) old.remove();
  const style = document.createElement('style');
  style.id = 'ai-style';
  style.textContent = `
    .ai-content{white-space:pre-wrap;line-height:1.7}
    .chips{display:flex;flex-wrap:wrap;gap:8px;margin-top:12px}
    .chip{padding:6px 10px;border-radius:999px;border:1px solid #2a3546;background:#0e1520;color:#e8edf3;cursor:pointer}
    .skeleton{display:grid;gap:8px}
    .skeleton div{height:12px;border-radius:6px;background:linear-gradient(90deg,#1a2431,#1f2b3b,#1a2431);animation:sh 1.2s infinite}
    @keyframes sh{0%{opacity:.5}50%{opacity:1}100%{opacity:.5}}
    .ai-lock-overlay{position:static;inset:auto;background:none;backdrop-filter:none;margin-top:10px;padding-top:10px;border-top:1px solid var(--line);text-align:center}
    .ai-lock-overlay .tip{color:#ffd88a;font-weight:700;margin-bottom:4px}
    .ai-lock-overlay .sub{color:var(--muted)}
  `;
  document.head.appendChild(style);
})();

function mdToHtml(md) {
  return (md || '')
    .replace(/^###?\s+(.*)$/gm, '<h3 style="margin:12px 0 6px;color:#f2d27a">$1</h3>')
    .replace(/^\s*[-*]\s+(.*)$/gm, 'â€¢ $1')
    .replace(/\*\*(.+?)\*\*/g, '<b>$1</b>')
    .replace(/\n{2,}/g, '\n\n')
    .replace(/\n/g, '<br/>');
}
function isVIP() {
  return localStorage.getItem('vipStatus') === 'active' || !!localStorage.getItem('vipEmail');
}
function ensureAiCard() {
  if ($('aiCard')) return;
  const wrap = $('rich-report') || $('result');
  if (!wrap) return;
  const sec = document.createElement('div');
  sec.className = 'sec';
  sec.id = 'aiCard';
  sec.innerHTML = `
    <h3 id="butlerTitle" data-i18n="butler_title">${t('butler_title')}</h3>
    <div id="aiContent" class="ai-content">
      <div class="skeleton">
        <div style="width:60%"></div><div style="width:80%"></div><div style="width:90%"></div>
        <div style="width:70%"></div><div style="width:50%"></div>
      </div>
    </div>
    <div class="chips" id="aiChips"></div>`;
  wrap.appendChild(sec);
  renderChips();
}
function renderChips() {
  const wrap = $('aiChips');
  if (!wrap) return;
  wrap.innerHTML = '';
  const items = [
    { k: 'chip_career', q: 'q_career' },
    { k: 'chip_love', q: 'q_love' },
    { k: 'chip_money', q: 'q_money' },
    { k: 'chip_list', q: 'q_list' },
    { k: 'chip_30d', q: 'q_30d' }
  ];
  items.forEach((it) => {
    const btn = document.createElement('button');
    btn.className = 'chip';
    btn.textContent = t(it.k);
    btn.setAttribute('data-q', t(it.q));
    wrap.appendChild(btn);
  });
}

function buildButlerSystemPrompt(lang) {
  const ln = BUTLER_LANG_NAME[lang] || BUTLER_LANG_NAME['zh-CN'];
  const HEADER_MAP = {
    'zh-CN': ['äººç‰©ç”»åƒ', 'å…³ç³»ä¸æ²Ÿé€š', 'äº‹ä¸šä¸è‡ªæˆ‘å®ç°', 'é‡‘é’±ä¸ç‰©è´¨', 'ä»Šæ—¥/æœ¬å‘¨å¯æ‰§è¡Œæ¸…å•', 'æ¸©æŸ”æé†’'],
    'zh-TW': ['äººç‰©ç”»åƒ', 'é—œä¿‚èˆ‡æºé€š', 'äº‹æ¥­èˆ‡è‡ªæˆ‘å¯¦ç¾', 'é‡‘éŒ¢èˆ‡ç‰©è³ª', 'ä»Šæ—¥/æœ¬é€±å¯åŸ·è¡Œæ¸…å–®', 'æº«æŸ”æé†’'],
    en: ['Persona', 'Relationships & Communication', 'Career & Self-Actualization', 'Money & Material', 'Actionable To-Dos (Today/This Week)', 'Gentle Reminder'],
    ja: ['äººç‰©åƒ', 'é–¢ä¿‚ã¨ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³', 'ã‚­ãƒ£ãƒªã‚¢ã¨è‡ªå·±å®Ÿç¾', 'ãŠé‡‘ã¨ç‰©è³ª', 'ä»Šæ—¥/ä»Šé€±ã®å®Ÿè¡Œãƒªã‚¹ãƒˆ', 'ã‚„ã•ã—ã„ãƒªãƒã‚¤ãƒ³ãƒ‰'],
    th: ['à¸ à¸²à¸à¸šà¸¸à¸„à¸„à¸¥', 'à¸„à¸§à¸²à¸¡à¸ªà¸±à¸¡à¸à¸±à¸™à¸˜à¹Œ & à¸à¸²à¸£à¸ªà¸·à¹ˆà¸­à¸ªà¸²à¸£', 'à¸à¸²à¸£à¸‡à¸²à¸™ & à¸à¸²à¸£à¹€à¸•à¸´à¸¡à¹€à¸•à¹‡à¸¡à¸•à¸™à¹€à¸­à¸‡', 'à¸à¸²à¸£à¹€à¸‡à¸´à¸™ & à¸§à¸±à¸•à¸–à¸¸', 'à¸£à¸²à¸¢à¸à¸²à¸£à¸›à¸à¸´à¸šà¸±à¸•à¸´ (à¸§à¸±à¸™à¸™à¸µà¹‰/à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œà¸™à¸µà¹‰)', 'à¸„à¸³à¹€à¸•à¸·à¸­à¸™à¸­à¹ˆà¸­à¸™à¹‚à¸¢à¸™'],
    ms: ['Persona', 'Hubungan & Komunikasi', 'Kerjaya & Aktualisasi Diri', 'Wang & Material', 'Senarai Tindakan (Hari/Minggu Ini)', 'Peringatan Lembut']
  };
  const headers = HEADER_MAP[lang] || HEADER_MAP['zh-CN'];

  return [
    `You are "Xinlian Butler". OUTPUT LANGUAGE: ${ln}. Reply strictly in ${ln} only.`,
    'Warm, practical, actionable. No medical/legal conclusions.',
    'Markdown structure:',
    `## ${headers[0]}`,
    `## ${headers[1]} (2â€“4 bullets)`,
    `## ${headers[2]} (2â€“4 bullets)`,
    `## ${headers[3]} (2â€“3 bullets)`,
    `## ${headers[4]} (3â€“5 bullets; start with verbs; quantify if possible)`,
    `## ${headers[5]}`
  ].join('\n');
}

function buildBaziUserPrompt(ctx) {
  // ctx åŒ…å«ï¼šname,date,time,place(å¯æ— ),pillars,percents,st,adv,timeUnknown
  const { name, date, time, place, pillars, percents, st, adv, timeUnknown } = ctx;
  const fav = listJoin(elCharsToLocale(adv?.useful || []));
  const avoid = listJoin(elCharsToLocale(adv?.avoid || []));
  const elementsLine = `wood ${Math.round(percents.wood)}% Â· fire ${Math.round(percents.fire)}% Â· earth ${Math.round(percents.earth)}% Â· metal ${Math.round(percents.metal)}% Â· water ${Math.round(percents.water)}%`;
  const hourTxt = timeUnknown ? t('rpt_time_unknown') : pillars.hour.stem + pillars.hour.branch;
  return [
    `Name: ${name || '-'}`,
    `Birth: ${date || '-'} ${time || 'â€”'}${place ? ' @ ' + place : ''}`,
    `Bazi pillars: Year ${pillars.year.stem}${pillars.year.branch} Â· Month ${pillars.month.stem}${pillars.month.branch} Â· Day ${pillars.day.stem}${pillars.day.branch} Â· Hour ${hourTxt}`,
    `Day Master: ${pillars.day.stem} (${pillars.day.element})`,
    `Season: ${st.season}; Chart Strength: ${st.mark}; Strategy: ${st.focus}`,
    `Favorable elements: ${fav || 'â€”'}; Avoid: ${avoid || 'â€”'}`,
    `Five elements distribution: ${elementsLine}`,
    'Expectation: human, concrete, and immediately actionable advice.'
  ].join('\n');
}

async function runButlerAI(ctx) {
  ensureAiCard();
  const title = $('butlerTitle');
  if (title) title.textContent = t('butler_title');

  const elC = $('aiContent');
  if (elC) {
    elC.innerHTML = `
      <div class="skeleton">
        <div style="width:60%"></div><div style="width:80%"></div><div style="width:90%"></div>
        <div style="width:70%"></div><div style="width:50%"></div>
      </div>`;
  }

  const lang = getLang();
  const sys = buildButlerSystemPrompt(lang);
  const usr = buildBaziUserPrompt(ctx);

  try {
    const r = await fetch(API_BASE + '/api/chat', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ messages: [{ role: 'system', content: sys }, { role: 'user', content: usr }] })
    });
    const data = await r.json().catch(() => ({}));
    const raw = data?.reply || data?.text || data?.choices?.[0]?.message?.content || '';
    let html = mdToHtml(raw);

    if (!isVIP()) {
      const parts = raw.split(/\n##\s+/);
      const header = parts.shift() || '';
      const kept = [header, ...(parts.slice(0, 2).map((p) => '## ' + p))].join('\n\n');
      html = mdToHtml(kept) + `
        <div class="ai-lock-overlay" style="text-align:center;padding:14px 10px;border-top:1px solid #1f2a36;margin-top:10px">
          <div class="tip">${t('vip_tip')}</div>
          <div class="sub" style="margin-top:4px">${t('vip_sub')}</div>
          <a class="btn" href="https://yourshopifyshop.com/products/monthly-vip" target="_blank" rel="noopener" style="margin-top:10px">${t('btn_unlock')}</a>
        </div>`;
    }

    if (elC) elC.innerHTML = html;
    renderChips();
  } catch (e) {
    if (elC) elC.innerHTML = `<div style="color:#98a7b7">${t('err_network')}</div>`;
  }
}

function rerunButlerIfAny() {
  if (!window.__bazi_ctx__) return;
  runButlerAI(window.__bazi_ctx__);
}

// è¿½é—®èŠ¯ç‰‡ç‚¹å‡»
document.addEventListener('click', (e) => {
  const chip = e.target.closest('.chip');
  if (!chip) return;
  const q = chip.getAttribute('data-q') || chip.textContent;
  const el = $('aiContent');
  if (!el) return;
  el.innerHTML += `<br/><br/><b>â€”</b> ${q}<br/>`;
  const sys = buildButlerSystemPrompt(getLang());
  fetch(API_BASE + '/api/chat', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ messages: [{ role: 'system', content: sys + '\n(Continue previous tone. Add concrete steps.)' }, { role: 'user', content: q }] })
  })
    .then((r) => r.json())
    .then((data) => {
      const txt = data?.reply || data?.text || data?.choices?.[0]?.message?.content || '';
      el.innerHTML += mdToHtml('\n\n' + (txt || '\n\n' + t('err_busy')));
    })
    .catch((err) => {
      el.innerHTML += `<div style=\"color:#98a7b7\">${t('err_network')}</div>`;
    });
});

/* ================== ç”Ÿæˆå‘½ç›˜ï¼ˆæ•´åˆ Butlerï¼‰ ================== */
async function genChart() {
  const birth = ($('birthdate')?.value || '').trim();
  const timeUnknown = $('timeUnknown')?.checked || false;
  const name = $('name')?.value?.trim() || '';
  const place = $('place')?.value?.trim() || '';
  if (!birth) {
    showErr('è¯·å¡«å†™å‡ºç”Ÿæ—¥æœŸã€‚');
    return;
  }

  const btn = $('genBtn'),
    tx = $('genBtnText'),
    ld = $('genBtnLoading');
  if (btn) btn.disabled = true;
  if (tx) tx.style.display = 'none';
  if (ld) ld.style.display = 'inline-block';

  try {
    const [Y, M, D] = birth.split('-').map(Number);
    let hour = 12;
    if (!timeUnknown) {
      const tval = ($('birthtime')?.value || '').trim();
      if (tval) {
        const h = parseInt(tval.split(':')[0], 10);
        if (!Number.isNaN(h)) hour = h;
      }
    }

    const { pillars, counts, percents, timeUnknown: tu } = baziCalculator.calculateBazi(Y, M, D, hour, timeUnknown);

    $('result')?.style.setProperty('display', 'block');
    const timeText = tu ? 'æ—¶é—´ä¸è¯¦' : hour + 'æ—¶';
    setText('bazi-date', `å‡ºç”Ÿæ—¥æœŸ: ${Y}å¹´${M}æœˆ${D}æ—¥ ${timeText}`);
    if (tu) {
      const el = $('bazi-date');
      if (el) el.innerHTML += ' <span class="badge-warn">æœªçº³å…¥æ—¶æŸ±</span>';
    }

    renderPillars($('bazi-pillars'), pillars, tu);
    displayClassicArea(pillars, tu);

    setBar($('bar-æœ¨'), percents.wood);
    setText('pct-æœ¨', Math.round(percents.wood) + '%');
    setBar($('bar-ç«'), percents.fire);
    setText('pct-ç«', Math.round(percents.fire) + '%');
    setBar($('bar-åœŸ'), percents.earth);
    setText('pct-åœŸ', Math.round(percents.earth) + '%');
    setBar($('bar-é‡‘'), percents.metal);
    setText('pct-é‡‘', Math.round(percents.metal) + '%');
    setBar($('bar-æ°´'), percents.water);
    setText('pct-æ°´', Math.round(percents.water) + '%');

    const st = judgeStrength(pillars.day.stem, pillars.month.branch, counts);
    const adv = chooseUseful(st.mark, pillars.day.element);

    // æ›´æ–°â€œæœ€å¼º/æœ€å¼±â€æç¤ºï¼ˆæœ¬åœ°åŒ–ï¼‰
    {
      const E = ELABEL();
      const keys = Object.keys(counts);
      const maxK = keys.reduce((a, b) => (counts[a] > counts[b] ? a : b));
      const minK = keys.reduce((a, b) => (counts[a] < counts[b] ? a : b));
      const char2Locale = { æœ¨: E.wood, ç«: E.fire, åœŸ: E.earth, é‡‘: E.metal, æ°´: E.water };
      setText(
        'bazi-elements-balance',
        t('elements_balance_tpl').replace('{max}', char2Locale[maxK]).replace('{min}', char2Locale[minK])
      );
    }

    // ç¼“å­˜ä¸Šä¸‹æ–‡ï¼Œä¾›è¯­è¨€åˆ‡æ¢/ç»§ç»­è¿½é—®ä½¿ç”¨
    window.__last_report__ = { pillars, percents, st, adv, tu };

    mountExtensionsIntoResult({ pillars, percents, st, adv, timeUnknown: tu });
    mountRichReport({ pillars, percents, st, adv, timeUnknown: tu });

    // Butler AI å¡ç‰‡
    const ctx = { name, place, date: `${Y}-${String(M).padStart(2, '0')}-${String(D).padStart(2, '0')}`, time: timeUnknown ? 'â€”' : `${String(hour).padStart(2, '0')}:00`, pillars, percents, st, adv, timeUnknown: tu };
    window.__bazi_ctx__ = ctx;
    await runButlerAI(ctx);

    // æ§åˆ¶å°æ ¡éªŒ
    console.log(
      'å®é™… â†’',
      pillars.year.stem + pillars.year.branch,
      pillars.month.stem + pillars.month.branch,
      pillars.day.stem + pillars.day.branch,
      tu ? 'ï¼Ÿ' : pillars.hour.stem + pillars.hour.branch
    );
  } catch (err) {
    console.error(err);
    showErr('è®¡ç®—å…«å­—æ—¶å‡ºç°é”™è¯¯ï¼Œè¯·é‡è¯•');
  } finally {
    if (btn) btn.disabled = false;
    if (tx) tx.style.display = 'inline';
    if (ld) ld.style.display = 'none';
  }
}

function rerenderReportsIfAny() {
  const ctx = window.__last_report__;
  if (!ctx) return;
  const { pillars, percents, st, adv, tu } = ctx;
  mountExtensionsIntoResult({ pillars, percents, st, adv, timeUnknown: tu });
  mountRichReport({ pillars, percents, st, adv, timeUnknown: tu });
}

/* ================== å³ä¸‹è§’ Chat æ‚¬æµ®çƒï¼ˆå¤šè¯­è¨€ï¼‰ ================== */
function mountChat() {
  if ($('ssChatFab')) return;
  const chatFab = document.createElement('div');
  chatFab.className = 'ss-chat-fab';
  chatFab.id = 'ssChatFab';
  chatFab.title = t('butler_chat_title');
  const chatPanel = document.createElement('div');
  chatPanel.className = 'ss-chat-panel';
  chatPanel.id = 'ssChatPanel';
  chatPanel.setAttribute('role', 'dialog');
  chatPanel.setAttribute('aria-label', t('butler_chat_title'));
  chatPanel.innerHTML = `
    <div class="ss-chat-head"><div class="ss-chat-title">${t('butler_chat_title')}</div><div class="ss-close" id="ssChatClose">âœ•</div></div>
    <div class="ss-chat-body" id="ssChatBody" aria-live="polite"></div>
    <div class="ss-chat-input">
      <input id="ssChatInput" type="text" placeholder="${t('chat_placeholder')}"/>
      <button id="ssChatSend" class="btn">${t('chat_send')}</button>
    </div>`;
  document.body.appendChild(chatFab);
  document.body.appendChild(chatPanel);
  applyChatI18n();

  const $body = $('ssChatBody'),
    $input = $('ssChatInput'),
    $send = $('ssChatSend'),
    $close = $('ssChatClose');
  const openPanel = () => {
    chatPanel.style.display = 'block';
    $input && $input.focus();
  };
  const closePanel = () => {
    chatPanel.style.display = 'none';
  };
  chatFab.addEventListener('click', openPanel);
  $close && $close.addEventListener('click', closePanel);

  function addMsg(text, me = false) {
    const div = document.createElement('div');
    div.className = 'ss-msg' + (me ? ' me' : '');
    div.textContent = text;
    $body.appendChild(div);
    $body.scrollTop = $body.scrollHeight;
  }
  async function askChat(prompt) {
    addMsg(prompt, true);
    if ($input) {
      $input.value = '';
      $input.focus();
    }
    const sys = [
      `You are "Xinlian Butler". OUTPUT LANGUAGE: ${BUTLER_LANG_NAME[getLang()] || 'Simplified Chinese'}.`,
      'Help visitors understand features, navigation and VIP. Tone: warm, concise, professional.'
    ].join('\n');
    try {
      const r = await fetch(`${API_BASE}/api/chat`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ messages: [{ role: 'system', content: sys }, { role: 'user', content: prompt }] })
      });
      let data, reply = '';
      try {
        data = await r.json();
      } catch {
        data = {};
      }
      reply = data?.reply ?? data?.text ?? data?.choices?.[0]?.message?.content ?? '';
      addMsg(reply || t('err_busy'));
    } catch (e) {
      addMsg(`${t('err_network')}ï¼Œ${t('err_busy')}`);
    }
  }
  $send &&
    $send.addEventListener('click', () => {
      const v = $input?.value.trim();
      if (v) askChat(v);
    });
  $input &&
    $input.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        const v = $input.value.trim();
        if (v) askChat(v);
      }
    });
}

/* ================== ç™»å½•æµç¨‹ï¼ˆåŸåŠŸèƒ½ä¿ç•™ï¼‰ ================== */
async function safeJson(resp) {
  try {
    return await resp.json();
  } catch {
    return { ok: false, msg: 'upstream_error' };
  }
}
async function loginFlow(email, password) {
  const res = await safeJson(
    await fetch(`${API_BASE}/api/login`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email, password })
    })
  );
  const msg = (res.msg || '').toString().toLowerCase();
  let expired = false;
  if (res.expired === true) expired = true;
  else if (msg === 'expired') expired = true;
  else if (res.expiresAt) {
    const ts = Date.parse(res.expiresAt);
    if (!Number.isNaN(ts) && ts < Date.now()) expired = true;
  }
  if (expired) {
    const go = confirm(t('err_expired') + 'ã€‚æ˜¯å¦å‰å¾€ç»­è´¹ï¼Ÿ');
    if (go) window.open('https://yourshopifyshop.com/products/monthly-vip', '_blank');
    return;
  }
  if (res.ok === true) {
    localStorage.setItem('vipEmail', res.email || email);
    location.href = 'https://astro.5xliving.com/vip_soul_sanctuary.html';
    return;
  }
  if (msg === 'no_account') return showAuthErr(t('err_no_account'));
  if (msg === 'wrong_pwd') return showAuthErr(t('err_wrong_pwd'));
  return showAuthErr(t('err_login_fail') + (res.msg ? ` ${res.msg}` : ''));
}

/* ================== é¡µé¢åˆå§‹åŒ– ================== */
document.addEventListener('DOMContentLoaded', () => {
  // é»˜è®¤æ—¥æœŸ
  if ($('birthdate') && !$('birthdate').value) $('birthdate').value = new Date().toISOString().split('T')[0];

  // è¯­è¨€ UI + åˆå§‹æ–‡æ¡ˆ
  initLangUI();
  applyI18n();
  applyChatI18n();

  // ç»‘å®šç”ŸæˆæŒ‰é’®
  $('genBtn')?.addEventListener('click', genChart);

  // å³ä¸‹è§’ Butler Chat
  mountChat();

  // ç™»å½•/æ³¨å†Œ/é‡ç½®ï¼ˆè‹¥é¡µé¢å­˜åœ¨å¯¹åº”è¡¨å•ï¼‰
  $('registerForm')?.addEventListener('submit', async (e) => {
    e.preventDefault();
    hideAuthErr();
    const email = $('email')?.value.trim();
    const password = $('password')?.value.trim();
    if (!email || !password) return showAuthErr(t('err_need_ep'));
    if (!strongPwd(password)) return showAuthErr(t('err_pwd_rule'));
    lock($('registerBtn'), true);
    try {
      const res = await safeJson(
        await fetch(`${API_BASE}/api/register`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email, password })
        })
      );
      if (res.ok === true) {
        localStorage.setItem('vipEmail', email);
        location.href = 'vip_trial.html';
        return;
      }
      if ((res.msg || '').toString() === 'exists') {
        await loginFlow(email, password);
        return;
      }
      return showAuthErr((res.msg && res.msg + '') || t('err_register_fail'));
    } catch (err) {
      showAuthErr(t('err_register_fail') + (err?.message || ''));
    } finally {
      lock($('registerBtn'), false);
    }
  });

  $('loginForm')?.addEventListener('submit', async (e) => {
    e.preventDefault();
    hideAuthErr();
    const email = $('email')?.value.trim();
    const password = $('password')?.value.trim();
    if (!email || !password) return showAuthErr(t('err_need_ep'));
    lock($('loginBtn'), true);
    try {
      await loginFlow(email, password);
    } catch (err) {
      showAuthErr(t('err_login_fail') + (err?.message || ''));
    } finally {
      lock($('loginBtn'), false);
    }
  });

  $('resetBtn')?.addEventListener('click', async () => {
    hideAuthErr();
    let email = prompt(t('prompt_email'));
    if (email === null) return;
    email = email.trim();
    if (!email) return showAuthErr(t('err_email_empty'));
    let newPassword = prompt(t('prompt_newpwd'));
    if (newPassword === null) return;
    newPassword = newPassword.trim();
    if (!newPassword) return showAuthErr(t('err_pwd_empty'));
    if (!strongPwd(newPassword)) return showAuthErr(t('err_pwd_rule'));
    lock($('resetBtn'), true);
    try {
      const res = await safeJson(
        await fetch(`${API_BASE}/api/reset`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email, newPassword })
        })
      );
      if (!res.ok) return showAuthErr((res.msg && res.msg + '') || t('err_reset_fail'));
      alert(t('msg_reset_ok'));
    } catch (err) {
      showAuthErr(t('err_reset_fail') + (err?.message || ''));
    } finally {
      lock($('resetBtn'), false);
    }
  });
});

/* ================== è‡ªæµ‹ï¼š1978-02-21 12:00 â†’ æˆŠåˆ ç”²å¯… ç”²å¯… åºšåˆ ================== */
(function () {
  const c = new BaziCalculator();
  const Y = c.calculateYearPillar(1978);
  const M = c.calculateMonthPillar(1978, 2, 21);
  const D = c.calculateDayPillar(1978, 2, 21);
  const H = c.calculateHourPillar(D.stem, 12);
  console.log('åº”ä¸º â†’ å¹´ æˆŠåˆï½œæœˆ ç”²å¯…ï½œæ—¥ ç”²å¯…ï½œæ—¶ åºšåˆ');
  console.log('å®é™… â†’', Y.stem + Y.branch, M.stem + M.branch, D.stem + D.branch, H.stem + H.branch);
})();
</script>
</body>
</html>
  



