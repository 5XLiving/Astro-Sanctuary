<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<title>å…«å­—å‘½ç† Â· 5XLivingï¼ˆä¿®æ­£ç‰ˆï¼‰</title>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<style>
:root { --bg:#0b0f14; --card:#11161dcc; --line:#1f2a36; --text:#e8edf3; --muted:#9aa3b2; --brand:#d4af37; --gold:#d4af37; --gold2:#f2d27a; --radius:14px; --shadow:0 8px 30px rgba(0,0,0,.35); --accent:#3a86ff; --success:#4cc9a7; --warning:#ff9e00; --danger:#ff5a5f; }
html,body{height:100%;margin:0;color:var(--text);background:var(--bg);font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans SC",Arial,sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;line-height:1.6}
body::before{content:"";position:fixed;inset:0;z-index:-2;background:linear-gradient(135deg,#0b0f14 0%,#1a2433 100%);filter:brightness(.8)}
.container{max-width:1100px;margin:0 auto;padding:24px 16px 80px}
header{position:sticky;top:0;z-index:10;background:#0b0f14cc;border-bottom:1px solid #0f1622;backdrop-filter:saturate(140%) blur(12px)}
.head-inner{display:flex;align-items:center;justify-content:space-between;gap:14px;padding:16px}
.brand{display:flex;align-items:center;gap:12px}
.brand-badge{width:36px;height:36px;border-radius:10px;background:linear-gradient(145deg,#273243,#0e141c);display:grid;place-items:center;color:var(--brand);font-weight:700;box-shadow:var(--shadow)}
.title{font-family:"Noto Serif SC","Noto Serif",serif;font-weight:600;letter-spacing:.02em;font-size:1.4rem}
.subtitle{color:var(--muted);font-size:.9rem}
.card{background:var(--card);border:1px solid #1f2a36;border-radius:var(--radius);box-shadow:var(--shadow);padding:24px;margin-bottom:20px}
.section{margin-top:18px}
.row{display:grid;gap:12px}
@media (min-width:760px){.row.cols-3{grid-template-columns:1fr 1fr 1fr}.row.cols-2{grid-template-columns:1fr 1fr}}
input,select,textarea{width:100%;box-sizing:border-box;border-radius:12px;border:1px solid #243244;background:#0e1520;color:var(--text);padding:12px 12px;font-size:15px;transition:all .2s ease}
input:focus,select:focus,textarea:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 2px rgba(58,134,255,.2)}
button,.btn{width:auto;display:inline-grid;place-items:center;padding:12px 16px;border-radius:12px;border:1px solid #e6c76e;background:linear-gradient(180deg,#fff9e6,#e6c76e);color:#191919;font-weight:700;cursor:pointer;transition:all .2s ease}
.btn:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(212,175,55,.3)}
.btn:disabled{opacity:.6;cursor:not-allowed;transform:none}
.h2{font-size:1.3rem;margin:0 0 1rem;font-weight:700;color:#ffe084;display:flex;align-items:center;gap:10px}
.h2::before{content:"";display:block;width:4px;height:20px;background:var(--brand);border-radius:2px}
.muted{color:#9aa3b2}
footer{color:#6c7b8c;font-size:.85rem;text-align:center;padding:30px 0;margin-top:30px}
.pillars{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:8px}
.pillar{background:#0f1624;border:1px solid #253245;border-radius:12px;padding:14px 10px;text-align:center;transition:all .3s ease;position:relative;overflow:hidden}
.pillar::before{content:"";position:absolute;top:0;left:0;right:0;height:3px;background:var(--brand);opacity:0;transition:opacity .3s ease}
.pillar:hover{transform:translateY(-3px);border-color:var(--brand)}
.pillar:hover::before{opacity:1}
.pillar .tit{color:#9aa3b2;font-size:.85rem;margin-bottom:6px}
.pillar .gz{font-size:1.5rem;font-weight:700;letter-spacing:.05em;color:var(--gold2)}
.bazi-table{width:100%;border-collapse:collapse;margin:15px 0;background:#0f1624;border-radius:8px;overflow:hidden}
.bazi-table th,.bazi-table td{padding:12px 15px;border:1px solid #253245;text-align:center}
.bazi-table th{background:rgba(212,175,55,.1);color:var(--gold2);font-weight:600}
.bars{display:grid;gap:8px;margin-top:10px}
.bar{height:10px;background:#0d1420;border:1px solid #233146;border-radius:999px;overflow:hidden;position:relative}
.bar i{display:block;height:100%;background:linear-gradient(90deg,#ffe084,#f2d27a);transition:width 1s ease}
.bar-label{display:flex;justify-content:space-between;margin-top:4px;font-size:.85rem}
.analysis-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px;margin:20px 0}
.analysis-card{background:rgba(15,22,36,.7);border:1px solid #253245;border-radius:12px;padding:20px}
.analysis-card-title{font-size:1.1rem;font-weight:600;color:var(--gold2);margin-bottom:12px}
.time-unknown-container{display:flex;align-items:center;gap:8px;margin-top:8px}
.time-unknown-checkbox{width:16px;height:16px}
.time-unknown-label{font-size:.9rem;color:var(--muted)}
.time-input-container{transition:all .3s ease}
.time-input-container.disabled{opacity:.5;pointer-events:none}
.chatgpt-window{position:fixed;bottom:20px;right:20px;width:380px;height:500px;background:var(--card);border:1px solid #1f2a36;border-radius:var(--radius);box-shadow:var(--shadow);display:none;flex-direction:column;z-index:1000}
.chatgpt-header{padding:15px;border-bottom:1px solid #1f2a36;display:flex;justify-content:space-between;align-items:center;background:rgba(15,22,36,.9)}
.chatgpt-title{font-weight:600;color:var(--gold2);display:flex;align-items:center;gap:8px}
.chatgpt-close{background:none;border:none;color:var(--muted);font-size:1.2rem;cursor:pointer;padding:5px}
.chatgpt-body{flex:1;padding:15px;overflow-y:auto;display:flex;flex-direction:column;gap:10px}
.chat-message{max-width:85%;padding:10px 15px;border-radius:15px;line-height:1.4}
.chat-message.user{align-self:flex-end;background:var(--accent);color:#fff}
.chat-message.bot{align-self:flex-start;background:rgba(15,22,36,.7);border:1px solid #253245}
.chatgpt-input{padding:15px;border-top:1px solid #1f2a36;display:flex;gap:10px}
.chatgpt-input input{flex:1;padding:10px 15px}
.chatgpt-send{padding:10px 15px;background:var(--accent);color:#fff;border:none;border-radius:8px;cursor:pointer}
.chatgpt-fab{position:fixed;bottom:20px;right:20px;width:60px;height:60px;background:linear-gradient(135deg,#10a37f,#1a7f64);border:none;border-radius:50%;color:#fff;font-size:1.5rem;cursor:pointer;box-shadow:var(--shadow);z-index:999;display:flex;align-items:center;justify-content:center}
.astro-auth{margin-top:30px}
.auth-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px}
.panel{background:rgba(15,22,36,.7);border:1px solid #253245;border-radius:12px;padding:20px}
.panel .head{font-size:1.1rem;font-weight:600;color:var(--gold2);margin-bottom:15px;text-align:center}
.btn.block{width:100%;margin-bottom:10px}
.btn.ghost{background:transparent;border:1px solid var(--muted);color:var(--text)}
.btn-gold{background:linear-gradient(180deg,#fff9e6,#e6c76e);color:#191919;border:1px solid #e6c76e}
.spacer{height:15px}
.error{color:var(--danger);background:rgba(255,90,95,.1);padding:10px;border-radius:8px;margin-top:10px}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.loading{display:inline-block;width:20px;height:20px;border:3px solid rgba(255,255,255,.3);border-radius:50%;border-top-color:var(--brand);animation:spin 1s ease-in-out infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.error-message{background:rgba(255,90,95,.1);border:1px solid var(--danger);border-radius:8px;padding:12px;margin:10px 0;color:#ffb4b4}
.membership-section{max-width:100%;box-sizing:border-box;padding:15px;margin:10px 0}
.vip-pricing{background:linear-gradient(135deg,#ffd700,#ffed4e);border-radius:12px;padding:20px;margin:15px 0;text-align:center;border:1px solid #e6c76e;box-shadow:0 4px 12px rgba(212,175,55,.3)}
.vip-price{font-size:2rem;font-weight:bold;color:#b8860b;margin:10px 0}
.vip-features{list-style:none;padding:0;margin:15px 0}
.vip-features li{padding:8px 0;border-bottom:1px solid rgba(255,255,255,.1)}
@media (max-width:768px){.membership-section{padding:10px;margin:5px 0}.vip-pricing{padding:15px}.vip-price{font-size:1.5rem}}
</style>
</head>
<body>
<header>
  <div class="head-inner container">
    <div class="brand">
      <div class="brand-badge">5X</div>
      <div>
        <div class="title">å‘½ç†ä¾›é—¨ Â· å…«å­—ç®€è¯„</div>
        <div class="subtitle">å…è´¹ç‰ˆ Â· å…¨é¢ä¸æ·±ï½œVIP è§£é”æµå¹´/å¤§è¿/æ‹©æ—¥/å‘½å</div>
      </div>
    </div>
    <div class="lang">
      <label for="langSelect">è¯­è¨€</label>
      <select id="langSelect" aria-label="Language">
        <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
        <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
        <option value="en">English</option>
        <option value="ms">Bahasa Melayu</option>
      </select>
    </div>
  </div>
</header>
<main class="container">
  <section class="card">
    <div class="h2">å…«å­—å‘½ç† Â· å¿«é€Ÿæ’ç›˜</div>
    <div class="row cols-3">
      <div>
        <label class="muted">å§“åï¼ˆå¯é€‰ï¼‰</label>
        <input id="name" placeholder="ä½ çš„ç§°å‘¼ï¼ˆç”¨äºä¸ªæ€§åŒ–ï¼‰">
      </div>
      <div>
        <label class="muted">æ€§åˆ«</label>
        <select id="gender">
          <option value="">ä¸é€éœ²</option>
          <option value="male">ç”·æ€§</option>
          <option value="female">å¥³æ€§</option>
          <option value="other">å…¶ä»–</option>
        </select>
      </div>
      <div>
        <label class="muted">å†æ³•</label>
        <div style="display:flex; gap:8px; align-items:center;">
          <select id="calendar">
            <option value="gregorian">é˜³å† / Gregorian</option>
            <option value="lunar">å†œå† / Lunar</option>
          </select>
          <label id="leapWrap" style="display:none; align-items:center; gap:6px; margin-left:8px;">
            <input type="checkbox" id="isLeap"> é—°æœˆ
          </label>
        </div>
      </div>
    </div>

    <div class="row cols-3" style="margin-top:10px">
      <div>
        <label class="muted">å‡ºç”Ÿæ—¥æœŸ</label>
        <input type="date" id="birthdate">
      </div>
      <div>
        <label class="muted">å‡ºç”Ÿæ—¶é—´</label>
        <div class="time-input-container" id="timeInputContainer">
          <input type="time" id="birthtime" value="12:00">
        </div>
        <div class="time-unknown-container">
          <input type="checkbox" id="timeUnknown" class="time-unknown-checkbox">
          <label for="timeUnknown" class="time-unknown-label">å‡ºç”Ÿæ—¶é—´ä¸è¯¦</label>
        </div>
      </div>
      <div style="display:flex;align-items:flex-end">
        <button class="btn" id="genBtn">
          <span id="genBtnText">ç”Ÿæˆå…«å­—</span>
          <span id="genBtnLoading" class="loading" style="display:none"></span>
        </button>
      </div>
    </div>

    <div class="muted" style="margin-top:6px">æç¤ºï¼šä¸´æ—¶é»˜è®¤ä¸œå…«åŒºï¼ˆUTC+8ï¼‰ã€‚åç»­å°†æ”¯æŒæŒ‰å‡ºç”Ÿåœ°æ¢ç®—ã€‚</div>
    <div id="error" class="error-message" style="display:none"></div>
  </section>

  <section id="result" style="display:none;">
    <div class="card section">
      <div class="h2">æ‚¨çš„ç”Ÿè¾°å…«å­—å‘½ç›˜</div>
      <div class="pillars" id="bazi-pillars"></div>
      <div class="muted" id="bazi-date"></div>
      <table class="bazi-table">
        <thead>
          <tr><th></th><th>å¹´æŸ±</th><th>æœˆæŸ±</th><th>æ—¥æŸ±</th><th>æ—¶æŸ±</th></tr>
        </thead>
        <tbody>
          <tr><td>å¤©å¹²</td><td id="year-stem">-</td><td id="month-stem">-</td><td id="day-stem">-</td><td id="hour-stem">-</td></tr>
          <tr><td>åœ°æ”¯</td><td id="year-branch">-</td><td id="month-branch">-</td><td id="day-branch">-</td><td id="hour-branch">-</td></tr>
          <tr><td>äº”è¡Œ</td><td id="year-element">-</td><td id="month-element">-</td><td id="day-element">-</td><td id="hour-element">-</td></tr>
          <tr><td>çº³éŸ³</td><td id="year-nayin">-</td><td id="month-nayin">-</td><td id="day-nayin">-</td><td id="hour-nayin">-</td></tr>
        </tbody>
      </table>
    </div>

    <div class="card section">
      <div class="h2">äº”è¡Œèƒ½é‡åˆ†æ</div>
      <div class="bars">
        <div class="bar"><i id="bar-æœ¨"></i></div>
        <div class="bar-label"><span>æœ¨</span><span id="pct-æœ¨">0%</span></div>
        <div class="bar"><i id="bar-ç«"></i></div>
        <div class="bar-label"><span>ç«</span><span id="pct-ç«">0%</span></div>
        <div class="bar"><i id="bar-åœŸ"></i></div>
        <div class="bar-label"><span>åœŸ</span><span id="pct-åœŸ">0%</span></div>
        <div class="bar"><i id="bar-é‡‘"></i></div>
        <div class="bar-label"><span>é‡‘</span><span id="pct-é‡‘">0%</span></div>
        <div class="bar"><i id="bar-æ°´"></i></div>
        <div class="bar-label"><span>æ°´</span><span id="pct-æ°´">0%</span></div>
      </div>
      <div id="bazi-elements-balance" class="muted" style="margin-top:8px"></div>
    </div>

    <div class="card section">
      <div class="h2">å‘½ç†è¯¦ç»†åˆ†æ</div>
      <div class="analysis-grid">
        <div class="analysis-card">
          <div class="analysis-card-title">ğŸ“… æ—¥æŸ±å‘½ç†</div>
          <div id="day-pillar-analysis">æ ¹æ®æ‚¨çš„å…«å­—æ—¥æŸ±è¿›è¡Œæ·±åº¦åˆ†æ...</div>
        </div>
        <div class="analysis-card">
          <div class="analysis-card-title">ğŸ å¹´å‘½ç”Ÿè‚–</div>
          <div id="zodiac-analysis">æ ¹æ®æ‚¨çš„å‡ºç”Ÿå¹´ä»½åˆ†æç”Ÿè‚–ç‰¹æ€§...</div>
        </div>
        <div class="analysis-card">
          <div class="analysis-card-title">ğŸ’¼ äº‹ä¸šè´¢è¿</div>
          <div id="career-analysis">åˆ†ææ‚¨çš„äº‹ä¸šå‘å±•æ–¹å‘å’Œè´¢è¿è¶‹åŠ¿...</div>
        </div>
        <div class="analysis-card">
          <div class="analysis-card-title">ğŸ¤ äººé™…å…³ç³»</div>
          <div id="relationship-analysis">åˆ†ææ‚¨çš„å§»ç¼˜å’Œäººé™…å…³ç³»...</div>
        </div>
      </div>
    </div>

    <div class="card section">
      <div class="h2">ğŸŒ™ ä¼šå‘˜åŒºåŸŸ VIP Segment</div>
      <div class="row cols-2">
        <div>
          <h4 style="color:var(--gold2); margin-bottom:10px;">ğŸ— å‘½ç†ç©ºé—´ä¸“å±å†…å®¹</h4>
          <ul style="color:var(--muted); line-height:1.8; font-size:.9rem;">
            <li>å§»ç¼˜æ–¹å‘ï¼šæ‹çˆ±ç¼˜åˆ†ã€å©šå§»èµ°åŠ¿</li>
            <li>äº‹ä¸šæ–¹å‘ï¼šèŒåœºå‘å±•ã€åˆ›ä¸šæ½œåŠ›</li>
            <li>è´¢è¿æ–¹å‘ï¼šè´¢ä½åˆ†æã€ç†è´¢æ—¶æœº</li>
            <li>å® ç‰©å‘½ç†ï¼šä¼´ä¾£åŠ¨ç‰©çš„æ€§æ ¼ä¸ç¼˜åˆ†</li>
            <li>åˆç›˜åˆ†æï¼šå©šæœŸæ‹©æ—¥ã€æ–°ç”Ÿæ‹©æ—¶</li>
            <li>æµ‹ååˆ†æï¼šå…¬å¸åã€å®å®åã€å‘½åæ”¹è¿</li>
            <li>è´¢ä½åˆç›˜ï¼šä½å®¶ / åŠå…¬å®¤åŠ¨çº¿é…åˆ</li>
          </ul>
        </div>
        <div>
          <h4 style="color:var(--gold2); margin-bottom:10px;">ğŸŒ™ å¿ƒæ€œç©ºé—´ä¸“å±å†…å®¹</h4>
          <ul style="color:var(--muted); line-height:1.8; font-size:.9rem;">
            <li>çµæ€§è®°å½•ï¼šç…§ç‰‡ã€æ¢¦å¢ƒã€å£°éŸ³ã€æ„¿æœ›ç¥ˆç¥·</li>
            <li>å‘½ç†è¯¾ç¨‹ï¼šå…«å­— / å¡”ç½— / å æ˜Ÿ / çµæ•° / äººç±»å›¾</li>
            <li>å®¶æ—çºªå¿µç³»ç»Ÿï¼šäº²äººçµæ€§çºªå¿µ & å»¶ç»­</li>
            <li>æ¯å‘¨èƒ½é‡ç»ƒä¹  / ç¥æ˜ä»ªå¼ä»»åŠ¡</li>
            <li>èƒ½é‡å•†åŸä¸“å±æŠ˜æ‰£ & å¾¡å®ˆè®¢åˆ¶</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <section class="astro-auth">
    <div class="auth-grid">
      <div class="panel">
        <div class="head">è´¦æˆ·ç™»å½• / æ³¨å†Œ</div>
        <div class="body">
          <div class="row" id="authFields">
            <input id="email" type="email" inputmode="email" autocomplete="email" placeholder="é‚®ç®± Email" required />
            <input id="password" type="password" autocomplete="new-password" placeholder="å¯†ç  Passwordï¼ˆè‡³å°‘8ä½ï¼Œå«å¤§å°å†™æ•°å­—ç¬¦å·ï¼‰" required />
          </div>
          <div class="spacer"></div>
          <form id="loginForm" class="row one">
            <button class="btn block" id="loginBtn" type="submit">ç™»å…¥è´¦æˆ·</button>
          </form>
          <div class="spacer"></div>
          <div class="row one">
            <button class="btn ghost block" id="resetBtn" type="button">ğŸ”‘ é‡è®¾å¯†ç </button>
          </div>
          <div class="spacer"></div>
          <form class="row one" id="registerForm">
            <button class="btn block" id="registerBtn" type="submit">æ³¨å†Œè´¦æˆ·</button>
            <div class="muted">æ³¨å†Œè´¦å·èµ é€ä¸€æ¬¡å…è´¹ä½“éªŒ</div>
            <div class="spacer"></div>
            <div class="error" id="authError" style="display:none"></div>
          </form>
        </div>
      </div>
      <div class="panel">
        <div class="head">ä¼šå‘˜æœåŠ¡</div>
        <div class="body">
          <div class="row one">
            <a class="btn btn-gold block" href="https://yourshopifyshop.com/products/monthly-vip" target="_blank" rel="noopener noreferrer">ğŸ’ å‡çº§ä¸º VIPï¼ˆæœˆè´¹ï¼‰</a>
          </div>
          <div class="spacer"></div>
          <div class="row one">
            <a class="btn ghost block" href="https://yourshopifyshop.myshopify.com" target="_blank" rel="noopener noreferrer">â† è¿”å›å‘½ç†å•†åŸ</a>
          </div>
          <div class="spacer"></div>
          <div class="muted">$9.9 / æœˆè´¹ VIPï¼ˆå‘½ç†ç©ºé—´ + å¿ƒæ€œç©ºé—´ + çµæ€§è¯¾ç¨‹ï¼‰</div>
        </div>
      </div>
    </div>
  </section>
</main>
<footer>Â© 5XLiving â€¢ Astro Sanctuary</footer>
<button class="chatgpt-fab" id="chatgptFab">ğŸ’¬</button>
<div class="chatgpt-window" id="chatgptWindow">
  <div class="chatgpt-header">
    <div class="chatgpt-title"><span>ğŸ’¬ å¿ƒæ€œç®¡å®¶</span></div>
    <button class="chatgpt-close" id="chatgptClose">Ã—</button>
  </div>
  <div class="chatgpt-body" id="chatgptBody">
    <div class="chat-message bot">æ‚¨å¥½ï¼æˆ‘æ˜¯å¿ƒæ€œç®¡å®¶ï¼Œå¯ä»¥ä¸ºæ‚¨è§£ç­”å…«å­—å‘½ç†ç›¸å…³é—®é¢˜ã€‚è¯·é—®æœ‰ä»€ä¹ˆå¯ä»¥å¸®æ‚¨çš„ï¼Ÿ</div>
  </div>
  <div class="chatgpt-input">
    <input type="text" id="chatgptInput" placeholder="è¾“å…¥æ‚¨çš„é—®é¢˜...">
    <button class="chatgpt-send" id="chatgptSend">å‘é€</button>
  </div>
</div>

<script>
// =========================
// å…«å­—è®¡ç®—å™¨ï¼ˆä¿®æ­£ç‰ˆï¼‰
// =========================
class BaziCalculator {
  constructor() {
    this.HEAVENLY_STEMS = ['ç”²','ä¹™','ä¸™','ä¸','æˆŠ','å·±','åºš','è¾›','å£¬','ç™¸'];
    this.EARTHLY_BRANCHES = ['å­','ä¸‘','å¯…','å¯','è¾°','å·³','åˆ','æœª','ç”³','é…‰','æˆŒ','äº¥'];
    this.ZODIAC = ['é¼ ','ç‰›','è™','å…”','é¾™','è›‡','é©¬','ç¾Š','çŒ´','é¸¡','ç‹—','çŒª'];
    this.NAYIN = ['æµ·ä¸­é‡‘','ç‚‰ä¸­ç«','å¤§æ—æœ¨','è·¯æ—åœŸ','å‰‘é”‹é‡‘','å±±å¤´ç«','æ¶§ä¸‹æ°´','åŸå¤´åœŸ','ç™½èœ¡é‡‘','æ¨æŸ³æœ¨','æ³‰ä¸­æ°´','å±‹ä¸ŠåœŸ','éœ¹é›³ç«','æ¾æŸæœ¨','é•¿æµæ°´','ç ‚çŸ³é‡‘','å±±ä¸‹ç«','å¹³åœ°æœ¨','å£ä¸ŠåœŸ','é‡‘ç®”é‡‘','ä½›ç¯ç«','å¤©æ²³æ°´','å¤§é©¿åœŸ','é’—é’é‡‘','æ¡‘æŸ˜æœ¨','å¤§æºªæ°´','æ²™ä¸­åœŸ','å¤©ä¸Šç«','çŸ³æ¦´æœ¨','å¤§æµ·æ°´'];
  }
  // å¹´æŸ±
  calculateYearPillar(year){
    const stemIndex = (year - 4) % 10;
    const branchIndex = (year - 4) % 12;
    return { stem:this.HEAVENLY_STEMS[stemIndex], branch:this.EARTHLY_BRANCHES[branchIndex], zodiac:this.ZODIAC[branchIndex] };
  }
  // æŒ‰èŠ‚æ°”ç¡®å®šâ€œèŠ‚æ°”æœˆåºâ€(å¯…=1,â€¦,ä¸‘=12)
  solarMonthIndex(y,m,d){
    const mmdd = m * 100 + d;
    // è¿‘ä¼¼èŠ‚æ°”åˆ†ç•Œï¼ˆç«‹æ˜¥2/4ã€æƒŠè›°3/6ã€æ¸…æ˜4/5ã€ç«‹å¤5/6ã€èŠ’ç§6/6ã€å°æš‘7/7ã€ç«‹ç§‹8/8ã€ç™½éœ²9/8ã€å¯’éœ²10/8ã€ç«‹å†¬11/7ã€å¤§é›ª12/7ã€å°å¯’1/6ï¼‰
    if (mmdd >= 1207 || mmdd < 106) return { branch:'å­', index:11 };
    if (mmdd < 204) return { branch:'ä¸‘', index:12 };
    if (mmdd < 306) return { branch:'å¯…', index:1 };
    if (mmdd < 405) return { branch:'å¯', index:2 };
    if (mmdd < 506) return { branch:'è¾°', index:3 };
    if (mmdd < 606) return { branch:'å·³', index:4 };
    if (mmdd < 707) return { branch:'åˆ', index:5 };
    if (mmdd < 808) return { branch:'æœª', index:6 };
    if (mmdd < 908) return { branch:'ç”³', index:7 };
    if (mmdd < 1008) return { branch:'é…‰', index:8 };
    if (mmdd < 1107) return { branch:'æˆŒ', index:9 };
    return { branch:'äº¥', index:10 };
  }
  // æœˆæŸ±ï¼ˆèŠ‚æ°”æœˆ + å¹´å¹²èµ·å§‹è¡¨ï¼‰
  calculateMonthPillar(year, month, day){
    const { branch, index } = this.solarMonthIndex(year, month, day);
    const yStem = this.calculateYearPillar(year).stem;
    const yIdx = this.HEAVENLY_STEMS.indexOf(yStem);
    // ç”²å·±å¹´ä¸™å¯…èµ·(2)ã€ä¹™åºšå¹´æˆŠå¯…èµ·(4)ã€ä¸™è¾›å¹´åºšå¯…èµ·(6)ã€ä¸å£¬å¹´å£¬å¯…èµ·(8)ã€æˆŠç™¸å¹´ç”²å¯…èµ·(0)
    const monthStartMap = {0:2,1:4,2:6,3:8,4:0,5:2,6:4,7:6,8:8,9:0};
    const start = monthStartMap[yIdx];
    const stemIndex = (start + (index - 1)) % 10;
    return { stem:this.HEAVENLY_STEMS[stemIndex], branch };
  }
  // æ—¥æŸ±ï¼ˆä»¥ 1900-01-31 ä¸ºã€ç”²è¾°ã€‘åŸºå‡†ï¼‰
  calculateDayPillar(year, month, day){
    const base = new Date(1900,0,31); // ç”²è¾°æ—¥ï¼šç”²=0ï¼Œè¾°=4
    const target = new Date(year, month-1, day);
    const dayDiff = Math.floor((target - base) / (1000*60*60*24));
    const stemIndex = ((0 + dayDiff) % 10 + 10) % 10;
    const branchIndex = ((4 + dayDiff) % 12 + 12) % 12;
    return { stem:this.HEAVENLY_STEMS[stemIndex], branch:this.EARTHLY_BRANCHES[branchIndex] };
  }
  // æ—¶æŸ±
  calculateHourPillar(dayStem, hour){
    const branchMap = {23:'å­',0:'å­',1:'ä¸‘',2:'ä¸‘',3:'å¯…',4:'å¯…',5:'å¯',6:'å¯',7:'è¾°',8:'è¾°',9:'å·³',10:'å·³',11:'åˆ',12:'åˆ',13:'æœª',14:'æœª',15:'ç”³',16:'ç”³',17:'é…‰',18:'é…‰',19:'æˆŒ',20:'æˆŒ',21:'äº¥',22:'äº¥'};
    const branch = branchMap[hour];
    const dayStemIndex = this.HEAVENLY_STEMS.indexOf(dayStem);
    const hourStartMap = {0:0,1:2,2:4,3:6,4:8,5:0,6:2,7:4,8:6,9:8};
    const startIndex = hourStartMap[dayStemIndex];
    const hourIndex = Math.floor((hour + 1) / 2) % 12;
    const stemIndex = (startIndex + hourIndex) % 10;
    return { stem:this.HEAVENLY_STEMS[stemIndex], branch };
  }
  getElement(stem, branch){
    const stemE = {ç”²:'æœ¨',ä¹™:'æœ¨',ä¸™:'ç«',ä¸:'ç«',æˆŠ:'åœŸ',å·±:'åœŸ',åºš:'é‡‘',è¾›:'é‡‘',å£¬:'æ°´',ç™¸:'æ°´'};
    const brE = {å­:'æ°´',ä¸‘:'åœŸ',å¯…:'æœ¨',å¯:'æœ¨',è¾°:'åœŸ',å·³:'ç«',åˆ:'ç«',æœª:'åœŸ',ç”³:'é‡‘',é…‰:'é‡‘',æˆŒ:'åœŸ',äº¥:'æ°´'};
    return `${stemE[stem]}${brE[branch]}`;
  }
  getNayin(stem, branch){
    const s = this.HEAVENLY_STEMS.indexOf(stem);
    const b = this.EARTHLY_BRANCHES.indexOf(branch);
    const i = (s*2 + b) % this.NAYIN.length;
    return this.NAYIN[i];
  }
  analyzeElements(bazi){
    const elems = { 'æœ¨':0,'ç«':0,'åœŸ':0,'é‡‘':0,'æ°´':0 };
    for(const k of ['year','month','day','hour']){
      const st = bazi[k].stem; if(st !== 'ï¼Ÿ'){ const e = this.getElement(st,'å­').charAt(0); elems[e]++; }
    }
    for(const k of ['year','month','day','hour']){
      const br = bazi[k].branch; if(br !== 'ï¼Ÿ'){ const e = this.getElement('ç”²',br).charAt(1); elems[e]++; }
    }
    return elems;
  }
}
const baziCalculator = new BaziCalculator();

function displayBaziResult(bazi, year, month, day, hour, timeUnknown){
  document.getElementById('result').style.display = 'block';
  const pillars = [
    { title:'å¹´æŸ±', stem:bazi.year.stem,  branch:bazi.year.branch },
    { title:'æœˆæŸ±', stem:bazi.month.stem, branch:bazi.month.branch },
    { title:'æ—¥æŸ±', stem:bazi.day.stem,   branch:bazi.day.branch },
    { title:'æ—¶æŸ±', stem:bazi.hour.stem,  branch:bazi.hour.branch }
  ];
  const wrap = document.getElementById('bazi-pillars');
  wrap.innerHTML = '';
  pillars.forEach(p => {
    const el = document.createElement('div');
    el.className = 'pillar';
    el.innerHTML = `<div class="tit">${p.title}</div><div class="gz">${p.stem}${p.branch}</div>`;
    wrap.appendChild(el);
  });
  document.getElementById('year-stem').textContent = bazi.year.stem;
  document.getElementById('year-branch').textContent = bazi.year.branch;
  document.getElementById('month-stem').textContent = bazi.month.stem;
  document.getElementById('month-branch').textContent = bazi.month.branch;
  document.getElementById('day-stem').textContent = bazi.day.stem;
  document.getElementById('day-branch').textContent = bazi.day.branch;
  document.getElementById('hour-stem').textContent = bazi.hour.stem;
  document.getElementById('hour-branch').textContent = bazi.hour.branch;
  document.getElementById('year-element').textContent  = baziCalculator.getElement(bazi.year.stem,  bazi.year.branch);
  document.getElementById('month-element').textContent = baziCalculator.getElement(bazi.month.stem, bazi.month.branch);
  document.getElementById('day-element').textContent   = baziCalculator.getElement(bazi.day.stem,   bazi.day.branch);
  document.getElementById('hour-element').textContent  = timeUnknown ? 'æœªçŸ¥' : baziCalculator.getElement(bazi.hour.stem,  bazi.hour.branch);
  document.getElementById('year-nayin').textContent  = baziCalculator.getNayin(bazi.year.stem,  bazi.year.branch);
  document.getElementById('month-nayin').textContent = baziCalculator.getNayin(bazi.month.stem, bazi.month.branch);
  document.getElementById('day-nayin').textContent   = baziCalculator.getNayin(bazi.day.stem,   bazi.day.branch);
  document.getElementById('hour-nayin').textContent  = timeUnknown ? 'æœªçŸ¥' : baziCalculator.getNayin(bazi.hour.stem,  bazi.hour.branch);
  document.getElementById('bazi-date').textContent = `å‡ºç”Ÿæ—¥æœŸ: ${year}å¹´${month}æœˆ${day}æ—¥ ${timeUnknown ? 'æ—¶é—´ä¸è¯¦' : hour + 'æ—¶'}`;
  const elements = baziCalculator.analyzeElements(bazi);
  updateElementBars(elements);
  generateBaziAnalysis(bazi, elements, year);
  document.getElementById('result').scrollIntoView({ behavior:'smooth' });
}

function updateElementBars(elements){
  const total = Object.values(elements).reduce((a,b)=>a+b,0) || 1;
  for(const [el,count] of Object.entries(elements)){
    const pct = (count/total)*100;
    const bar = document.getElementById(`bar-${el}`);
    const pctEl = document.getElementById(`pct-${el}`);
    if(bar) bar.style.width = `${pct.toFixed(1)}%`;
    if(pctEl) pctEl.textContent = `${pct.toFixed(1)}%`;
  }
  const maxEl = Object.keys(elements).reduce((a,b)=>elements[a]>elements[b]?a:b);
  const minEl = Object.keys(elements).reduce((a,b)=>elements[a]<elements[b]?a:b);
  document.getElementById('bazi-elements-balance').textContent = `äº”è¡Œä¸­${maxEl}å…ƒç´ æœ€å¼ºï¼Œ${minEl}å…ƒç´ æœ€å¼±ã€‚`;
}

function generateBaziAnalysis(bazi, elements, year){
  const name = document.getElementById('name').value || 'æ‚¨';
  const dayStemNames = {ç”²:'ç”²æœ¨',ä¹™:'ä¹™æœ¨',ä¸™:'ä¸™ç«',ä¸:'ä¸ç«',æˆŠ:'æˆŠåœŸ',å·±:'å·±åœŸ',åºš:'åºšé‡‘',è¾›:'è¾›é‡‘',å£¬:'å£¬æ°´',ç™¸:'ç™¸æ°´'};
  document.getElementById('day-pillar-analysis').innerHTML = `<p>${name}çš„æ—¥ä¸»ä¸º<strong>${dayStemNames[bazi.day.stem]}</strong>ï¼Œä»£è¡¨å‘½ä¸»çš„æœ¬æ€§å’Œæ ¸å¿ƒç‰¹è´¨ã€‚</p><p>æ—¥æŸ±${bazi.day.stem}${bazi.day.branch}ï¼Œçº³éŸ³${baziCalculator.getNayin(bazi.day.stem,bazi.day.branch)}ã€‚</p>`;
  document.getElementById('zodiac-analysis').innerHTML = `<p>${name}çš„ç”Ÿè‚–ä¸º<strong>${bazi.year.zodiac}</strong>ï¼Œå…·æœ‰è¯¥ç”Ÿè‚–çš„å…¸å‹ç‰¹å¾ã€‚</p><p>å¹´æŸ±${bazi.year.stem}${bazi.year.branch}ï¼Œçº³éŸ³${baziCalculator.getNayin(bazi.year.stem,bazi.year.branch)}ã€‚</p>`;
  document.getElementById('career-analysis').innerHTML = `<p>æ ¹æ®äº”è¡Œåˆ†æï¼Œ${name}çš„å‘½å±€ä¸­${getStrongestElement(elements)}å…ƒç´ è¾ƒä¸ºçªå‡ºã€‚</p><p>é€‚åˆä»äº‹ä¸${getCareerAdvice(elements)}ç›¸å…³çš„è¡Œä¸šã€‚</p><p>è´¢è¿æ–¹é¢ï¼Œ${getWealthAdvice(bazi.day.stem)}</p>`;
  document.getElementById('relationship-analysis').innerHTML = `<p>${name}åœ¨äººé™…å…³ç³»æ–¹é¢${getRelationshipAdvice(bazi.day.stem)}</p><p>æ„Ÿæƒ…æ–¹é¢ï¼Œ${getLoveAdvice(bazi.day.stem, document.getElementById('gender').value)}</p>`;
}

function getStrongestElement(elements){ return Object.keys(elements).reduce((a,b)=>elements[a]>elements[b]?a:b); }
function getCareerAdvice(elements){
  const s = getStrongestElement(elements);
  const map = { 'æœ¨':'æ•™è‚²ã€æ–‡åŒ–ã€è‰ºæœ¯ã€åŒ»ç–—','ç«':'ç§‘æŠ€ã€èƒ½æºã€é¤é¥®ã€å¨±ä¹','åœŸ':'æˆ¿åœ°äº§ã€å»ºç­‘ã€å†œä¸šã€é‡‘è','é‡‘':'é‡‘å±ã€æœºæ¢°ã€æ³•å¾‹ã€ç®¡ç†','æ°´':'è´¸æ˜“ã€è¿è¾“ã€æ—…æ¸¸ã€æœåŠ¡' };
  return map[s] || 'å¤šç§è¡Œä¸š';
}
function getWealthAdvice(st){
  const map = {ç”²:'è´¢è¿ç¨³å®šï¼Œé€‚åˆé•¿æœŸæŠ•èµ„',ä¹™:'è´¢è¿èµ·ä¼ï¼Œéœ€è¦è°¨æ…ç†è´¢',ä¸™:'è´¢è¿æ—ºç››ï¼Œä½†éœ€é˜²ç ´è´¢',ä¸:'è´¢è¿å¹³ç¨³ï¼Œé€‚åˆç¨³å¥æŠ•èµ„',æˆŠ:'è´¢è¿ä¸°åšï¼Œä½†æ¥å¾—è¾ƒæ…¢',å·±:'è´¢è¿ç¨³å®šï¼Œé€‚åˆç§¯ç´¯',åºš:'è´¢è¿èµ·ä¼ï¼Œéœ€è¦æŠŠæ¡æ—¶æœº',è¾›:'è´¢è¿è‰¯å¥½ï¼Œé€‚åˆç²¾ç»†ç»è¥',å£¬:'è´¢è¿æµåŠ¨ï¼Œé€‚åˆçµæ´»æŠ•èµ„',ç™¸:'è´¢è¿éšç§˜ï¼Œéœ€è¦è€å¿ƒç­‰å¾…'}; return map[st]||'è´¢è¿å¹³ç¨³ï¼Œéœ€è¦åˆç†è§„åˆ’'; }
function getRelationshipAdvice(st){
  const map = {ç”²:'æ€§æ ¼ç›´çˆ½ï¼Œäººé™…å…³ç³»è‰¯å¥½',ä¹™:'æ¸©å’Œä½“è´´ï¼Œäººç¼˜ä¸é”™',ä¸™:'çƒ­æƒ…å¼€æœ—ï¼Œäº¤å‹å¹¿æ³›',ä¸:'ç»†è…»æ•æ„Ÿï¼Œéœ€è¦æ›´å¤šä¿¡ä»»',æˆŠ:'ç¨³é‡å¯é ï¼Œæœ‹å‹å¿ è¯š',å·±:'åŒ…å®¹å¤§åº¦ï¼Œäººç¼˜å¾ˆå¥½',åºš:'åˆšå¼ºæœæ–­ï¼Œéœ€è¦æ›´å¤šæŸ”å’Œ',è¾›:'ç²¾æ˜ç»†è‡´ï¼Œäº¤å‹è°¨æ…',å£¬:'éšå’ŒåŒ…å®¹ï¼Œäººç¼˜å¹¿æ³›',ç™¸:'å†…å‘æ•æ„Ÿï¼Œéœ€è¦ä¸»åŠ¨ç¤¾äº¤'}; return map[st]||'äººé™…å…³ç³»å¹³ç¨³ï¼Œéœ€è¦ç”¨å¿ƒç»è¥'; }
function getLoveAdvice(st, gender){
  const base = {ç”²:'æ„Ÿæƒ…ä¸“ä¸€ï¼Œé‡è§†å®¶åº­',ä¹™:'æ„Ÿæƒ…ç»†è…»ï¼Œéœ€è¦å®‰å…¨æ„Ÿ',ä¸™:'æ„Ÿæƒ…çƒ­çƒˆï¼Œè¿½æ±‚æµªæ¼«',ä¸:'æ„Ÿæƒ…æ·±æ²‰ï¼Œéœ€è¦ç†è§£',æˆŠ:'æ„Ÿæƒ…ç¨³å®šï¼Œé‡è§†è´£ä»»',å·±:'æ„Ÿæƒ…åŒ…å®¹ï¼Œå–„äºä»˜å‡º',åºš:'æ„Ÿæƒ…åˆšå¼ºï¼Œéœ€è¦æ¸©æŸ”',è¾›:'æ„Ÿæƒ…ç²¾è‡´ï¼Œè¿½æ±‚å®Œç¾',å£¬:'æ„Ÿæƒ…éšå’Œï¼Œé€‚åº”æ€§å¼º',ç™¸:'æ„Ÿæƒ…æ•æ„Ÿï¼Œéœ€è¦å‘µæŠ¤'};
  let a = base[st] || 'æ„Ÿæƒ…å¹³ç¨³ï¼Œéœ€è¦ç”¨å¿ƒç»è¥';
  if (gender === 'male') a += 'ï¼Œä½œä¸ºç”·æ€§ï¼Œåœ¨æ„Ÿæƒ…ä¸­åº”è¯¥ä¸»åŠ¨æ‰¿æ‹…è´£ä»»ã€‚';
  else if (gender === 'female') a += 'ï¼Œä½œä¸ºå¥³æ€§ï¼Œåœ¨æ„Ÿæƒ…ä¸­åº”è¯¥ä¿æŒç‹¬ç«‹è‡ªä¿¡ã€‚';
  return a;
}

function showError(msg){ const el = document.getElementById('error'); el.textContent = msg; el.style.display='block'; setTimeout(()=>el.style.display='none', 5000); }

// ====== èŠå¤©çª—å£ï¼ˆç¤ºä¾‹æ¨¡æ‹Ÿï¼‰ ======
function addChatMessage(message, sender){ const body=document.getElementById('chatgptBody'); const el=document.createElement('div'); el.className=`chat-message ${sender}`; el.textContent=message; body.appendChild(el); body.scrollTop=body.scrollHeight; }
function sendMessage(){ const input=document.getElementById('chatgptInput'); const msg=input.value.trim(); if(!msg) return; addChatMessage(msg,'user'); input.value=''; setTimeout(()=>{ const arr=["æ ¹æ®å…«å­—åˆ†æï¼Œå»ºè®®å¤šå…³æ³¨äº‹ä¸šå‘å±•å’Œäººé™…å…³ç³»ã€‚","ä»äº”è¡Œå¹³è¡¡æ¥çœ‹ï¼Œæ‚¨éœ€è¦åŠ å¼ºæ°´å…ƒç´ çš„èƒ½é‡ã€‚","æ‚¨çš„å‘½ç†æ˜¾ç¤ºä»Šå¹´æœ‰è¾ƒå¥½çš„è´¢è¿æœºä¼šï¼Œå¯ä»¥æŠŠæ¡ã€‚","æ„Ÿæƒ…æ–¹é¢ï¼Œä»Šå¹´æœ‰æœºä¼šé‡åˆ°åˆé€‚çš„ä¼´ä¾£ã€‚","å¥åº·æ–¹é¢éœ€è¦æ³¨æ„è„¾èƒƒé—®é¢˜ï¼Œé¥®é£Ÿè¦è§„å¾‹ã€‚","å»ºè®®å¤šæ¥è§¦è‡ªç„¶ï¼Œå¹³è¡¡èº«å¿ƒèƒ½é‡ã€‚","äº‹ä¸šå‘å±•æ–¹é¢ï¼Œé€‚åˆä¸å›¢é˜Ÿåˆä½œå…±åŒè¿›æ­¥ã€‚"]; addChatMessage(arr[Math.floor(Math.random()*arr.length)],'bot');},1000); }

// ====== åˆå§‹åŒ–ä¸äº‹ä»¶ç»‘å®šï¼ˆåªç»‘å®šä¸€æ¬¡ï¼Œå»é‡ï¼‰ ======
document.addEventListener('DOMContentLoaded', ()=>{
  const today = new Date();
  document.getElementById('birthdate').value = today.toISOString().split('T')[0];
  document.getElementById('timeUnknown').addEventListener('change', function(){
    document.getElementById('timeInputContainer').classList.toggle('disabled', this.checked);
  });
  document.getElementById('chatgptFab').addEventListener('click', ()=>{ document.getElementById('chatgptWindow').style.display='flex'; });
  document.getElementById('chatgptClose').addEventListener('click', ()=>{ document.getElementById('chatgptWindow').style.display='none'; });
  document.getElementById('chatgptSend').addEventListener('click', sendMessage);
  document.getElementById('chatgptInput').addEventListener('keypress', e=>{ if(e.key==='Enter') sendMessage(); });

  document.getElementById('loginForm').addEventListener('submit', e=>{ e.preventDefault(); const email=document.getElementById('email').value; const password=document.getElementById('password').value; if(!email||!password) return showAuthError('è¯·è¾“å…¥é‚®ç®±å’Œå¯†ç '); alert(`ç™»å½•æˆåŠŸï¼æ¬¢è¿å›æ¥ï¼Œ${email}`); });
  document.getElementById('registerForm').addEventListener('submit', e=>{ e.preventDefault(); const email=document.getElementById('email').value; const password=document.getElementById('password').value; if(!email||!password) return showAuthError('è¯·è¾“å…¥é‚®ç®±å’Œå¯†ç '); if(password.length<8) return showAuthError('å¯†ç è‡³å°‘éœ€è¦8ä½å­—ç¬¦'); alert(`æ³¨å†ŒæˆåŠŸï¼æ¬¢è¿ ${email}ï¼Œæ‚¨å·²è·å¾—24å°æ—¶VIPä½“éªŒæƒé™ã€‚`); });
  document.getElementById('resetBtn').addEventListener('click', ()=>{ const email = prompt('è¯·è¾“å…¥æ‚¨çš„é‚®ç®±åœ°å€ï¼š'); if(email) alert('å¯†ç é‡ç½®é“¾æ¥å·²å‘é€åˆ°æ‚¨çš„é‚®ç®±ï¼Œè¯·æŸ¥æ”¶ã€‚'); });
  function showAuthError(message){ const el=document.getElementById('authError'); el.textContent=message; el.style.display='block'; setTimeout(()=>el.style.display='none',5000); }

  // â€”â€” ç”Ÿæˆå…«å­—ï¼ˆå”¯ä¸€ç»‘å®šï¼‰
  document.getElementById('genBtn').addEventListener('click', ()=>{
    const birthdate = document.getElementById('birthdate').value;
    const birthtime = document.getElementById('birthtime').value;
    const timeUnknown = document.getElementById('timeUnknown').checked;
    if(!birthdate) return showError('è¯·é€‰æ‹©å‡ºç”Ÿæ—¥æœŸ');
    document.getElementById('genBtnText').style.display='none';
    document.getElementById('genBtnLoading').style.display='inline-block';
    setTimeout(()=>{
      try{
        const date = new Date(birthdate);
        const year = date.getFullYear();
        const month = date.getMonth()+1;
        const day = date.getDate();
        let hour = 12;
        if(!timeUnknown && birthtime){ const [h] = birthtime.split(':'); hour = parseInt(h); }
        const yearPillar  = baziCalculator.calculateYearPillar(year);
        const monthPillar = baziCalculator.calculateMonthPillar(year, month, day);
        const dayPillar   = baziCalculator.calculateDayPillar(year, month, day);
        const hourPillar  = timeUnknown ? {stem:'ï¼Ÿ',branch:'ï¼Ÿ'} : baziCalculator.calculateHourPillar(dayPillar.stem, hour);
        const bazi = { year:yearPillar, month:monthPillar, day:dayPillar, hour:hourPillar };
        displayBaziResult(bazi, year, month, day, hour, timeUnknown);
      }catch(err){ console.error('è®¡ç®—å…«å­—æ—¶å‡ºé”™:', err); showError('è®¡ç®—å…«å­—æ—¶å‡ºç°é”™è¯¯ï¼Œè¯·é‡è¯•'); }
      finally{ document.getElementById('genBtnText').style.display='inline'; document.getElementById('genBtnLoading').style.display='none'; }
    }, 600);
  });

  // â€”â€” è‡ªæµ‹ï¼š1978-02-21 12:45 åº”ä¸º æˆŠåˆï½œç”²å¯…ï½œç”²å¯…ï½œåºšåˆ
  (function testBaziCalculation(){
    const year=1978, month=2, day=21, hour=12;
    const yearP = baziCalculator.calculateYearPillar(year);
    const monthP= baziCalculator.calculateMonthPillar(year, month, day);
    const dayP  = baziCalculator.calculateDayPillar(year, month, day);
    const hourP = baziCalculator.calculateHourPillar(dayP.stem, hour);
    const ok = (yearP.stem+yearP.branch==='æˆŠåˆ')&&(monthP.stem+monthP.branch==='ç”²å¯…')&&(dayP.stem+dayP.branch==='ç”²å¯…')&&(hourP.stem+hourP.branch==='åºšåˆ');
    console.log('è‡ªæµ‹-å¹´æŸ±:', yearP.stem+yearP.branch, 'åº”: æˆŠåˆ');
    console.log('è‡ªæµ‹-æœˆæŸ±:', monthP.stem+monthP.branch, 'åº”: ç”²å¯…');
    console.log('è‡ªæµ‹-æ—¥æŸ±:', dayP.stem+dayP.branch, 'åº”: ç”²å¯…');
    console.log('è‡ªæµ‹-æ—¶æŸ±:', hourP.stem+hourP.branch, 'åº”: åºšåˆ');
    console.log('è®¡ç®—ç»“æœæ˜¯å¦æ­£ç¡®:', ok);
  })();
});
</script>
</body>
</html>
