<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<title>八字命理 · 5XLiving</title>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #0b0f14;
  --card: #11161dcc;
  --line: #1f2a36;
  --text: #e8edf3;
  --muted: #9aa3b2;
  --brand: #d4af37;
  --gold: #d4af37;
  --gold2: #f2d27a;
  --radius: 14px;
  --shadow: 0 8px 30px rgba(0,0,0,.35);
  --accent: #3a86ff;
  --success: #4cc9a7;
  --warning: #ff9e00;
  --danger: #ff5a5f;
}

html, body {
  height: 100%;
  margin: 0;
  color: var(--text);
  background: var(--bg);
  font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans SC", Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  line-height: 1.6;
}

body::before {
  content: "";
  position: fixed;
  inset: 0;
  z-index: -2;
  background: url('assets/images/gate.jpg') center/cover no-repeat;
  filter: brightness(.45) saturate(.9) blur(2px);
}

.container {
  max-width: 1100px;
  margin: 0 auto;
  padding: 24px 16px 80px;
}

header {
  position: sticky;
  top: 0;
  z-index: 10;
  background: #0b0f14cc;
  border-bottom: 1px solid #0f1622;
  backdrop-filter: saturate(140%) blur(12px);
}

.head-inner {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 14px;
  padding: 16px;
}

.brand {
  display: flex;
  align-items: center;
  gap: 12px;
}

.brand-badge {
  width: 36px;
  height: 36px;
  border-radius: 10px;
  background: linear-gradient(145deg, #273243, #0e141c);
  display: grid;
  place-items: center;
  color: var(--brand);
  font-weight: 700;
  box-shadow: var(--shadow);
}

.title {
  font-family: "Noto Serif SC", "Noto Serif", serif;
  font-weight: 600;
  letter-spacing: .02em;
  font-size: 1.4rem;
}

.subtitle {
  color: var(--muted);
  font-size: 0.9rem;
}

.lang {
  display: flex;
  align-items: center;
  gap: 8px;
}

.lang label {
  color: var(--muted);
  font-size: .9rem;
}

.lang select {
  appearance: none;
  border-radius: 10px;
  border: 1px solid #243244;
  background: #0e1520;
  color: var(--text);
  padding: 10px 34px 10px 12px;
  font-size: 0.9rem;
}

.card {
  background: var(--card);
  border: 1px solid #1f2a36;
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding: 24px;
  margin-bottom: 20px;
}

.section {
  margin-top: 18px;
}

.row {
  display: grid;
  gap: 12px;
}

@media (min-width: 760px) {
  .row.cols-3 {
    grid-template-columns: 1fr 1fr 1fr;
  }
  .row.cols-2 {
    grid-template-columns: 1fr 1fr;
  }
}

input, select, textarea {
  width: 100%;
  box-sizing: border-box;
  border-radius: 12px;
  border: 1px solid #243244;
  background: #0e1520;
  color: var(--text);
  padding: 12px 12px;
  font-size: 15px;
  transition: all 0.2s ease;
}

input:focus, select:focus, textarea:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 2px rgba(58, 134, 255, 0.2);
}

button, .btn {
  width: auto;
  display: inline-grid;
  place-items: center;
  padding: 12px 16px;
  border-radius: 12px;
  border: 1px solid #e6c76e;
  background: linear-gradient(180deg, #fff9e6, #e6c76e);
  color: #191919;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.2s ease;
}

.btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(212, 175, 55, 0.3);
}

.btn:disabled {
  opacity: .6;
  cursor: not-allowed;
  transform: none;
}

.h2 {
  font-size: 1.3rem;
  margin: 0 0 1rem;
  font-weight: 700;
  color: #ffe084;
  display: flex;
  align-items: center;
  gap: 10px;
}

.h2::before {
  content: "";
  display: block;
  width: 4px;
  height: 20px;
  background: var(--brand);
  border-radius: 2px;
}

.muted {
  color: #9aa3b2;
}

footer {
  color: #6c7b8c;
  font-size: .85rem;
  text-align: center;
  padding: 30px 0;
  margin-top: 30px;
}

/* 结果样式 */
.pillars {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 10px;
  margin-top: 8px;
}

.pillar {
  background: #0f1624;
  border: 1px solid #253245;
  border-radius: 12px;
  padding: 14px 10px;
  text-align: center;
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.pillar::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: var(--brand);
  opacity: 0;
  transition: opacity 0.3s ease;
}

.pillar:hover {
  transform: translateY(-3px);
  border-color: var(--brand);
}

.pillar:hover::before {
  opacity: 1;
}

.pillar .tit {
  color: #9aa3b2;
  font-size: .85rem;
  margin-bottom: 6px;
}

.pillar .gz {
  font-size: 1.5rem;
  font-weight: 700;
  letter-spacing: .05em;
  color: var(--gold2);
}

.bars {
  display: grid;
  gap: 8px;
  margin-top: 10px;
}

.bar {
  height: 10px;
  background: #0d1420;
  border: 1px solid #233146;
  border-radius: 999px;
  overflow: hidden;
  position: relative;
}

.bar i {
  display: block;
  height: 100%;
  background: linear-gradient(90deg, #ffe084, #f2d27a);
  transition: width 1s ease;
}

.bar-label {
  display: flex;
  justify-content: space-between;
  margin-top: 4px;
  font-size: 0.85rem;
}

.ul {
  margin: .4rem 0 0 .9rem;
  line-height: 1.8;
}

/* Chat 固定与样式 */
.ss-chat-fab {
  position: fixed;
  right: 18px;
  bottom: 18px;
  z-index: 9999;
  width: 56px;
  height: 56px;
  border-radius: 9999px;
  display: grid;
  place-items: center;
  font-weight: 800;
  border: 1px solid #e6c76e;
  background: linear-gradient(180deg, #fff9e6, #e6c76e);
  color: #191919;
  box-shadow: 0 8px 30px rgba(0,0,0,.35);
  cursor: pointer;
  transition: all 0.3s ease;
}

.ss-chat-fab:hover {
  transform: scale(1.1);
  box-shadow: 0 10px 35px rgba(212, 175, 55, 0.4);
}

.ss-chat-panel {
  position: fixed;
  right: 18px;
  bottom: 86px;
  z-index: 9999;
  width: 360px;
  max-width: calc(100vw - 28px);
  max-height: 70vh;
  display: none;
  flex-direction: column;
  overflow: hidden;
  background: #0e1520;
  border: 1px solid #243244;
  border-radius: 14px;
  box-shadow: 0 8px 30px rgba(0,0,0,.35);
}

@media (max-width: 480px) {
  .ss-chat-panel {
    right: 10px;
    left: 10px;
    width: auto;
  }
}

.ss-chat-head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 12px;
  border-bottom: 1px solid #243244;
  color: #ffe084;
  font-weight: 700;
}

.ss-chat-body {
  padding: 10px;
  overflow: auto;
  display: flex;
  flex-direction: column;
  gap: 8px;
  min-height: 120px;
}

.ss-msg {
  background: #101a28;
  border: 1px solid #223047;
  padding: 8px 10px;
  border-radius: 10px;
  max-width: 95%;
  font-size: 14px;
  line-height: 1.5;
}

.ss-msg.me {
  margin-left: auto;
  background: #1a2433;
  border-color: #2b3a51;
}

.ss-chat-input {
  display: flex;
  gap: 8px;
  padding: 10px;
  border-top: 1px solid #243244;
}

.ss-chat-input textarea {
  flex: 1;
  resize: none;
  min-height: 44px;
  max-height: 180px;
  font-size: 14px;
  padding: 10px 12px;
  border-radius: 10px;
  border: 1px solid #243244;
  background: #0f1522;
  color: #eaf0ff;
}

.ss-chat-input button {
  padding: 10px 12px;
  border-radius: 10px;
  border: 1px solid #e6c76e;
  background: linear-gradient(180deg, #fff9e6, #e6c76e);
  color: #191919;
  font-weight: 700;
}

/* 专业扩展块 */
.kv {
  display: grid;
  grid-template-columns: 120px 1fr;
  gap: 6px 12px;
  margin-top: 6px;
}

.kv .k {
  color: #9aa3b2;
}

.grid-2 {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
}

.table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0 8px;
}

.table th, .table td {
  padding: 8px 10px;
  border: 1px solid #243244;
  background: #0f1624;
}

.table th {
  color: #ffe084;
  font-weight: 700;
}

.badge2 {
  display: inline-block;
  border: 1px solid #33465e;
  border-radius: 999px;
  padding: 2px 10px;
  margin-right: 6px;
  margin-top: 6px;
  color: #a7b5c5;
}

.note {
  color: #a7b5c5;
  font-size: .92rem;
}

.hr {
  height: 1px;
  background: #1f2a36;
  margin: 10px 0;
}

/* 修复"重新加载"按钮被拉伸 */
.btn, #depsReload {
  width: auto;
  display: inline-grid;
}

/* 新增样式 */
.tab-container {
  display: flex;
  gap: 10px;
  margin-bottom: 20px;
  border-bottom: 1px solid #1f2a36;
  padding-bottom: 10px;
}

.tab {
  padding: 8px 16px;
  border-radius: 8px;
  background: #0f1624;
  border: 1px solid #1f2a36;
  color: var(--muted);
  cursor: pointer;
  transition: all 0.2s ease;
}

.tab.active {
  background: var(--brand);
  color: #191919;
  border-color: var(--brand);
}

.info-box {
  background: #0f1624;
  border: 1px solid #1f2a36;
  border-radius: 12px;
  padding: 16px;
  margin-top: 15px;
}

.info-box .title {
  font-size: 1.1rem;
  margin-bottom: 10px;
  color: var(--gold2);
}

.element-interaction {
  display: flex;
  justify-content: space-between;
  margin-top: 20px;
}

.interaction-item {
  text-align: center;
  flex: 1;
  padding: 10px;
}

.interaction-arrow {
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.5rem;
  color: var(--brand);
}

.strength-indicator {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-top: 10px;
}

.strength-bar {
  flex: 1;
  height: 8px;
  background: #0d1420;
  border-radius: 4px;
  overflow: hidden;
}

.strength-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--danger), var(--warning), var(--success));
}

.luck-prediction {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  gap: 10px;
  margin-top: 15px;
}

.luck-item {
  background: #0f1624;
  border: 1px solid #1f2a36;
  border-radius: 10px;
  padding: 12px;
  text-align: center;
}

.luck-item .value {
  font-size: 1.2rem;
  font-weight: 700;
  margin: 5px 0;
  color: var(--gold2);
}

.progress-container {
  margin: 15px 0;
}

.progress-label {
  display: flex;
  justify-content: space-between;
  margin-bottom: 5px;
}

.progress-bar {
  height: 8px;
  background: #0d1420;
  border-radius: 4px;
  overflow: hidden;
}

.progress-fill {
  height: 100%;
  background: var(--accent);
  transition: width 1s ease;
}

.tooltip {
  position: relative;
  display: inline-block;
  border-bottom: 1px dotted var(--muted);
  cursor: help;
}

.tooltip .tooltiptext {
  visibility: hidden;
  width: 200px;
  background-color: #0f1624;
  color: var(--text);
  text-align: center;
  border-radius: 6px;
  padding: 8px;
  position: absolute;
  z-index: 1;
  bottom: 125%;
  left: 50%;
  margin-left: -100px;
  opacity: 0;
  transition: opacity 0.3s;
  border: 1px solid #1f2a36;
  font-size: 0.85rem;
}

.tooltip:hover .tooltiptext {
  visibility: visible;
  opacity: 1;
}

.fade-in {
  animation: fadeIn 0.5s ease-in;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

.highlight {
  background: linear-gradient(120deg, transparent 0%, rgba(212, 175, 55, 0.1) 50%, transparent 100%);
  padding: 2px 5px;
  border-radius: 4px;
}

.character-analysis {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 15px;
  margin-top: 15px;
}

.character-trait {
  background: #0f1624;
  border: 1px solid #1f2a36;
  border-radius: 10px;
  padding: 12px;
}

.character-trait .trait-name {
  font-weight: 600;
  color: var(--gold2);
  margin-bottom: 5px;
}

.character-trait .trait-desc {
  font-size: 0.9rem;
  color: var(--muted);
}

.compatibility-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
  gap: 10px;
  margin-top: 15px;
}

.compatibility-item {
  background: #0f1624;
  border: 1px solid #1f2a36;
  border-radius: 10px;
  padding: 10px;
  text-align: center;
}

.compatibility-item.good {
  border-color: var(--success);
}

.compatibility-item.bad {
  border-color: var(--danger);
}

.compatibility-item .score {
  font-size: 1.1rem;
  font-weight: 700;
  margin: 5px 0;
}

.compatibility-item.good .score {
  color: var(--success);
}

.compatibility-item.bad .score {
  color: var(--danger);
}

.year-calendar {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
  gap: 5px;
  margin-top: 15px;
}

.calendar-month {
  background: #0f1624;
  border: 1px solid #1f2a36;
  border-radius: 6px;
  padding: 8px 5px;
  text-align: center;
  font-size: 0.85rem;
}

.calendar-month.good {
  border-color: var(--success);
  background: rgba(76, 201, 167, 0.1);
}

.calendar-month.bad {
  border-color: var(--danger);
  background: rgba(255, 90, 95, 0.1);
}

.calendar-month.neutral {
  border-color: var(--warning);
  background: rgba(255, 158, 0, 0.1);
}

/* 响应式调整 */
@media (max-width: 768px) {
  .head-inner {
    flex-direction: column;
    align-items: flex-start;
    gap: 10px;
  }
  
  .lang {
    align-self: flex-end;
  }
  
  .pillars {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .grid-2 {
    grid-template-columns: 1fr;
  }
  
  .element-interaction {
    flex-direction: column;
    gap: 15px;
  }
  
  .interaction-arrow {
    transform: rotate(90deg);
  }
}
</style>
</head>

<body>
<header>
  <div class="head-inner container">
    <div class="brand">
      <div class="brand-badge">5X</div>
      <div>
        <div class="title">命理供门 · 八字简评</div>
        <div class="subtitle">免费版 · 全面不深｜VIP 解锁流年/大运/择日/命名</div>
      </div>
    </div>
    <div class="lang">
      <label for="langSelect">语言</label>
      <select id="langSelect" aria-label="Language">
        <option value="zh-CN">简体中文</option>
        <option value="zh-TW">繁體中文</option>
        <option value="en">English</option>
        <option value="ms">Bahasa Melayu</option>
      </select>
    </div>
  </div>
</header>

<main class="container">
  <section class="card">
    <div class="h2">八字命理 · 快速排盘</div>
    <div class="row cols-3">
      <div>
        <label class="muted">姓名（可选）</label>
        <input id="name" placeholder="你的称呼（用于个性化）">
      </div>
      <div>
        <label class="muted">性别</label>
        <select id="gender">
          <option value="">不透露</option>
          <option value="male">男性</option>
          <option value="female">女性</option>
          <option value="other">其他</option>
        </select>
      </div>
      <div>
        <label class="muted">历法</label>
        <div style="display:flex; gap:8px; align-items:center;">
          <select id="calendar">
            <option value="gregorian">阳历 / Gregorian</option>
            <option value="lunar">农历 / Lunar</option>
          </select>
          <label id="leapWrap" style="display:none; align-items:center; gap:6px; margin-left:8px;">
            <input type="checkbox" id="isLeap"> 闰月
          </label>
        </div>
        <div id="calendarHint" class="muted" style="display:none; margin-top:6px;">
          选择农历时，请确认是否为闰月；若为闰月请勾选"闰月"。系统会自动换算为阳历后计算。
        </div>
      </div>
    </div>

    <div id="depsRow" class="muted" style="display:flex;align-items:center;gap:10px;margin-top:8px">
      <span>依赖状态：</span>
      <span id="depsStatus" style="color:#ffdf8a">未加载</span>
      <button id="depsReload" class="btn" style="padding:6px 10px;border-radius:10px">重新加载</button>
    </div>

    <div class="row cols-3" style="margin-top:10px">
      <div>
        <label class="muted">出生日期</label>
        <input type="date" id="birthdate">
      </div>
      <div>
        <label class="muted">出生时间</label>
        <input type="time" id="birthtime">
      </div>
      <div style="display:flex;align-items:flex-end">
        <button class="btn" id="genBtn">生成八字</button>
      </div>
    </div>

    <div class="muted" style="margin-top:6px">提示：临时默认东八区（UTC+8）。后续将支持按出生地换算。</div>
    <div class="muted" id="error" style="color:#ffb4b4;display:none"></div>
  </section>

  <section id="result" style="display:none;">
    <div class="tab-container">
      <div class="tab active" data-tab="basic">基础信息</div>
      <div class="tab" data-tab="analysis">命理分析</div>
      <div class="tab" data-tab="character">性格特质</div>
      <div class="tab" data-tab="compatibility">人际匹配</div>
      <div class="tab" data-tab="calendar">年度运势</div>
    </div>

    <div class="tab-content" id="tab-basic">
      <div class="card section">
        <div class="h2">八字命理排盘</div>
        <div class="pillars" id="bazi-pillars"></div>
        <div class="muted" id="bazi-date"></div>
        <div class="muted" id="bazi-day-master"></div>
      </div>

      <div class="card section">
        <div class="h2">五行分析</div>
        <div class="bars">
          <div class="bar"><i id="bar-wood"></i></div>
          <div class="bar-label">
            <span>木</span>
            <span id="pct-wood">0%</span>
          </div>
          <div class="bar"><i id="bar-fire"></i></div>
          <div class="bar-label">
            <span>火</span>
            <span id="pct-fire">0%</span>
          </div>
          <div class="bar"><i id="bar-earth"></i></div>
          <div class="bar-label">
            <span>土</span>
            <span id="pct-earth">0%</span>
          </div>
          <div class="bar"><i id="bar-metal"></i></div>
          <div class="bar-label">
            <span>金</span>
            <span id="pct-metal">0%</span>
          </div>
          <div class="bar"><i id="bar-water"></i></div>
          <div class="bar-label">
            <span>水</span>
            <span id="pct-water">0%</span>
          </div>
        </div>
        <div class="muted" id="bazi-elements-balance" style="margin-top:8px"></div>
        <div class="muted" id="bazi-strengths" style="margin-top:6px"></div>
      </div>

      <!-- 基础信息 -->
      <div class="card section">
        <div class="h2">基础信息</div>
        <div class="kv" id="kv-basic"></div>
      </div>

      <!-- 四柱明细 -->
      <div class="card section">
        <div class="h2">四柱明细</div>
        <table class="table" id="tbl-pillars">
          <thead><tr><th>柱</th><th>天干</th><th>十神</th><th>地支</th><th>藏干</th></tr></thead>
          <tbody></tbody>
        </table>
        <div class="note" id="note-stem-branch"></div>
      </div>

      <!-- 阴阳与五行 -->
      <div class="card section">
        <div class="h2">阴阳与五行</div>
        <div class="grid-2">
          <div>
            <div class="h3 muted" style="margin:0 0 6px">阴阳比例</div>
            <div id="yy-ratio" class="kv"></div>
          </div>
          <div>
            <div class="h3 muted" style="margin:0 0 6px">五行缺失/偏旺</div>
            <div id="elem-flags" class="kv"></div>
          </div>
        </div>
      </div>

      <!-- 喜用与开运建议 -->
      <div class="card section">
        <div class="h2">喜用与开运建议</div>
        <div class="kv" id="useful"></div>
        <div class="hr"></div>
        <div id="fengshui" class="note"></div>
      </div>

      <!-- 起运 / 大运 / 流年 -->
      <div class="card section">
        <div class="h2">起运·大运·流年（简表）</div>
        <div class="kv" id="start-yun"></div>
        <table class="table" id="tbl-dayun">
          <thead><tr><th>起始(公历)</th><th>大运干支</th><th>十神</th><th>所临地支</th></tr></thead>
          <tbody></tbody>
        </table>
        <div class="hr"></div>
        <table class="table" id="tbl-liunian">
          <thead><tr><th>年份</th><th>流年干支</th><th>十神</th><th>备注</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

    <div class="tab-content" id="tab-analysis" style="display:none;">
      <div class="card section">
        <div class="h2">五行相生相克分析</div>
        <div class="element-interaction">
          <div class="interaction-item">
            <div class="interaction-title">相生关系</div>
            <div class="interaction-desc">木生火 → 火生土 → 土生金 → 金生水 → 水生木</div>
          </div>
          <div class="interaction-arrow">⇄</div>
          <div class="interaction-item">
            <div class="interaction-title">相克关系</div>
            <div class="interaction-desc">木克土 → 土克水 → 水克火 → 火克金 → 金克木</div>
          </div>
        </div>
        
        <div class="info-box">
          <div class="title">命局强度分析</div>
          <div class="strength-indicator">
            <span>弱</span>
            <div class="strength-bar">
              <div class="strength-fill" id="strength-fill" style="width: 50%"></div>
            </div>
            <span>强</span>
          </div>
          <div id="strength-desc" class="muted" style="margin-top: 10px;"></div>
        </div>
        
        <div class="info-box">
          <div class="title">五行平衡建议</div>
          <div id="balance-advice"></div>
        </div>
      </div>

      <div class="card section">
        <div class="h2">十神关系详解</div>
        <div id="ten-gods-detail"></div>
      </div>

      <div class="card section">
        <div class="h2">大运走势预测</div>
        <div class="progress-container">
          <div class="progress-label">
            <span>青年运 (20-40岁)</span>
            <span id="youth-luck">75%</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" style="width: 75%"></div>
          </div>
        </div>
        
        <div class="progress-container">
          <div class="progress-label">
            <span>中年运 (40-60岁)</span>
            <span id="mid-luck">60%</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" style="width: 60%"></div>
          </div>
        </div>
        
        <div class="progress-container">
          <div class="progress-label">
            <span>晚年运 (60岁后)</span>
            <span id="old-luck">85%</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" style="width: 85%"></div>
          </div>
        </div>
        
        <div class="luck-prediction">
          <div class="luck-item">
            <div>事业运</div>
            <div class="value" id="career-luck">7.5</div>
            <div class="muted">/10分</div>
          </div>
          <div class="luck-item">
            <div>财运</div>
            <div class="value" id="wealth-luck">6.8</div>
            <div class="muted">/10分</div>
          </div>
          <div class="luck-item">
            <div>健康运</div>
            <div class="value" id="health-luck">8.2</div>
            <div class="muted">/10分</div>
          </div>
          <div class="luck-item">
            <div>感情运</div>
            <div class="value" id="love-luck">7.0</div>
            <div class="muted">/10分</div>
          </div>
        </div>
      </div>
    </div>

    <div class="tab-content" id="tab-character" style="display:none;">
      <div class="card section">
        <div class="h2">性格特质分析</div>
        <div class="character-analysis">
          <div class="character-trait">
            <div class="trait-name">领导能力</div>
            <div class="trait-desc">具有天生的领导才能，善于组织和指挥他人。</div>
          </div>
          <div class="character-trait">
            <div class="trait-name">创造力</div>
            <div class="trait-desc">思维活跃，富有创意，擅长解决复杂问题。</div>
          </div>
          <div class="character-trait">
            <div class="trait-name">情绪稳定性</div>
            <div class="trait-desc">情绪较为稳定，但在压力下可能表现出焦虑。</div>
          </div>
          <div class="character-trait">
            <div class="trait-name">社交能力</div>
            <div class="trait-desc">善于交际，人缘好，但有时会过于直率。</div>
          </div>
        </div>
      </div>

      <div class="card section">
        <div class="h2">潜在优势与挑战</div>
        <div class="grid-2">
          <div>
            <div class="h3 muted" style="margin:0 0 10px">优势</div>
            <ul class="ul">
              <li>决策果断，执行力强</li>
              <li>学习能力强，适应变化</li>
              <li>责任心重，值得信赖</li>
              <li>富有同情心，乐于助人</li>
            </ul>
          </div>
          <div>
            <div class="h3 muted" style="margin:0 0 10px">挑战</div>
            <ul class="ul">
              <li>有时过于固执己见</li>
              <li>容易过度投入工作</li>
              <li>对细节关注不够</li>
              <li>情绪波动较大</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="card section">
        <div class="h2">发展建议</div>
        <div class="info-box">
          <div class="title">职业方向</div>
          <p>适合从事管理、教育、创意产业或与人打交道的工作。避免过于机械重复的职业。</p>
        </div>
        <div class="info-box">
          <div class="title">人际关系</div>
          <p>学会倾听他人意见，适当表达脆弱面，建立更深层次的人际关系。</p>
        </div>
        <div class="info-box">
          <div class="title">个人成长</div>
          <p>培养耐心和细致，学习情绪管理技巧，平衡工作与生活。</p>
        </div>
      </div>
    </div>

    <div class="tab-content" id="tab-compatibility" style="display:none;">
      <div class="card section">
        <div class="h2">人际匹配分析</div>
        <div class="compatibility-grid">
          <div class="compatibility-item good">
            <div>与木型人</div>
            <div class="score">8.5</div>
            <div class="muted">/10分</div>
          </div>
          <div class="compatibility-item good">
            <div>与火型人</div>
            <div class="score">7.8</div>
            <div class="muted">/10分</div>
          </div>
          <div class="compatibility-item">
            <div>与土型人</div>
            <div class="score">6.2</div>
            <div class="muted">/10分</div>
          </div>
          <div class="compatibility-item bad">
            <div>与金型人</div>
            <div class="score">4.5</div>
            <div class="muted">/10分</div>
          </div>
          <div class="compatibility-item">
            <div>与水型人</div>
            <div class="score">7.0</div>
            <div class="muted">/10分</div>
          </div>
        </div>
      </div>

      <div class="card section">
        <div class="h2">最佳合作伙伴</div>
        <div class="info-box">
          <div class="title">事业伙伴</div>
          <p>与<span class="highlight">木型或火型</span>人合作最为有利，能够互补优势，共同成长。</p>
        </div>
        <div class="info-box">
          <div class="title">情感伴侣</div>
          <p>适合与<span class="highlight">水型或土型</span>人建立长期关系，能够提供情感支持和稳定性。</p>
        </div>
        <div class="info-box">
          <div class="title">避免组合</div>
          <p>与<span class="highlight">金型</span>人合作需谨慎，可能存在价值观冲突和沟通障碍。</p>
        </div>
      </div>
    </div>

    <div class="tab-content" id="tab-calendar" style="display:none;">
      <div class="card section">
        <div class="h2">年度运势日历</div>
        <div class="year-calendar">
          <div class="calendar-month good">1月</div>
          <div class="calendar-month good">2月</div>
          <div class="calendar-month">3月</div>
          <div class="calendar-month">4月</div>
          <div class="calendar-month bad">5月</div>
          <div class="calendar-month bad">6月</div>
          <div class="calendar-month neutral">7月</div>
          <div class="calendar-month">8月</div>
          <div class="calendar-month good">9月</div>
          <div class="calendar-month good">10月</div>
          <div class="calendar-month good">11月</div>
          <div class="calendar-month">12月</div>
        </div>
      </div>

      <div class="card section">
        <div class="h2">月度运势详解</div>
        <div class="info-box">
          <div class="title">最佳月份：1月、2月、9-11月</div>
          <p>这些月份运势较佳，适合开展新项目、做出重要决策或进行投资。</p>
        </div>
        <div class="info-box">
          <div class="title">需谨慎月份：5月、6月</div>
          <p>这两个月运势较低，宜保守行事，避免重大变动和风险投资。</p>
        </div>
        <div class="info-box">
          <div class="title">平稳月份：其余月份</div>
          <p>运势平稳，适合按部就班推进计划，保持现状。</p>
        </div>
      </div>

      <div class="card section">
        <div class="h2">年度重要提示</div>
        <ul class="ul">
          <li>春季适合开展新计划，特别是与<span class="highlight">创意、教育</span>相关的项目</li>
          <li>夏季需注意<span class="highlight">健康问题</span>，避免过度劳累</li>
          <li>秋季财运较佳，适合<span class="highlight">投资理财</span></li>
          <li>冬季人际关系运上升，适合<span class="highlight">拓展人脉</span></li>
        </ul>
      </div>
    </div>
  </section>
</main>

<footer>© 5XLiving • Astro Sanctuary</footer>

<!-- Chat 浮窗 -->
<div class="ss-chat-fab" id="ssChatFab" title="Concierge">问</div>
<div class="ss-chat-panel" id="ssChatPanel" role="dialog" aria-label="Concierge">
  <div class="ss-chat-head">
    <div id="ssChatTitle">心怜管家 · Chat</div>
    <div id="ssChatClose" style="cursor:pointer">✕</div>
  </div>
  <div class="ss-chat-body" id="ssChatBody" aria-live="polite"></div>
  <div class="ss-chat-input">
    <textarea id="ssChatInput" rows="2" placeholder="想和我说点什么…"></textarea>
    <button id="ssChatSend">发送</button>
  </div>
</div>

<script>
// 由于代码长度限制，这里只展示关键优化部分
// 完整的JavaScript代码需要根据原有逻辑进行扩展

// 添加标签切换功能
document.addEventListener('DOMContentLoaded', function() {
  // 标签切换
  const tabs = document.querySelectorAll('.tab');
  tabs.forEach(tab => {
    tab.addEventListener('click', function() {
      // 移除所有active类
      tabs.forEach(t => t.classList.remove('active'));
      // 添加active类到当前标签
      this.classList.add('active');
      
      // 隐藏所有内容
      document.querySelectorAll('.tab-content').forEach(content => {
        content.style.display = 'none';
      });
      
      // 显示对应内容
      const tabId = this.getAttribute('data-tab');
      document.getElementById(`tab-${tabId}`).style.display = 'block';
    });
  });
  
  // 其他原有代码...
});

// 扩展原有的genChart函数，添加更多分析内容
// 这里只是示例，实际实现需要根据具体命理算法进行
function enhanceAnalysis() {
  // 添加五行相生相克分析
  document.getElementById('strength-desc').textContent = '根据八字分析，您的命局属于中等偏强类型，具有较好的发展潜力。';
  document.getElementById('balance-advice').innerHTML = '<p>建议加强<span class="highlight">水元素</span>的平衡，可通过佩戴蓝色饰品、多接触水域等方式调节。</p>';
  
  // 添加十神关系详解
  document.getElementById('ten-gods-detail').innerHTML = `
    <div class="info-box">
      <div class="title">正官</div>
      <p>代表事业、名誉和社会地位。您的正官位置良好，预示事业上有不错的发展。</p>
    </div>
    <div class="info-box">
      <div class="title">偏财</div>
      <p>代表意外之财、投资运。偏财位置适中，适合通过副业或投资增加收入。</p>
    </div>
  `;
  
  // 添加更多分析内容...
}

// 在原有genChart函数成功生成结果后调用enhanceAnalysis
// 修改原有的genChart函数，在成功生成结果后添加：
// enhanceAnalysis();
</script>
</body>
</html>
