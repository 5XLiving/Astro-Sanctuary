<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>å…«å­—å‘½ç† Â· å¿«é€Ÿæ’ç›˜</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <link rel="icon" href="data:,">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600&family=Inter:wght@400;600&display=swap" rel="stylesheet">

  <style>
    /* ä¿æŒä½ çš„åŸæœ‰æ ·å¼ï¼Œå¹¶ä¿®å¤/è¡¥å…¨å°‘é‡ç»†èŠ‚ */
:root{
  --bg:#0b0f14;
  --bg-accent:#0e1520;
  --card:#11161dcc;
  --surface:#0f1624;
  --line:#1f2a36;
  --text:#e8edf3;
  --muted:#98a7b7;

  --brand:#d4af37;
  --gold:#d4af37;
  --gold2:#f2d27a;
  --accent:#58b9ff;

  --radius:14px;
  --radius-sm:10px;
  --radius-lg:18px;

  --shadow:0 8px 30px rgba(0,0,0,.35);
  --shadow-sm:0 4px 14px rgba(0,0,0,.28);

  --container:1100px;
  --gap:12px;
  --pad:18px;

  /* ä¿®å¤ï¼šæ·»åŠ æ­£ç¡®çš„focuså˜é‡ */
  --focus: 0 0 0 2px rgba(212,175,55,0.2);

  /* ä»…ä¾›æ³¨é‡Šè¯´æ˜ï¼šåª’ä½“æŸ¥è¯¢ä»ç”¨å›ºå®šæ•°å€¼å†™ */
  --bp-s:520px;
  --bp-m:760px;
  --bp-l:900px;
}

/* Reset + base */
*,
*::before,
*::after{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; padding:0;
  color:var(--text);
  background:
    radial-gradient(1200px 600px at 70% -10%, #16202b 10%, transparent 60%) no-repeat,
    linear-gradient(180deg, #0b0f14, #0b0f14);
  font-family:Inter,system-ui,-apple-system,"Noto Sans SC","Segoe UI",Roboto,Arial,sans-serif;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}
body::before{
  content:""; position:fixed; inset:0; z-index:-2;
  background:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" opacity="0.05"><rect width="100" height="100" fill="%23d4af37"/></svg>') center/cover no-repeat;
  filter:brightness(0.45) saturate(0.9) blur(2px);
}

.container{max-width:var(--container); margin:0 auto; padding:24px 16px 80px}

.site-header{
  position:sticky; top:0; z-index:10;
  background:rgba(11,15,20,.8);
  border-bottom:1px solid #0f1622;
  backdrop-filter:saturate(140%) blur(12px);
}
.head-inner{display:flex; align-items:center; justify-content:space-between; gap:14px; padding:14px 16px}

.brand{display:flex; align-items:center; gap:10px; text-decoration:none; color:var(--text)}
.brand-badge{
  display:inline-grid; place-items:center;
  width:34px; height:34px; border-radius:8px;
  background:linear-gradient(180deg,#0e1520,#0b1018);
  border:1px solid #2a3546; box-shadow:var(--shadow-sm);
  font-weight:800; color:#ffe084
}
.title{font-family:"Noto Serif SC",serif; font-weight:700; letter-spacing:0.02em; font-size:1.1rem}

.lang{display:flex; align-items:center; gap:8px}
.lang select{
  appearance:none; min-width:140px;
  border-radius:10px; border:1px solid #243244;
  background:var(--bg-accent); color:var(--text);
  padding:10px 34px 10px 12px; font-size:0.95rem;
  background-image:url("data:image/svg+xml,%3Csvg width='12' height='8' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%2398a7b7' stroke-width='2' fill='none'/%3E%3C/svg%3E");
  background-repeat:no-repeat; background-position:calc(100% - 12px) 50%;
}

.section{margin-top:18px}
.card{
  background:var(--card);
  border:1px solid var(--line);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  backdrop-filter:blur(10px);
  padding:var(--pad);
  margin:16px 0;
}
.h2{
  font-size:1.2rem; margin:0 0 12px 0; font-weight:800; color:#ffe084;
  display:flex; gap:8px; align-items:center
}
.h2::before{content:""; width:4px; height:18px; background:var(--brand); border-radius:2px}

.row{display:grid; gap:var(--gap); grid-template-columns:1fr}
@media (min-width: 760px){
  .row.cols-3{grid-template-columns:1fr 1fr 1fr}
  .row.cols-2{grid-template-columns:1fr 1fr}
}

input,select{
  width:100%;
  border-radius:12px; border:1px solid #243244;
  background:var(--bg-accent); color:var(--text);
  padding:12px 12px; font-size:15px; outline:0;
}
input::placeholder{color:#6f8092}
input:focus, select:focus{box-shadow:var(--focus); border-color:#3a4c63}

.btn{
  display:inline-grid; place-items:center;
  padding:12px 16px; border-radius:12px;
  border:1px solid #e6c76e;
  background:linear-gradient(180deg,#fff9e6,#e6c76e);
  color:#191919; font-weight:800; cursor:pointer;
  transition:transform .2s ease, box-shadow .2s ease;
}
.btn:hover{transform:translateY(-1px); box-shadow:0 10px 22px rgba(230,199,110,.5)}
.btn[disabled]{opacity:.6; cursor:not-allowed}
.btn.ghost{background:transparent; color:var(--gold2); border:1px solid rgba(212,175,55,.45); box-shadow:none}
.btn.block{display:block; width:100%}

.pillars{display:grid; grid-template-columns:repeat(4,1fr); gap:10px; margin-bottom:20px}
.pillar{background:var(--surface); border:1px solid #253245; border-radius:12px; padding:14px 10px; text-align:center}
.pillar .tit{color:#9aa3b2; font-size:0.85rem; margin-bottom:6px}
.pillar .gz{font-size:1.5rem; font-weight:800; color:var(--gold2)}
@media (max-width: 520px){
  .pillars{grid-template-columns:repeat(2,1fr)}
}

.bazi-table{
  width:100%; border-collapse:collapse; margin-top:12px;
  background:var(--surface); border-radius:8px; overflow:hidden
}
.bazi-table th,.bazi-table td{
  padding:10px 12px; border:1px solid #253245; text-align:center; vertical-align:middle
}
.bazi-table th{background:rgba(212,175,55,.1); color:var(--gold2)}
/* å°å±è¡¨æ ¼å¯æ¨ªå‘æ»šåŠ¨ï¼šæŠŠ table ç”¨ div åŒ…ä¸€å±‚ .bazi-table-wrap å³å¯ */
.bazi-table-wrap{overflow:auto}
@media (max-width: 420px){
  .bazi-table th,.bazi-table td{padding:8px 10px}
}

.bar{height:10px; background:#0d1420; border:1px solid #233146; border-radius:999px; overflow:hidden; margin:6px 0}
.bar i{display:block; height:100%; background:linear-gradient(90deg,#ffe084,#f2d27a); width:0%; transition:width 0.5s ease}
.bar-row{display:grid; grid-template-columns:60px 1fr 60px; gap:10px; align-items:center}

.error-message{
  background:rgba(255,90,95,.1);
  border:1px solid #ff5a5f; border-radius:8px;
  padding:10px; display:none; margin-top:10px
}
.badge-warn{display:inline-block; padding:2px 8px; margin-left:6px; border:1px solid #ffb84d; border-radius:999px; color:#ffb84d; font-size:0.82rem}
.muted{color:var(--muted)}

.time-row{display:flex; align-items:center; gap:10px}
.time-row .time-unknown{display:flex; align-items:center; gap:6px; white-space:nowrap}
.time-row input[type="time"]{width:auto !important; flex:0 0 160px; min-width:140px}

.gen-wrap{display:flex; align-items:flex-end; justify-content:flex-end}
#genBtn{width:auto !important}

.analysis-grid{display:grid; gap:16px; margin-top:20px}
.analysis-card{background:var(--surface); border:1px solid #253245; border-radius:12px; padding:16px}
.analysis-card h3{color:var(--gold2); margin:0 0 12px 0; font-size:1.1rem}
.analysis-content{line-height:1.6}
.rating{display:flex; align-items:center; gap:8px; margin:8px 0}
.rating-stars{color:var(--gold2)}
.tag{display:inline-block; background:rgba(212,175,55,.1); color:var(--gold2); padding:4px 8px; border-radius:6px; font-size:0.85rem; margin:2px}

.luck-grid{display:grid; gap:10px}
.luck-item{background:rgba(255,255,255,.05); border-radius:8px; padding:12px; border-left:3px solid var(--gold2)}
.luck-year{font-weight:700; color:var(--gold2)}
.luck-desc{font-size:0.9rem; margin-top:4px}

.columns{display:grid; gap:12px; grid-template-columns:1fr}
@media (min-width: 900px){ .columns{grid-template-columns:1fr 1fr} }
.list-block{border:1px solid #263448; background:var(--bg-accent); border-radius:12px; padding:16px}
.list-block ul{margin:0.2rem 0 0 0; padding-left:1.1rem}
.group-title{font-size:1.05rem; color:#ffe084; margin:6px 0 14px}

.astro-auth{max-width:980px; margin:28px auto; padding:20px 18px;
  background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.01));
  border:1px solid rgba(212,175,55,.22); border-radius:14px; box-shadow:0 18px 50px rgba(0,0,0,.35)
}
.auth-grid{display:grid; gap:18px; grid-template-columns:1.2fr .8fr}
@media (max-width:860px){ .auth-grid{grid-template-columns:1fr} }
.panel{background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.01)); border:1px solid rgba(212,175,55,.22); border-radius:14px; box-shadow:0 10px 30px rgba(0,0,0,.35)}
.panel .head{padding:16px 18px; border-bottom:1px solid rgba(212,175,55,.22); color:var(--gold); font-weight:700; letter-spacing:0.3px}
.panel .body{padding:18px}
.spacer{height:12px}

.ai-box{background:#0b111a; border:1px solid #1f2a36; border-radius:12px; padding:14px 16px; margin:14px 0}
.ai-box-h{color:#ffd88a; font-weight:700; margin-bottom:8px}
.ai-box-c{color:#e8edf3; line-height:1.7}
.chips{display:flex; flex-wrap:wrap; gap:8px; margin-top:12px}
.chip{padding:6px 10px; border-radius:999px; border:1px solid #2a3546; background:#0e1520; color:#e8edf3; cursor:pointer; transition:border-color .2s ease, box-shadow .2s ease}
.chip:hover{border-color:#f2d27a; box-shadow:0 0 0 2px rgba(242,210,122,.15) inset}
.chip:disabled{opacity:.6; cursor:not-allowed}

.skeleton{display:grid; gap:8px}
.skeleton div{height:12px; border-radius:6px; background:linear-gradient(90deg,#1a2431,#1f2b3b,#1a2431); animation:sh 1.2s infinite}
@keyframes sh{0%{opacity:.5} 50%{opacity:1} 100%{opacity:.5}}

.ai-lock-overlay{margin-top:10px; padding-top:10px; border-top:1px solid #1f2a36; text-align:center}
.ai-lock-overlay .tip{color:#ffd88a; font-weight:700; margin-bottom:4px}
.ai-lock-overlay .sub{color:var(--muted)}

.detail-view{display:none}
.detail-header{display:flex; align-items:center; gap:12px; margin-bottom:20px}
.back-btn{background:rgba(212,175,55,.1); border:1px solid rgba(212,175,55,.3); color:var(--gold2); padding:8px 16px; border-radius:8px; cursor:pointer}
.detail-content{line-height:1.8}
.detail-section{margin-bottom:24px}
.detail-section h4{color:var(--gold2); margin-bottom:12px; font-size:1.1rem}
.action-list{list-style:none; padding:0; margin:0}
.action-list li{margin-bottom:8px; padding-left:20px; position:relative}
.action-list li::before{content:"â€¢"; color:var(--gold2); position:absolute; left:0; top:0}

footer{color:#6c7b8c; font-size:0.85rem; text-align:center; padding:30px 0; margin-top:40px}

/* Motion ä¼˜åŒ– */
@media (prefers-reduced-motion: reduce){
  *{animation:none !important; transition:none !important}
}

/* Utilities */
.sr-only{position:absolute !important; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0}
.chips-container{display:flex; flex-wrap:wrap; gap:8px; margin:20px 0; justify-content:center}

/* VIP section demo å¯è§ */
.vip-section{display:block !important}

/* Butler ç»„ä»¶ */
.butler-professional{display:none; margin-top:20px; background:var(--card); border:1px solid var(--line); border-radius:var(--radius); padding:20px}
.butler-header{display:flex; align-items:center; gap:10px; margin-bottom:20px; color:var(--gold2); font-size:1.2rem; font-weight:700}
.butler-content{line-height:1.8; max-height:600px; overflow-y:auto; padding:15px; background:var(--surface); border-radius:10px; border:1px solid #253245}
.butler-section{margin-bottom:25px; padding-bottom:15px; border-bottom:1px solid #253245}
.butler-section h4{color:var(--gold2); margin-bottom:10px; font-size:1.1rem}
.butler-chat{margin-top:20px; border-top:1px solid var(--line); padding-top:15px}
.chat-messages{height:200px; overflow-y:auto; margin-bottom:15px; padding:10px; background:var(--surface); border-radius:8px; border:1px solid #253245}
.chat-input-area{display:flex; gap:10px}
.chat-input-area input{flex:1; padding:10px; border-radius:8px; border:1px solid #253245; background:#0e1520; color:#e8edf3}
.chat-send-btn{padding:10px 20px; background:var(--gold); color:#191919; border:none; border-radius:8px; font-weight:700; cursor:pointer}

/* ==== remove the brown/gold focus outline ==== */
input:focus,
select:focus,
textarea:focus{
  outline: none !important;
  box-shadow: none !important;
  border-color: #243244 !important;
}
button:focus,
.btn:focus,
a:focus{
  outline: none !important;
  box-shadow: none !important;
}

/* (optional) also remove tap highlight on mobile */
*{ -webkit-tap-highlight-color: transparent; }    
.chip:hover{ border-color:#2a3546; box-shadow:none; }

/* æµ®çª—èŠå¤©æ ·å¼ */
.chat-float {
  position: fixed;
  bottom: 20px;
  right: 20px;
  width: 350px;
  height: 500px;
  background: var(--card);
  border: 1px solid var(--line);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  backdrop-filter: blur(10px);
  z-index: 1000;
  display: none;
  flex-direction: column;
}

.chat-float-header {
  padding: 12px 16px;
  border-bottom: 1px solid var(--line);
  background: rgba(212,175,55,.1);
  color: var(--gold2);
  font-weight: 700;
  display: flex;
  justify-content: space-between;
  align-items: center;
  cursor: move;
}

.chat-float-close {
  background: none;
  border: none;
  color: var(--gold2);
  font-size: 1.2rem;
  cursor: pointer;
  padding: 4px;
  border-radius: 4px;
}

.chat-float-close:hover {
  background: rgba(212,175,55,.2);
}

.chat-float-body {
  flex: 1;
  display: flex;
  flex-direction: column;
  padding: 0;
}

.chat-float-messages {
  flex: 1;
  overflow-y: auto;
  padding: 12px;
  background: var(--surface);
}

.chat-float-input-area {
  padding: 12px;
  border-top: 1px solid var(--line);
  background: var(--bg-accent);
}

.chat-toggle-btn {
  position: fixed;
  bottom: 20px;
  right: 20px;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: linear-gradient(180deg,#fff9e6,#e6c76e);
  border: 1px solid #e6c76e;
  color: #191919;
  font-size: 1.5rem;
  cursor: pointer;
  box-shadow: 0 4px 12px rgba(230,199,110,.3);
  z-index: 1001;
  display: flex;
  align-items: center;
  justify-content: center;
}

.chat-toggle-btn:hover {
  transform: scale(1.05);
  box-shadow: 0 6px 20px rgba(230,199,110,.5);
}

/* å“åº”å¼è°ƒæ•´ */
@media (max-width: 768px) {
  .chat-float {
    width: 300px;
    height: 400px;
    bottom: 10px;
    right: 10px;
  }
  
  .chat-toggle-btn {
    width: 50px;
    height: 50px;
    bottom: 10px;
    right: 10px;
  }
}    
</style>
</head>
<body>
  <header class="site-header">
    <div class="head-inner container">
      <a class="brand" href="https://astro.5xliving.com/" target="_self">
        <span class="brand-badge">5X</span>
      <span class="title" data-i18n="brand.subtitle">5xLiving Â· å…«å­—ç®€è¯„</span>
    </a>
    <div class="lang">
      <label for="langSelect" class="muted" data-i18n="nav.langLabel">è¯­è¨€</label>
      <select id="langSelect" aria-label="Language">
        <option value="zh-CN" data-i18n="lang.zh-CN">ç®€ä½“ä¸­æ–‡</option>
        <option value="zh-TW" data-i18n="lang.zh-TW">ç¹é«”ä¸­æ–‡</option>
        <option value="en"    data-i18n="lang.en">English</option>
        <option value="ja"    data-i18n="lang.ja">æ—¥æœ¬èª</option>
        <option value="th"    data-i18n="lang.th">à¹„à¸—à¸¢</option>
        <option value="ms"    data-i18n="lang.ms">Bahasa Melayu</option>
      </select>
    </div>
  </div>
</header>

<main class="container">
  <section class="card">
    <div class="h2" data-i18n="app.title">å…«å­—å‘½ç† Â· å¿«é€Ÿæ’ç›˜</div>
    <div class="row cols-3">
      <div>
        <label class="muted" data-i18n="form.nameLabel">å§“åï¼ˆå¯é€‰ï¼‰</label>
        <input id="name" placeholder="ä½ çš„ç§°å‘¼ï¼ˆç”¨äºä¸ªæ€§åŒ–ï¼‰" />
      </div>
      <div>
        <label class="muted" data-i18n="form.genderLabel">æ€§åˆ«</label>
        <select id="gender">
          <option value=""        data-i18n="form.gender.hidden">ä¸é€éœ²</option>
          <option value="male"    data-i18n="form.gender.male">ç”·æ€§</option>
          <option value="female"  data-i18n="form.gender.female">å¥³æ€§</option>
        </select>
      </div>
      <div>
        <label class="muted" data-i18n="form.calendarLabel">å†æ³•</label>
        <select id="calendar">
          <option value="gregorian" data-i18n="form.calendar.gregorian">é˜³å†</option>
          <option value="lunar"     data-i18n="form.calendar.lunar">å†œå†</option>
        </select>
      </div>
    </div>
    <div class="row cols-3" style="margin-top:10px">
      <div>
        <label class="muted" data-i18n="form.birthdateLabel">å‡ºç”Ÿæ—¥æœŸ</label>
        <input type="date" id="birthdate" />
      </div>
      <div>
        <label class="muted" data-i18n="form.birthtimeLabel">å‡ºç”Ÿæ—¶é—´</label>
        <div class="time-row">
          <input type="time" id="birthtime" />
          <label class="muted time-unknown">
            <input type="checkbox" id="timeUnknown" />
            <span data-i18n="form.timeUnknown">å‡ºç”Ÿæ—¶é—´ä¸è¯¦</span>
          </label>
        </div>
      </div>
      <div class="gen-wrap">
        <button class="btn" id="genBtn" type="button">
          <span id="genBtnText" data-i18n="btn.generate">ç”Ÿæˆå…«å­—</span>
          <span id="genBtnLoading" style="display:none" data-i18n="btn.loading">è®¡ç®—ä¸­...</span>
        </button>
      </div>
    </div>
    <div id="error" class="error-message"></div>
  </section>

<section id="result" style="display:none;">
    <div class="card">
      <div class="h2" data-i18n="result.title">æ‚¨çš„ç”Ÿè¾°å…«å­—å‘½ç›˜</div>
      <div class="pillars" id="bazi-pillars"></div>
      <div class="muted" id="bazi-date" style="margin-top:6px"></div>
     
      <table class="bazi-table">
        <thead>
          <tr>
            <th></th>
            <th data-i18n="pillar.year">å¹´æŸ±</th>
            <th data-i18n="pillar.month">æœˆæŸ±</th>
            <th data-i18n="pillar.day">æ—¥æŸ±</th>
            <th data-i18n="pillar.hour">æ—¶æŸ±</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td data-i18n="table.row.stem">å¤©å¹²</td>
            <td id="year-stem">-</td><td id="month-stem">-</td><td id="day-stem">-</td><td id="hour-stem">-</td>
          </tr>
          <tr>
            <td data-i18n="table.row.branch">åœ°æ”¯</td>
            <td id="year-branch">-</td><td id="month-branch">-</td><td id="day-branch">-</td><td id="hour-branch">-</td>
          </tr>
          <tr>
            <td data-i18n="table.row.fiveElem">äº”è¡Œ</td>
            <td id="year-element">-</td><td id="month-element">-</td><td id="day-element">-</td><td id="hour-element">-</td>
          </tr>
          <tr>
            <td data-i18n="table.row.nayin">çº³éŸ³</td>
            <td id="year-nayin">-</td><td id="month-nayin">-</td><td id="day-nayin">-</td><td id="hour-nayin">-</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="card">
      <div class="h2" data-i18n="energy.title">äº”è¡Œèƒ½é‡åˆ†æ</div>
      <div class="bar-row"><span data-i18n="elem.wood">æœ¨</span><div class="bar"><i id="bar-æœ¨"></i></div><span id="pct-æœ¨">0%</span></div>
      <div class="bar-row"><span data-i18n="elem.fire">ç«</span><div class="bar"><i id="bar-ç«"></i></div><span id="pct-ç«">0%</span></div>
      <div class="bar-row"><span data-i18n="elem.earth">åœŸ</span><div class="bar"><i id="bar-åœŸ"></i></div><span id="pct-åœŸ">0%</span></div>
      <div class="bar-row"><span data-i18n="elem.metal">é‡‘</span><div class="bar"><i id="bar-é‡‘"></i></div><span id="pct-é‡‘">0%</span></div>
      <div class="bar-row"><span data-i18n="elem.water">æ°´</span><div class="bar"><i id="bar-æ°´"></i></div><span id="pct-æ°´">0%</span></div>
      <div id="bazi-elements-balance" class="muted"></div>
    </div>
  </section>

  <section id="butlerProfessional" class="butler-professional">
    <div class="butler-header">
      <span data-i18n="pro.title">ğŸ§™â€â™‚ï¸ å¿ƒæ€œç®¡å®¶ Â· ä¸“ä¸šå‘½ç†åˆ†æ</span>
    </div>
    <div class="butler-content" id="professionalReport"></div>
</section>
    
<!-- æµ®çª—èŠå¤©æŒ‰é’® -->
<button class="chat-toggle-btn" id="chatToggle" data-i18n="chat.toggle">é—®</button>

<!-- æµ®çª—èŠå¤©çª—å£ -->
<div class="chat-float" id="chatFloat">
  <div class="chat-float-header">
    <span data-i18n="pro.title">ğŸ§™â€â™‚ï¸ å¿ƒæ€œç®¡å®¶ Â· ä¸“ä¸šå‘½ç†åˆ†æ</span>
    <button class="chat-float-close" id="chatClose">Ã—</button>
  </div>
  <div class="chat-float-body">
    <div class="chat-float-messages" id="chatMessages">
      <div class="ss-msg" data-i18n="pro.welcome">æ‚¨å¥½ï¼æˆ‘æ˜¯æ‚¨çš„ä¸“ä¸šå‘½ç†é¡¾é—®ï¼Œå·²ä¸ºæ‚¨ç”Ÿæˆè¯¦ç»†åˆ†ææŠ¥å‘Šã€‚æœ‰ä»€ä¹ˆå…·ä½“é—®é¢˜å¯ä»¥éšæ—¶é—®æˆ‘ã€‚</div>
    </div>
    <div class="chat-float-input-area">
      <div style="display: flex; gap: 8px;">
        <input type="text" id="chatInput" placeholder="è¯·è¾“å…¥æ‚¨çš„é—®é¢˜..." style="flex: 1; padding: 10px; border-radius: 8px; border: 1px solid #253245; background: #0e1520; color: #e8edf3;">
        <button class="chat-send-btn" id="chatSend" data-i18n="chat.send" style="padding: 10px 16px; background: var(--gold); color: #191919; border: none; border-radius: 8px; font-weight: 700; cursor: pointer;">å‘é€</button>
      </div>
    </div>
  </div>
</div>  

  <section class="card section vip-section">
    <h2 class="group-title" data-i18n="vip.title">ğŸŒ™ ä¼šå‘˜åŒºåŸŸ VIP Segment</h2>
    <div class="columns">
      <div class="list-block">
        <div class="group-title" data-i18n="vip.group.astrology">ğŸ— å‘½ç†ç©ºé—´ä¸“å±å†…å®¹</div>
        <ul>
          <li data-i18n="vip.astrology.match">å§»ç¼˜æ–¹å‘ï¼šæ‹çˆ±ç¼˜åˆ†ã€å©šå§»èµ°åŠ¿</li>
          <li data-i18n="vip.astrology.career">äº‹ä¸šæ–¹å‘ï¼šèŒåœºå‘å±•ã€åˆ›ä¸šæ½œåŠ›</li>
          <li data-i18n="vip.astrology.wealth">è´¢è¿æ–¹å‘ï¼šè´¢ä½åˆ†æã€ç†è´¢æ—¶æœº</li>
          <li data-i18n="vip.astrology.pet">å® ç‰©å‘½ç†ï¼šä¼´ä¾£åŠ¨ç‰©çš„æ€§æ ¼ä¸ç¼˜åˆ†</li>
        </ul>
      </div>
      <div class="list-block">
        <div class="group-title" data-i18n="vip.group.spiritual">ğŸŒ™ å¿ƒæ€œç©ºé—´ä¸“å±å†…å®¹</div>
        <ul>
          <li data-i18n="vip.spiritual.record">çµæ€§è®°å½•ï¼šç…§ç‰‡ã€æ¢¦å¢ƒã€å£°éŸ³ã€æ„¿æœ›ç¥ˆç¥·</li>
          <li data-i18n="vip.spiritual.courses">å‘½ç†è¯¾ç¨‹ï¼šå…«å­— / å¡”ç½— / å æ˜Ÿ / çµæ•°</li>
          <li data-i18n="vip.spiritual.family">å®¶æ—çºªå¿µç³»ç»Ÿï¼šäº²äººçµæ€§çºªå¿µ & å»¶ç»­</li>
          <li data-i18n="vip.spiritual.practice">æ¯å‘¨èƒ½é‡ç»ƒä¹  / ç¥æ˜ä»ªå¼ä»»åŠ¡</li>
        </ul>
      </div>
    </div>

    <div class="group-title" style="margin-top:14px" data-i18n="vip.login.title">ğŸ’ ç™»å…¥ VIP åŠŸèƒ½</div>
    <section class="astro-auth">
      <div class="auth-grid">
        <div class="panel">
          <div class="head" data-i18n="auth.header">è´¦æˆ·ç™»å½• / æ³¨å†Œ</div>
          <div class="body">
            <div class="row" id="authFields">
              <input id="email" name="email" type="email" inputmode="email" autocomplete="username" placeholder="é‚®ç®± Email">
              <input id="password" name="password" type="password" autocomplete="current-password" placeholder="å¯†ç  Passwordï¼ˆè‡³å°‘8ä½ï¼Œå«å¤§å°å†™æ•°å­—ç¬¦å·ï¼‰">
            </div>
            <div class="spacer"></div>
            <form id="loginForm" class="row one">
              <button class="btn block" id="loginBtn" type="submit" data-i18n="auth.login">ç™»å…¥è´¦æˆ·</button>
            </form>
            <div class="spacer"></div>
            <div class="row one">
              <button class="btn ghost block" id="resetBtn" type="button" data-i18n="auth.reset">ğŸ”‘ é‡è®¾å¯†ç </button>
            </div>
            <div class="spacer"></div>
            <form class="row one" id="registerForm">
              <button class="btn block" id="registerBtn" type="submit" data-i18n="auth.register">æ³¨å†Œè´¦æˆ·</button>
              <div class="muted" data-i18n="auth.freeTrialNote">æ³¨å†Œè´¦å·èµ é€ä¸€æ¬¡å…è´¹ä½“éªŒ</div>
              <div class="spacer"></div>
              <div class="error-message" id="authError" style="display:none"></div>
            </form>
          </div>
        </div>

        <div class="panel">
          <div class="head" data-i18n="vip.services.header">ä¼šå‘˜æœåŠ¡</div>
          <div class="body">
            <div class="row one">
              <a class="btn block" href="https://yourshopifyshop.com/products/monthly-vip" target="_blank" rel="noopener noreferrer" data-i18n="vip.upgrade">ğŸ’ å‡çº§ä¸º VIPï¼ˆæœˆè´¹ï¼‰</a>
            </div>
            <div class="row one">
              <a class="btn ghost block" href="https://yourshopifyshop.myshopify.com" target="_blank" rel="noopener noreferrer" data-i18n="vip.back">â† è¿”å›å‘½ç†å•†åŸ</a>
            </div>
            <div class="muted" data-i18n="vip.priceNote">$9.9 / æœˆè´¹ VIPï¼ˆå‘½ç†ç©ºé—´ + å¿ƒæ€œç©ºé—´ + çµæ€§è¯¾ç¨‹ï¼‰</div>
          </div>
        </div>
      </div>
    </section>
  </section>

  <footer data-i18n="footer.copy">Â© 5XLiving â€¢ Astro Sanctuary</footer>
</main>
  
<script>window.API_BASE='https://throbbing-lab-1440.hello5xliving.workers.dev';</script>
<script>
/*!
 * 5XLiving Â· Bazi Quick Chart (single-file script)
 * Place this once at the END of your <body>.
 * Changes:
 * - NowBox current time (auto refresh)
 * - No echo of email/password; no payload logs
 * - Source badge (#originBadge) shows Local vs AI(API)
 * - Safer i18n + hour text formatting
 */
(() => {
  'use strict';

  /* =========================
   * CONFIG
   * ========================= */
  const CONFIG = {
    API_BASE: (typeof window.API_BASE === 'string' ? window.API_BASE : ''), // e.g. 'https://your-api.example.com'
    TIMEOUT_MS: 12000
  };

  /* =========================
   * I18N DICTIONARY
   * ========================= */
  const I18N = {
    /* ---- zh-CN ---- */
'zh-CN': {
  brand: { subtitle: '5xLiving Â· å…«å­—ç®€è¯„' },
  nav: { langLabel: 'è¯­è¨€' },
  lang: { 'zh-CN':'ç®€ä½“ä¸­æ–‡','zh-TW':'ç¹é«”ä¸­æ–‡','en':'English','ja':'æ—¥æœ¬èª','th':'à¹„à¸—à¸¢','ms':'Bahasa Melayu' },

  app: { title: 'å…«å­—å‘½ç† Â· å¿«é€Ÿæ’ç›˜' },

  form: {
    nameLabel: 'å§“åï¼ˆå¯é€‰ï¼‰',
    namePlaceholder: 'ä½ çš„ç§°å‘¼ï¼ˆç”¨äºä¸ªæ€§åŒ–ï¼‰',
    genderLabel: 'æ€§åˆ«',
    gender: { hidden:'ä¸é€éœ²', male:'ç”·æ€§', female:'å¥³æ€§' },
    calendarLabel: 'å†æ³•',
    calendar: { gregorian:'é˜³å†', lunar:'å†œå†' },
    birthdateLabel: 'å‡ºç”Ÿæ—¥æœŸ',
    birthtimeLabel: 'å‡ºç”Ÿæ—¶é—´',
    timeUnknown: 'å‡ºç”Ÿæ—¶é—´ä¸è¯¦'
  },

  btn: { generate:'ç”Ÿæˆå…«å­—', loading:'è®¡ç®—ä¸­...' },

  result: { title:'æ‚¨çš„ç”Ÿè¾°å…«å­—å‘½ç›˜' },
  pillar: { year:'å¹´æŸ±', month:'æœˆæŸ±', day:'æ—¥æŸ±', hour:'æ—¶æŸ±' },
  table: { row: { stem:'å¤©å¹²', branch:'åœ°æ”¯', fiveElem:'äº”è¡Œ', nayin:'çº³éŸ³' } },

  energy: { title:'äº”è¡Œèƒ½é‡åˆ†æ' },
  elem: { wood:'æœ¨', fire:'ç«', earth:'åœŸ', metal:'é‡‘', water:'æ°´' },

  pro: { title:'ğŸ§™â€â™‚ï¸ å¿ƒæ€œç®¡å®¶ Â· ä¸“ä¸šå‘½ç†åˆ†æ', welcome:'æ‚¨å¥½ï¼æˆ‘æ˜¯æ‚¨çš„ä¸“ä¸šå‘½ç†é¡¾é—®ï¼Œå·²ä¸ºæ‚¨ç”Ÿæˆè¯¦ç»†åˆ†ææŠ¥å‘Šã€‚æœ‰ä»€ä¹ˆå…·ä½“é—®é¢˜å¯ä»¥éšæ—¶é—®æˆ‘ã€‚' },
  chat: { send:'å‘é€', placeholder:'è¯·è¾“å…¥æ‚¨çš„é—®é¢˜...' },

  vip: {
    title:'ğŸŒ™ ä¼šå‘˜åŒºåŸŸ VIP Segment',
    group: { astrology:'ğŸ— å‘½ç†ç©ºé—´ä¸“å±å†…å®¹', spiritual:'ğŸŒ™ å¿ƒæ€œç©ºé—´ä¸“å±å†…å®¹' },
    astrology: { match:'å§»ç¼˜æ–¹å‘ï¼šæ‹çˆ±ç¼˜åˆ†ã€å©šå§»èµ°åŠ¿', career:'äº‹ä¸šæ–¹å‘ï¼šèŒåœºå‘å±•ã€åˆ›ä¸šæ½œåŠ›', wealth:'è´¢è¿æ–¹å‘ï¼šè´¢ä½åˆ†æã€ç†è´¢æ—¶æœº', pet:'å® ç‰©å‘½ç†ï¼šä¼´ä¾£åŠ¨ç‰©çš„æ€§æ ¼ä¸ç¼˜åˆ†' },
    spiritual: { record:'çµæ€§è®°å½•ï¼šç…§ç‰‡ã€æ¢¦å¢ƒã€å£°éŸ³ã€æ„¿æœ›ç¥ˆç¥·', courses:'å‘½ç†è¯¾ç¨‹ï¼šå…«å­— / å¡”ç½— / å æ˜Ÿ / çµæ•°', family:'å®¶æ—çºªå¿µç³»ç»Ÿï¼šäº²äººçµæ€§çºªå¿µ & å»¶ç»­', practice:'æ¯å‘¨èƒ½é‡ç»ƒä¹  / ç¥æ˜ä»ªå¼ä»»åŠ¡' },
    login: { title:'ğŸ’ ç™»å…¥ VIP åŠŸèƒ½' },
    services: { header:'ä¼šå‘˜æœåŠ¡' },
    upgrade:'ğŸ’ å‡çº§ä¸º VIPï¼ˆæœˆè´¹ï¼‰',
    back:'â† è¿”å›å‘½ç†å•†åŸ',
    priceNote:'$9.9 / æœˆè´¹ VIPï¼ˆå‘½ç†ç©ºé—´ + å¿ƒæ€œç©ºé—´ + çµæ€§è¯¾ç¨‹ï¼‰'
  },

  auth: {
    header:'è´¦æˆ·ç™»å½• / æ³¨å†Œ',
    login:'ç™»å…¥è´¦æˆ·',
    reset:'ğŸ”‘ é‡è®¾å¯†ç ',
    register:'æ³¨å†Œè´¦æˆ·',
    freeTrialNote:'æ³¨å†Œè´¦å·èµ é€ä¸€æ¬¡å…è´¹ä½“éªŒ',
    emailPlaceholder:'é‚®ç®± Email',
    passwordPlaceholder:'å¯†ç  Passwordï¼ˆè‡³å°‘8ä½ï¼Œå«å¤§å°å†™æ•°å­—ç¬¦å·ï¼‰'
  },

  footer: { copy:'Â© 5XLiving â€¢ Astro Sanctuary' },

  err: {
    fillBirthdate: 'è¯·å¡«å†™å‡ºç”Ÿæ—¥æœŸ',
    invalidDate:   'æ— æ•ˆçš„æ—¥æœŸæ ¼å¼ï¼Œè¯·ç”¨ YYYY-MM-DD',
    generateFail:  'ç”Ÿæˆå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•'
  },
  ui: {
    unknown:      'æœªçŸ¥',
    timeUnknown:  'æ—¶é—´ä¸è¯¦',
    hourSuffix:   '{h}æ—¶',
    birthSummary: 'å‡ºç”Ÿæ—¥æœŸ: {y}å¹´{m}æœˆ{d}æ—¥ {timeText}',
    balance:      'äº”è¡Œä¸­{strongest}æœ€å¼ºï¼Œ{weakest}æœ€å¼±ã€‚'
  },
  badge: { noHour: 'æœªçº³å…¥æ—¶æŸ±' },
  chatDyn:  { autoReply: 'æ”¶åˆ°ï¼š{q}ã€‚ç¨åå¯åœ¨ä¸“ä¸šæŠ¥å‘Šç›¸åº”ç« èŠ‚æ‰¾åˆ°è¦ç‚¹ã€‚' },
  elemNames: { æœ¨:'æœ¨', ç«:'ç«', åœŸ:'åœŸ', é‡‘:'é‡‘', æ°´:'æ°´' },
  report: { hourUnknownTip: 'âš ï¸ æç¤ºï¼šå› å‡ºç”Ÿæ—¶é—´ä¸è¯¦ï¼Œéƒ¨åˆ†åˆ†æä»…ä¾›å‚è€ƒã€‚' },

  relations: {
    same:       'åŒç±»ï¼ˆäº’åŠ©ï¼‰',
    i_output:   'è¾“å‡ºï¼ˆæˆ‘â†’å¯¹æ–¹ï¼‰',
    benefit_me: 'è¡¥ç›Šï¼ˆå¯¹æ–¹â†’æˆ‘ï¼‰',
    i_control:  'ä¸»æ§ï¼ˆæˆ‘åˆ¶è¡¡ï¼‰',
    control_me: 'å—å‹ï¼ˆå—åˆ¶è¡¡ï¼‰'
  },

  reportLabels: {
  traits: 'ç‰¹è´¨',
  actions: 'è¡ŒåŠ¨',
  outcomes: 'ç»“æœå€¾å‘',
  cautions: 'æ³¨æ„',
  timing: 'æ—¶æœº',
  confidence: 'å¯ä¿¡åº¦'
},
  
reportTitles: {
  overview: 'å‘½ç›˜æ€»è§ˆ',
  five_elements: 'äº”è¡Œèƒ½é‡åˆ†æ',
  ten_gods: 'åç¥é…ç½®åˆ†æ',
  useful_spirit: 'ç”¨ç¥å–œå¿Œ',
  career: 'äº‹ä¸šå‘å±•',
  wealth: 'è´¢è¿èµ°åŠ¿',
  relationship: 'æ„Ÿæƒ…å©šå§»',
  health: 'å¥åº·å…»ç”Ÿ',
  spiritual: 'ç„å­¦ç¼˜åˆ†',
  near_term: 'è¿‘æœŸè¿åŠ¿ï¼ˆ3â€“6ä¸ªæœˆï¼‰'
},
  
  units: { before:'', after:'ä¸ª' },
  chat: { send:'å‘é€', placeholder:'è¯·è¾“å…¥æ‚¨çš„é—®é¢˜...', toggle:'é—®' },
  report: { hourUnknownTip:'âš ï¸ æç¤ºï¼šå› å‡ºç”Ÿæ—¶é—´ä¸è¯¦ï¼Œéƒ¨åˆ†åˆ†æä»…ä¾›å‚è€ƒã€‚', tipTitle:'æç¤º' },

  elemJoin: '',
  tenGods: { æ¯”è‚©:'æ¯”è‚©', åŠ«è´¢:'åŠ«è´¢', é£Ÿç¥:'é£Ÿç¥', ä¼¤å®˜:'ä¼¤å®˜', åè´¢:'åè´¢', æ­£è´¢:'æ­£è´¢', ä¸ƒæ€:'ä¸ƒæ€', æ­£å®˜:'æ­£å®˜', åå°:'åå°', æ­£å°:'æ­£å°' },
  dirMap: { ä¸œ:'ä¸œ', è¥¿:'è¥¿', å—:'å—', åŒ—:'åŒ—', ä¸­:'ä¸­', æ­£ä¸œæ–¹:'æ­£ä¸œæ–¹', ä¸œå—æ–¹:'ä¸œå—æ–¹', å—æ–¹:'å—æ–¹', è¥¿æ–¹:'è¥¿æ–¹', åŒ—æ–¹:'åŒ—æ–¹', ä¸­å¤®:'ä¸­å¤®' },
  colorMap: { æœ¨:'ç»¿è‰²ã€é’è‰²', ç«:'çº¢è‰²ã€ç´«è‰²', åœŸ:'é»„è‰²ã€æ£•è‰²', é‡‘:'ç™½è‰²ã€é‡‘è‰²', æ°´:'é»‘è‰²ã€è“è‰²' },
  nayinMap: {},

  stemMap: {
    'ç”²':'ç”²', 'ä¹™':'ä¹™', 'ä¸™':'ä¸™', 'ä¸':'ä¸', 'æˆŠ':'æˆŠ', 
    'å·±':'å·±', 'åºš':'åºš', 'è¾›':'è¾›', 'å£¬':'å£¬', 'ç™¸':'ç™¸'
  },
  branchMap: {
    'å­':'å­', 'ä¸‘':'ä¸‘', 'å¯…':'å¯…', 'å¯':'å¯', 'è¾°':'è¾°', 'å·³':'å·³',
    'åˆ':'åˆ', 'æœª':'æœª', 'ç”³':'ç”³', 'é…‰':'é…‰', 'æˆŒ':'æˆŒ', 'äº¥':'äº¥'
  }
},

/* ---- zh-TW ---- */
'zh-TW': {
  brand: { subtitle: '5xLiving Â· å…«å­—ç°¡è©•' },
  nav: { langLabel: 'èªè¨€' },
  lang: { 'zh-CN':'ç°¡é«”ä¸­æ–‡','zh-TW':'ç¹é«”ä¸­æ–‡','en':'English','ja':'æ—¥æœ¬èª','th':'à¹„à¸—à¸¢','ms':'Bahasa Melayu' },

  app: { title: 'å…«å­—å‘½ç† Â· å¿«é€Ÿæ’ç›¤' },

  form: {
    nameLabel: 'å§“åï¼ˆå¯é¸ï¼‰',
    namePlaceholder: 'ä½ çš„ç¨±å‘¼ï¼ˆç”¨æ–¼å€‹æ€§åŒ–ï¼‰',
    genderLabel: 'æ€§åˆ¥',
    gender: { hidden:'ä¸é€éœ²', male:'ç”·æ€§', female:'å¥³æ€§' },
    calendarLabel: 'æ›†æ³•',
    calendar: { gregorian:'é™½æ›†', lunar:'è¾²æ›†' },
    birthdateLabel: 'å‡ºç”Ÿæ—¥æœŸ',
    birthtimeLabel: 'å‡ºç”Ÿæ™‚é–“',
    timeUnknown: 'å‡ºç”Ÿæ™‚é–“ä¸è©³'
  },

  btn: { generate:'ç”Ÿæˆå…«å­—', loading:'è¨ˆç®—ä¸­...' },

  result: { title:'æ‚¨çš„ç”Ÿè¾°å…«å­—å‘½ç›¤' },
  pillar: { year:'å¹´æŸ±', month:'æœˆæŸ±', day:'æ—¥æŸ±', hour:'æ™‚æŸ±' },
  table: { row: { stem:'å¤©å¹²', branch:'åœ°æ”¯', fiveElem:'äº”è¡Œ', nayin:'ç´éŸ³' } },

  energy: { title:'äº”è¡Œèƒ½é‡åˆ†æ' },
  elem: { wood:'æœ¨', fire:'ç«', earth:'åœŸ', metal:'é‡‘', water:'æ°´' },

  pro: { title:'ğŸ§™â€â™‚ï¸ å¿ƒæ†ç®¡å®¶ Â· å°ˆæ¥­å‘½ç†åˆ†æ', welcome:'æ‚¨å¥½ï¼æˆ‘æ˜¯æ‚¨çš„å°ˆæ¥­å‘½ç†é¡§å•ï¼Œå·²ç‚ºæ‚¨ç”Ÿæˆè©³ç´°åˆ†æå ±å‘Šã€‚æœ‰ä»€éº¼å…·é«”å•é¡Œå¯ä»¥éš¨æ™‚å•æˆ‘ã€‚' },
  chat: { send:'ç™¼é€', placeholder:'è«‹è¼¸å…¥æ‚¨çš„å•é¡Œ...' },

  vip: {
    title:'ğŸŒ™ æœƒå“¡å€åŸŸ VIP Segment',
    group: { astrology:'ğŸ— å‘½ç†ç©ºé–“å°ˆå±¬å…§å®¹', spiritual:'ğŸŒ™ å¿ƒæ†ç©ºé–“å°ˆå±¬å…§å®¹' },
    astrology: { match:'å§»ç·£æ–¹å‘ï¼šæˆ€æ„›ç·£åˆ†ã€å©šå§»èµ°å‹¢', career:'äº‹æ¥­æ–¹å‘ï¼šè·å ´ç™¼å±•ã€å‰µæ¥­æ½›åŠ›', wealth:'è²¡é‹æ–¹å‘ï¼šè²¡ä½åˆ†æã€ç†è²¡æ™‚æ©Ÿ', pet:'å¯µç‰©å‘½ç†ï¼šä¼´ä¾¶å‹•ç‰©çš„æ€§æ ¼èˆ‡ç·£åˆ†' },
    spiritual: { record:'éˆæ€§è¨˜éŒ„ï¼šç…§ç‰‡ã€å¤¢å¢ƒã€è²éŸ³ã€é¡˜æœ›ç¥ˆç¦±', courses:'å‘½ç†èª²ç¨‹ï¼šå…«å­— / å¡”ç¾… / å æ˜Ÿ / éˆæ•¸', family:'å®¶æ—ç´€å¿µç³»çµ±ï¼šè¦ªäººéˆæ€§ç´€å¿µ & å»¶çºŒ', practice:'æ¯é€±èƒ½é‡ç·´ç¿’ / ç¥æ˜å„€å¼ä»»å‹™' },
    login: { title:'ğŸ’ ç™»å…¥ VIP åŠŸèƒ½' },
    services: { header:'æœƒå“¡æœå‹™' },
    upgrade:'ğŸ’ å‡ç´šç‚º VIPï¼ˆæœˆè²»ï¼‰',
    back:'â† è¿”å›å‘½ç†å•†åŸ',
    priceNote:'$9.9 / æœˆè²» VIPï¼ˆå‘½ç†ç©ºé–“ + å¿ƒæ†ç©ºé–“ + éˆæ€§èª²ç¨‹ï¼‰'
  },

  auth: {
    header:'è³¬æˆ¶ç™»éŒ„ / è¨»å†Š',
    login:'ç™»å…¥è³¬æˆ¶',
    reset:'ğŸ”‘ é‡è¨­å¯†ç¢¼',
    register:'è¨»å†Šè³¬æˆ¶',
    freeTrialNote:'è¨»å†Šè³¬è™Ÿè´ˆé€ä¸€æ¬¡å…è²»é«”é©—',
    emailPlaceholder:'éƒµç®± Email',
    passwordPlaceholder:'å¯†ç¢¼ Passwordï¼ˆè‡³å°‘8ä½ï¼Œå«å¤§å°å¯«æ•¸å­—ç¬¦è™Ÿï¼‰'
  },

  footer: { copy:'Â© 5XLiving â€¢ Astro Sanctuary' },

  err: {
    fillBirthdate: 'è«‹å¡«å¯«å‡ºç”Ÿæ—¥æœŸ',
    invalidDate:   'ç„¡æ•ˆçš„æ—¥æœŸæ ¼å¼ï¼Œè«‹ç”¨ YYYY-MM-DD',
    generateFail:  'ç”Ÿæˆå¤±æ•—ï¼Œè«‹ç¨å¾Œé‡è©¦'
  },
  ui: {
    unknown:      'æœªçŸ¥',
    timeUnknown:  'æ™‚é–“ä¸è©³',
    hourSuffix:   '{h}æ™‚',
    birthSummary: 'å‡ºç”Ÿæ—¥æœŸ: {y}å¹´{m}æœˆ{d}æ—¥ {timeText}',
    balance:      'äº”è¡Œä¸­{strongest}æœ€å¼·ï¼Œ{weakest}æœ€å¼±ã€‚'
  },
  badge: { noHour: 'æœªç´å…¥æ™‚æŸ±' },
  chatDyn:  { autoReply: 'æ”¶åˆ°ï¼š{q}ã€‚ç¨å¾Œå¯åœ¨å°ˆæ¥­å ±å‘Šç›¸æ‡‰ç« ç¯€æ‰¾åˆ°è¦é»ã€‚' },
  elemNames: { æœ¨:'æœ¨', ç«:'ç«', åœŸ:'åœŸ', é‡‘:'é‡‘', æ°´:'æ°´' },
  report: { hourUnknownTip: 'âš ï¸ æç¤ºï¼šå› å‡ºç”Ÿæ™‚é–“ä¸è©³ï¼Œéƒ¨åˆ†åˆ†æåƒ…ä¾›åƒè€ƒã€‚' },

  relations: {
    same:       'åŒé¡ï¼ˆäº’åŠ©ï¼‰',
    i_output:   'è¼¸å‡ºï¼ˆæˆ‘â†’å°æ–¹ï¼‰',
    benefit_me: 'è£œç›Šï¼ˆå°æ–¹â†’æˆ‘ï¼‰',
    i_control:  'ä¸»æ§ï¼ˆæˆ‘åˆ¶è¡¡ï¼‰',
    control_me: 'å—å£“ï¼ˆå—åˆ¶è¡¡ï¼‰'
  },

  reportLabels: {
  traits: 'ç‰¹è³ª',
  actions: 'è¡Œå‹•',
  outcomes: 'çµæœå‚¾å‘',
  cautions: 'æ³¨æ„',
  timing: 'æ™‚æ©Ÿ',
  confidence: 'å¯ä¿¡åº¦'
},
  
reportTitles: {
  overview: 'å‘½ç›¤ç¸½è¦½',
  five_elements: 'äº”è¡Œèƒ½é‡åˆ†æ',
  ten_gods: 'åç¥é…ç½®åˆ†æ',
  useful_spirit: 'ç”¨ç¥å–œå¿Œ',
  career: 'äº‹æ¥­ç™¼å±•',
  wealth: 'è²¡é‹èµ°å‹¢',
  relationship: 'æ„Ÿæƒ…å©šå§»',
  health: 'å¥åº·é¤Šç”Ÿ',
  spiritual: 'ç„å­¸ç·£åˆ†',
  near_term: 'è¿‘æœŸé‹å‹¢ï¼ˆ3â€“6å€‹æœˆï¼‰'
},
  
  units: { before:'', after:'å€‹' },
  chat: { send:'ç™¼é€', placeholder:'è«‹è¼¸å…¥æ‚¨çš„å•é¡Œ...', toggle:'å•' },
  report: { hourUnknownTip:'âš ï¸ æç¤ºï¼šå› å‡ºç”Ÿæ™‚é–“ä¸è©³ï¼Œéƒ¨åˆ†åˆ†æåƒ…ä¾›åƒè€ƒã€‚', tipTitle:'æç¤º' },
  
  elemJoin: '',
  tenGods: { æ¯”è‚©:'æ¯”è‚©', åŠ«è²¡:'åŠ«è²¡', é£Ÿç¥:'é£Ÿç¥', å‚·å®˜:'å‚·å®˜', åè²¡:'åè²¡', æ­£è²¡:'æ­£è²¡', ä¸ƒæ®º:'ä¸ƒæ®º', æ­£å®˜:'æ­£å®˜', åå°:'åå°', æ­£å°:'æ­£å°' },
  dirMap: { ä¸œ:'æ±', è¥¿:'è¥¿', å—:'å—', åŒ—:'åŒ—', ä¸­:'ä¸­', æ­£ä¸œæ–¹:'æ­£æ±æ–¹', ä¸œå—æ–¹:'æ±å—æ–¹', å—æ–¹:'å—æ–¹', è¥¿æ–¹:'è¥¿æ–¹', åŒ—æ–¹:'åŒ—æ–¹', ä¸­å¤®:'ä¸­å¤®' },
  colorMap: { æœ¨:'ç¶ è‰²ã€é’è‰²', ç«:'ç´…è‰²ã€ç´«è‰²', åœŸ:'é»ƒè‰²ã€æ£•è‰²', é‡‘:'ç™½è‰²ã€é‡‘è‰²', æ°´:'é»‘è‰²ã€è—è‰²' },
  nayinMap: {},

  stemMap: {
    'ç”²':'ç”²', 'ä¹™':'ä¹™', 'ä¸™':'ä¸™', 'ä¸':'ä¸', 'æˆŠ':'æˆŠ', 
    'å·±':'å·±', 'åºš':'åºš', 'è¾›':'è¾›', 'å£¬':'å£¬', 'ç™¸':'ç™¸'
  },
  branchMap: {
    'å­':'å­', 'ä¸‘':'ä¸‘', 'å¯…':'å¯…', 'å¯':'å¯', 'è¾°':'è¾°', 'å·³':'å·³',
    'åˆ':'åˆ', 'æœª':'æœª', 'ç”³':'ç”³', 'é…‰':'é…‰', 'æˆŒ':'æˆŒ', 'äº¥':'äº¥'
  }
},

/* ---- en ---- */
'en': {
  brand: { subtitle: '5xLiving Â· Bazi Brief' },
  nav: { langLabel: 'Language' },
  lang: { 'zh-CN':'ç®€ä½“ä¸­æ–‡','zh-TW':'ç¹é«”ä¸­æ–‡','en':'English','ja':'æ—¥æœ¬èª','th':'à¹„à¸—à¸¢','ms':'Bahasa Melayu' },

  app: { title: 'Bazi Â· Quick Chart' },

  form: {
    nameLabel: 'Name (optional)',
    namePlaceholder: 'Your name (for personalization)',
    genderLabel: 'Gender',
    gender: { hidden:'Prefer not to say', male:'Male', female:'Female' },
    calendarLabel: 'Calendar',
    calendar: { gregorian:'Gregorian', lunar:'Lunar' },
    birthdateLabel: 'Birth Date',
    birthtimeLabel: 'Birth Time',
    timeUnknown: 'Time unknown'
  },

  btn: { generate:'Generate', loading:'Calculating...' },

  result: { title:'Your Bazi Chart' },
  pillar: { year:'Year', month:'Month', day:'Day', hour:'Hour' },
  table: { row: { stem:'Heavenly Stem', branch:'Earthly Branch', fiveElem:'Five Elements', nayin:'Nayin' } },

  energy: { title:'Five-Element Energy Analysis' },
  elem: { wood:'Wood', fire:'Fire', earth:'Earth', metal:'Metal', water:'Water' },

  pro: { title:'ğŸ§™â€â™‚ï¸ Butler Â· Professional Analysis', welcome:'Hi! I\'ve generated your detailed analysis. Ask me anything.' },
  chat: { send:'Send', placeholder:'Type your question...' },

  vip: {
    title:'ğŸŒ™ VIP Segment',
    group: { astrology:'ğŸ— Exclusive Astrology Content', spiritual:'ğŸŒ™ Spiritual Space Exclusives' },
    astrology: { match:'Relationships: love & marriage', career:'Career: workplace & entrepreneurship', wealth:'Wealth: positions & timing', pet:'Pet astrology: personality & bond' },
    spiritual: { record:'Spiritual records: photos, dreams, voice, prayers', courses:'Courses: Bazi / Tarot / Astrology / Numerology', family:'Family memorial system', practice:'Weekly practices / rituals' },
    login: { title:'ğŸ’ Sign in for VIP' },
    services: { header:'Membership' },
    upgrade:'ğŸ’ Upgrade to VIP (Monthly)',
    back:'â† Back to Store',
    priceNote:'$9.9 / month (Astro + Spiritual + Courses)'
  },

  auth: {
    header:'Sign In / Register',
    login:'Sign In',
    reset:'ğŸ”‘ Reset Password',
    register:'Register',
    freeTrialNote:'New accounts get one free trial',
    emailPlaceholder:'Email',
    passwordPlaceholder:'Password (min 8 chars, mixed case & symbols)'
  },

  footer: { copy:'Â© 5XLiving â€¢ Astro Sanctuary' },

  err: {
    fillBirthdate: 'Please enter your birth date',
    invalidDate:   'Invalid date. Use YYYY-MM-DD.',
    generateFail:  'Failed to generate. Please try again later.'
  },
  ui: {
    unknown:      'Unknown',
    timeUnknown:  'time unknown',
    hourSuffix:   '{h}:00',
    birthSummary: 'Birth date: {y}-{m}-{d} {timeText}',
    balance:      'Among the Five Elements, {strongest} is strongest and {weakest} is weakest.'
  },
  badge: { noHour: 'Hour not included' },
  chatDyn:  { autoReply: 'Got it: {q}. Find key points in the relevant sections.' },
  elemNames: { æœ¨:'Wood', ç«:'Fire', åœŸ:'Earth', é‡‘:'Metal', æ°´:'Water' },
  report: { hourUnknownTip: 'âš ï¸ Note: Birth time unknown; parts of the analysis are for reference only.' },

  relations: {
    same:       'Peer (mutual)',
    i_output:   'Output (I â†’ other)',
    benefit_me: 'Support (other â†’ me)',
    i_control:  'Control (I restrain)',
    control_me: 'Challenge (restrains me)'
  },

  reportLabels: {
  traits: 'Traits',
  actions: 'Actions',
  outcomes: 'Outcomes',
  cautions: 'Cautions',
  timing: 'Timing',
  confidence: 'Confidence'
},
  
reportTitles: {
  overview: 'Overview',
  five_elements: 'Five-Element Energy Analysis',
  ten_gods: 'Ten Gods Configuration',
  useful_spirit: 'Useful Spirit',
  career: 'Career Development',
  wealth: 'Wealth Trend',
  relationship: 'Relationships & Marriage',
  health: 'Health & Wellbeing',
  spiritual: 'Spiritual Affinities',
  near_term: 'Near-term Outlook (3â€“6 months)'
},
  
  units: { before:'', after:'Ã—' },
  chat: { send:'Send', placeholder:'Type your question...', toggle:'Ask' },
  report: { hourUnknownTip:'âš ï¸ Note: Birth time unknown; parts of the analysis are for reference only.', tipTitle:'TIP' },
  
  elemJoin: ' - ',
  tenGods: {
    æ¯”è‚©:'Friend', åŠ«è´¢:'Rob Wealth',
    é£Ÿç¥:'Eating God', ä¼¤å®˜:'Hurting Officer',
    åè´¢:'Indirect Wealth', æ­£è´¢:'Direct Wealth',
    ä¸ƒæ€:'Seven Killings', æ­£å®˜:'Direct Officer',
    åå°:'Indirect Resource', æ­£å°:'Direct Resource'
  },
  dirMap: { ä¸œ:'East', è¥¿:'West', å—:'South', åŒ—:'North', ä¸­:'Center', æ­£ä¸œæ–¹:'Due East', ä¸œå—æ–¹:'Southeast', ä¸­å¤®:'Center' },
  colorMap: { æœ¨:'Green, teal', ç«:'Red, purple', åœŸ:'Yellow, brown', é‡‘:'White, gold', æ°´:'Black, blue' },
  nayinMap: {},

  stemMap: {
    'ç”²':'Jia', 'ä¹™':'Yi', 'ä¸™':'Bing', 'ä¸':'Ding', 'æˆŠ':'Wu', 
    'å·±':'Ji', 'åºš':'Geng', 'è¾›':'Xin', 'å£¬':'Ren', 'ç™¸':'Gui'
  },
  branchMap: {
    'å­':'Zi', 'ä¸‘':'Chou', 'å¯…':'Yin', 'å¯':'Mao', 'è¾°':'Chen', 'å·³':'Si',
    'åˆ':'Wu', 'æœª':'Wei', 'ç”³':'Shen', 'é…‰':'You', 'æˆŒ':'Xu', 'äº¥':'Hai'
  }
},

/* ---- ja ---- */
'ja': {
  brand: { subtitle: '5xLiving Â· å…«å­—ç°¡è©•' },
  nav: { langLabel: 'è¨€èª' },
  lang: { 'zh-CN':'ç°¡ä½“ä¸­æ–‡','zh-TW':'ç¹ä½“ä¸­æ–‡','en':'English','ja':'æ—¥æœ¬èª','th':'à¹„à¸—à¸¢','ms':'Bahasa Melayu' },

  app: { title: 'å…«å­—å‘½ç† Â· å¿«é€Ÿæ’ç›¤' },

  form: {
    nameLabel: 'åå‰ï¼ˆä»»æ„ï¼‰',
    namePlaceholder: 'ã‚ãªãŸã®å‘¼ã³åï¼ˆå€‹äººç”¨ï¼‰',
    genderLabel: 'æ€§åˆ¥',
    gender: { hidden:'éå…¬é–‹', male:'ç”·æ€§', female:'å¥³æ€§' },
    calendarLabel: 'æš¦æ³•',
    calendar: { gregorian:'ã‚°ãƒ¬ã‚´ãƒªã‚ªæš¦', lunar:'æ—§æš¦' },
    birthdateLabel: 'ç”Ÿå¹´æœˆæ—¥',
    birthtimeLabel: 'å‡ºç”Ÿæ™‚é–“',
    timeUnknown: 'å‡ºç”Ÿæ™‚é–“ä¸æ˜'
  },

  btn: { generate:'å…«å­—ç”Ÿæˆ', loading:'è¨ˆç®—ä¸­...' },

  result: { title:'ã‚ãªãŸã®ç”Ÿè¾°å…«å­—å‘½ç›¤' },
  pillar: { year:'å¹´æŸ±', month:'æœˆæŸ±', day:'æ—¥æŸ±', hour:'æ™‚æŸ±' },
  table: { row: { stem:'å¤©å¹²', branch:'åœ°æ”¯', fiveElem:'äº”è¡Œ', nayin:'ç´éŸ³' } },

  energy: { title:'äº”è¡Œã‚¨ãƒãƒ«ã‚®ãƒ¼åˆ†æ' },
  elem: { wood:'æœ¨', fire:'ç«', earth:'åœŸ', metal:'é‡‘', water:'æ°´' },

  pro: { title:'ğŸ§™â€â™‚ï¸ å¿ƒæ†ç®¡å®¶ Â· å°‚é–€å‘½ç†åˆ†æ', welcome:'ã“ã‚“ã«ã¡ã¯ï¼å°‚é–€ã®å‘½ç†é¡§å•ã§ã™ã€‚è©³ç´°ãªåˆ†æãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆã—ã¾ã—ãŸã€‚å…·ä½“çš„ãªè³ªå•ãŒã‚ã‚Œã°ã„ã¤ã§ã‚‚ãŠèããã ã•ã„ã€‚' },
  chat: { send:'é€ä¿¡', placeholder:'è³ªå•ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„...' },

  vip: {
    title:'ğŸŒ™ ä¼šå“¡ã‚¨ãƒªã‚¢ VIP Segment',
    group: { astrology:'ğŸ— å‘½ç†ç©ºé–“é™å®šã‚³ãƒ³ãƒ†ãƒ³ãƒ„', spiritual:'ğŸŒ™ å¿ƒæ†ç©ºé–“é™å®šã‚³ãƒ³ãƒ†ãƒ³ãƒ„' },
    astrology: { match:'ç¸è«‡æ–¹å‘ï¼šæ‹æ„›ç¸ã€çµå©šé‹', career:'äº‹æ¥­æ–¹å‘ï¼šè·å ´ç™ºå±•ã€èµ·æ¥­æ½œåœ¨åŠ›', wealth:'è²¡é‹æ–¹å‘ï¼šè²¡ä½åˆ†æã€æŠ•è³‡æ™‚æœŸ', pet:'ãƒšãƒƒãƒˆå‘½ç†ï¼šä¼´ä¾¶å‹•ç‰©ã®æ€§æ ¼ã¨ç¸' },
    spiritual: { record:'ã‚¹ãƒ”ãƒªãƒãƒ¥ã‚¢ãƒ«è¨˜éŒ²ï¼šå†™çœŸã€å¤¢ã€éŸ³å£°ã€é¡˜ã„ç¥ˆã‚Š', courses:'å‘½ç†ã‚³ãƒ¼ã‚¹ï¼šå…«å­— / ã‚¿ãƒ­ãƒƒãƒˆ / å æ˜Ÿè¡“ / æ•°ç§˜è¡“', family:'å®¶æ—è¨˜å¿µã‚·ã‚¹ãƒ†ãƒ ï¼šè¦ªæ—ã‚¹ãƒ”ãƒªãƒãƒ¥ã‚¢ãƒ«è¨˜å¿µ', practice:'é€±æ¬¡ã‚¨ãƒãƒ«ã‚®ãƒ¼ç·´ç¿’ / ç¥äº‹å„€å¼ã‚¿ã‚¹ã‚¯' },
    login: { title:'ğŸ’ VIPæ©Ÿèƒ½ãƒ­ã‚°ã‚¤ãƒ³' },
    services: { header:'ä¼šå“¡ã‚µãƒ¼ãƒ“ã‚¹' },
    upgrade:'ğŸ’ VIPã«ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ï¼ˆæœˆé¡ï¼‰',
    back:'â† å‘½ç†ã‚·ãƒ§ãƒƒãƒ—ã«æˆ»ã‚‹',
    priceNote:'$9.9 / æœˆé¡VIPï¼ˆå‘½ç†ç©ºé–“ + å¿ƒæ†ç©ºé–“ + ã‚¹ãƒ”ãƒªãƒãƒ¥ã‚¢ãƒ«ã‚³ãƒ¼ã‚¹ï¼‰'
  },

  auth: {
    header:'ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ã‚°ã‚¤ãƒ³ / ç™»éŒ²',
    login:'ãƒ­ã‚°ã‚¤ãƒ³',
    reset:'ğŸ”‘ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆ',
    register:'ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç™»éŒ²',
    freeTrialNote:'æ–°è¦ç™»éŒ²ã§ç„¡æ–™ä½“é¨“1å›ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆ',
    emailPlaceholder:'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹',
    passwordPlaceholder:'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆ8æ–‡å­—ä»¥ä¸Šã€å¤§æ–‡å­—å°æ–‡å­—æ•°å­—è¨˜å·ã‚’å«ã‚€ï¼‰'
  },

  footer: { copy:'Â© 5XLiving â€¢ Astro Sanctuary' },

  err: {
    fillBirthdate: 'ç”Ÿå¹´æœˆæ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„',
    invalidDate:   'ç„¡åŠ¹ãªæ—¥ä»˜å½¢å¼ã§ã™ã€‚YYYY-MM-DDå½¢å¼ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚',
    generateFail:  'ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸã€‚å¾Œã»ã©å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚'
  },
  ui: {
    unknown:      'ä¸æ˜',
    timeUnknown:  'æ™‚é–“ä¸æ˜',
    hourSuffix:   '{h}æ™‚',
    birthSummary: 'å‡ºç”Ÿæ—¥: {y}å¹´{m}æœˆ{d}æ—¥ {timeText}',
    balance:      'äº”è¡Œã®ä¸­ã§{strongest}ãŒæœ€ã‚‚å¼·ãã€{weakest}ãŒæœ€ã‚‚å¼±ã„ã€‚'
  },
  badge: { noHour: 'æ™‚æŸ±ã‚’å«ã¾ãªã„' },
  chatDyn:  { autoReply: 'å—ä¿¡ï¼š{q}ã€‚å¾Œã»ã©å°‚é–€ãƒ¬ãƒãƒ¼ãƒˆã®è©²å½“ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§è¦ç‚¹ã‚’ã”ç¢ºèªãã ã•ã„ã€‚' },
  elemNames: { æœ¨:'æœ¨', ç«:'ç«', åœŸ:'åœŸ', é‡‘:'é‡‘', æ°´:'æ°´' },
  report: { hourUnknownTip: 'âš ï¸ æ³¨æ„ï¼šå‡ºç”Ÿæ™‚é–“ä¸æ˜ã®ãŸã‚ã€ä¸€éƒ¨ã®åˆ†æã¯å‚è€ƒæƒ…å ±ã§ã™ã€‚' },

  relations: {
    same:       'åŒé¡ï¼ˆäº’åŠ©ï¼‰',
    i_output:   'å‡ºåŠ›ï¼ˆç§â†’ç›¸æ‰‹ï¼‰',
    benefit_me: 'è£œç›Šï¼ˆç›¸æ‰‹â†’ç§ï¼‰',
    i_control:  'ä¸»æ§ï¼ˆç§åˆ¶è¡¡ï¼‰',
    control_me: 'å—å‹ï¼ˆå—åˆ¶è¡¡ï¼‰'
  },

  reportLabels: {
  traits: 'ç‰¹æ€§',
  actions: 'è¡Œå‹•',
  outcomes: 'çµæœå‚¾å‘',
  cautions: 'æ³¨æ„ç‚¹',
  timing: 'ã‚¿ã‚¤ãƒŸãƒ³ã‚°',
  confidence: 'ä¿¡é ¼åº¦'
},
  
reportTitles: {
  overview: 'å‘½ç›¤ç·è¦§',
  five_elements: 'äº”è¡Œã‚¨ãƒãƒ«ã‚®ãƒ¼åˆ†æ',
  ten_gods: 'åç¥é…ç½®åˆ†æ',
  useful_spirit: 'ç”¨ç¥ãƒ»å¿Œç¥',
  career: 'äº‹æ¥­ç™ºå±•',
  wealth: 'è²¡é‹ã®æ¨ç§»',
  relationship: 'æ‹æ„›ãƒ»çµå©š',
  health: 'å¥åº·ã¨é¤Šç”Ÿ',
  spiritual: 'éœŠæ€§ã®ç¸',
  near_term: 'ç›´è¿‘é‹å‹¢ï¼ˆ3ã€œ6ã‹æœˆï¼‰'
},
  
  units: { before:'', after:'å€‹' },
  chat: { send:'é€ä¿¡', placeholder:'è³ªå•ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„...', toggle:'è³ªå•' },
  report: { hourUnknownTip:'âš ï¸ æ³¨æ„ï¼šå‡ºç”Ÿæ™‚é–“ä¸æ˜ã®ãŸã‚ã€ä¸€éƒ¨ã®åˆ†æã¯å‚è€ƒæƒ…å ±ã§ã™ã€‚', tipTitle:'ãƒ’ãƒ³ãƒˆ' },

  elemJoin: '',
  tenGods: { æ¯”è‚©:'æ¯”è‚©', åŠ«è²¡:'åŠ«è²¡', é£Ÿç¥:'é£Ÿç¥', å‚·å®˜:'å‚·å®˜', åè²¡:'åè²¡', æ­£è²¡:'æ­£è²¡', ä¸ƒæ®º:'ä¸ƒæ®º', æ­£å®˜:'æ­£å®˜', åå°:'åå°', æ­£å°:'æ­£å°' },
  dirMap: { ä¸œ:'æ±', è¥¿:'è¥¿', å—:'å—', åŒ—:'åŒ—', ä¸­:'ä¸­', æ­£ä¸œæ–¹:'çœŸæ±', ä¸œå—æ–¹:'å—æ±', å—æ–¹:'å—', è¥¿æ–¹:'è¥¿', åŒ—æ–¹:'åŒ—', ä¸­å¤®:'ä¸­å¤®' },
  colorMap: { æœ¨:'ç·‘è‰²ã€é’', ç«:'èµ¤è‰²ã€ç´«', åœŸ:'é»„è‰²ã€èŒ¶', é‡‘:'ç™½è‰²ã€é‡‘', æ°´:'é»’è‰²ã€é’' },
  nayinMap: {},

  stemMap: {
    'ç”²':'ç”²', 'ä¹™':'ä¹™', 'ä¸™':'ä¸™', 'ä¸':'ä¸', 'æˆŠ':'æˆŠ', 
    'å·±':'å·±', 'åºš':'åºš', 'è¾›':'è¾›', 'å£¬':'å£¬', 'ç™¸':'ç™¸'
  },
  branchMap: {
    'å­':'å­', 'ä¸‘':'ä¸‘', 'å¯…':'å¯…', 'å¯':'å¯', 'è¾°':'è¾°', 'å·³':'å·³',
    'åˆ':'åˆ', 'æœª':'æœª', 'ç”³':'ç”³', 'é…‰':'é…‰', 'æˆŒ':'æˆŒ', 'äº¥':'äº¥'
  }
},

/* ---- th ---- */
'th': {
  brand: { subtitle: '5xLiving Â· å…«å­—ç°¡è©•' },
  nav: { langLabel: 'à¸ à¸²à¸©à¸²' },
  lang: { 'zh-CN':'à¸ˆà¸µà¸™à¸•à¸±à¸§à¸¢à¹ˆà¸­','zh-TW':'à¸ˆà¸µà¸™à¸•à¸±à¸§à¹€à¸•à¹‡à¸¡','en':'English','ja':'æ—¥æœ¬èª','th':'à¹„à¸—à¸¢','ms':'Bahasa Melayu' },

  app: { title: 'à¹‚à¸«à¸£à¸²à¸¨à¸²à¸ªà¸•à¸£à¹Œå…«å­— Â· à¸ˆà¸±à¸”à¸—à¸³à¸”à¸§à¸‡à¸Šà¸°à¸•à¸²' },

  form: {
    nameLabel: 'à¸Šà¸·à¹ˆà¸­ (à¹„à¸¡à¹ˆà¸ˆà¸³à¹€à¸›à¹‡à¸™)',
    namePlaceholder: 'à¸Šà¸·à¹ˆà¸­à¹€à¸£à¸µà¸¢à¸à¸‚à¸­à¸‡à¸„à¸¸à¸“ (à¸ªà¸³à¸«à¸£à¸±à¸šà¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§)',
    genderLabel: 'à¹€à¸à¸¨',
    gender: { hidden:'à¹„à¸¡à¹ˆà¹€à¸›à¸´à¸”à¹€à¸œà¸¢', male:'à¸Šà¸²à¸¢', female:'à¸«à¸à¸´à¸‡' },
    calendarLabel: 'à¸›à¸à¸´à¸—à¸´à¸™',
    calendar: { gregorian:'à¸ªà¸²à¸à¸¥', lunar:'à¸ˆà¸±à¸™à¸—à¸£à¸„à¸•à¸´' },
    birthdateLabel: 'à¸§à¸±à¸™à¹€à¸à¸´à¸”',
    birthtimeLabel: 'à¹€à¸§à¸¥à¸²à¹€à¸à¸´à¸”',
    timeUnknown: 'à¹€à¸§à¸¥à¸²à¹€à¸à¸´à¸”à¹„à¸¡à¹ˆà¹à¸™à¹ˆà¸Šà¸±à¸”'
  },

  btn: { generate:'à¸ªà¸£à¹‰à¸²à¸‡å…«å­—', loading:'à¸à¸³à¸¥à¸±à¸‡à¸„à¸³à¸™à¸§à¸“...' },

  result: { title:'à¸”à¸§à¸‡à¸Šà¸°à¸•à¸²à¸à¸·à¹‰à¸™à¸à¸²à¸™à¸‚à¸­à¸‡à¸„à¸¸à¸“' },
  pillar: { year:'à¸›à¸µ', month:'à¹€à¸”à¸·à¸­à¸™', day:'à¸§à¸±à¸™', hour:'à¹€à¸§à¸¥à¸²' },
  table: { row: { stem:'à¸ªà¸§à¸£à¸£à¸„à¹Œ', branch:'à¹‚à¸¥à¸', fiveElem:'à¸«à¹‰à¸²à¸˜à¸²à¸•à¸¸', nayin:'à¸™à¹ˆà¸²à¸­à¸´à¹ˆà¸™' } },

  energy: { title:'à¸à¸²à¸£à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œà¸à¸¥à¸±à¸‡à¸‡à¸²à¸™à¸«à¹‰à¸²à¸˜à¸²à¸•à¸¸' },
  elem: { wood:'à¹„à¸¡à¹‰', fire:'à¹„à¸Ÿ', earth:'à¸”à¸´à¸™', metal:'à¸—à¸­à¸‡', water:'à¸™à¹‰à¸³' },

  pro: { title:'ğŸ§™â€â™‚ï¸ à¸œà¸¹à¹‰à¸”à¸¹à¹à¸¥ Â· à¸à¸²à¸£à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œà¸¡à¸·à¸­à¸­à¸²à¸Šà¸µà¸', welcome:'à¸ªà¸§à¸±à¸ªà¸”à¸µ! à¸‰à¸±à¸™à¹€à¸›à¹‡à¸™à¸—à¸µà¹ˆà¸›à¸£à¸¶à¸à¸©à¸²à¹‚à¸«à¸£à¸²à¸¨à¸²à¸ªà¸•à¸£à¹Œà¸¡à¸·à¸­à¸­à¸²à¸Šà¸µà¸à¸‚à¸­à¸‡à¸„à¸¸à¸“ à¹„à¸”à¹‰à¸ªà¸£à¹‰à¸²à¸‡à¸£à¸²à¸¢à¸‡à¸²à¸™à¸à¸²à¸£à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œà¹‚à¸”à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”à¹à¸¥à¹‰à¸§ à¸¡à¸µà¸„à¸³à¸–à¸²à¸¡à¸­à¸°à¹„à¸£à¸à¹‡à¸–à¸²à¸¡à¹„à¸”à¹‰à¸•à¸¥à¸­à¸”à¹€à¸§à¸¥à¸²' },
  chat: { send:'à¸ªà¹ˆà¸‡', placeholder:'à¸à¸´à¸¡à¸à¹Œà¸„à¸³à¸–à¸²à¸¡à¸‚à¸­à¸‡à¸„à¸¸à¸“...' },

  vip: {
    title:'ğŸŒ™ à¸à¸·à¹‰à¸™à¸—à¸µà¹ˆà¸ªà¸¡à¸²à¸Šà¸´à¸ VIP',
    group: { astrology:'ğŸ— à¹€à¸™à¸·à¹‰à¸­à¸«à¸²à¹€à¸‰à¸à¸²à¸°à¹‚à¸«à¸£à¸²à¸¨à¸²à¸ªà¸•à¸£à¹Œ', spiritual:'ğŸŒ™ à¹€à¸™à¸·à¹‰à¸­à¸«à¸²à¹€à¸‰à¸à¸²à¸°à¸ˆà¸´à¸•à¸§à¸´à¸à¸à¸²à¸“' },
    astrology: { match:'à¸—à¸´à¸¨à¸—à¸²à¸‡à¸„à¸§à¸²à¸¡à¸£à¸±à¸: à¹‚à¸Šà¸„à¸Šà¸°à¸•à¸²à¸„à¸§à¸²à¸¡à¸£à¸±à¸ à¸à¸²à¸£à¹à¸•à¹ˆà¸‡à¸‡à¸²à¸™', career:'à¸—à¸´à¸¨à¸—à¸²à¸‡à¸­à¸²à¸Šà¸µà¸: à¸à¸²à¸£à¸à¸±à¸’à¸™à¸²à¸‡à¸²à¸™ à¸¨à¸±à¸à¸¢à¸ à¸²à¸à¸˜à¸¸à¸£à¸à¸´à¸ˆ', wealth:'à¸—à¸´à¸¨à¸—à¸²à¸‡à¸à¸²à¸£à¹€à¸‡à¸´à¸™: à¸à¸²à¸£à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œà¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¹€à¸‡à¸´à¸™ à¹€à¸§à¸¥à¸²à¸¥à¸‡à¸—à¸¸à¸™', pet:'à¹‚à¸«à¸£à¸²à¸¨à¸²à¸ªà¸•à¸£à¹Œà¸ªà¸±à¸•à¸§à¹Œà¹€à¸¥à¸µà¹‰à¸¢à¸‡: à¸šà¸¸à¸„à¸¥à¸´à¸à¹à¸¥à¸°à¹‚à¸Šà¸„à¸Šà¸°à¸•à¸²' },
    spiritual: { record:'à¸šà¸±à¸™à¸—à¸¶à¸à¸ˆà¸´à¸•à¸§à¸´à¸à¸à¸²à¸“: à¸£à¸¹à¸›à¸ à¸²à¸ à¸„à¸§à¸²à¸¡à¸à¸±à¸™ à¹€à¸ªà¸µà¸¢à¸‡ à¸à¸²à¸£à¸­à¸˜à¸´à¸©à¸à¸²à¸™', courses:'à¸„à¸­à¸£à¹Œà¸ªà¹‚à¸«à¸£à¸²à¸¨à¸²à¸ªà¸•à¸£à¹Œ:å…«å­— / à¸—à¸²à¹‚à¸£à¸•à¹Œ / à¸”à¸²à¸£à¸²à¸¨à¸²à¸ªà¸•à¸£à¹Œ / à¹€à¸¥à¸‚à¸¨à¸²à¸ªà¸•à¸£à¹Œ', family:'à¸£à¸°à¸šà¸šà¸„à¸§à¸²à¸¡à¸—à¸£à¸‡à¸ˆà¸³à¸„à¸£à¸­à¸šà¸„à¸£à¸±à¸§: à¸à¸²à¸£à¸£à¸³à¸¥à¸¶à¸à¸–à¸¶à¸‡à¸ˆà¸´à¸•à¸§à¸´à¸à¸à¸²à¸“à¸„à¸™à¹ƒà¸™à¸„à¸£à¸­à¸šà¸„à¸£à¸±à¸§', practice:'à¹à¸šà¸šà¸à¸¶à¸à¸«à¸±à¸”à¸à¸¥à¸±à¸‡à¸‡à¸²à¸™à¸£à¸²à¸¢à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œ / à¸ à¸²à¸£à¸à¸´à¸ˆà¸à¸´à¸˜à¸µà¸à¸£à¸£à¸¡' },
    login: { title:'ğŸ’ à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š VIP' },
    services: { header:'à¸šà¸£à¸´à¸à¸²à¸£à¸ªà¸¡à¸²à¸Šà¸´à¸' },
    upgrade:'ğŸ’ à¸­à¸±à¸›à¹€à¸à¸£à¸”à¹€à¸›à¹‡à¸™ VIP (à¸£à¸²à¸¢à¹€à¸”à¸·à¸­à¸™)',
    back:'â† à¸à¸¥à¸±à¸šà¸ªà¸¹à¹ˆà¸£à¹‰à¸²à¸™à¸„à¹‰à¸²',
    priceNote:'$9.9 / VIP à¸£à¸²à¸¢à¹€à¸”à¸·à¸­à¸™ (à¹‚à¸«à¸£à¸²à¸¨à¸²à¸ªà¸•à¸£à¹Œ + à¸ˆà¸´à¸•à¸§à¸´à¸à¸à¸²à¸“ + à¸„à¸­à¸£à¹Œà¸ª)'
  },

  auth: {
    header:'à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š / à¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™',
    login:'à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š',
    reset:'ğŸ”‘ à¸£à¸µà¹€à¸‹à¹‡à¸•à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™',
    register:'à¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™',
    freeTrialNote:'à¸šà¸±à¸à¸Šà¸µà¹ƒà¸«à¸¡à¹ˆà¹„à¸”à¹‰à¸£à¸±à¸šà¸—à¸”à¸¥à¸­à¸‡à¸Ÿà¸£à¸µ 1 à¸„à¸£à¸±à¹‰à¸‡',
    emailPlaceholder:'à¸­à¸µà¹€à¸¡à¸¥',
    passwordPlaceholder:'à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™ (à¸‚à¸±à¹‰à¸™à¸•à¹ˆà¸³ 8 à¸•à¸±à¸§à¸­à¸±à¸à¸©à¸£ à¸•à¸±à¸§à¸à¸´à¸¡à¸à¹Œà¹ƒà¸«à¸à¹ˆ-à¹€à¸¥à¹‡à¸ à¹à¸¥à¸°à¸ªà¸±à¸à¸¥à¸±à¸à¸©à¸“à¹Œ)'
  },

  footer: { copy:'Â© 5XLiving â€¢ Astro Sanctuary' },

  err: {
    fillBirthdate: 'à¸à¸£à¸¸à¸“à¸²à¸à¸£à¸­à¸à¸§à¸±à¸™à¹€à¸à¸´à¸”',
    invalidDate:   'à¸£à¸¹à¸›à¹à¸šà¸šà¸§à¸±à¸™à¸—à¸µà¹ˆà¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡ à¹ƒà¸Šà¹‰ YYYY-MM-DD',
    generateFail:  'à¸ªà¸£à¹‰à¸²à¸‡à¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§ à¸à¸£à¸¸à¸“à¸²à¸¥à¸­à¸‡à¹ƒà¸«à¸¡à¹ˆà¹ƒà¸™à¸ à¸²à¸¢à¸«à¸¥à¸±à¸‡'
  },
  ui: {
    unknown:      'à¹„à¸¡à¹ˆà¸—à¸£à¸²à¸š',
    timeUnknown:  'à¹€à¸§à¸¥à¸²à¹„à¸¡à¹ˆà¸—à¸£à¸²à¸š',
    hourSuffix:   '{h}:00',
    birthSummary: 'à¸§à¸±à¸™à¹€à¸à¸´à¸”: {y}-{m}-{d} {timeText}',
    balance:      'à¹ƒà¸™à¸«à¹‰à¸²à¸˜à¸²à¸•à¸¸ {strongest} à¹à¸‚à¹‡à¸‡à¹à¸£à¸‡à¸—à¸µà¹ˆà¸ªà¸¸à¸” à¹à¸¥à¸° {weakest} à¸­à¹ˆà¸­à¸™à¹à¸­à¸—à¸µà¹ˆà¸ªà¸¸à¸”'
  },
  badge: { noHour: 'à¹„à¸¡à¹ˆà¸£à¸§à¸¡à¸Šà¸±à¹ˆà¸§à¹‚à¸¡à¸‡' },
  chatDyn:  { autoReply: 'à¹„à¸”à¹‰à¸£à¸±à¸š: {q} à¸„à¹‰à¸™à¸«à¸²à¸ˆà¸¸à¸”à¸ªà¸³à¸„à¸±à¸à¹ƒà¸™à¸ªà¹ˆà¸§à¸™à¸—à¸µà¹ˆà¹€à¸à¸µà¹ˆà¸¢à¸§à¸‚à¹‰à¸­à¸‡' },
  elemNames: { æœ¨:'à¹„à¸¡à¹‰', ç«:'à¹„à¸Ÿ', åœŸ:'à¸”à¸´à¸™', é‡‘:'à¸—à¸­à¸‡', æ°´:'à¸™à¹‰à¸³' },
  report: { hourUnknownTip: 'âš ï¸ à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸: à¹€à¸§à¸¥à¸²à¹€à¸à¸´à¸”à¹„à¸¡à¹ˆà¸—à¸£à¸²à¸š; à¸šà¸²à¸‡à¸ªà¹ˆà¸§à¸™à¸‚à¸­à¸‡à¸à¸²à¸£à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œà¹€à¸›à¹‡à¸™à¹€à¸à¸µà¸¢à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸­à¹‰à¸²à¸‡à¸­à¸´à¸‡' },

  relations: {
    same:       'à¸›à¸£à¸°à¹€à¸ à¸—à¹€à¸”à¸µà¸¢à¸§à¸à¸±à¸™ (à¸Šà¹ˆà¸§à¸¢à¹€à¸«à¸¥à¸·à¸­à¸‹à¸¶à¹ˆà¸‡à¸à¸±à¸™à¹à¸¥à¸°à¸à¸±à¸™)',
    i_output:   'à¸ªà¹ˆà¸‡à¸­à¸­à¸ (à¸‰à¸±à¸™ â†’ à¸­à¸·à¹ˆà¸™)',
    benefit_me: 'à¸ªà¸™à¸±à¸šà¸ªà¸™à¸¸à¸™ (à¸­à¸·à¹ˆà¸™ â†’ à¸‰à¸±à¸™)',
    i_control:  'à¸„à¸§à¸šà¸„à¸¸à¸¡ (à¸‰à¸±à¸™à¸„à¸§à¸šà¸„à¸¸à¸¡)',
    control_me: 'à¸—à¹‰à¸²à¸—à¸²à¸¢ (à¸„à¸§à¸šà¸„à¸¸à¸¡à¸‰à¸±à¸™)'
  },

  reportLabels: {
  traits: 'à¸¥à¸±à¸à¸©à¸“à¸°à¹€à¸”à¹ˆà¸™',
  actions: 'à¸à¸²à¸£à¸¥à¸‡à¸¡à¸·à¸­à¸—à¸³',
  outcomes: 'à¹à¸™à¸§à¹‚à¸™à¹‰à¸¡à¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œ',
  cautions: 'à¸‚à¹‰à¸­à¸„à¸§à¸£à¸£à¸°à¸§à¸±à¸‡',
  timing: 'à¸ˆà¸±à¸‡à¸«à¸§à¸°à¹€à¸§à¸¥à¸²',
  confidence: 'à¸„à¸§à¸²à¸¡à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸±à¹ˆà¸™'
},
  
reportTitles: {
  overview: 'à¸ à¸²à¸à¸£à¸§à¸¡à¸”à¸§à¸‡à¸Šà¸°à¸•à¸²',
  five_elements: 'à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œà¸à¸¥à¸±à¸‡à¸˜à¸²à¸•à¸¸à¸—à¸±à¹‰à¸‡à¸«à¹‰à¸²',
  ten_gods: 'à¸à¸²à¸£à¸ˆà¸±à¸”à¸§à¸²à¸‡à¸ªà¸´à¸šà¹€à¸—à¸',
  useful_spirit: 'à¹€à¸—à¸à¸—à¸µà¹ˆà¹€à¸à¸·à¹‰à¸­à¸«à¸™à¸¸à¸™ (Useful Spirit)',
  career: 'à¸à¸²à¸£à¸à¸±à¸’à¸™à¸²à¸­à¸²à¸Šà¸µà¸',
  wealth: 'à¹à¸™à¸§à¹‚à¸™à¹‰à¸¡à¸à¸²à¸£à¹€à¸‡à¸´à¸™',
  relationship: 'à¸„à¸§à¸²à¸¡à¸£à¸±à¸à¹à¸¥à¸°à¸à¸²à¸£à¹à¸•à¹ˆà¸‡à¸‡à¸²à¸™',
  health: 'à¸ªà¸¸à¸‚à¸ à¸²à¸à¹à¸¥à¸°à¸à¸²à¸£à¸”à¸¹à¹à¸¥à¸•à¸™à¹€à¸­à¸‡',
  spiritual: 'à¸ªà¸²à¸¢à¸ªà¸±à¸¡à¸à¸±à¸™à¸˜à¹Œà¸—à¸²à¸‡à¸ˆà¸´à¸•à¸§à¸´à¸à¸à¸²à¸“',
  near_term: 'à¹à¸™à¸§à¹‚à¸™à¹‰à¸¡à¸£à¸°à¸¢à¸°à¸ªà¸±à¹‰à¸™ (3â€“6 à¹€à¸”à¸·à¸­à¸™)'
},
  
  units: { before:'', after:'Ã—' },
  chat: { send:'à¸ªà¹ˆà¸‡', placeholder:'à¸à¸´à¸¡à¸à¹Œà¸„à¸³à¸–à¸²à¸¡à¸‚à¸­à¸‡à¸„à¸¸à¸“...', toggle:'à¸–à¸²à¸¡' },
  report: { hourUnknownTip:'âš ï¸ à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸: à¹€à¸§à¸¥à¸²à¹€à¸à¸´à¸”à¹„à¸¡à¹ˆà¸—à¸£à¸²à¸š; à¸šà¸²à¸‡à¸ªà¹ˆà¸§à¸™à¸‚à¸­à¸‡à¸à¸²à¸£à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œà¹€à¸›à¹‡à¸™à¹€à¸à¸µà¸¢à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸­à¹‰à¸²à¸‡à¸­à¸´à¸‡', tipTitle:'à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸' },

  elemJoin: ' - ',
  tenGods: {
    æ¯”è‚©:'à¹€à¸à¸·à¹ˆà¸­à¸™', åŠ«è´¢:'à¸£à¸´à¸„à¸§à¸²à¸¡à¸¡à¸±à¹ˆà¸‡à¸„à¸±à¹ˆà¸‡',
    é£Ÿç¥:'à¹€à¸—à¸à¹€à¸ˆà¹‰à¸²à¹à¸«à¹ˆà¸‡à¸à¸²à¸£à¸à¸´à¸™', ä¼¤å®˜:'à¹€à¸ˆà¹‰à¸²à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆà¸—à¸µà¹ˆà¸šà¸²à¸”à¹€à¸ˆà¹‡à¸š',
    åè´¢:'à¸„à¸§à¸²à¸¡à¸¡à¸±à¹ˆà¸‡à¸„à¸±à¹ˆà¸‡à¸—à¸²à¸‡à¸­à¹‰à¸­à¸¡', æ­£è´¢:'à¸„à¸§à¸²à¸¡à¸¡à¸±à¹ˆà¸‡à¸„à¸±à¹ˆà¸‡à¹‚à¸”à¸¢à¸•à¸£à¸‡',
    ä¸ƒæ€:'à¹€à¸ˆà¹‡à¸”à¸à¸²à¸£à¸†à¹ˆà¸²', æ­£å®˜:'à¹€à¸ˆà¹‰à¸²à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆà¹‚à¸”à¸¢à¸•à¸£à¸‡',
    åå°:'à¸—à¸£à¸±à¸à¸¢à¸²à¸à¸£à¸—à¸²à¸‡à¸­à¹‰à¸­à¸¡', æ­£å°:'à¸—à¸£à¸±à¸à¸¢à¸²à¸à¸£à¹‚à¸”à¸¢à¸•à¸£à¸‡'
  },
  dirMap: { ä¸œ:'à¸•à¸°à¸§à¸±à¸™à¸­à¸­à¸', è¥¿:'à¸•à¸°à¸§à¸±à¸™à¸•à¸', å—:'à¹ƒà¸•à¹‰', åŒ—:'à¹€à¸«à¸™à¸·à¸­', ä¸­:'à¸à¸¥à¸²à¸‡', æ­£ä¸œæ–¹:'à¸•à¸°à¸§à¸±à¸™à¸­à¸­à¸à¹‚à¸”à¸¢à¸•à¸£à¸‡', ä¸œå—æ–¹:'à¸•à¸°à¸§à¸±à¸™à¸­à¸­à¸à¹€à¸‰à¸µà¸¢à¸‡à¹ƒà¸•à¹‰', ä¸­å¤®:'à¸à¸¥à¸²à¸‡' },
  colorMap: { æœ¨:'à¹€à¸‚à¸µà¸¢à¸§, à¸™à¹‰à¸³à¹€à¸‡à¸´à¸™à¹€à¸‚à¸µà¸¢à¸§', ç«:'à¹à¸”à¸‡, à¸¡à¹ˆà¸§à¸‡', åœŸ:'à¹€à¸«à¸¥à¸·à¸­à¸‡, à¸™à¹‰à¸³à¸•à¸²à¸¥', é‡‘:'à¸‚à¸²à¸§, à¸—à¸­à¸‡', æ°´:'à¸”à¸³, à¸™à¹‰à¸³à¹€à¸‡à¸´à¸™' },
  nayinMap: {},

  stemMap: {
    'ç”²':'Jia', 'ä¹™':'Yi', 'ä¸™':'Bing', 'ä¸':'Ding', 'æˆŠ':'Wu', 
    'å·±':'Ji', 'åºš':'Geng', 'è¾›':'Xin', 'å£¬':'Ren', 'ç™¸':'Gui'
  },
  branchMap: {
    'å­':'Zi', 'ä¸‘':'Chou', 'å¯…':'Yin', 'å¯':'Mao', 'è¾°':'Chen', 'å·³':'Si',
    'åˆ':'Wu', 'æœª':'Wei', 'ç”³':'Shen', 'é…‰':'You', 'æˆŒ':'Xu', 'äº¥':'Hai'
  }
},

/* ---- ms ---- */
'ms': {
  brand: { subtitle: '5xLiving Â· Ringkas Bazi' },
  nav: { langLabel: 'Bahasa' },
  lang: { 'zh-CN':'Cina Ringkas','zh-TW':'Cina Tradisional','en':'English','ja':'æ—¥æœ¬èª','th':'à¹„à¸—à¸¢','ms':'Bahasa Melayu' },

  app: { title: 'Bazi Â· Carta Pantas' },

  form: {
    nameLabel: 'Nama (pilihan)',
    namePlaceholder: 'Nama anda (untuk peribadi)',
    genderLabel: 'Jantina',
    gender: { hidden:'Tidak mahu nyatakan', male:'Lelaki', female:'Perempuan' },
    calendarLabel: 'Kalendar',
    calendar: { gregorian:'Gregorian', lunar:'Qamari' },
    birthdateLabel: 'Tarikh Lahir',
    birthtimeLabel: 'Masa Lahir',
    timeUnknown: 'Masa tidak pasti'
  },

  btn: { generate:'Jana', loading:'Mengira...' },

  result: { title:'Carta Bazi Anda' },
  pillar: { year:'Tahun', month:'Bulan', day:'Hari', hour:'Jam' },
  table: { row: { stem:'Batang Langit', branch:'Cawangan Bumi', fiveElem:'Lima Unsur', nayin:'Nayin' } },

  energy: { title:'Analisis Tenaga Lima Unsur' },
  elem: { wood:'Kayu', fire:'Api', earth:'Tanah', metal:'Logam', water:'Air' },

  pro: { title:'ğŸ§™â€â™‚ï¸ Butler Â· Analisis Profesional', welcome:'Hai! Laporan terperinci telah dijana. Tanya apa sahaja.' },
  chat: { send:'Hantar', placeholder:'Taip soalan anda...' },

  vip: {
    title:'ğŸŒ™ Segmen VIP',
    group: { astrology:'ğŸ— Kandungan Astrologi Eksklusif', spiritual:'ğŸŒ™ Eksklusif Ruang Spiritual' },
    astrology: { match:'Hubungan: cinta & perkahwinan', career:'Kerjaya: tempat kerja & niaga', wealth:'Rezeki: posisi & masa', pet:'Astrologi haiwan peliharaan' },
    spiritual: { record:'Rekod rohani: foto, mimpi, suara, doa', courses:'Kursus: Bazi / Tarot / Astrologi / Numerologi', family:'Sistem memorial keluarga', practice:'Amalan mingguan / ritual' },
    login: { title:'ğŸ’ Log masuk untuk VIP' },
    services: { header:'Keahlian' },
    upgrade:'ğŸ’ Naik taraf VIP (Bulanan)',
    back:'â† Kembali ke Kedai',
    priceNote:'$9.9 / bulan (Astro + Spiritual + Kursus)'
  },

  auth: {
    header:'Log Masuk / Daftar',
    login:'Log Masuk',
    reset:'ğŸ”‘ Tetap Semula Kata Laluan',
    register:'Daftar',
    freeTrialNote:'Akaun baharu dapat satu percubaan percuma',
    emailPlaceholder:'Emel',
    passwordPlaceholder:'Kata laluan (min 8 aksara, huruf besar/kecil & simbol)'
  },

  footer: { copy:'Â© 5XLiving â€¢ Astro Sanctuary' },

  err: {
    fillBirthdate: 'Sila isi tarikh lahir',
    invalidDate:   'Tarikh tidak sah. Guna YYYY-MM-DD.',
    generateFail:  'Gagal menjana. Cuba lagi nanti.'
  },
  ui: {
    unknown:      'Tidak diketahui',
    timeUnknown:  'masa tidak pasti',
    hourSuffix:   '{h}:00',
    birthSummary: 'Tarikh lahir: {y}-{m}-{d} {timeText}',
    balance:      'Antara Lima Unsur, {strongest} paling kuat dan {weakest} paling lemah.'
  },
  badge: { noHour: 'Jam tidak diambil kira' },
  chatDyn:  { autoReply: 'Diterima: {q}. Poin penting ada di seksyen berkaitan.' },
  elemNames: { æœ¨:'Kayu', ç«:'Api', åœŸ:'Tanah', é‡‘:'Logam', æ°´:'Air' },
  report: { hourUnknownTip: 'âš ï¸ Nota: Masa lahir tidak pasti; sebahagian analisis untuk rujukan.' },

  relations: {
    same:       'Sejenis (saling sokong)',
    i_output:   'Keluaran (saya â†’ pihak lain)',
    benefit_me: 'Sokongan (pihak lain â†’ saya)',
    i_control:  'Mengawal (saya menahan)',
    control_me: 'Dikawal (menahan saya)'
  },

  reportLabels: {
  traits: 'Ciri',
  actions: 'Tindakan',
  outcomes: 'Hasil yang Cenderung',
  cautions: 'Perhatian',
  timing: 'Masa',
  confidence: 'Keyakinan'
},
  
reportTitles: {
  overview: 'Gambaran Umum',
  five_elements: 'Analisis Lima Unsur',
  ten_gods: 'Konfigurasi Sepuluh Dewa',
  useful_spirit: 'Roh Berguna (Useful Spirit)',
  career: 'Pembangunan Kerjaya',
  wealth: 'Trend Kewangan',
  relationship: 'Hubungan & Perkahwinan',
  health: 'Kesihatan & Penjagaan Diri',
  spiritual: 'Jalinan Rohani',
  near_term: 'Tinjauan Jangka Dekat (3â€“6 bulan)'
},
  
  units: { before:'', after:'Ã—' },
  chat: { send:'Hantar', placeholder:'Taip soalan anda...', toggle:'Tanya' },
  report: { hourUnknownTip:'âš ï¸ Nota: Masa lahir tidak pasti; sebahagian analisis untuk rujukan.', tipTitle:'Nota' },

  elemJoin: ' - ',
  tenGods: {
    æ¯”è‚©:'Rakan', åŠ«è´¢:'Rampas Rezeki',
    é£Ÿç¥:'Dewa Makan', ä¼¤å®˜:'Pegawai Terluka',
    åè´¢:'Rezeki Tidak Langsung', æ­£è´¢:'Rezeki Langsung',
    ä¸ƒæ€:'Tujuh Pembunuh', æ­£å®˜:'Pegawai',
    åå°:'Sumber Tidak Langsung', æ­£å°:'Sumber Langsung'
  },
  dirMap: { ä¸œ:'Timur', è¥¿:'Barat', å—:'Selatan', åŒ—:'Utara', ä¸­:'Tengah', æ­£ä¸œæ–¹:'Timur tepat', ä¸œå—æ–¹:'Tenggara', ä¸­å¤®:'Tengah' },
  colorMap: { æœ¨:'Hijau, teal', ç«:'Merah, ungu', åœŸ:'Kuning, coklat', é‡‘:'Putih, emas', æ°´:'Hitam, biru' },
  nayinMap: {},

  stemMap: {
    'ç”²':'Jia', 'ä¹™':'Yi', 'ä¸™':'Bing', 'ä¸':'Ding', 'æˆŠ':'Wu', 
    'å·±':'Ji', 'åºš':'Geng', 'è¾›':'Xin', 'å£¬':'Ren', 'ç™¸':'Gui'
  },
  branchMap: {
    'å­':'Zi', 'ä¸‘':'Chou', 'å¯…':'Yin', 'å¯':'Mao', 'è¾°':'Chen', 'å·³':'Si',
    'åˆ':'Wu', 'æœª':'Wei', 'ç”³':'Shen', 'é…‰':'You', 'æˆŒ':'Xu', 'äº¥':'Hai'
  }
}
}; // END I18N

  /* ===== i18n helpers & now defaults ===== */
const LANG_ALIAS = {
  'zh': 'zh-CN', 'zh-HK': 'zh-TW', 'zh-MO': 'zh-TW', 'zh-SG':'zh-CN',
  'en-US':'en', 'en-GB':'en',
  'ja-JP':'ja',
  'th-TH':'th',
  'ms-MY':'ms'
};

function dictFor(lang){
  if (I18N[lang]) return I18N[lang];
  if (LANG_ALIAS[lang]) return I18N[LANG_ALIAS[lang]];
  return I18N['en'];
}
function normLang(lang){
  if (I18N[lang]) return lang;
  if (LANG_ALIAS[lang]) return LANG_ALIAS[lang];
  return 'en';
}

function pad(n){ return String(n).padStart(2,'0'); }
const $ = id => document.getElementById(id);

function setNowDefaults(){
  const now = new Date();
  const yyyy = now.getFullYear();
  const mm = pad(now.getMonth()+1);
  const dd = pad(now.getDate());
  const hh = pad(now.getHours());
  const mi = pad(now.getMinutes());
  const d = $('birthdate'), t = $('birthtime');

  if (d && !d.value) d.value = `${yyyy}-${mm}-${dd}`;
  if (t && !t.value) t.value = `${hh}:${mi}`;

  // optional: show current time
  function updateNowBox(){
    const el = $('nowBox'); if (!el) return;
    const loc = normLang(localStorage.getItem('5x_lang') || 'zh-CN');
    try{ el.textContent = new Date().toLocaleString(loc); }
    catch{ el.textContent = new Date().toLocaleString(); }
  }
  updateNowBox();
  setInterval(updateNowBox, 60*1000);
}

/* =========================
 * UTILS
 * ========================= */
const KEYS = ['year','month','day','hour'];

const state = {
  lang: localStorage.getItem('5x_lang') || 'zh-CN'
};

function get(obj, path){
  return path.split('.').reduce((o,k)=> (o && o[k]!=null) ? o[k] : undefined, obj);
}
function t(key){
  const dict = dictFor(state.lang);
  const val = get(dict, key);
  return (typeof val === 'string') ? val : '';
}

function scrubSensitiveEcho(){
  // never echo creds; also stop browser autofill echoing them
  const email = document.getElementById('email');
  const pw    = document.getElementById('password');
  if (email){ email.value=''; email.autocomplete='email'; }
  if (pw){ pw.value=''; pw.autocomplete='new-password'; }
}
  
function applyI18n(){
  const dict = dictFor(state.lang);
  const htmlLang = normLang(state.lang);
  document.documentElement.lang = htmlLang;

  // data-i18n text
  document.querySelectorAll('[data-i18n]').forEach(el=>{
    const key = el.getAttribute('data-i18n');
    const val = get(dict, key);
    if (typeof val === 'string' && val) el.textContent = val;
  });

  // options
  document.querySelectorAll('option[data-i18n]').forEach(opt=>{
    const key = opt.getAttribute('data-i18n');
    const val = get(dict, key);
    if (typeof val === 'string' && val) opt.textContent = val;
  });

  const ph = {
    name:    get(dict,'form.namePlaceholder'),
    email:   get(dict,'auth.emailPlaceholder'),
    password:get(dict,'auth.passwordPlaceholder'),
    chat:    get(dict,'chat.placeholder')
  };
  if ($('name')     && ph.name)     $('name').placeholder     = ph.name;
  if ($('email')    && ph.email)    $('email').placeholder    = ph.email;
  if ($('password') && ph.password) $('password').placeholder = ph.password;
  if ($('chatInput')&& ph.chat)     $('chatInput').placeholder= ph.chat;

  const langSelect = $('langSelect');
  if (langSelect) langSelect.value = state.lang;

  scrubSensitiveEcho();
}

function showErr(msg){
  const box = $('error');
  if (!box) return;
  box.textContent = msg || t('err.generateFail') || 'Error';
  box.style.display = 'block';
  setTimeout(()=>{ box.style.display='none'; }, 4000);
}

function setGenLoading(v){
  const btn = $('genBtn'), txt = $('genBtnText'), ld = $('genBtnLoading');
  if (!btn) return;
  btn.disabled = !!v;
  if (txt) txt.style.display = v ? 'none' : 'inline';
  if (ld)  ld.style.display  = v ? 'inline' : 'none';
}

/* ===== Source badge ===== */
function setSourceBadge(fromAPI){
  const el = $('originBadge'); if (!el) return;
  const zh = state.lang.startsWith('zh');
  el.style.display = 'inline-flex';
  el.dataset.src = fromAPI ? 'api' : 'local';
  el.textContent = fromAPI
    ? (zh ? 'æ¥æºï¼šAIï¼ˆAPIï¼‰' : 'Source: AI (API)')
    : (zh ? 'æ¥æºï¼šæœ¬åœ°è®¡ç®—' : 'Source: Local calc');
}

/* =========================
 * RENDERERS
 * ========================= */
function renderPillars(labels){
  const dict = dictFor(state.lang);
  const stemMap = get(dict, 'stemMap') || {};
  const branchMap = get(dict, 'branchMap') || {};
  
  const translatedLabels = labels.map(label => {
    if (label && label.length === 2) {
      const stem = stemMap[label[0]] || label[0];
      const branch = branchMap[label[1]] || label[1];
      const separator = state.lang.startsWith('zh') ? '' : ' ';
      return stem + separator + branch;
    }
    return label || '-';
  });

  const mapKey = ['pillar.year','pillar.month','pillar.day','pillar.hour'];
  const html = mapKey.map((key,i)=>`
    <div class="pillar">
      <div class="tit">${t(key)}</div>
      <div class="gz">${translatedLabels[i] || '-'}</div>
    </div>
  `).join('');
  const box = $('bazi-pillars');
  if (box) box.innerHTML = html;
}

function renderTable(data){
  const dict = dictFor(state.lang);
  const stemMap = get(dict, 'stemMap') || {};
  const branchMap = get(dict, 'branchMap') || {};
  const elemNames = get(dict, 'elemNames') || {};
  
  const keys = ['stem','branch','element','nayin'];
  KEYS.forEach((k,i)=>{
    keys.forEach(row=>{
      const cell = document.getElementById(`${k}-${row}`);
      if (cell) {
        let value = (data[row] && data[row][i]) ? data[row][i] : '-';
        if (row === 'stem' && value !== '-') {
          value = stemMap[value] || value;
        } else if (row === 'branch' && value !== '-') {
          value = branchMap[value] || value;
        } else if (row === 'element' && value !== '-') {
          value = elemNames[value] || value;
        }
        cell.textContent = value;
      }
    });
  });
}

function renderBars(pcts){
  const elems = ['æœ¨','ç«','åœŸ','é‡‘','æ°´'];
  elems.forEach(e=>{
    const pct = Math.max(0, Math.min(100, Math.round(pcts[e] || 0)));
    const bar = $('bar-'+e);
    const lab = $('pct-'+e);
    if (bar) bar.style.width = pct + '%';
    if (lab) lab.textContent = pct + '%';
  });
  const sorted = Object.entries(pcts).sort((a,b)=> b[1]-a[1]);
  const strongest = sorted[0]?.[0];
  const weakest   = sorted[sorted.length-1]?.[0];
  const tip = $('bazi-elements-balance');
  const dict = I18N[state.lang] || I18N['zh-CN'];
  const names = get(dict,'elemNames') || {};
  if (tip && strongest && weakest){
    tip.textContent = (t('ui.balance') || '')
      .replace('{strongest}', names[strongest] || strongest)
      .replace('{weakest}',   names[weakest]   || weakest);
  }
}

function showResultContainers(){
  if ($('result')) $('result').style.display = 'block';
  if ($('butlerProfessional')){
    $('butlerProfessional').style.display = 'block';
  }
}

/* ===== Float chat (single implementation) ===== */
function initFloatChat() {
  const toggleBtn   = $('chatToggle');
  const floatWindow = $('chatFloat');
  const closeBtn    = $('chatClose');
  const sendBtn     = $('chatSend');
  const input       = $('chatInput');
  const messages    = $('chatMessages');
  if (!toggleBtn || !floatWindow) return;

  const show = v => { floatWindow.style.display = v ? 'flex' : 'none'; };
  toggleBtn.addEventListener('click', () => show(floatWindow.style.display !== 'flex'));
  if (closeBtn) closeBtn.addEventListener('click', () => show(false));

  function appendMsg(text, mine=false){
    const div = document.createElement('div');
    div.className = 'ss-msg';
    div.textContent = text;
    div.style.background = mine ? 'rgba(212,175,55,0.1)' : 'rgba(255,255,255,0.05)';
    if (mine) { div.style.marginLeft = 'auto'; div.style.marginRight = '0'; }
    div.style.maxWidth = '80%';
    div.style.padding = '8px 12px';
    div.style.borderRadius = '10px';
    div.style.margin = '6px 0';
    messages.appendChild(div);
    messages.scrollTop = messages.scrollHeight;
  }
  function sendMessage() {
    const q = (input?.value || '').trim();
    if (!q) return;
    appendMsg(q, true);
    if (input) input.value = '';
    setTimeout(() => {
      const auto = (t('chatDyn.autoReply') || 'æ”¶åˆ°ï¼š{q}ã€‚').replace('{q}', q);
      appendMsg(auto, false);
    }, 300);
  }
  if (sendBtn) sendBtn.addEventListener('click', sendMessage);
  if (input)   input.addEventListener('keypress', e => { if (e.key === 'Enter') sendMessage(); });

  // Drag
  let isDragging = false;
  const dragOffset = { x: 0, y: 0 };
  const header = floatWindow.querySelector('.chat-float-header');
  function startDrag(e){
    isDragging = true;
    const rect = floatWindow.getBoundingClientRect();
    dragOffset.x = e.clientX - rect.left;
    dragOffset.y = e.clientY - rect.top;
    floatWindow.style.cursor = 'grabbing';
  }
  function drag(e){
    if (!isDragging) return;
    floatWindow.style.left   = (e.clientX - dragOffset.x) + 'px';
    floatWindow.style.top    = (e.clientY - dragOffset.y) + 'px';
    floatWindow.style.right  = 'auto';
    floatWindow.style.bottom = 'auto';
  }
  function stopDrag(){
    isDragging = false;
    floatWindow.style.cursor = 'default';
  }
  if (header){
    header.addEventListener('mousedown', startDrag);
    document.addEventListener('mousemove', drag);
    document.addEventListener('mouseup',   stopDrag);
  }
}

/* =========================
 * DATA SHAPES & ADAPTERS
 * ========================= */
function hydrateFromAPI(rsp){
  const pillars = rsp?.pillars?.labels || [
    (rsp.stem?.[0]||'-') + (rsp.branch?.[0]||''),
    (rsp.stem?.[1]||'-') + (rsp.branch?.[1]||''),
    (rsp.stem?.[2]||'-') + (rsp.branch?.[2]||''),
    (rsp.stem?.[3]||'-') + (rsp.branch?.[3]||'')
  ];
  renderPillars(pillars);
  renderTable({
    stem: rsp.stem || ['-','-','-','-'],
    branch: rsp.branch || ['-','-','-','-'],
    element: rsp.element || ['-','-','-','-'],
    nayin: rsp.nayin || ['-','-','-','-']
  });
  renderBars(rsp.elementsPct || {'æœ¨':0,'ç«':0,'åœŸ':0,'é‡‘':0,'æ°´':0});
  showResultContainers();
}

/* ===== Bazi core (calculator) ===== */
class BaziCalculator{
  constructor(){
    this.HEAVENLY_STEMS=['ç”²','ä¹™','ä¸™','ä¸','æˆŠ','å·±','åºš','è¾›','å£¬','ç™¸'];
    this.EARTHLY_BRANCHES=['å­','ä¸‘','å¯…','å¯','è¾°','å·³','åˆ','æœª','ç”³','é…‰','æˆŒ','äº¥'];
    this.ZODIAC=['é¼ ','ç‰›','è™','å…”','é¾™','è›‡','é©¬','ç¾Š','çŒ´','é¸¡','ç‹—','çŒª'];
    this.NAYIN=['æµ·ä¸­é‡‘','ç‚‰ä¸­ç«','å¤§æ—æœ¨','è·¯æ—åœŸ','å‰‘é”‹é‡‘','å±±å¤´ç«','æ¶§ä¸‹æ°´','åŸå¤´åœŸ','ç™½èœ¡é‡‘','æ¨æŸ³æœ¨','æ³‰ä¸­æ°´','å±‹ä¸ŠåœŸ','éœ¹é›³ç«','æ¾æŸæœ¨','é•¿æµæ°´','ç ‚çŸ³é‡‘','å±±ä¸‹ç«','å¹³åœ°æœ¨','å£ä¸ŠåœŸ','é‡‘ç®”é‡‘','ä½›ç¯ç«','å¤©æ²³æ°´','å¤§é©¿åœŸ','é’—é’é‡‘','æ¡‘æŸ˜æœ¨','å¤§æºªæ°´','æ²™ä¸­åœŸ','å¤©ä¸Šç«','çŸ³æ¦´æœ¨','å¤§æµ·æ°´'];
  }
  calculateYearPillar(year){
    const s=(year-4)%10, b=(year-4)%12;
    return { stem: this.HEAVENLY_STEMS[(s+10)%10], branch: this.EARTHLY_BRANCHES[(b+12)%12], zodiac: this.ZODIAC[(b+12)%12] };
  }
  solarMonthIndex(y,m,d){
    const mmdd=m*100+d;
    const gates=[[106,12],[204,1],[306,2],[405,3],[506,4],[606,5],[707,6],[808,7],[908,8],[1008,9],[1107,10],[1207,11]];
    let idx=11; for(const [thr,val] of gates){ if(mmdd>=thr) idx=val; }
    const branchBy={1:'å¯…',2:'å¯',3:'è¾°',4:'å·³',5:'åˆ',6:'æœª',7:'ç”³',8:'é…‰',9:'æˆŒ',10:'äº¥',11:'å­',12:'ä¸‘'};
    return {index:idx, branch:branchBy[idx]};
  }
  calculateMonthPillar(year,month,day){
    const {index,branch}=this.solarMonthIndex(year,month,day);
    const yStemIdx=this.HEAVENLY_STEMS.indexOf(this.calculateYearPillar(year).stem);
    const startMap={0:2,1:4,2:6,3:8,4:0,5:2,6:4,7:6,8:8,9:0};
    const stemIdx=(startMap[yStemIdx]+(index-1))%10;
    return {stem:this.HEAVENLY_STEMS[stemIdx], branch};
  }
  calculateDayPillar(year,month,day){
    const baseUTC=Date.UTC(1900,0,31);
    const targetUTC=Date.UTC(year,month-1,day);
    const dayDiff=Math.floor((targetUTC-baseUTC)/86400000);
    const stemIdx=(0+dayDiff)%10;
    const branchIdx=(4+dayDiff)%12;
    return { stem: this.HEAVENLY_STEMS[(stemIdx+10)%10], branch: this.EARTHLY_BRANCHES[(branchIdx+12)%12] };
  }
  calculateHourPillar(dayStem,hour){
    const branchMap={23:'å­',0:'å­',1:'ä¸‘',2:'ä¸‘',3:'å¯…',4:'å¯…',5:'å¯',6:'å¯',7:'è¾°',8:'è¾°',9:'å·³',10:'å·³',11:'åˆ',12:'åˆ',13:'æœª',14:'æœª',15:'ç”³',16:'ç”³',17:'é…‰',18:'é…‰',19:'æˆŒ',20:'æˆŒ',21:'äº¥',22:'äº¥'};
    const startMap={0:0,1:2,2:4,3:6,4:8,5:0,6:2,7:4,8:6,9:8};
    const dayIdx=this.HEAVENLY_STEMS.indexOf(dayStem);
    const hourIndex=Math.floor((hour+1)/2)%12;
    const stemIdx=(startMap[dayIdx]+hourIndex)%10;
    return { stem:this.HEAVENLY_STEMS[stemIdx], branch: branchMap[hour] };
  }
  getStemElement(stem){ return ({ç”²:'æœ¨',ä¹™:'æœ¨',ä¸™:'ç«',ä¸:'ç«',æˆŠ:'åœŸ',å·±:'åœŸ',åºš:'é‡‘',è¾›:'é‡‘',å£¬:'æ°´',ç™¸:'æ°´'})[stem]; }
  getBranchElement(branch){ return ({å­:'æ°´',ä¸‘:'åœŸ',å¯…:'æœ¨',å¯:'æœ¨',è¾°:'åœŸ',å·³:'ç«',åˆ:'ç«',æœª:'åœŸ',ç”³:'é‡‘',é…‰:'é‡‘',æˆŒ:'åœŸ',äº¥:'æ°´'})[branch]; }
  getNayin(stem,branch){
    const si=this.HEAVENLY_STEMS.indexOf(stem), bi=this.EARTHLY_BRANCHES.indexOf(branch);
    return this.NAYIN[(si*2+bi)%this.NAYIN.length];
  }
}

/* ===== Adapter the UI expects ===== */
function calculateBaziFromInput(birthdate, timeStr, timeUnknown){
  const [Y,M,D] = (birthdate||'').split('-').map(n=>parseInt(n,10));
  let hour = 12;
  if (!timeUnknown && timeStr){ const hh = parseInt(timeStr.slice(0,2),10); if(!Number.isNaN(hh)) hour = hh; }

  const calc = new BaziCalculator();
  const yearP  = calc.calculateYearPillar(Y);
  const monthP = calc.calculateMonthPillar(Y,M,D);
  const dayP   = calc.calculateDayPillar(Y,M,D);
  const hourP  = timeUnknown ? {stem:'-',branch:'-'} : calc.calculateHourPillar(dayP.stem, hour);

  const stems   = [yearP.stem, monthP.stem, dayP.stem, hourP.stem];
  const branchs = [yearP.branch, monthP.branch, dayP.branch, hourP.branch];

  // element row = use stem's five element
  const elemRow = [
    calc.getStemElement(stems[0]) || '-',
    calc.getStemElement(stems[1]) || '-',
    calc.getStemElement(stems[2]) || '-',
    timeUnknown ? '-' : (calc.getStemElement(stems[3]) || '-')
  ];

  const nayinRow = [
    calc.getNayin(stems[0], branchs[0]),
    calc.getNayin(stems[1], branchs[1]),
    calc.getNayin(stems[2], branchs[2]),
    timeUnknown ? '-' : calc.getNayin(stems[3], branchs[3])
  ];

  const counts = { 'æœ¨':0,'ç«':0,'åœŸ':0,'é‡‘':0,'æ°´':0 };
  const consider = timeUnknown
    ? [[stems[0],branchs[0]],[stems[1],branchs[1]],[stems[2],branchs[2]]]
    : [[stems[0],branchs[0]],[stems[1],branchs[1]],[stems[2],branchs[2]],[stems[3],branchs[3]]];
  consider.forEach(([s,b])=>{
    counts[(calc.getStemElement(s))]   += 1;
    counts[(calc.getBranchElement(b))] += 1;
  });
  const total = Object.values(counts).reduce((a,b)=>a+b,0) || 1;
  const elementsPct = Object.fromEntries(Object.entries(counts).map(([k,v])=>[k, v/total*100]));

  return {
    pillars: { labels: [
      stems[0]+branchs[0],
      stems[1]+branchs[1],
      stems[2]+branchs[2],
      timeUnknown ? '-' : (stems[3]+branchs[3])
    ]},
    stem: stems,
    branch: branchs,
    element: elemRow,
    nayin: nayinRow,
    elementsPct,
    timeUnknown: !!timeUnknown
  };
}

/* ===== API CALL (optional) ===== */
async function postJSON(url, data){
  const ctrl = new AbortController();
  const t = setTimeout(()=> ctrl.abort(), CONFIG.TIMEOUT_MS);
  try{
    const res = await fetch(url, {
      method:'POST',
      headers:{ 'Content-Type':'application/json' },
      body: JSON.stringify(data),
      signal: ctrl.signal
    });
    if (!res.ok) throw new Error('HTTP '+res.status);
    return await res.json();
  } finally { clearTimeout(t); }
}

async function generateViaAPI(payload){
  if (!CONFIG.API_BASE) return null;
  const endpoints = ['/bazi/quick','/bazi/brief','/bazi'];
  for (const ep of endpoints){
    try{
      // Never log sensitive payload
      const rsp = await postJSON(CONFIG.API_BASE + ep, payload);
      if (rsp) return rsp;
    }catch(_e){ /* try next */ }
  }
  return null;
}

/* === helper: add/remove/update the hour-unknown tip === */
function upsertHourUnknownTip(isUnknown){
  const host = $('professionalReport'); if (!host) return;

  const exist = document.getElementById('hourUnknownTip');
  if (!isUnknown){ if (exist) exist.remove(); return; }

  const title = t('report.tipTitle') || 'TIP';
  const body  = t('report.hourUnknownTip') || '';

  if (exist){
    const h = exist.querySelector('.ai-box-h');
    const c = exist.querySelector('.ai-box-c');
    if (h) h.textContent = title;
    if (c) c.textContent = body;
    return;
  }

  const tip = document.createElement('div');
  tip.id = 'hourUnknownTip';
  tip.className = 'ai-box';
  tip.setAttribute('role', 'status');
  tip.setAttribute('aria-live', 'polite');

  const h = document.createElement('div');
  h.className = 'ai-box-h';
  h.textContent = title;

  const c = document.createElement('div');
  c.className = 'ai-box-c';
  c.textContent = body;

  tip.append(h, c);
  host.prepend(tip);
} 

/* ========= Professional report: schema + rendering ========= */

// 2.1 Schema (keys are stable; you localize only UI labels)
const REPORT_SCHEMA = {
  sections: [
    { id: "overview",      title: "å‘½ç›˜æ€»è§ˆ / Overview" },
    { id: "five_elements", title: "äº”è¡Œèƒ½é‡åˆ†æ / Five-Element Balance" },
    { id: "ten_gods",      title: "åç¥é…ç½®åˆ†æ / Ten Gods" },
    { id: "useful_spirit", title: "ç”¨ç¥å–œå¿Œ / Useful Spirit" },
    { id: "career",        title: "äº‹ä¸šå‘å±• / Career" },
    { id: "wealth",        title: "è´¢è¿èµ°åŠ¿ / Wealth" },
    { id: "relationship",  title: "æ„Ÿæƒ…å©šå§» / Relationship" },
    { id: "health",        title: "å¥åº·å…»ç”Ÿ / Health" },
    { id: "spiritual",     title: "ç„å­¦ç¼˜åˆ† / Spiritual" },
    { id: "near_term",     title: "è¿‘æœŸè¿åŠ¿ï¼ˆ3â€“6ä¸ªæœˆï¼‰ / Next 3â€“6 Months" }
  ]
};

// 2.2 Prompt builder â€“ inject hard facts of this chart; forbid generic answers
function buildReportPrompt(locale, calc) {
  // calc = output of calculateBaziFromInput(...) or API result
  const lang = locale || 'zh-CN';
  const pillars = (calc?.pillars?.labels || []).join(" / ");

  return [
    `Write in ${lang}. Tone: warm, professional, concrete. Use "ä½ /æ‚¨" in Chinese, "you" in English.`,
    `Base EVERYTHING on this person's Bazi only. Do not generalize.`,
    `Chart pillars: ${pillars}`,
    `Stems: ${JSON.stringify(calc.stem)}`,
    `Branches: ${JSON.stringify(calc.branch)}`,
    `Elements%: ${JSON.stringify(calc.elementsPct)}`,
    (calc.timeUnknown ? `Birth hour unknown: yes (hour pillar omitted). Be explicit about uncertainty.` : `Birth hour known.`),
    `Return STRICT JSON matching this shape:
{
  "sections": [
    {
      "id": "overview",
      "traits": ["... 3-6 short bullets, personal character derived from chart ..."],
      "actions": ["... 5 practical actions with verbs ..."],
      "outcomes": ["... 2-4 likely outcomes if actions followed ..."],
      "cautions": ["... 2-3 risks or taboos ..."],
      "timing": "YYYY-QX or YYYY-MM~YYYY-MM windows grounded in luck/flows",
      "confidence": 0.0-1.0
    },
    ...
  ]
}
Rules:
- Traits = clear personality/operating style (e.g., â€œå¿ƒå¤§ä¸è®°ä»‡ã€æŠ¤çŸ­é‡ä¹‰â€ï¼ŒNOT â€œinteraction patternsâ€).
- Actions = concrete steps (â€œæ¯å‘¨å›ºå®šä¸€æ¬¡è´¢åŠ¡å¤ç›˜â€ã€â€œå¯¹ä¼´ä¾£ä½¿ç”¨â€˜å…ˆå…±æƒ…åæè®®â€™è¯æœ¯â€¦â€).
- Outcomes = what tends to happen if actions done.
- Cautions = what to avoid (e.g., è¿‡åº¦é€æ”¯ã€é€å¼ºã€æƒ…ç»ªå‹æŠ‘).
- Timing = realistic windows (e.g., â€œ2025-Q2 èµ·è‰²ï¼Œ2025-07~2025-09æ¨è¿›è°ˆåˆ¤â€).
- Never invent Western astrology. Stay within Bazi logic (day master, ten gods, element balance).
- If hour is unknown, explicitly state which parts are less certain.
}`
  ].join('\n');
}

function extractSections(any){
  if (!any) return null;
  if (Array.isArray(any.sections)) return { sections: any.sections };
  if (any.data && Array.isArray(any.data.sections)) return { sections: any.data.sections };
  if (any.result && Array.isArray(any.result.sections)) return { sections: any.result.sections };
  if (typeof any === 'string'){
    try { return extractSections(JSON.parse(any)); } catch {}
    const matches = any.match(/{[\s\S]*?}/g);
    if (matches) for (let i = matches.length - 1; i >= 0; i--){
      try { const obj = JSON.parse(matches[i]); const got = extractSections(obj); if (got) return got; } catch {}
    }
  }
  if (any.text){
    try { return extractSections(JSON.parse(any.text)); } catch {}
  }
  return null;
}
  
// 2.3 Call your backend LLM (new endpoint recommended: /bazi/report)
async function generateProReport(calc, locale) {
  const payload = {
    locale: locale || 'zh-CN',
    prompt: buildReportPrompt(locale, calc),
    // Optionally include raw features for server-side guardrails
    features: {
      pillars: calc?.pillars?.labels || [],
      stem: calc?.stem || [],
      branch: calc?.branch || [],
      elementsPct: calc?.elementsPct || {},
      timeUnknown: !!calc?.timeUnknown
    }
  };

  if (!CONFIG.API_BASE) return null;
  const endpoints = [
    '/bazi/report',
    '/api/bazi/report',
    '/api/chat/report',
    '/report'
  ];
  for (const ep of endpoints){
    try{
      const rsp = await postJSON(CONFIG.API_BASE + ep, payload);
      const parsed = extractSections(rsp);
      if (parsed) return parsed;
    }catch(_){} // try next
  }
  return null;
}

function synthesizeReport(calc, locale){
  const lang = normLang(locale||state.lang);
  const isZH = lang.startsWith('zh');

  // simple reads from calc
  const elems = calc?.elementsPct || {};
  const strongest = Object.entries(elems).sort((a,b)=>b[1]-a[1])[0]?.[0];
  const weakest   = Object.entries(elems).sort((a,b)=>b[1]-a[1]).slice(-1)[0]?.[0];
  const dayStem   = calc?.stem?.[2] || ''; // day master

  function L(zh, en){ return isZH ? zh : en; }

  const overview = {
    id: "overview",
    traits: [
      L(`ä»¥${dayStem||'æ—¥ä¸»'}ä¸ºæ ¸å¿ƒï¼Œè¡ŒåŠ¨æœæ–­ä½†çœ‹é‡èŠ‚å¥`,`Day master ${dayStem||''}; decisive with attention to pacing`),
      L(`äº”è¡Œå${strongest||'æŸä¸€'}ï¼Œæ“…é•¿åœ¨è¯¥è±¡ä¸­å‘åŠ›`,`Leans ${strongest||'one element'}; excels when using that quality`),
      L(`ç›¸å¯¹æ¬ ${weakest||'æŸä¸€'}ï¼Œé‡è¯¥è±¡é¢˜ç›®éœ€è¡¥æ•‘`,`Relatively lacking ${weakest||'one element'}; needs compensation in those topics`)
    ],
    actions: [
      L('å»ºç«‹æ¯å‘¨å¤ç›˜ä»ªå¼ï¼ˆç›®æ ‡/ç°é‡‘æµ/æƒ…ç»ªï¼‰','Do a weekly review (goals/cashflow/mood)'),
      L('æŠŠæœ€å¼ºè±¡ç”¨äºä¸»æˆ˜åœºï¼ŒæŠŠæœ€å¼±è±¡å®‰æ’â€œè¡¥ä½â€ä»»åŠ¡','Use strongest element for main pushes; assign weakest to supporting routines'),
      L('å¯¹å…³é”®å…³ç³»é‡‡ç”¨â€œå…ˆå…±æƒ…åå»ºè®®â€çš„è¯æœ¯','Use empathy-first script in key conversations')
    ],
    outcomes: [
      L('ç°é‡‘æµä¸èŠ‚å¥æ›´ç¨³','More stable cashflow and cadence'),
      L('äººé™…æ‘©æ“¦å‡å°‘ï¼Œæ¨è¿›æ›´é¡º','Less friction, smoother execution')
    ],
    cautions: [
      L('é¿å…åœ¨å¼±è±¡ä¸»é¢˜ä¸Šç¡¬åˆšï¼ˆè€—èƒ½é«˜ï¼Œå›æŠ¥ä½ï¼‰','Avoid brute forcing the weakest-element domains'),
      L('åˆ«ç‰ºç‰²ç¡çœ æ¢æ•ˆç‡','Donâ€™t trade sleep for speed')
    ],
    timing: L('æœªæ¥3ä¸ªæœˆä»¥â€œå¼ºè±¡æœˆä»½â€ä¸ºæ¨è¿›çª—å£','Use the next 3 monthsâ€™ strongest-element months as push windows'),
    confidence: 0.72
  };

  const five = {
    id: "five_elements",
    traits: [
      L(`æœ€å¼ºï¼š${strongest||'-'}ï¼›æœ€å¼±ï¼š${weakest||'-'}` ,`Strongest: ${strongest||'-'}; Weakest: ${weakest||'-'}`),
      L('ä»¥å¼ºè¡¥å¼±ï¼šç¯å¢ƒ/ä½œæ¯/ç¤¾äº¤ç»“æ„è¿›è¡Œè°ƒå‚','Compensate weak element via environment/routine/social design')
    ],
    actions: [
      L('æŠŠå¼ºè±¡äº‹é¡¹å®‰æ’åœ¨é«˜èƒ½æ—¶æ®µï¼ˆä¸Šåˆ/å‘¨å‰åŠï¼‰','Schedule strongest-element tasks at high-energy times'),
      L('å¯¹å¼±è±¡äº‹é¡¹è®¾ç½®â€œæ¨¡æ¿+é™æ—¶+å¤ç›˜â€','For weakest-element tasks: template + time-box + review')
    ],
    outcomes:[ L('æ•´ä½“æ‰§è¡ŒåŠ›æå‡','Execution quality improves') ],
    cautions:[ L('é¿å…ä¸€æ¬¡æ€§åšå¤ªå¤šå¼±è±¡ä»»åŠ¡','Donâ€™t stack too many weakest-element tasks in a row') ],
    timing: L('æŒ‰æœˆåº¦å…ƒç´ æµåŠ¨å¾®è°ƒ','Adjust monthly with element flow'),
    confidence: 0.68
  };

  return { sections: [overview, five] };
}  

// 2.4 Render JSON â†’ DOM
function renderProReportJSON(json){
  const host = $('professionalReport');
  if (!host) return;

  if (!json?.sections?.length){
    host.innerHTML = `<div class="ai-box"><div class="ai-box-h">${t('report.tipTitle')||'æç¤º'}</div><div class="ai-box-c">æœªè·å–åˆ°æŠ¥å‘Šå†…å®¹ã€‚</div></div>`;
    return;
  }

  const dict = dictFor(state.lang);
  const L = (k, fb='') => (dict.reportLabels?.[k] ?? fb);

  const titleOf = (id, fallback) => {
    const tmap = dict.reportTitles || {};
    return tmap[id] || fallback || id;
  };

  host.innerHTML = json.sections.map(sec=>{
    const traits   = (sec.traits||[]).map(s=>`<li>${s}</li>`).join('');
    const actions  = (sec.actions||[]).map(s=>`<li>${s}</li>`).join('');
    const outcomes = (sec.outcomes||[]).map(s=>`<li>${s}</li>`).join('');
    const cautions = (sec.cautions||[]).map(s=>`<li>${s}</li>`).join('');

    return `
      <div class="butler-section">
        <h4>${titleOf(sec.id, sec.title)}</h4>
        ${traits   ? `<div class="detail-section"><strong>${L('traits','Traits')}</strong><ul class="action-list">${traits}</ul></div>` : ''}
        ${actions  ? `<div class="detail-section"><strong>${L('actions','Actions')}</strong><ul class="action-list">${actions}</ul></div>` : ''}
        ${outcomes ? `<div class="detail-section"><strong>${L('outcomes','Outcomes')}</strong><ul class="action-list">${outcomes}</ul></div>` : ''}
        ${cautions ? `<div class="detail-section"><strong>${L('cautions','Cautions')}</strong><ul class="action-list">${cautions}</ul></div>` : ''}
        ${sec.timing ? `<div class="detail-section"><strong>${L('timing','Timing')}</strong><div>${sec.timing}</div></div>` : ''}
        ${typeof sec.confidence === 'number'
            ? `<div class="detail-section muted">${L('confidence','Confidence')} ${Math.round(sec.confidence*100)}%</div>`
            : ''
        }
      </div>
    `;
  }).join('');

  $('butlerProfessional')?.style && ( $('butlerProfessional').style.display = 'block' );
}
  
/* =========================
 * GENERATE HANDLER
 * ========================= */
async function onGenerate(){
  setGenLoading(true);
  try{
    const date   = $('birthdate')?.value;
    const unknown= $('timeUnknown')?.checked;
    const timeVal= $('birthtime')?.value || '00:00';
    const cal    = $('calendar')?.value || 'gregorian';
    const gender = $('gender')?.value || '';
    const name   = $('name')?.value || '';

    if (!date){
      showErr(t('err.fillBirthdate') || 'Please enter your birth date');
      return;
    }

    const [yy, mo, dd] = String(date).split('-');
    const [hh, mi]     = String(timeVal || '00:00').split(':');

    const hourTpl = t('ui.hourSuffix') || '{hh}:{mm}';
    const timeText = unknown
      ? (t('ui.timeUnknown') || '')
      : (hourTpl.includes('{h}')
          ? hourTpl.replace('{h}', String(hh ?? '00').padStart(2,'0'))
          : hourTpl.replace('{hh}', String(hh ?? '00').padStart(2,'0'))
                   .replace('{mm}', String(mi ?? '00').padStart(2,'0')));

    const summaryTpl = t('ui.birthSummary') || 'Birth date: {y}-{m}-{d} {timeText}';
    const summary = summaryTpl
      .replace('{y}', yy)
      .replace('{m}', mo)
      .replace('{d}', dd)
      .replace('{timeText}', timeText);

    if ($('bazi-date')) $('bazi-date').textContent = summary;

    const payload = {
      name, gender, calendar: cal,
      birthdate: date,
      birthtime: unknown ? null : timeVal,
      timeUnknown: !!unknown,
      locale: state.lang
    };

    let data = null, fromAPI = false;
    try{ data = await generateViaAPI(payload); if (data) fromAPI = true; }catch(_e){}
    if (!data) data = calculateBaziFromInput(date, timeVal, unknown);

    hydrateFromAPI(data);
    upsertHourUnknownTip(!!unknown);
    setSourceBadge(fromAPI);

    // Generate the professional report ONLY from the personal chart (no presets)
try {
  const report = await generateProReport(data, state.lang);
  renderProReportJSON(report);
} catch (e) {
  // Fail silent to UI; show a gentle message
  renderProReportJSON(null);
}

  }catch(err){
    // Do not log personal inputs
    console.error('Generate failed'); // no payload in logs
    showErr(t('err.generateFail') || 'Failed to generate');
  }finally{
    setGenLoading(false);
  }
  
  // inside onGenerate() after you computed `data` (the chart)
let report = null;
try { report = await generateProReport(data, state.lang); } catch {}
if (!report || !Array.isArray(report.sections) || report.sections.length === 0) {
  // guaranteed, non-generic, chart-based fallback
  report = synthesizeReport(data, state.lang);
}
renderProReportJSON(report);
}

/* =========================
 * INIT
 * ========================= */
document.addEventListener('DOMContentLoaded', ()=>{
  setNowDefaults();

  const sel = $('langSelect');
  if (sel){
    sel.value = state.lang;
    sel.addEventListener('change', e=>{
      state.lang = e.target.value || 'zh-CN';
      localStorage.setItem('5x_lang', state.lang);
      applyI18n();
      if ($('professionalReport') && $('professionalReport').innerHTML) {
      }
      // refresh source badge text (language switch)
      const srcEl = $('originBadge');
      if (srcEl && srcEl.dataset.src){
        setSourceBadge(srcEl.dataset.src === 'api');
      }
    });
  }

  const timeUnknown = $('timeUnknown');
  if (timeUnknown){
    timeUnknown.addEventListener('change', e=>{
      const dis = !!e.target.checked;
      if ($('birthtime')) $('birthtime').disabled = dis;
    });
  }

  const gen = $('genBtn');
  if (gen) gen.addEventListener('click', onGenerate);

  initFloatChat();
  applyI18n();
});
})();
</script>
</body>
</html>
