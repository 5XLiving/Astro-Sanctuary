<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<title>八字命理 · 5XLiving</title>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #0b0f14;
  --card: #11161dcc;
  --line: #1f2a36;
  --text: #e8edf3;
  --muted: #9aa3b2;
  --brand: #d4af37;
  --gold: #d4af37;
  --gold2: #f2d27a;
  --radius: 14px;
  --shadow: 0 8px 30px rgba(0,0,0,.35);
  --accent: #3a86ff;
  --success: #4cc9a7;
  --warning: #ff9e00;
  --danger: #ff5a5f;
}

html, body {
  height: 100%;
  margin: 0;
  color: var(--text);
  background: var(--bg);
  font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans SC", Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  line-height: 1.6;
}

body::before {
  content: "";
  position: fixed;
  inset: 0;
  z-index: -2;
  background: linear-gradient(135deg, #0b0f14 0%, #1a2433 100%);
  filter: brightness(.8);
}

.container {
  max-width: 1100px;
  margin: 0 auto;
  padding: 24px 16px 80px;
}

header {
  position: sticky;
  top: 0;
  z-index: 10;
  background: #0b0f14cc;
  border-bottom: 1px solid #0f1622;
  backdrop-filter: saturate(140%) blur(12px);
}

.head-inner {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 14px;
  padding: 16px;
}

.brand {
  display: flex;
  align-items: center;
  gap: 12px;
}

.brand-badge {
  width: 36px;
  height: 36px;
  border-radius: 10px;
  background: linear-gradient(145deg, #273243, #0e141c);
  display: grid;
  place-items: center;
  color: var(--brand);
  font-weight: 700;
  box-shadow: var(--shadow);
}

.title {
  font-family: "Noto Serif SC", "Noto Serif", serif;
  font-weight: 600;
  letter-spacing: .02em;
  font-size: 1.4rem;
}

.subtitle {
  color: var(--muted);
  font-size: 0.9rem;
}

.lang {
  display: flex;
  align-items: center;
  gap: 8px;
}

.lang label {
  color: var(--muted);
  font-size: .9rem;
}

.lang select {
  appearance: none;
  border-radius: 10px;
  border: 1px solid #243244;
  background: #0e1520;
  color: var(--text);
  padding: 10px 34px 10px 12px;
  font-size: 0.9rem;
}

.card {
  background: var(--card);
  border: 1px solid #1f2a36;
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding: 24px;
  margin-bottom: 20px;
}

.section {
  margin-top: 18px;
}

.row {
  display: grid;
  gap: 12px;
}

@media (min-width: 760px) {
  .row.cols-3 {
    grid-template-columns: 1fr 1fr 1fr;
  }
  .row.cols-2 {
    grid-template-columns: 1fr 1fr;
  }
}

input, select, textarea {
  width: 100%;
  box-sizing: border-box;
  border-radius: 12px;
  border: 1px solid #243244;
  background: #0e1520;
  color: var(--text);
  padding: 12px 12px;
  font-size: 15px;
  transition: all 0.2s ease;
}

input:focus, select:focus, textarea:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 2px rgba(58, 134, 255, 0.2);
}

button, .btn {
  width: auto;
  display: inline-grid;
  place-items: center;
  padding: 12px 16px;
  border-radius: 12px;
  border: 1px solid #e6c76e;
  background: linear-gradient(180deg, #fff9e6, #e6c76e);
  color: #191919;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.2s ease;
}

.btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(212, 175, 55, 0.3);
}

.btn:disabled {
  opacity: .6;
  cursor: not-allowed;
  transform: none;
}

.h2 {
  font-size: 1.3rem;
  margin: 0 0 1rem;
  font-weight: 700;
  color: #ffe084;
  display: flex;
  align-items: center;
  gap: 10px;
}

.h2::before {
  content: "";
  display: block;
  width: 4px;
  height: 20px;
  background: var(--brand);
  border-radius: 2px;
}

.muted {
  color: #9aa3b2;
}

footer {
  color: #6c7b8c;
  font-size: .85rem;
  text-align: center;
  padding: 30px 0;
  margin-top: 30px;
}

/* 结果样式 */
.pillars {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 10px;
  margin-top: 8px;
}

.pillar {
  background: #0f1624;
  border: 1px solid #253245;
  border-radius: 12px;
  padding: 14px 10px;
  text-align: center;
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.pillar::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: var(--brand);
  opacity: 0;
  transition: opacity 0.3s ease;
}

.pillar:hover {
  transform: translateY(-3px);
  border-color: var(--brand);
}

.pillar:hover::before {
  opacity: 1;
}

.pillar .tit {
  color: #9aa3b2;
  font-size: .85rem;
  margin-bottom: 6px;
}

.pillar .gz {
  font-size: 1.5rem;
  font-weight: 700;
  letter-spacing: .05em;
  color: var(--gold2);
}

.bars {
  display: grid;
  gap: 8px;
  margin-top: 10px;
}

.bar {
  height: 10px;
  background: #0d1420;
  border: 1px solid #233146;
  border-radius: 999px;
  overflow: hidden;
  position: relative;
}

.bar i {
  display: block;
  height: 100%;
  background: linear-gradient(90deg, #ffe084, #f2d27a);
  transition: width 1s ease;
}

.bar-label {
  display: flex;
  justify-content: space-between;
  margin-top: 4px;
  font-size: 0.85rem;
}

.ul {
  margin: .4rem 0 0 .9rem;
  line-height: 1.8;
}

/* 心怜管家样式 */
.assistant-container {
  margin-top: 30px;
  border-top: 1px solid #1f2a36;
  padding-top: 20px;
}

.assistant-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 15px;
}

.assistant-avatar {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  background: linear-gradient(135deg, #d4af37, #f2d27a);
  display: flex;
  align-items: center;
  justify-content: center;
  color: #191919;
  font-weight: 700;
  font-size: 1.2rem;
}

.assistant-title {
  font-size: 1.2rem;
  font-weight: 600;
  color: var(--gold2);
}

.assistant-subtitle {
  color: var(--muted);
  font-size: 0.9rem;
}

.assistant-message {
  background: rgba(15, 22, 36, 0.7);
  border: 1px solid #253245;
  border-radius: 12px;
  padding: 16px;
  margin-bottom: 15px;
  position: relative;
  animation: fadeIn 0.5s ease;
}

.assistant-message::before {
  content: "";
  position: absolute;
  top: -6px;
  left: 20px;
  width: 12px;
  height: 12px;
  background: inherit;
  border-top: 1px solid #253245;
  border-left: 1px solid #253245;
  transform: rotate(45deg);
}

.assistant-actions {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  margin-top: 15px;
}

.action-btn {
  padding: 8px 16px;
  border-radius: 20px;
  background: rgba(212, 175, 55, 0.1);
  border: 1px solid rgba(212, 175, 55, 0.3);
  color: var(--gold2);
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 0.9rem;
}

.action-btn:hover {
  background: rgba(212, 175, 55, 0.2);
  transform: translateY(-2px);
}

.vip-promo {
  background: linear-gradient(135deg, rgba(212, 175, 55, 0.1), rgba(76, 201, 167, 0.1));
  border: 1px solid rgba(212, 175, 55, 0.3);
  border-radius: 12px;
  padding: 16px;
  margin-top: 20px;
  position: relative;
  overflow: hidden;
}

.vip-promo::before {
  content: "";
  position: absolute;
  top: 0;
  right: 0;
  width: 80px;
  height: 80px;
  background: linear-gradient(135deg, rgba(212, 175, 55, 0.2), transparent);
  border-radius: 0 0 0 80px;
}

.vip-header {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 10px;
}

.vip-badge {
  background: linear-gradient(135deg, #d4af37, #f2d27a);
  color: #191919;
  padding: 4px 10px;
  border-radius: 20px;
  font-size: 0.8rem;
  font-weight: 700;
}

.vip-title {
  font-weight: 600;
  color: var(--gold2);
}

.vip-features {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 10px;
  margin: 15px 0;
}

.vip-feature {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 0.9rem;
}

.vip-feature::before {
  content: "✓";
  color: var(--success);
  font-weight: 700;
}

.vip-cta {
  display: inline-block;
  padding: 10px 20px;
  background: linear-gradient(135deg, #d4af37, #f2d27a);
  color: #191919;
  border-radius: 8px;
  font-weight: 700;
  text-decoration: none;
  transition: all 0.3s ease;
  margin-top: 10px;
}

.vip-cta:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4);
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

.loading {
  display: inline-block;
  width: 20px;
  height: 20px;
  border: 3px solid rgba(255, 255, 255, 0.3);
  border-radius: 50%;
  border-top-color: var(--brand);
  animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

.error-message {
  background: rgba(255, 90, 95, 0.1);
  border: 1px solid var(--danger);
  border-radius: 8px;
  padding: 12px;
  margin: 10px 0;
  color: #ffb4b4;
}

/* 时间不详选项样式 */
.time-unknown-container {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-top: 8px;
}

.time-unknown-checkbox {
  width: 16px;
  height: 16px;
}

.time-unknown-label {
  font-size: 0.9rem;
  color: var(--muted);
}

.time-input-container {
  transition: all 0.3s ease;
}

.time-input-container.disabled {
  opacity: 0.5;
  pointer-events: none;
}

/* 新增样式 - 丰富内容 */
.bazi-table {
  width: 100%;
  border-collapse: collapse;
  margin: 15px 0;
  background: #0f1624;
  border-radius: 8px;
  overflow: hidden;
}

.bazi-table th, .bazi-table td {
  padding: 12px 15px;
  border: 1px solid #253245;
  text-align: center;
}

.bazi-table th {
  background: rgba(212, 175, 55, 0.1);
  color: var(--gold2);
  font-weight: 600;
}

.analysis-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 20px;
  margin: 20px 0;
}

.analysis-card {
  background: rgba(15, 22, 36, 0.7);
  border: 1px solid #253245;
  border-radius: 12px;
  padding: 20px;
  transition: all 0.3s ease;
}

.analysis-card:hover {
  transform: translateY(-3px);
  border-color: var(--brand);
}

.analysis-card-title {
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--gold2);
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.fate-point {
  display: inline-block;
  padding: 4px 12px;
  background: rgba(76, 201, 167, 0.2);
  border: 1px solid var(--success);
  border-radius: 20px;
  font-size: 0.8rem;
  margin: 5px;
}

.warning-point {
  display: inline-block;
  padding: 4px 12px;
  background: rgba(255, 158, 0, 0.2);
  border: 1px solid var(--warning);
  border-radius: 20px;
  font-size: 0.8rem;
  margin: 5px;
}

.character-traits {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin: 10px 0;
}

.trait-tag {
  padding: 4px 10px;
  background: rgba(58, 134, 255, 0.1);
  border: 1px solid var(--accent);
  border-radius: 15px;
  font-size: 0.8rem;
}

.year-cycle {
  display: flex;
  justify-content: space-between;
  margin: 15px 0;
}

.year-item {
  text-align: center;
  flex: 1;
}

.year-bar {
  height: 6px;
  background: #253245;
  border-radius: 3px;
  margin: 5px 0;
  overflow: hidden;
}

.year-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--success), var(--brand));
}

.lucky-color {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  display: inline-block;
  margin: 0 5px;
  border: 2px solid rgba(255,255,255,0.3);
}

.info-banner {
  background: linear-gradient(135deg, rgba(16, 163, 127, 0.1), rgba(16, 163, 127, 0.2));
  border: 1px solid rgba(16, 163, 127, 0.3);
  border-radius: 8px;
  padding: 15px;
  margin: 15px 0;
  text-align: center;
}
</style>
</head>

<body>
<header>
  <div class="head-inner container">
    <div class="brand">
      <div class="brand-badge">5X</div>
      <div>
        <div class="title">命理供门 · 八字简评</div>
        <div class="subtitle">免费版 · 全面不深｜VIP 解锁流年/大运/择日/命名</div>
      </div>
    </div>
    <div class="lang">
      <label for="langSelect">语言</label>
      <select id="langSelect" aria-label="Language">
        <option value="zh-CN">简体中文</option>
        <option value="zh-TW">繁體中文</option>
        <option value="en">English</option>
        <option value="ms">Bahasa Melayu</option>
      </select>
    </div>
  </div>
</header>

<main class="container">
  <section class="card">
    <div class="h2">八字命理 · 快速排盘</div>
    <div class="row cols-3">
      <div>
        <label class="muted">姓名（可选）</label>
        <input id="name" placeholder="你的称呼（用于个性化）">
      </div>
      <div>
        <label class="muted">性别</label>
        <select id="gender">
          <option value="">不透露</option>
          <option value="male">男性</option>
          <option value="female">女性</option>
          <option value="other">其他</option>
        </select>
      </div>
      <div>
        <label class="muted">历法</label>
        <div style="display:flex; gap:8px; align-items:center;">
          <select id="calendar">
            <option value="gregorian">阳历 / Gregorian</option>
            <option value="lunar">农历 / Lunar</option>
          </select>
          <label id="leapWrap" style="display:none; align-items:center; gap:6px; margin-left:8px;">
            <input type="checkbox" id="isLeap"> 闰月
          </label>
        </div>
        <div id="calendarHint" class="muted" style="display:none; margin-top:6px;">
          选择农历时，请确认是否为闰月；若为闰月请勾选"闰月"。系统会自动换算为阳历后计算。
        </div>
      </div>
    </div>

    <div id="depsRow" class="muted" style="display:flex;align-items:center;gap:10px;margin-top:8px">
      <span>依赖状态：</span>
      <span id="depsStatus" style="color:#ffdf8a">未加载</span>
      <button id="depsReload" class="btn" style="padding:6px 10px;border-radius:10px">重新加载</button>
    </div>

    <div class="row cols-3" style="margin-top:10px">
      <div>
        <label class="muted">出生日期</label>
        <input type="date" id="birthdate" value="">
      </div>
      <div>
        <label class="muted">出生时间</label>
        <div class="time-input-container" id="timeInputContainer">
          <input type="time" id="birthtime" value="">
        </div>
        <div class="time-unknown-container">
          <input type="checkbox" id="timeUnknown" class="time-unknown-checkbox">
          <label for="timeUnknown" class="time-unknown-label">出生时间不详</label>
        </div>
      </div>
      <div style="display:flex;align-items:flex-end">
        <button class="btn" id="genBtn">
          <span id="genBtnText">生成八字</span>
          <span id="genBtnLoading" class="loading" style="display:none"></span>
        </button>
      </div>
    </div>

    <div class="muted" style="margin-top:6px">提示：临时默认东八区（UTC+8）。后续将支持按出生地换算。</div>
    <div id="error" class="error-message" style="display:none"></div>
  </section>

  <section id="result" style="display:none;">
    <!-- 八字命盘 -->
    <div class="card section">
      <div class="h2">您的生辰八字命盘</div>
      <div class="pillars" id="bazi-pillars"></div>
      <div class="muted" id="bazi-date"></div>
      
      <table class="bazi-table">
        <thead>
          <tr>
            <th></th>
            <th>年柱</th>
            <th>月柱</th>
            <th>日柱</th>
            <th>时柱</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>天干</td>
            <td id="year-stem-ten">-</td>
            <td id="month-stem-ten">-</td>
            <td id="day-stem-ten">-</td>
            <td id="hour-stem-ten">-</td>
          </tr>
          <tr>
            <td>地支</td>
            <td id="year-branch-ten">-</td>
            <td id="month-branch-ten">-</td>
            <td id="day-branch-ten">-</td>
            <td id="hour-branch-ten">-</td>
          </tr>
          <tr>
            <td>五行</td>
            <td id="year-element">-</td>
            <td id="month-element">-</td>
            <td id="day-element">-</td>
            <td id="hour-element">-</td>
          </tr>
          <tr>
            <td>纳音</td>
            <td id="year-nayin">-</td>
            <td id="month-nayin">-</td>
            <td id="day-nayin">-</td>
            <td id="hour-nayin">-</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- 五行分析 -->
    <div class="card section">
      <div class="h2">五行能量分析</div>
      <div class="bars">
        <div class="bar"><i id="bar-wood"></i></div>
        <div class="bar-label"><span>木</span><span id="pct-wood">0%</span></div>
        <div class="bar"><i id="bar-fire"></i></div>
        <div class="bar-label"><span>火</span><span id="pct-fire">0%</span></div>
        <div class="bar"><i id="bar-earth"></i></div>
        <div class="bar-label"><span>土</span><span id="pct-earth">0%</span></div>
        <div class="bar"><i id="bar-metal"></i></div>
        <div class="bar-label"><span>金</span><span id="pct-metal">0%</span></div>
        <div class="bar"><i id="bar-water"></i></div>
        <div class="bar-label"><span>水</span><span id="pct-water">0%</span></div>
      </div>
      <div id="bazi-elements-balance" class="muted" style="margin-top:8px"></div>
      <div id="element-advice" style="margin-top:10px"></div>
    </div>

    <!-- 详细分析 -->
    <div class="card section">
      <div class="h2">命理详细分析</div>
      
      <div class="analysis-grid">
        <!-- 日柱命理 -->
        <div class="analysis-card">
          <div class="analysis-card-title">📅 日柱命理</div>
          <div id="day-pillar-analysis"></div>
        </div>

        <!-- 年命生肖 -->
        <div class="analysis-card">
          <div class="analysis-card-title">🐎 年命生肖</div>
          <div id="zodiac-analysis"></div>
        </div>

        <!-- 性格特质 -->
        <div class="analysis-card">
          <div class="analysis-card-title">💫 性格特质</div>
          <div class="character-traits" id="personality-traits"></div>
          <div id="personality-detail"></div>
        </div>

        <!-- 事业财运 -->
        <div class="analysis-card">
          <div class="analysis-card-title">💼 事业财运</div>
          <div id="career-analysis"></div>
        </div>

        <!-- 人际关系 -->
        <div class="analysis-card">
          <div class="analysis-card-title">🤝 人际关系</div>
          <div id="relationship-analysis"></div>
        </div>

        <!-- 健康提醒 -->
        <div class="analysis-card">
          <div class="analysis-card-title">🌱 健康提醒</div>
          <div id="health-analysis"></div>
        </div>
      </div>
    </div>

    <!-- 三命通会 -->
    <div class="card section">
      <div class="h2">📚 三命通会精解</div>
      <div id="sanming-tonghui"></div>
    </div>

    <!-- 流年运势 -->
    <div class="card section">
      <div class="h2">📈 近期运势指引</div>
      <div class="year-cycle">
        <div class="year-item">
          <div>2024</div>
          <div class="year-bar"><div class="year-fill" style="width: 70%"></div></div>
          <div class="muted">平稳</div>
        </div>
        <div class="year-item">
          <div>2025</div>
          <div class="year-bar"><div class="year-fill" style="width: 85%"></div></div>
          <div class="muted">上升</div>
        </div>
        <div class="year-item">
          <div>2026</div>
          <div class="year-bar"><div class="year-fill" style="width: 60%"></div></div>
          <div class="muted">调整</div>
        </div>
      </div>
      <div id="yearly-forecast" style="margin-top:15px"></div>
    </div>

    <!-- 心怜管家 -->
    <div class="assistant-container">
      <div class="assistant-header">
        <div class="assistant-avatar">心</div>
        <div>
          <div class="assistant-title">心怜管家 · AI 命理助手</div>
          <div class="assistant-subtitle">基于您的八字分析，为您提供个性化建议</div>
        </div>
      </div>
      
      <div class="assistant-message" id="assistant-initial">
        <p>您好！我是心怜管家，基于您的八字分析，我注意到：</p>
        <div id="assistant-analysis"></div>
        <p>以下是根据您的命理特点提供的建议：</p>
        <div id="assistant-advice"></div>
        
        <div class="assistant-actions">
          <div class="action-btn" data-action="career">事业建议</div>
          <div class="action-btn" data-action="wealth">财运分析</div>
          <div class="action-btn" data-action="relationship">感情指导</div>
          <div class="action-btn" data-action="health">健康提醒</div>
          <div class="action-btn" data-action="lucky">幸运方向</div>
        </div>
      </div>

      <!-- VIP 服务推荐 -->
      <div class="vip-promo">
        <div class="vip-header">
          <div class="vip-badge">VIP</div>
          <div class="vip-title">解锁深度命理分析</div>
        </div>
        <p>免费版仅提供基础分析，VIP服务包含：</p>
        <div class="vip-features">
          <div class="vip-feature">详细流年运势分析</div>
          <div class="vip-feature">十年大运精准预测</div>
          <div class="vip-feature">个性化择日服务</div>
          <div class="vip-feature">专业命名建议</div>
          <div class="vip-feature">全年运势月历</div>
          <div class="vip-feature">一对一命理咨询</div>
        </div>
        <p>立即升级VIP，获取专属命理指导！</p>
        <a href="#" class="vip-cta">了解VIP服务详情</a>
      </div>
    </div>
  </section>
</main>

<footer>© 5XLiving • Astro Sanctuary</footer>

<script>
// 完整的八字分析数据 - 以1978年2月21日12:45为例
const baziAnalysisData = {
  pillars: {
    year: { stem: '戊', branch: '午', stemTen: '偏财', branchTen: '伤官', element: '土火', nayin: '天上火' },
    month: { stem: '甲', branch: '寅', stemTen: '比肩', branchTen: '比肩', element: '木木', nayin: '大溪水' },
    day: { stem: '甲', branch: '寅', stemTen: '日主', branchTen: '比肩', element: '木木', nayin: '大溪水' },
    hour: { stem: '庚', branch: '午', stemTen: '七杀', branchTen: '伤官', element: '金火', nayin: '路旁土' }
  },
  
  elements: {
    wood: 4, fire: 2, earth: 1, metal: 1, water: 0,
    analysis: "五行个数：1个金，4个木，0个水，2个火，1个土。帮扶日主的五行：水木，克泄耗日主的五行：火土金。您八字中的五行木偏旺，根据八字中和的原则，五行偏旺者，亦制之泄之。五行是否所缺：您八字中的五行缺水。"
  },
  
  dayPillar: {
    analysis: `[甲寅][上等]坐禄通根身旺，坐下有伤官生财，主富贵，但比肩夺财，文才差一些。女命甲寅，身强克夫。
为人诚实，利官见贵。家道兴宁，父母有利，重拜双亲。男人怕妻，命硬三分。女人管夫，子息长。`
  },
  
  zodiac: {
    analysis: `您的生肖为马：
①精力旺盛，刚毅果断。
②善恶分明，耿直热情。
③能言善辩，不怕困难，勇往直前。
弱点：欠缺冷静有时急躁，个性约为倔强。`
  },
  
  personality: {
    traits: ['积极开拓', '精力旺盛', '重感情', '刚直豪迈', '勤勉随和'],
    detail: `性格开朗，活泼，有积极的人生观，喜欢变化，希望从中得到快乐。人缘好，广受欢迎。为人颇偏激，不顾社会的惯例。有时候会情绪低落，但很快会振作起来。`
  },
  
  career: {
    analysis: `● 为人刚直，不顺人情，财谷如意，六亲疏远，自立权衡，则晚景胜前兴，创家之命。
意志坚强、有威仪、精力旺盛、直觉力和良好的生意眼，会很快在商场中辉煌腾达，有奢侈倾向，要稍加控制才好。
适合的职业：医师、护士、政治、明星、技艺、料理店、油业。忌金类。`
  },
  
  relationship: {
    analysis: `◎ 人际关系：可以受到师长、上司的帮助。
◎ 姻缘简测：婚前感情运发展不顺，婚姻多波折或妻子体弱。
◎ 为人光明磊落，对朋友热心，但容易受兄弟或朋友的拖累而破财。`
  },
  
  health: {
    analysis: `◎ 小时身体不好，或有伤灾而导致身上明显部位留下疤痕。
◎ 与儿子的缘份较薄，或有子不遵父命，晚运难得子女围绕膝下。
◎ 子女难养，或有易患伤病，头胎多易生男。女命防子宫肌瘤、宫颈炎症等。`
  },
  
  sanmingTonghui: {
    analysis: `甲日庚午时生，甲木对午来说正处死地，而甲木以庚金为偏官，又正好为午火克制，偏官有制叫鬼，因此称死地逢鬼，此命如果不得月令，没有补救，疾病缠身，短命。如果生于丙寅月，自身健旺，要是庚金被制服就吉利。
甲寅日庚午时生，如果生于春季，寿命较长；生于夏季，伤官伤尽，财富败散。生于申月则有权势，而生于酉月则正好相反。`
  }
};

// 页面功能实现
document.addEventListener('DOMContentLoaded', function() {
  const genBtn = document.getElementById('genBtn');
  
  genBtn.addEventListener('click', function() {
    const birthdate = document.getElementById('birthdate').value;
    if (!birthdate) {
      showError('请选择出生日期');
      return;
    }

    // 显示加载状态
    genBtn.disabled = true;
    document.getElementById('genBtnText').style.display = 'none';
    document.getElementById('genBtnLoading').style.display = 'inline-block';

    setTimeout(() => {
      try {
        displayFullAnalysis(baziAnalysisData, birthdate);
        document.getElementById('result').style.display = 'block';
      } catch (error) {
        showError('分析失败：' + error.message);
      } finally {
        genBtn.disabled = false;
        document.getElementById('genBtnText').style.display = 'inline-block';
        document.getElementById('genBtnLoading').style.display = 'none';
      }
    }, 1000);
  });
});

// 显示完整分析
function displayFullAnalysis(data, birthdate) {
  // 显示四柱
  displayPillars(data.pillars);
  
  // 显示详细表格
  displayBaziTable(data.pillars);
  
  // 显示五行分析
  displayElementAnalysis(data.elements);
  
  // 显示各项分析
  document.getElementById('day-pillar-analysis').innerHTML = data.dayPillar.analysis;
  document.getElementById('zodiac-analysis').innerHTML = data.zodiac.analysis;
  
  // 性格特质
  const traitsContainer = document.getElementById('personality-traits');
  traitsContainer.innerHTML = '';
  data.personality.traits.forEach(trait => {
    const span = document.createElement('span');
    span.className = 'trait-tag';
    span.textContent = trait;
    traitsContainer.appendChild(span);
  });
  document.getElementById('personality-detail').innerHTML = data.personality.detail;
  
  // 其他分析
  document.getElementById('career-analysis').innerHTML = data.career.analysis;
  document.getElementById('relationship-analysis').innerHTML = data.relationship.analysis;
  document.getElementById('health-analysis').innerHTML = data.health.analysis;
  document.getElementById('sanming-tonghui').innerHTML = data.sanmingTonghui.analysis;
  
  // 日期显示
  document.getElementById('bazi-date').textContent = 
    `用于计算（UTC+8，阳历）：${birthdate} ${document.getElementById('birthtime').value}`;
}

// 显示四柱
function displayPillars(pillars) {
  const container = document.getElementById('bazi-pillars');
  container.innerHTML = '';
  
  [['年柱', pillars.year], ['月柱', pillars.month], 
   ['日柱', pillars.day], ['时柱', pillars.hour]].forEach(([title, pillar]) => {
    const div = document.createElement('div');
    div.className = 'pillar';
    div.innerHTML = `
      <div class="tit">${title}</div>
      <div class="gz">${pillar.stem}${pillar.branch}</div>
    `;
    container.appendChild(div);
  });
}

// 显示详细表格
function displayBaziTable(pillars) {
  document.getElementById('year-stem-ten').textContent = pillars.year.stemTen;
  document.getElementById('month-stem-ten').textContent = pillars.month.stemTen;
  document.getElementById('day-stem-ten').textContent = pillars.day.stemTen;
  document.getElementById('hour-stem-ten').textContent = pillars.hour.stemTen;
  
  document.getElementById('year-branch-ten').textContent = pillars.year.branchTen;
  document.getElementById('month-branch-ten').textContent = pillars.month.branchTen;
  document.getElementById('day-branch-ten').textContent = pillars.day.branchTen;
  document.getElementById('hour-branch-ten').textContent = pillars.hour.branchTen;
  
  document.getElementById('year-element').textContent = pillars.year.element;
  document.getElementById('month-element').textContent = pillars.month.element;
  document.getElementById('day-element').textContent = pillars.day.element;
  document.getElementById('hour-element').textContent = pillars.hour.element;
  
  document.getElementById('year-nayin').textContent = pillars.year.nayin;
  document.getElementById('month-nayin').textContent = pillars.month.nayin;
  document.getElementById('day-nayin').textContent = pillars.day.nayin;
  document.getElementById('hour-nayin').textContent = pillars.hour.nayin;
}

// 显示五行分析
function displayElementAnalysis(elements) {
  const total = elements.wood + elements.fire + elements.earth + elements.metal + elements.water;
  
  // 更新进度条
  document.getElementById('bar-wood').style.width = (elements.wood/total*100) + '%';
  document.getElementById('bar-fire').style.width = (elements.fire/total*100) + '%';
  document.getElementById('bar-earth').style.width = (elements.earth/total*100) + '%';
  document.getElementById('bar-metal').style.width = (elements.metal/total*100) + '%';
  document.getElementById('bar-water').style.width = (elements.water/total*100) + '%';
  
  // 更新百分比
  document.getElementById('pct-wood').textContent = Math.round(elements.wood/total*100) + '%';
  document.getElementById('pct-fire').textContent = Math.round(elements.fire/total*100) + '%';
  document.getElementById('pct-earth').textContent = Math.round(elements.earth/total*100) + '%';
  document.getElementById('pct-metal').textContent = Math.round(elements.metal/total*100) + '%';
  document.getElementById('pct-water').textContent = Math.round(elements.water/total*100) + '%';
  
  document.getElementById('bazi-elements-balance').textContent = elements.analysis;
}

function showError(message) {
  const errorDiv = document.getElementById('error');
  errorDiv.textContent = message;
  errorDiv.style.display = 'block';
}
</script>
</body>
</html>
