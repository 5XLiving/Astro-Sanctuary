<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<title>å…«å­—å‘½ç† Â· 5XLiving</title>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<style>
:root {
  --bg: #0b0f14;
  --card: #11161dcc;
  --line: #1f2a36;
  --text: #e8edf3;
  --muted: #9aa3b2;
  --brand: #d4af37;
  --gold: #d4af37;
  --gold2: #f2d27a;
  --radius: 14px;
  --shadow: 0 8px 30px rgba(0,0,0,.35);
  --accent: #3a86ff;
  --success: #4cc9a7;
  --warning: #ff9e00;
  --danger: #ff5a5f;
}

html, body {
  height: 100%;
  margin: 0;
  color: var(--text);
  background: var(--bg);
  font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans SC", Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  line-height: 1.6;
}

body::before {
  content: "";
  position: fixed;
  inset: 0;
  z-index: -2;
  background: linear-gradient(135deg, #0b0f14 0%, #1a2433 100%);
  filter: brightness(.8);
}

.container {
  max-width: 1100px;
  margin: 0 auto;
  padding: 24px 16px 80px;
}

header {
  position: sticky;
  top: 0;
  z-index: 10;
  background: #0b0f14cc;
  border-bottom: 1px solid #0f1622;
  backdrop-filter: saturate(140%) blur(12px);
}

.head-inner {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 14px;
  padding: 16px;
}

.brand {
  display: flex;
  align-items: center;
  gap: 12px;
}

.brand-badge {
  width: 36px;
  height: 36px;
  border-radius: 10px;
  background: linear-gradient(145deg, #273243, #0e141c);
  display: grid;
  place-items: center;
  color: var(--brand);
  font-weight: 700;
  box-shadow: var(--shadow);
}

.title {
  font-family: "Noto Serif SC", "Noto Serif", serif;
  font-weight: 600;
  letter-spacing: .02em;
  font-size: 1.4rem;
}

.subtitle {
  color: var(--muted);
  font-size: 0.9rem;
}

.card {
  background: var(--card);
  border: 1px solid #1f2a36;
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding: 24px;
  margin-bottom: 20px;
}

.section {
  margin-top: 18px;
}

.row {
  display: grid;
  gap: 12px;
}

@media (min-width: 760px) {
  .row.cols-3 {
    grid-template-columns: 1fr 1fr 1fr;
  }
  .row.cols-2 {
    grid-template-columns: 1fr 1fr;
  }
}

input, select, textarea {
  width: 100%;
  box-sizing: border-box;
  border-radius: 12px;
  border: 1px solid #243244;
  background: #0e1520;
  color: var(--text);
  padding: 12px 12px;
  font-size: 15px;
  transition: all 0.2s ease;
}

input:focus, select:focus, textarea:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 2px rgba(58, 134, 255, 0.2);
}

button, .btn {
  width: auto;
  display: inline-grid;
  place-items: center;
  padding: 12px 16px;
  border-radius: 12px;
  border: 1px solid #e6c76e;
  background: linear-gradient(180deg, #fff9e6, #e6c76e);
  color: #191919;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.2s ease;
}

.btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(212, 175, 55, 0.3);
}

.btn:disabled {
  opacity: .6;
  cursor: not-allowed;
  transform: none;
}

.h2 {
  font-size: 1.3rem;
  margin: 0 0 1rem;
  font-weight: 700;
  color: #ffe084;
  display: flex;
  align-items: center;
  gap: 10px;
}

.h2::before {
  content: "";
  display: block;
  width: 4px;
  height: 20px;
  background: var(--brand);
  border-radius: 2px;
}

.muted {
  color: #9aa3b2;
}

footer {
  color: #6c7b8c;
  font-size: .85rem;
  text-align: center;
  padding: 30px 0;
  margin-top: 30px;
}

/* å…«å­—ç»“æœæ ·å¼ */
.pillars {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 10px;
  margin-top: 8px;
}

.pillar {
  background: #0f1624;
  border: 1px solid #253245;
  border-radius: 12px;
  padding: 14px 10px;
  text-align: center;
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.pillar::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: var(--brand);
  opacity: 0;
  transition: opacity 0.3s ease;
}

.pillar:hover {
  transform: translateY(-3px);
  border-color: var(--brand);
}

.pillar:hover::before {
  opacity: 1;
}

.pillar .tit {
  color: #9aa3b2;
  font-size: .85rem;
  margin-bottom: 6px;
}

.pillar .gz {
  font-size: 1.5rem;
  font-weight: 700;
  letter-spacing: .05em;
  color: var(--gold2);
}

.bazi-table {
  width: 100%;
  border-collapse: collapse;
  margin: 15px 0;
  background: #0f1624;
  border-radius: 8px;
  overflow: hidden;
}

.bazi-table th, .bazi-table td {
  padding: 12px 15px;
  border: 1px solid #253245;
  text-align: center;
}

.bazi-table th {
  background: rgba(212, 175, 55, 0.1);
  color: var(--gold2);
  font-weight: 600;
}

.bars {
  display: grid;
  gap: 8px;
  margin-top: 10px;
}

.bar {
  height: 10px;
  background: #0d1420;
  border: 1px solid #233146;
  border-radius: 999px;
  overflow: hidden;
  position: relative;
}

.bar i {
  display: block;
  height: 100%;
  background: linear-gradient(90deg, #ffe084, #f2d27a);
  transition: width 1s ease;
}

.bar-label {
  display: flex;
  justify-content: space-between;
  margin-top: 4px;
  font-size: 0.85rem;
}

.analysis-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 20px;
  margin: 20px 0;
}

.analysis-card {
  background: rgba(15, 22, 36, 0.7);
  border: 1px solid #253245;
  border-radius: 12px;
  padding: 20px;
}

.analysis-card-title {
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--gold2);
  margin-bottom: 12px;
}

/* æ—¶é—´ä¸è¯¦é€‰é¡¹æ ·å¼ */
.time-unknown-container {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-top: 8px;
}

.time-unknown-checkbox {
  width: 16px;
  height: 16px;
}

.time-unknown-label {
  font-size: 0.9rem;
  color: var(--muted);
}

.time-input-container {
  transition: all 0.3s ease;
}

.time-input-container.disabled {
  opacity: 0.5;
  pointer-events: none;
}

/* ChatGPT å¯¹è¯çª—å£æ ·å¼ */
.chatgpt-window {
  position: fixed;
  bottom: 20px;
  right: 20px;
  width: 380px;
  height: 500px;
  background: var(--card);
  border: 1px solid #1f2a36;
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  display: none;
  flex-direction: column;
  z-index: 1000;
}

.chatgpt-header {
  padding: 15px;
  border-bottom: 1px solid #1f2a36;
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: rgba(15, 22, 36, 0.9);
}

.chatgpt-title {
  font-weight: 600;
  color: var(--gold2);
  display: flex;
  align-items: center;
  gap: 8px;
}

.chatgpt-close {
  background: none;
  border: none;
  color: var(--muted);
  font-size: 1.2rem;
  cursor: pointer;
  padding: 5px;
}

.chatgpt-body {
  flex: 1;
  padding: 15px;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.chat-message {
  max-width: 85%;
  padding: 10px 15px;
  border-radius: 15px;
  line-height: 1.4;
}

.chat-message.user {
  align-self: flex-end;
  background: var(--accent);
  color: white;
}

.chat-message.bot {
  align-self: flex-start;
  background: rgba(15, 22, 36, 0.7);
  border: 1px solid #253245;
}

.chatgpt-input {
  padding: 15px;
  border-top: 1px solid #1f2a36;
  display: flex;
  gap: 10px;
}

.chatgpt-input input {
  flex: 1;
  padding: 10px 15px;
}

.chatgpt-send {
  padding: 10px 15px;
  background: var(--accent);
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
}

.chatgpt-fab {
  position: fixed;
  bottom: 20px;
  right: 20px;
  width: 60px;
  height: 60px;
  background: linear-gradient(135deg, #10a37f, #1a7f64);
  border: none;
  border-radius: 50%;
  color: white;
  font-size: 1.5rem;
  cursor: pointer;
  box-shadow: var(--shadow);
  z-index: 999;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* ç™»å½•åŒºåŸŸæ ·å¼ */
.astro-auth {
  margin-top: 30px;
}

.auth-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
}

.panel {
  background: rgba(15, 22, 36, 0.7);
  border: 1px solid #253245;
  border-radius: 12px;
  padding: 20px;
}

.panel .head {
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--gold2);
  margin-bottom: 15px;
  text-align: center;
}

.btn.block {
  width: 100%;
  margin-bottom: 10px;
}

.btn.ghost {
  background: transparent;
  border: 1px solid var(--muted);
  color: var(--text);
}

.btn-gold {
  background: linear-gradient(180deg, #fff9e6, #e6c76e);
  color: #191919;
  border: 1px solid #e6c76e;
}

.spacer {
  height: 15px;
}

.error {
  color: var(--danger);
  background: rgba(255, 90, 95, 0.1);
  padding: 10px;
  border-radius: 8px;
  margin-top: 10px;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

.loading {
  display: inline-block;
  width: 20px;
  height: 20px;
  border: 3px solid rgba(255, 255, 255, 0.3);
  border-radius: 50%;
  border-top-color: var(--brand);
  animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

.error-message {
  background: rgba(255, 90, 95, 0.1);
  border: 1px solid var(--danger);
  border-radius: 8px;
  padding: 12px;
  margin: 10px 0;
  color: #ffb4b4;
}

/* ä¼šå‘˜æœåŠ¡å®¹å™¨æ ·å¼ä¿®å¤ */
.membership-section {
  max-width: 100%;
  box-sizing: border-box;
  padding: 15px;
  margin: 10px 0;
}

.vip-pricing {
  background: linear-gradient(135deg, #ffd700, #ffed4e);
  border-radius: 12px;
  padding: 20px;
  margin: 15px 0;
  text-align: center;
  border: 1px solid #e6c76e;
  box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
}

.vip-price {
  font-size: 2rem;
  font-weight: bold;
  color: #b8860b;
  margin: 10px 0;
}

.vip-features {
  list-style: none;
  padding: 0;
  margin: 15px 0;
}

.vip-features li {
  padding: 8px 0;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

/* å“åº”å¼å¸ƒå±€ä¿®å¤ */
@media (max-width: 768px) {
  .membership-section {
    padding: 10px;
    margin: 5px 0;
  }
  
  .vip-pricing {
    padding: 15px;
  }
  
  .vip-price {
    font-size: 1.5rem;
  }
}  
</style>
</head>

<body>
<header>
  <div class="head-inner container">
    <div class="brand">
      <div class="brand-badge">5X</div>
      <div>
        <div class="title">å‘½ç†ä¾›é—¨ Â· å…«å­—ç®€è¯„</div>
        <div class="subtitle">å…è´¹ç‰ˆ Â· å…¨é¢ä¸æ·±ï½œVIP è§£é”æµå¹´/å¤§è¿/æ‹©æ—¥/å‘½å</div>
      </div>
    </div>
    <div class="lang">
      <label for="langSelect">è¯­è¨€</label>
      <select id="langSelect" aria-label="Language">
        <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
        <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
        <option value="en">English</option>
        <option value="ms">Bahasa Melayu</option>
      </select>
    </div>
  </div>
</header>

<main class="container">
  <section class="card">
    <div class="h2">å…«å­—å‘½ç† Â· å¿«é€Ÿæ’ç›˜</div>
    <div class="row cols-3">
      <div>
        <label class="muted">å§“åï¼ˆå¯é€‰ï¼‰</label>
        <input id="name" placeholder="ä½ çš„ç§°å‘¼ï¼ˆç”¨äºä¸ªæ€§åŒ–ï¼‰">
      </div>
      <div>
        <label class="muted">æ€§åˆ«</label>
        <select id="gender">
          <option value="">ä¸é€éœ²</option>
          <option value="male">ç”·æ€§</option>
          <option value="female">å¥³æ€§</option>
          <option value="other">å…¶ä»–</option>
        </select>
      </div>
      <div>
        <label class="muted">å†æ³•</label>
        <div style="display:flex; gap:8px; align-items:center;">
          <select id="calendar">
            <option value="gregorian">é˜³å† / Gregorian</option>
            <option value="lunar">å†œå† / Lunar</option>
          </select>
          <label id="leapWrap" style="display:none; align-items:center; gap:6px; margin-left:8px;">
            <input type="checkbox" id="isLeap"> é—°æœˆ
          </label>
        </div>
      </div>
    </div>

    <div class="row cols-3" style="margin-top:10px">
      <div>
        <label class="muted">å‡ºç”Ÿæ—¥æœŸ</label>
        <input type="date" id="birthdate">
      </div>
      <div>
        <label class="muted">å‡ºç”Ÿæ—¶é—´</label>
        <div class="time-input-container" id="timeInputContainer">
          <input type="time" id="birthtime" value="12:00">
        </div>
        <div class="time-unknown-container">
          <input type="checkbox" id="timeUnknown" class="time-unknown-checkbox">
          <label for="timeUnknown" class="time-unknown-label">å‡ºç”Ÿæ—¶é—´ä¸è¯¦</label>
        </div>
      </div>
      <div style="display:flex;align-items:flex-end">
<!-- ç¡®ä¿æŒ‰é’®æœ‰æ­£ç¡®çš„ID -->
<button class="btn" id="genBtn">
  <span id="genBtnText">ç”Ÿæˆå…«å­—</span>
  <span id="genBtnLoading" class="loading" style="display:none"></span>
</button>
      </div>
    </div>

    <div class="muted" style="margin-top:6px">æç¤ºï¼šä¸´æ—¶é»˜è®¤ä¸œå…«åŒºï¼ˆUTC+8ï¼‰ã€‚åç»­å°†æ”¯æŒæŒ‰å‡ºç”Ÿåœ°æ¢ç®—ã€‚</div>
    <div id="error" class="error-message" style="display:none"></div>
  </section>

  <section id="result" style="display:none;">
    <!-- å…«å­—å‘½ç›˜ -->
    <div class="card section">
      <div class="h2">æ‚¨çš„ç”Ÿè¾°å…«å­—å‘½ç›˜</div>
      <div class="pillars" id="bazi-pillars"></div>
      <div class="muted" id="bazi-date"></div>
      
      <table class="bazi-table">
        <thead>
          <tr>
            <th></th>
            <th>å¹´æŸ±</th>
            <th>æœˆæŸ±</th>
            <th>æ—¥æŸ±</th>
            <th>æ—¶æŸ±</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>å¤©å¹²</td>
            <td id="year-stem">-</td>
            <td id="month-stem">-</td>
            <td id="day-stem">-</td>
            <td id="hour-stem">-</td>
          </tr>
          <tr>
            <td>åœ°æ”¯</td>
            <td id="year-branch">-</td>
            <td id="month-branch">-</td>
            <td id="day-branch">-</td>
            <td id="hour-branch">-</td>
          </tr>
          <tr>
            <td>äº”è¡Œ</td>
            <td id="year-element">-</td>
            <td id="month-element">-</td>
            <td id="day-element">-</td>
            <td id="hour-element">-</td>
          </tr>
          <tr>
            <td>çº³éŸ³</td>
            <td id="year-nayin">-</td>
            <td id="month-nayin">-</td>
            <td id="day-nayin">-</td>
            <td id="hour-nayin">-</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- äº”è¡Œåˆ†æ -->
    <div class="card section">
      <div class="h2">äº”è¡Œèƒ½é‡åˆ†æ</div>
      <div class="bars">
        <div class="bar"><i id="bar-wood"></i></div>
        <div class="bar-label"><span>æœ¨</span><span id="pct-wood">0%</span></div>
        <div class="bar"><i id="bar-fire"></i></div>
        <div class="bar-label"><span>ç«</span><span id="pct-fire">0%</span></div>
        <div class="bar"><i id="bar-earth"></i></div>
        <div class="bar-label"><span>åœŸ</span><span id="pct-earth">0%</span></div>
        <div class="bar"><i id="bar-metal"></i></div>
        <div class="bar-label"><span>é‡‘</span><span id="pct-metal">0%</span></div>
        <div class="bar"><i id="bar-water"></i></div>
        <div class="bar-label"><span>æ°´</span><span id="pct-water">0%</span></div>
      </div>
      <div id="bazi-elements-balance" class="muted" style="margin-top:8px"></div>
    </div>

    <!-- è¯¦ç»†åˆ†æ -->
    <div class="card section">
      <div class="h2">å‘½ç†è¯¦ç»†åˆ†æ</div>
      <div class="analysis-grid">
        <div class="analysis-card">
          <div class="analysis-card-title">ğŸ“… æ—¥æŸ±å‘½ç†</div>
          <div id="day-pillar-analysis">æ ¹æ®æ‚¨çš„å…«å­—æ—¥æŸ±è¿›è¡Œæ·±åº¦åˆ†æ...</div>
        </div>
        <div class="analysis-card">
          <div class="analysis-card-title">ğŸ å¹´å‘½ç”Ÿè‚–</div>
          <div id="zodiac-analysis">æ ¹æ®æ‚¨çš„å‡ºç”Ÿå¹´ä»½åˆ†æç”Ÿè‚–ç‰¹æ€§...</div>
        </div>
        <div class="analysis-card">
          <div class="analysis-card-title">ğŸ’¼ äº‹ä¸šè´¢è¿</div>
          <div id="career-analysis">åˆ†ææ‚¨çš„äº‹ä¸šå‘å±•æ–¹å‘å’Œè´¢è¿è¶‹åŠ¿...</div>
        </div>
        <div class="analysis-card">
          <div class="analysis-card-title">ğŸ¤ äººé™…å…³ç³»</div>
          <div id="relationship-analysis">åˆ†ææ‚¨çš„å§»ç¼˜å’Œäººé™…å…³ç³»...</div>
        </div>
      </div>
    </div>

    <!-- VIP åŒºåŸŸ -->
    <div class="card section">
      <div class="h2">ğŸŒ™ ä¼šå‘˜åŒºåŸŸ VIP Segment</div>
      
      <div class="row cols-2">
        <div>
          <h4 style="color:var(--gold2); margin-bottom:10px;">ğŸ— å‘½ç†ç©ºé—´ä¸“å±å†…å®¹</h4>
          <ul style="color:var(--muted); line-height:1.8; font-size:0.9rem;">
            <li>å§»ç¼˜æ–¹å‘ï¼šæ‹çˆ±ç¼˜åˆ†ã€å©šå§»èµ°åŠ¿</li>
            <li>äº‹ä¸šæ–¹å‘ï¼šèŒåœºå‘å±•ã€åˆ›ä¸šæ½œåŠ›</li>
            <li>è´¢è¿æ–¹å‘ï¼šè´¢ä½åˆ†æã€ç†è´¢æ—¶æœº</li>
            <li>å® ç‰©å‘½ç†ï¼šä¼´ä¾£åŠ¨ç‰©çš„æ€§æ ¼ä¸ç¼˜åˆ†</li>
            <li>åˆç›˜åˆ†æï¼šå©šæœŸæ‹©æ—¥ã€æ–°ç”Ÿæ‹©æ—¶</li>
            <li>æµ‹ååˆ†æï¼šå…¬å¸åã€å®å®åã€å‘½åæ”¹è¿</li>
            <li>è´¢ä½åˆç›˜ï¼šä½å®¶ / åŠå…¬å®¤åŠ¨çº¿é…åˆ</li>
          </ul>
        </div>
        
        <div>
          <h4 style="color:var(--gold2); margin-bottom:10px;">ğŸŒ™ å¿ƒæ€œç©ºé—´ä¸“å±å†…å®¹</h4>
          <ul style="color:var(--muted); line-height:1.8; font-size:0.9rem;">
            <li>çµæ€§è®°å½•ï¼šç…§ç‰‡ã€æ¢¦å¢ƒã€å£°éŸ³ã€æ„¿æœ›ç¥ˆç¥·</li>
            <li>å‘½ç†è¯¾ç¨‹ï¼šå…«å­— / å¡”ç½— / å æ˜Ÿ / çµæ•° / äººç±»å›¾</li>
            <li>å®¶æ—çºªå¿µç³»ç»Ÿï¼šäº²äººçµæ€§çºªå¿µ & å»¶ç»­</li>
            <li>æ¯å‘¨èƒ½é‡ç»ƒä¹  / ç¥æ˜ä»ªå¼ä»»åŠ¡</li>
            <li>èƒ½é‡å•†åŸä¸“å±æŠ˜æ‰£ & å¾¡å®ˆè®¢åˆ¶</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- ç™»å½•/æ³¨å†ŒåŒºåŸŸ -->
  <section class="astro-auth">
    <div class="auth-grid">
      <!-- å·¦ä¾§ï¼šè¾“å…¥ + æ³¨å†Œ/ç™»å½• -->
      <div class="panel">
        <div class="head">è´¦æˆ·ç™»å½• / æ³¨å†Œ</div>
        <div class="body">
          <!-- ç‹¬ç«‹è¾“å…¥åŒºï¼ˆç™»å½•/æ³¨å†Œå…±äº«è¿™äº›è¾“å…¥ï¼‰ -->
          <div class="row" id="authFields">
            <input
              id="email"
              type="email"
              inputmode="email"
              autocomplete="email"
              placeholder="é‚®ç®± Email"
              required
            />

            <input
              id="password"
              type="password"
              autocomplete="new-password"
              placeholder="å¯†ç  Passwordï¼ˆè‡³å°‘8ä½ï¼Œå«å¤§å°å†™æ•°å­—ç¬¦å·ï¼‰"
              required
            />
          </div>

          <div class="spacer"></div>

          <!-- ç™»å½•è¡¨å•ï¼ˆå¤ç”¨ä¸Šæ–¹ä¸¤æ ¼è¾“å…¥ï¼‰ -->
          <form id="loginForm" class="row one">
            <button class="btn block" id="loginBtn" type="submit">ç™»å…¥è´¦æˆ·</button>
          </form>

          <div class="spacer"></div>

          <!-- é‡è®¾å¯†ç ï¼ˆæŒ‰é’®éæäº¤ï¼‰ -->
          <div class="row one">
            <button class="btn ghost block" id="resetBtn" type="button">ğŸ”‘ é‡è®¾å¯†ç </button>
          </div>

          <div class="spacer"></div>

          <!-- æ³¨å†Œè¡¨å•ï¼ˆå¤ç”¨ä¸Šæ–¹ä¸¤æ ¼è¾“å…¥ï¼‰ -->
          <form class="row one" id="registerForm">
            <button class="btn block" id="registerBtn" type="submit">æ³¨å†Œè´¦æˆ·</button>
          
          <div class="muted">
          æ³¨å†Œè´¦å·èµ é€ä¸€æ¬¡å…è´¹ä½“éªŒ
          </div>  

          <div class="spacer"></div>

          <div class="error" id="authError" style="display:none"></div>
        </div>
      </div>
      </form>
      
      <!-- å³ä¾§ï¼šä¼šå‘˜ä¸è¿”å› -->
      <div class="panel">
        <div class="head">ä¼šå‘˜æœåŠ¡</div>
        <div class="body">
          <div class="row one">
            <a class="btn btn-gold block" href="https://yourshopifyshop.com/products/monthly-vip" target="_blank" rel="noopener noreferrer">ğŸ’ å‡çº§ä¸º VIPï¼ˆæœˆè´¹ï¼‰</a>
          </div>

          <div class="spacer"></div>

          <div class="row one">
            <a class="btn ghost block" href="https://yourshopifyshop.myshopify.com" target="_blank" rel="noopener noreferrer">â† è¿”å›å‘½ç†å•†åŸ</a>
          </div>

          <div class="spacer"></div>
          <div class="muted">
            $9.9 / æœˆè´¹ VIPï¼ˆå‘½ç†ç©ºé—´ + å¿ƒæ€œç©ºé—´ + çµæ€§è¯¾ç¨‹ï¼‰
          </div>
        </div>
      </div>
    </div>
  </section>
</main>

<footer>Â© 5XLiving â€¢ Astro Sanctuary</footer>

<!-- ChatGPT å¯¹è¯çª—å£ -->
<button class="chatgpt-fab" id="chatgptFab">ğŸ’¬</button>
<div class="chatgpt-window" id="chatgptWindow">
  <div class="chatgpt-header">
    <div class="chatgpt-title">
      <span>ğŸ’¬ å¿ƒæ€œç®¡å®¶</span>
    </div>
    <button class="chatgpt-close" id="chatgptClose">Ã—</button>
  </div>
  <div class="chatgpt-body" id="chatgptBody">
    <div class="chat-message bot">
      æ‚¨å¥½ï¼æˆ‘æ˜¯å¿ƒæ€œç®¡å®¶ï¼Œå¯ä»¥ä¸ºæ‚¨è§£ç­”å…«å­—å‘½ç†ç›¸å…³é—®é¢˜ã€‚è¯·é—®æœ‰ä»€ä¹ˆå¯ä»¥å¸®æ‚¨çš„ï¼Ÿ
    </div>
  </div>
  <div class="chatgpt-input">
    <input type="text" id="chatgptInput" placeholder="è¾“å…¥æ‚¨çš„é—®é¢˜...">
    <button class="chatgpt-send" id="chatgptSend">å‘é€</button>
  </div>
</div>

<script>
// å…«å­—è®¡ç®—å™¨ç±»
// å…«å­—è®¡ç®—å™¨ç±» - ä¿®å¤ç‰ˆæœ¬
class BaziCalculator {
  constructor() {
    this.HEAVENLY_STEMS = ['ç”²', 'ä¹™', 'ä¸™', 'ä¸', 'æˆŠ', 'å·±', 'åºš', 'è¾›', 'å£¬', 'ç™¸'];
    this.EARTHLY_BRANCHES = ['å­', 'ä¸‘', 'å¯…', 'å¯', 'è¾°', 'å·³', 'åˆ', 'æœª', 'ç”³', 'é…‰', 'æˆŒ', 'äº¥'];
    this.ZODIAC = ['é¼ ', 'ç‰›', 'è™', 'å…”', 'é¾™', 'è›‡', 'é©¬', 'ç¾Š', 'çŒ´', 'é¸¡', 'ç‹—', 'çŒª'];
    this.NAYIN = ['æµ·ä¸­é‡‘', 'ç‚‰ä¸­ç«', 'å¤§æ—æœ¨', 'è·¯æ—åœŸ', 'å‰‘é”‹é‡‘', 'å±±å¤´ç«', 'æ¶§ä¸‹æ°´', 'åŸå¤´åœŸ', 'ç™½èœ¡é‡‘', 'æ¨æŸ³æœ¨', 'æ³‰ä¸­æ°´', 'å±‹ä¸ŠåœŸ', 'éœ¹é›³ç«', 'æ¾æŸæœ¨', 'é•¿æµæ°´', 'ç ‚çŸ³é‡‘', 'å±±ä¸‹ç«', 'å¹³åœ°æœ¨', 'å£ä¸ŠåœŸ', 'é‡‘ç®”é‡‘', 'ä½›ç¯ç«', 'å¤©æ²³æ°´', 'å¤§é©¿åœŸ', 'é’—é’é‡‘', 'æ¡‘æŸ˜æœ¨', 'å¤§æºªæ°´', 'æ²™ä¸­åœŸ', 'å¤©ä¸Šç«', 'çŸ³æ¦´æœ¨', 'å¤§æµ·æ°´'];
  }

  // è®¡ç®—å¹´æŸ± - ä¿æŒåŸæ ·
  calculateYearPillar(year) {
    const stemIndex = (year - 4) % 10;
    const branchIndex = (year - 4) % 12;
    return {
      stem: this.HEAVENLY_STEMS[stemIndex],
      branch: this.EARTHLY_BRANCHES[branchIndex],
      zodiac: this.ZODIAC[branchIndex]
    };
  }

  // ä¿®å¤æœˆæŸ±è®¡ç®— - å…³é”®ä¿®å¤ï¼
  calculateMonthPillar(year, month) {
    // æœˆæ”¯å›ºå®šå¯¹åº”æœˆä»½
    const branchMap = { 
      1: 'å¯…', 2: 'å¯', 3: 'è¾°', 4: 'å·³', 5: 'åˆ', 6: 'æœª', 
      7: 'ç”³', 8: 'é…‰', 9: 'æˆŒ', 10: 'äº¥', 11: 'å­', 12: 'ä¸‘' 
    };
    const branch = branchMap[month];
    
    const yearStem = this.calculateYearPillar(year).stem;
    const yearStemIndex = this.HEAVENLY_STEMS.indexOf(yearStem);
    
    // ä¿®æ­£çš„æœˆå¹²èµ·å§‹è¡¨ - å…³é”®ä¿®å¤ï¼
    const monthStartMap = {
      0: 2,  // ç”²å¹´ï¼šä¸™ä½œé¦–
      1: 4,  // ä¹™å¹´ï¼šæˆŠä¸ºå¤´
      2: 6,  // ä¸™å¹´ï¼šå¯»åºšèµ·
      3: 8,  // ä¸å¹´ï¼šå£¬ä½é¡ºè¡Œæµ
      4: 0,  // æˆŠå¹´ï¼šç”²å¯…ä¹‹ä¸Šå¥½è¿½æ±‚ â† è¿™é‡Œåº”è¯¥æ˜¯0ï¼
      5: 2,  // å·±å¹´ï¼šä¸™ä½œé¦–
      6: 4,  // åºšå¹´ï¼šæˆŠä¸ºå¤´
      7: 6,  // è¾›å¹´ï¼šå¯»åºšèµ·
      8: 8,  // å£¬å¹´ï¼šå£¬ä½é¡ºè¡Œæµ
      9: 0   // ç™¸å¹´ï¼šç”²å¯…ä¹‹ä¸Šå¥½è¿½æ±‚
    };
    
    const startIndex = monthStartMap[yearStemIndex];
    const stemIndex = (startIndex + month - 1) % 10;
    
    return {
      stem: this.HEAVENLY_STEMS[stemIndex],
      branch: branch
    };
  }

  // ä¿®å¤æ—¥æŸ±è®¡ç®— - ä½¿ç”¨æ›´å‡†ç¡®çš„ç®—æ³•
  calculateDayPillar(year, month, day) {
    // ä½¿ç”¨å·²çŸ¥å‡†ç¡®çš„åŸºå‡†æ—¥ï¼š1900å¹´1æœˆ31æ—¥ä¸ºç”²åˆæ—¥
    const baseDate = new Date(1900, 0, 31); // 1900-01-31 ç”²åˆæ—¥
    const targetDate = new Date(year, month - 1, day);
    
    // è®¡ç®—å¤©æ•°å·®
    const timeDiff = targetDate.getTime() - baseDate.getTime();
    const dayDiff = Math.floor(timeDiff / (1000 * 60 * 60 * 24));
    
    // ç”²åˆæ—¥çš„ç´¢å¼•ï¼šç”²=0, åˆ=6
    const baseStemIndex = 0;
    const baseBranchIndex = 6;
    
    // è®¡ç®—ç›®æ ‡æ—¥çš„å¹²æ”¯ç´¢å¼•
    let stemIndex = (baseStemIndex + dayDiff) % 10;
    let branchIndex = (baseBranchIndex + dayDiff) % 12;
    
    // å¤„ç†è´Ÿæ•°
    if (stemIndex < 0) stemIndex += 10;
    if (branchIndex < 0) branchIndex += 12;
    
    return {
      stem: this.HEAVENLY_STEMS[stemIndex],
      branch: this.EARTHLY_BRANCHES[branchIndex]
    };
  }

  // ä¿®å¤æ—¶æŸ±è®¡ç®—
  calculateHourPillar(dayStem, hour) {
    const branchMap = { 
      23: 'å­', 0: 'å­', 1: 'ä¸‘', 2: 'ä¸‘', 3: 'å¯…', 4: 'å¯…', 
      5: 'å¯', 6: 'å¯', 7: 'è¾°', 8: 'è¾°', 9: 'å·³', 10: 'å·³', 
      11: 'åˆ', 12: 'åˆ', 13: 'æœª', 14: 'æœª', 15: 'ç”³', 16: 'ç”³', 
      17: 'é…‰', 18: 'é…‰', 19: 'æˆŒ', 20: 'æˆŒ', 21: 'äº¥', 22: 'äº¥'
    };
    
    const branch = branchMap[hour];
    const dayStemIndex = this.HEAVENLY_STEMS.indexOf(dayStem);
    
    // ä¿®æ­£çš„æ—¶å¹²è®¡ç®—è¡¨
    const hourStartMap = {
      0: 0,  // ç”²æ—¥ï¼šç”²
      1: 2,  // ä¹™æ—¥ï¼šä¸™
      2: 4,  // ä¸™æ—¥ï¼šæˆŠ
      3: 6,  // ä¸æ—¥ï¼šåºš
      4: 8,  // æˆŠæ—¥ï¼šå£¬
      5: 0,  // å·±æ—¥ï¼šç”²
      6: 2,  // åºšæ—¥ï¼šä¸™
      7: 4,  // è¾›æ—¥ï¼šæˆŠ
      8: 6,  // å£¬æ—¥ï¼šåºš
      9: 8   // ç™¸æ—¥ï¼šå£¬
    };
    
    const startIndex = hourStartMap[dayStemIndex];
    const hourIndex = Math.floor((hour + 1) / 2) % 12;
    const stemIndex = (startIndex + hourIndex) % 10;
    
    return {
      stem: this.HEAVENLY_STEMS[stemIndex],
      branch: branch
    };
  }

  // è·å–äº”è¡Œ - ä¿æŒåŸæ ·
  getElement(stem, branch) {
    const stemElements = {
      'ç”²': 'æœ¨', 'ä¹™': 'æœ¨', 'ä¸™': 'ç«', 'ä¸': 'ç«',
      'æˆŠ': 'åœŸ', 'å·±': 'åœŸ', 'åºš': 'é‡‘', 'è¾›': 'é‡‘',
      'å£¬': 'æ°´', 'ç™¸': 'æ°´'
    };
    
    const branchElements = {
      'å­': 'æ°´', 'ä¸‘': 'åœŸ', 'å¯…': 'æœ¨', 'å¯': 'æœ¨',
      'è¾°': 'åœŸ', 'å·³': 'ç«', 'åˆ': 'ç«', 'æœª': 'åœŸ',
      'ç”³': 'é‡‘', 'é…‰': 'é‡‘', 'æˆŒ': 'åœŸ', 'äº¥': 'æ°´'
    };
    
    return `${stemElements[stem]}${branchElements[branch]}`;
  }

  // è·å–çº³éŸ³ - ä¿æŒåŸæ ·
  getNayin(stem, branch) {
    const stemIndex = this.HEAVENLY_STEMS.indexOf(stem);
    const branchIndex = this.EARTHLY_BRANCHES.indexOf(branch);
    const index = (stemIndex * 2 + branchIndex) % this.NAYIN.length;
    return this.NAYIN[index];
  }

  // åˆ†æäº”è¡Œå¹³è¡¡ - ä¿æŒåŸæ ·
  analyzeElements(bazi) {
    const elements = {
      'æœ¨': 0, 'ç«': 0, 'åœŸ': 0, 'é‡‘': 0, 'æ°´': 0
    };
    
    // ç»Ÿè®¡å¤©å¹²äº”è¡Œ
    for (let pillar of ['year', 'month', 'day', 'hour']) {
      const stem = bazi[pillar].stem;
      if (stem !== 'ï¼Ÿ') {
        const element = this.getElement(stem, 'å­').charAt(0);
        elements[element]++;
      }
    }
    
    // ç»Ÿè®¡åœ°æ”¯äº”è¡Œ
    for (let pillar of ['year', 'month', 'day', 'hour']) {
      const branch = bazi[pillar].branch;
      if (branch !== 'ï¼Ÿ') {
        const element = this.getElement('ç”²', branch).charAt(1);
        elements[element]++;
      }
    }
    
    return elements;
  }
}

// åˆå§‹åŒ–å…«å­—è®¡ç®—å™¨
const baziCalculator = new BaziCalculator();

// ç”Ÿæˆå…«å­—æŒ‰é’®ç‚¹å‡»äº‹ä»¶
document.getElementById('genBtn').addEventListener('click', function() {
  const birthdate = document.getElementById('birthdate').value;
  const birthtime = document.getElementById('birthtime').value;
  const timeUnknown = document.getElementById('timeUnknown').checked;
  
  if (!birthdate) {
    showError('è¯·é€‰æ‹©å‡ºç”Ÿæ—¥æœŸ');
    return;
  }
  
  // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
  document.getElementById('genBtnText').style.display = 'none';
  document.getElementById('genBtnLoading').style.display = 'inline-block';
  
  setTimeout(() => {
    try {
      // è§£ææ—¥æœŸå’Œæ—¶é—´
      const date = new Date(birthdate);
      const year = date.getFullYear();
      const month = date.getMonth() + 1;
      const day = date.getDate();
      
      let hour = 12;
      if (!timeUnknown && birthtime) {
        const timeParts = birthtime.split(':');
        hour = parseInt(timeParts[0]);
      }
      
      // è®¡ç®—å…«å­—
      const yearPillar = baziCalculator.calculateYearPillar(year);
      const monthPillar = baziCalculator.calculateMonthPillar(year, month);
      const dayPillar = baziCalculator.calculateDayPillar(year, month, day);
      const hourPillar = timeUnknown ? 
        { stem: 'ï¼Ÿ', branch: 'ï¼Ÿ' } : 
        baziCalculator.calculateHourPillar(dayPillar.stem, hour);
      
      const bazi = {
        year: yearPillar,
        month: monthPillar,
        day: dayPillar,
        hour: hourPillar
      };
      
      // æ˜¾ç¤ºç»“æœ
      displayBaziResult(bazi, year, month, day, hour, timeUnknown);
      
      // éšè—åŠ è½½çŠ¶æ€
      document.getElementById('genBtnText').style.display = 'inline';
      document.getElementById('genBtnLoading').style.display = 'none';
      
    } catch (error) {
      console.error('è®¡ç®—å…«å­—æ—¶å‡ºé”™:', error);
      showError('è®¡ç®—å…«å­—æ—¶å‡ºç°é”™è¯¯ï¼Œè¯·é‡è¯•');
      document.getElementById('genBtnText').style.display = 'inline';
      document.getElementById('genBtnLoading').style.display = 'none';
    }
  }, 1000);
});

// æ˜¾ç¤ºå…«å­—ç»“æœ
function displayBaziResult(bazi, year, month, day, hour, timeUnknown) {
  // æ˜¾ç¤ºç»“æœåŒºåŸŸ
  document.getElementById('result').style.display = 'block';
  
  // æ˜¾ç¤ºå…«å­—å››æŸ±
  const pillars = [
    { title: 'å¹´æŸ±', stem: bazi.year.stem, branch: bazi.year.branch },
    { title: 'æœˆæŸ±', stem: bazi.month.stem, branch: bazi.month.branch },
    { title: 'æ—¥æŸ±', stem: bazi.day.stem, branch: bazi.day.branch },
    { title: 'æ—¶æŸ±', stem: bazi.hour.stem, branch: bazi.hour.branch }
  ];
  
  const pillarsContainer = document.getElementById('bazi-pillars');
  pillarsContainer.innerHTML = '';
  
  pillars.forEach(pillar => {
    const pillarElement = document.createElement('div');
    pillarElement.className = 'pillar';
    pillarElement.innerHTML = `
      <div class="tit">${pillar.title}</div>
      <div class="gz">${pillar.stem}${pillar.branch}</div>
    `;
    pillarsContainer.appendChild(pillarElement);
  });
  
  // æ˜¾ç¤ºè¯¦ç»†è¡¨æ ¼
  document.getElementById('year-stem').textContent = bazi.year.stem;
  document.getElementById('year-branch').textContent = bazi.year.branch;
  document.getElementById('month-stem').textContent = bazi.month.stem;
  document.getElementById('month-branch').textContent = bazi.month.branch;
  document.getElementById('day-stem').textContent = bazi.day.stem;
  document.getElementById('day-branch').textContent = bazi.day.branch;
  document.getElementById('hour-stem').textContent = bazi.hour.stem;
  document.getElementById('hour-branch').textContent = bazi.hour.branch;
  
  // æ˜¾ç¤ºäº”è¡Œå’Œçº³éŸ³
  document.getElementById('year-element').textContent = baziCalculator.getElement(bazi.year.stem, bazi.year.branch);
  document.getElementById('month-element').textContent = baziCalculator.getElement(bazi.month.stem, bazi.month.branch);
  document.getElementById('day-element').textContent = baziCalculator.getElement(bazi.day.stem, bazi.day.branch);
  document.getElementById('hour-element').textContent = timeUnknown ? 'æœªçŸ¥' : baziCalculator.getElement(bazi.hour.stem, bazi.hour.branch);
  
  document.getElementById('year-nayin').textContent = baziCalculator.getNayin(bazi.year.stem, bazi.year.branch);
  document.getElementById('month-nayin').textContent = baziCalculator.getNayin(bazi.month.stem, bazi.month.branch);
  document.getElementById('day-nayin').textContent = baziCalculator.getNayin(bazi.day.stem, bazi.day.branch);
  document.getElementById('hour-nayin').textContent = timeUnknown ? 'æœªçŸ¥' : baziCalculator.getNayin(bazi.hour.stem, bazi.hour.branch);
  
  // æ˜¾ç¤ºæ—¥æœŸ
  document.getElementById('bazi-date').textContent = `å‡ºç”Ÿæ—¥æœŸ: ${year}å¹´${month}æœˆ${day}æ—¥ ${timeUnknown ? 'æ—¶é—´ä¸è¯¦' : hour + 'æ—¶'}`;
  
  // åˆ†æäº”è¡Œ
  const elements = baziCalculator.analyzeElements(bazi);
  updateElementBars(elements);
  
  // ç”Ÿæˆå‘½ç†åˆ†æ
  generateBaziAnalysis(bazi, elements, year);
  
  // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
  document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
}

// æ›´æ–°äº”è¡ŒæŸ±çŠ¶å›¾
function updateElementBars(elements) {
  const total = Object.values(elements).reduce((a, b) => a + b, 0);
  
  for (const [element, count] of Object.entries(elements)) {
    const percentage = total > 0 ? (count / total) * 100 : 0;
    const barElement = document.getElementById(`bar-${element}`);
    const pctElement = document.getElementById(`pct-${element}`);
    
    if (barElement) barElement.style.width = `${percentage}%`;
    if (pctElement) pctElement.textContent = `${percentage.toFixed(1)}%`;
  }
  
  // äº”è¡Œå¹³è¡¡åˆ†æ
  const balanceElement = document.getElementById('bazi-elements-balance');
  const maxElement = Object.keys(elements).reduce((a, b) => elements[a] > elements[b] ? a : b);
  const minElement = Object.keys(elements).reduce((a, b) => elements[a] < elements[b] ? a : b);
  
  balanceElement.textContent = `äº”è¡Œä¸­${maxElement}å…ƒç´ æœ€å¼ºï¼Œ${minElement}å…ƒç´ æœ€å¼±ã€‚`;
}

// ç”Ÿæˆå‘½ç†åˆ†æ
function generateBaziAnalysis(bazi, elements, year) {
  const name = document.getElementById('name').value || 'æ‚¨';
  
  // æ—¥æŸ±åˆ†æ
  const dayStemNames = {
    'ç”²': 'ç”²æœ¨', 'ä¹™': 'ä¹™æœ¨', 'ä¸™': 'ä¸™ç«', 'ä¸': 'ä¸ç«',
    'æˆŠ': 'æˆŠåœŸ', 'å·±': 'å·±åœŸ', 'åºš': 'åºšé‡‘', 'è¾›': 'è¾›é‡‘',
    'å£¬': 'å£¬æ°´', 'ç™¸': 'ç™¸æ°´'
  };
  
  document.getElementById('day-pillar-analysis').innerHTML = `
    <p>${name}çš„æ—¥ä¸»ä¸º<strong>${dayStemNames[bazi.day.stem]}</strong>ï¼Œä»£è¡¨å‘½ä¸»çš„æœ¬æ€§å’Œæ ¸å¿ƒç‰¹è´¨ã€‚</p>
    <p>æ—¥æŸ±${bazi.day.stem}${bazi.day.branch}ï¼Œçº³éŸ³${baziCalculator.getNayin(bazi.day.stem, bazi.day.branch)}ã€‚</p>
  `;
  
  // ç”Ÿè‚–åˆ†æ
  document.getElementById('zodiac-analysis').innerHTML = `
    <p>${name}çš„ç”Ÿè‚–ä¸º<strong>${bazi.year.zodiac}</strong>ï¼Œå…·æœ‰è¯¥ç”Ÿè‚–çš„å…¸å‹ç‰¹å¾ã€‚</p>
    <p>å¹´æŸ±${bazi.year.stem}${bazi.year.branch}ï¼Œçº³éŸ³${baziCalculator.getNayin(bazi.year.stem, bazi.year.branch)}ã€‚</p>
  `;
  
  // äº‹ä¸šè´¢è¿åˆ†æ
  document.getElementById('career-analysis').innerHTML = `
    <p>æ ¹æ®äº”è¡Œåˆ†æï¼Œ${name}çš„å‘½å±€ä¸­${getStrongestElement(elements)}å…ƒç´ è¾ƒä¸ºçªå‡ºã€‚</p>
    <p>é€‚åˆä»äº‹ä¸${getCareerAdvice(elements)}ç›¸å…³çš„è¡Œä¸šã€‚</p>
    <p>è´¢è¿æ–¹é¢ï¼Œ${getWealthAdvice(bazi.day.stem)}</p>
  `;
  
  // äººé™…å…³ç³»åˆ†æ
  document.getElementById('relationship-analysis').innerHTML = `
    <p>${name}åœ¨äººé™…å…³ç³»æ–¹é¢${getRelationshipAdvice(bazi.day.stem)}</p>
    <p>æ„Ÿæƒ…æ–¹é¢ï¼Œ${getLoveAdvice(bazi.day.stem, document.getElementById('gender').value)}</p>
  `;
}

// è¾…åŠ©åˆ†æå‡½æ•°
function getStrongestElement(elements) {
  return Object.keys(elements).reduce((a, b) => elements[a] > elements[b] ? a : b);
}

function getCareerAdvice(elements) {
  const strongest = getStrongestElement(elements);
  const careers = {
    'æœ¨': 'æ•™è‚²ã€æ–‡åŒ–ã€è‰ºæœ¯ã€åŒ»ç–—',
    'ç«': 'ç§‘æŠ€ã€èƒ½æºã€é¤é¥®ã€å¨±ä¹',
    'åœŸ': 'æˆ¿åœ°äº§ã€å»ºç­‘ã€å†œä¸šã€é‡‘è',
    'é‡‘': 'é‡‘å±ã€æœºæ¢°ã€æ³•å¾‹ã€ç®¡ç†',
    'æ°´': 'è´¸æ˜“ã€è¿è¾“ã€æ—…æ¸¸ã€æœåŠ¡'
  };
  return careers[strongest] || 'å¤šç§è¡Œä¸š';
}

function getWealthAdvice(dayStem) {
  const advice = {
    'ç”²': 'è´¢è¿ç¨³å®šï¼Œé€‚åˆé•¿æœŸæŠ•èµ„',
    'ä¹™': 'è´¢è¿èµ·ä¼ï¼Œéœ€è¦è°¨æ…ç†è´¢',
    'ä¸™': 'è´¢è¿æ—ºç››ï¼Œä½†éœ€é˜²ç ´è´¢',
    'ä¸': 'è´¢è¿å¹³ç¨³ï¼Œé€‚åˆç¨³å¥æŠ•èµ„',
    'æˆŠ': 'è´¢è¿ä¸°åšï¼Œä½†æ¥å¾—è¾ƒæ…¢',
    'å·±': 'è´¢è¿ç¨³å®šï¼Œé€‚åˆç§¯ç´¯',
    'åºš': 'è´¢è¿èµ·ä¼ï¼Œéœ€è¦æŠŠæ¡æ—¶æœº',
    'è¾›': 'è´¢è¿è‰¯å¥½ï¼Œé€‚åˆç²¾ç»†ç»è¥',
    'å£¬': 'è´¢è¿æµåŠ¨ï¼Œé€‚åˆçµæ´»æŠ•èµ„',
    'ç™¸': 'è´¢è¿éšç§˜ï¼Œéœ€è¦è€å¿ƒç­‰å¾…'
  };
  return advice[dayStem] || 'è´¢è¿å¹³ç¨³ï¼Œéœ€è¦åˆç†è§„åˆ’';
}

function getRelationshipAdvice(dayStem) {
  const advice = {
    'ç”²': 'æ€§æ ¼ç›´çˆ½ï¼Œäººé™…å…³ç³»è‰¯å¥½',
    'ä¹™': 'æ¸©å’Œä½“è´´ï¼Œäººç¼˜ä¸é”™',
    'ä¸™': 'çƒ­æƒ…å¼€æœ—ï¼Œäº¤å‹å¹¿æ³›',
    'ä¸': 'ç»†è…»æ•æ„Ÿï¼Œéœ€è¦æ›´å¤šä¿¡ä»»',
    'æˆŠ': 'ç¨³é‡å¯é ï¼Œæœ‹å‹å¿ è¯š',
    'å·±': 'åŒ…å®¹å¤§åº¦ï¼Œäººç¼˜å¾ˆå¥½',
    'åºš': 'åˆšå¼ºæœæ–­ï¼Œéœ€è¦æ›´å¤šæŸ”å’Œ',
    'è¾›': 'ç²¾æ˜ç»†è‡´ï¼Œäº¤å‹è°¨æ…',
    'å£¬': 'éšå’ŒåŒ…å®¹ï¼Œäººç¼˜å¹¿æ³›',
    'ç™¸': 'å†…å‘æ•æ„Ÿï¼Œéœ€è¦ä¸»åŠ¨ç¤¾äº¤'
  };
  return advice[dayStem] || 'äººé™…å…³ç³»å¹³ç¨³ï¼Œéœ€è¦ç”¨å¿ƒç»è¥';
}

function getLoveAdvice(dayStem, gender) {
  const baseAdvice = {
    'ç”²': 'æ„Ÿæƒ…ä¸“ä¸€ï¼Œé‡è§†å®¶åº­',
    'ä¹™': 'æ„Ÿæƒ…ç»†è…»ï¼Œéœ€è¦å®‰å…¨æ„Ÿ',
    'ä¸™': 'æ„Ÿæƒ…çƒ­çƒˆï¼Œè¿½æ±‚æµªæ¼«',
    'ä¸': 'æ„Ÿæƒ…æ·±æ²‰ï¼Œéœ€è¦ç†è§£',
    'æˆŠ': 'æ„Ÿæƒ…ç¨³å®šï¼Œé‡è§†è´£ä»»',
    'å·±': 'æ„Ÿæƒ…åŒ…å®¹ï¼Œå–„äºä»˜å‡º',
    'åºš': 'æ„Ÿæƒ…åˆšå¼ºï¼Œéœ€è¦æ¸©æŸ”',
    'è¾›': 'æ„Ÿæƒ…ç²¾è‡´ï¼Œè¿½æ±‚å®Œç¾',
    'å£¬': 'æ„Ÿæƒ…éšå’Œï¼Œé€‚åº”æ€§å¼º',
    'ç™¸': 'æ„Ÿæƒ…æ•æ„Ÿï¼Œéœ€è¦å‘µæŠ¤'
  };
  
  let advice = baseAdvice[dayStem] || 'æ„Ÿæƒ…å¹³ç¨³ï¼Œéœ€è¦ç”¨å¿ƒç»è¥';
  
  if (gender === 'male') {
    advice += 'ï¼Œä½œä¸ºç”·æ€§ï¼Œåœ¨æ„Ÿæƒ…ä¸­åº”è¯¥ä¸»åŠ¨æ‰¿æ‹…è´£ä»»ã€‚';
  } else if (gender === 'female') {
    advice += 'ï¼Œä½œä¸ºå¥³æ€§ï¼Œåœ¨æ„Ÿæƒ…ä¸­åº”è¯¥ä¿æŒç‹¬ç«‹è‡ªä¿¡ã€‚';
  }
  
  return advice;
}

// é”™è¯¯æ˜¾ç¤ºå‡½æ•°
function showError(message) {
  const errorElement = document.getElementById('error');
  errorElement.textContent = message;
  errorElement.style.display = 'block';
  
  setTimeout(() => {
    errorElement.style.display = 'none';
  }, 5000);
}

// ChatGPT å¯¹è¯çª—å£åŠŸèƒ½
document.getElementById('chatgptFab').addEventListener('click', function() {
  document.getElementById('chatgptWindow').style.display = 'flex';
});

document.getElementById('chatgptClose').addEventListener('click', function() {
  document.getElementById('chatgptWindow').style.display = 'none';
});

document.getElementById('chatgptSend').addEventListener('click', sendMessage);
document.getElementById('chatgptInput').addEventListener('keypress', function(e) {
  if (e.key === 'Enter') {
    sendMessage();
  }
});

function sendMessage() {
  const input = document.getElementById('chatgptInput');
  const message = input.value.trim();
  
  if (!message) return;
  
  // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
  addChatMessage(message, 'user');
  input.value = '';
  
  // æ¨¡æ‹ŸAIå›å¤
  setTimeout(() => {
    const responses = [
      "æ ¹æ®å…«å­—åˆ†æï¼Œå»ºè®®å¤šå…³æ³¨äº‹ä¸šå‘å±•å’Œäººé™…å…³ç³»ã€‚",
      "ä»äº”è¡Œå¹³è¡¡æ¥çœ‹ï¼Œæ‚¨éœ€è¦åŠ å¼ºæ°´å…ƒç´ çš„èƒ½é‡ã€‚",
      "æ‚¨çš„å‘½ç†æ˜¾ç¤ºä»Šå¹´æœ‰è¾ƒå¥½çš„è´¢è¿æœºä¼šï¼Œå¯ä»¥æŠŠæ¡ã€‚",
      "æ„Ÿæƒ…æ–¹é¢ï¼Œä»Šå¹´æœ‰æœºä¼šé‡åˆ°åˆé€‚çš„ä¼´ä¾£ã€‚",
      "å¥åº·æ–¹é¢éœ€è¦æ³¨æ„è„¾èƒƒé—®é¢˜ï¼Œé¥®é£Ÿè¦è§„å¾‹ã€‚",
      "å»ºè®®å¤šæ¥è§¦è‡ªç„¶ï¼Œå¹³è¡¡èº«å¿ƒèƒ½é‡ã€‚",
      "äº‹ä¸šå‘å±•æ–¹é¢ï¼Œé€‚åˆä¸å›¢é˜Ÿåˆä½œå…±åŒè¿›æ­¥ã€‚"
    ];
    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
    addChatMessage(randomResponse, 'bot');
  }, 1000);
}

function addChatMessage(message, sender) {
  const chatBody = document.getElementById('chatgptBody');
  const messageElement = document.createElement('div');
  messageElement.className = `chat-message ${sender}`;
  messageElement.textContent = message;
  chatBody.appendChild(messageElement);
  chatBody.scrollTop = chatBody.scrollHeight;
}

// ç™»å½•/æ³¨å†ŒåŠŸèƒ½
document.getElementById('loginForm').addEventListener('submit', function(e) {
  e.preventDefault();
  const email = document.getElementById('email').value;
  const password = document.getElementById('password').value;
  
  if (!email || !password) {
    showAuthError('è¯·è¾“å…¥é‚®ç®±å’Œå¯†ç ');
    return;
  }
  
  // æ¨¡æ‹Ÿç™»å½•æˆåŠŸ
  simulateLogin(email);
});

document.getElementById('registerForm').addEventListener('submit', function(e) {
  e.preventDefault();
  const email = document.getElementById('email').value;
  const password = document.getElementById('password').value;
  
  if (!email || !password) {
    showAuthError('è¯·è¾“å…¥é‚®ç®±å’Œå¯†ç ');
    return;
  }
  
  if (password.length < 8) {
    showAuthError('å¯†ç è‡³å°‘éœ€è¦8ä½å­—ç¬¦');
    return;
  }
  
  // æ¨¡æ‹Ÿæ³¨å†ŒæˆåŠŸå¹¶èµ é€VIPä½“éªŒ
  simulateRegistration(email);
});

document.getElementById('resetBtn').addEventListener('click', function() {
  const email = prompt('è¯·è¾“å…¥æ‚¨çš„é‚®ç®±åœ°å€ï¼š');
  if (email) {
    alert('å¯†ç é‡ç½®é“¾æ¥å·²å‘é€åˆ°æ‚¨çš„é‚®ç®±ï¼Œè¯·æŸ¥æ”¶ã€‚');
  }
});

function simulateLogin(email) {
  // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œåº”è¯¥è°ƒç”¨åç«¯API
  alert(`ç™»å½•æˆåŠŸï¼æ¬¢è¿å›æ¥ï¼Œ${email}`);
  // è¿™é‡Œå¯ä»¥è®¾ç½®ç™»å½•çŠ¶æ€ï¼Œè·³è½¬é¡µé¢ç­‰
}

function simulateRegistration(email) {
  // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œåº”è¯¥è°ƒç”¨åç«¯API
  alert(`æ³¨å†ŒæˆåŠŸï¼æ¬¢è¿ ${email}ï¼Œæ‚¨å·²è·å¾—24å°æ—¶VIPä½“éªŒæƒé™ã€‚`);
  // è¿™é‡Œå¯ä»¥è®¾ç½®ç™»å½•çŠ¶æ€ï¼Œè·³è½¬é¡µé¢ç­‰
}

function showAuthError(message) {
  const errorElement = document.getElementById('authError');
  errorElement.textContent = message;
  errorElement.style.display = 'block';
  
  setTimeout(() => {
    errorElement.style.display = 'none';
  }, 5000);
}

// ... å‰é¢çš„æ‰€æœ‰ä»£ç ä¿æŒä¸å˜ ...

// æ—¶é—´ä¸è¯¦å¤é€‰æ¡†äº‹ä»¶
document.getElementById('timeUnknown').addEventListener('change', function() {
  const timeInputContainer = document.getElementById('timeInputContainer');
  if (this.checked) {
    timeInputContainer.classList.add('disabled');
  } else {
    timeInputContainer.classList.remove('disabled');
  }
});

// åˆå§‹åŒ– - ä¿®å¤è¿™ä¸ªéƒ¨åˆ†
document.addEventListener('DOMContentLoaded', function() {
  // è®¾ç½®é»˜è®¤æ—¥æœŸä¸ºä»Šå¤©
  const today = new Date();
  const formattedDate = today.toISOString().split('T')[0];
  document.getElementById('birthdate').value = formattedDate;
  
  // é‡æ–°ç»‘å®šç”Ÿæˆå…«å­—æŒ‰é’®äº‹ä»¶
  const genBtn = document.getElementById('genBtn');
  if (genBtn) {
    // ç§»é™¤å¯èƒ½å­˜åœ¨çš„æ—§äº‹ä»¶ç›‘å¬å™¨
    genBtn.replaceWith(genBtn.cloneNode(true));
    
    // é‡æ–°è·å–æŒ‰é’®å¹¶ç»‘å®šäº‹ä»¶
    document.getElementById('genBtn').addEventListener('click', function() {
      console.log('ç”Ÿæˆå…«å­—æŒ‰é’®è¢«ç‚¹å‡»');
      
      const birthdate = document.getElementById('birthdate').value;
      const birthtime = document.getElementById('birthtime').value;
      const timeUnknown = document.getElementById('timeUnknown').checked;
      
      if (!birthdate) {
        showError('è¯·é€‰æ‹©å‡ºç”Ÿæ—¥æœŸ');
        return;
      }
      
      // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
      document.getElementById('genBtnText').style.display = 'none';
      document.getElementById('genBtnLoading').style.display = 'inline-block';
      
      setTimeout(() => {
        try {
          // è§£ææ—¥æœŸå’Œæ—¶é—´
          const date = new Date(birthdate);
          const year = date.getFullYear();
          const month = date.getMonth() + 1;
          const day = date.getDate();
          
          let hour = 12;
          if (!timeUnknown && birthtime) {
            const timeParts = birthtime.split(':');
            hour = parseInt(timeParts[0]);
          }
          
          // è®¡ç®—å…«å­—
          const yearPillar = baziCalculator.calculateYearPillar(year);
          const monthPillar = baziCalculator.calculateMonthPillar(year, month);
          const dayPillar = baziCalculator.calculateDayPillar(year, month, day);
          const hourPillar = timeUnknown ? 
            { stem: 'ï¼Ÿ', branch: 'ï¼Ÿ' } : 
            baziCalculator.calculateHourPillar(dayPillar.stem, hour);
          
          const bazi = {
            year: yearPillar,
            month: monthPillar,
            day: dayPillar,
            hour: hourPillar
          };
          
          // æ˜¾ç¤ºç»“æœ
          displayBaziResult(bazi, year, month, day, hour, timeUnknown);
          
          // éšè—åŠ è½½çŠ¶æ€
          document.getElementById('genBtnText').style.display = 'inline';
          document.getElementById('genBtnLoading').style.display = 'none';
          
        } catch (error) {
          console.error('è®¡ç®—å…«å­—æ—¶å‡ºé”™:', error);
          showError('è®¡ç®—å…«å­—æ—¶å‡ºç°é”™è¯¯ï¼Œè¯·é‡è¯•');
          document.getElementById('genBtnText').style.display = 'inline';
          document.getElementById('genBtnLoading').style.display = 'none';
        }
      }, 1000);
    });
  } else {
    console.error('æ‰¾ä¸åˆ°ç”Ÿæˆå…«å­—æŒ‰é’®');
  }
  
  // è¿è¡Œå…«å­—è®¡ç®—æµ‹è¯•
  testBaziCalculation();
});

// éªŒè¯å…«å­—è®¡ç®—æ˜¯å¦æ­£ç¡®
function testBaziCalculation() {
  const calculator = new BaziCalculator();
  
  // æµ‹è¯•1978å¹´2æœˆ21æ—¥12:45
  const year = 1978, month = 2, day = 21, hour = 12;
  
  const yearPillar = calculator.calculateYearPillar(year);
  const monthPillar = calculator.calculateMonthPillar(year, month);
  const dayPillar = calculator.calculateDayPillar(year, month, day);
  const hourPillar = calculator.calculateHourPillar(dayPillar.stem, hour);
  
  console.log('ä¿®å¤åè®¡ç®—ç»“æœ:');
  console.log('å¹´æŸ±:', yearPillar.stem + yearPillar.branch, '(åº”è¯¥æ˜¯: æˆŠåˆ)');
  console.log('æœˆæŸ±:', monthPillar.stem + monthPillar.branch, '(åº”è¯¥æ˜¯: ç”²å¯…)');
  console.log('æ—¥æŸ±:', dayPillar.stem + dayPillar.branch, '(åº”è¯¥æ˜¯: ç”²å¯…)');
  console.log('æ—¶æŸ±:', hourPillar.stem + hourPillar.branch, '(åº”è¯¥æ˜¯: åºšåˆ)');
  
  // éªŒè¯ç»“æœ
  const isCorrect = 
    yearPillar.stem + yearPillar.branch === 'æˆŠåˆ' &&
    monthPillar.stem + monthPillar.branch === 'ç”²å¯…' &&
    dayPillar.stem + dayPillar.branch === 'ç”²å¯…' &&
    hourPillar.stem + hourPillar.branch === 'åºšåˆ';
  
  console.log('è®¡ç®—ç»“æœæ˜¯å¦æ­£ç¡®:', isCorrect);
  
  if (!isCorrect) {
    console.error('å…«å­—è®¡ç®—ä»æœ‰é—®é¢˜ï¼Œéœ€è¦è¿›ä¸€æ­¥è°ƒè¯•');
  }
  
  return isCorrect;
}
</script>
</body>
</html>
