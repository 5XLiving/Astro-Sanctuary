
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title data-i18n="page_title">çµæ•°ç®€è¯„</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600&family=Inter:wght@400;600&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0b0f14; --card:#11161dcc; --line:#1f2a36; --text:#e8edf3; --muted:#98a7b7;
  --brand:#d4af37; --gold:#d4af37; --gold2:#f2d27a; --accent:#58b9ff;
  --radius:14px; --shadow:0 8px 30px rgba(0,0,0,.35);
  --card-w:128px; --card-h:212px; --gap:14px;
}
@media (max-width:640px){ :root{ --card-w:100px; --card-h:168px; --gap:10px; } }

html,body{height:100%}
body{
  margin:0; color:var(--text);
  background: radial-gradient(1200px 600px at 70% -10%, #16202b 10%, transparent 60%) no-repeat,
              linear-gradient(180deg,#0b0f14,#0b0f14);
  font-family: Inter,system-ui,-apple-system,"Noto Sans SC","Segoe UI",Roboto,Arial,sans-serif;
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  overflow-x: hidden;
}
body::before{
  content:"";
  position:fixed;
  inset:0;
  z-index:-2;
  background: linear-gradient(rgba(11, 15, 20, 0.85), rgba(11, 15, 20, 0.9)), 
              radial-gradient(circle at 20% 80%, rgba(212, 175, 55, 0.1) 0%, transparent 50%),
              radial-gradient(circle at 80% 20%, rgba(88, 185, 255, 0.05) 0%, transparent 50%);
}
.container{max-width:1100px;margin:0 auto;padding:24px 16px 80px}

  /* â€”â€” å¤´éƒ¨ï¼ˆTarot åŒæ¬¾ï¼‰ â€”â€” */
  .site-header{
    position:sticky;
    top:0;
    z-index:10;
    background:#0b0f14cc;
    border-bottom:1px solid #0f1622;
    backdrop-filter:saturate(140%) blur(12px);
    transition: all 0.3s ease;
  }
  .site-header.scrolled {
    background: rgba(11, 15, 20, 0.95);
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
  }
  .head-inner{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:14px;
    padding:14px 16px;
  }
  
.brand{display:flex; align-items:center; gap:10px; text-decoration:none; color:var(--text)}
.brand-badge{
  display:inline-grid; 
  place-items:center; 
  width:34px; 
  height:34px; 
  border-radius:8px; 
  background:linear-gradient(180deg,#0e1520,#0b1018); 
  border:1px solid #2a3546; 
  box-shadow:0 4px 14px rgba(0,0,0,.35); 
  font-weight:800; 
  color:#ffe084;
  transition: all 0.3s ease;
}
.brand:hover .brand-badge {
  transform: rotate(15deg);
  box-shadow: 0 6px 20px rgba(212, 175, 55, 0.3);
}
.title{
  font-family:"Noto Serif SC","Noto Serif",serif !important;
  font-weight:600 !important;
  letter-spacing:.02em;
  font-size:1.1rem !important;
  line-height:1.25;
}

.title{
  font-family:"Noto Serif SC","Noto Serif",serif !important;
  font-weight:600 !important;
  letter-spacing:.02em;
  font-size:1.1rem !important;
  line-height:1.25;
}

/* æ–°å¢ï¼šé¼ æ ‡åœ¨æ•´æ¡ brand ä¸Šæ—¶ï¼Œé«˜äº®æ ‡é¢˜ */
.brand:hover .title {
  color: var(--gold);
}
.lang{display:flex; align-items:center; gap:8px}
.lang label{white-space:nowrap; color:var(--muted); margin-right:4px}
.lang select{
  appearance:none; 
  min-width:170px; 
  border-radius:10px; 
  border:1px solid #243244; 
  background:#0e1520; 
  color:var(--text); 
  padding:10px 34px 10px 12px; 
  font-size:.95rem; 
  background-image:url("data:image/svg+xml,%3Csvg width='12' height='8' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%2398a7b7' stroke-width='2' fill='none'/%3E%3C/svg%3E"); 
  background-repeat:no-repeat; 
  background-position:calc(100% - 12px) 50%;
  transition: all 0.3s ease;
}
.lang select:focus {
  outline: none;
  border-color: var(--gold);
  box-shadow: 0 0 0 2px rgba(212, 175, 55, 0.2);
}
@media (max-width:520px){ .title{font-size:1rem} .lang select{min-width:140px} }

  /* åŸºç¡€å— */
  .h1{
    margin:12px 0 6px; 
    color:#ffe084; 
    font-weight:800; 
    font-size:1.8rem
  }
  .sub{color:var(--muted)}
  .card{
    background:var(--card);
    border:1px solid var(--line);
    border-radius:var(--radius);
    box-shadow:var(--shadow);
    backdrop-filter:blur(10px);
    padding:18px;
    margin:16px 0;
  }
  .row{
    display:grid; 
    gap:12px; 
    grid-template-columns:1fr;
  }
  @media(min-width:760px){
    .row.cols-2{grid-template-columns:1fr 1fr} 
    .row.cols-3{grid-template-columns:1fr 1fr 1fr}
  }
  label.muted{display:block;margin-bottom:4px}
  input,select,textarea{
    width:100%;
    box-sizing:border-box;
    border-radius:12px;
    border:1px solid #243244;
    background:#0e1520;
    color:var(--text);
    padding:12px;
    font-size:15px;
    outline:none;
  }
  input::placeholder{color:#6f8092}
  .btn{
    display:inline-grid;
    place-items:center;
    padding:12px 16px;
    border-radius:12px;
    border:1px solid #e6c76e;
    background:linear-gradient(180deg,#fff9e6,#e6c76e);
    color:#191919;
    font-weight:800;
    cursor:pointer;
  }
  .btn[disabled]{opacity:.6;cursor:not-allowed}
  .btn.ghost{
    background:transparent;
    color:var(--gold2);
    border:1px solid rgba(212,175,55,.45);
    box-shadow:none;
  }

  .report{
    margin-top:12px;
    display:grid;
    gap:10px;
  }
  .report .sec{
    padding:12px;
    border:1px solid var(--line);
    background:#0e1520;
    border-radius:12px;
  }
  .report .sec h3{
    margin:0 0 6px;
    color:#f2d27a;
    font-size:1.05rem;
  }
  .report p,.report li{line-height:1.7}

/* ===== VIP åŒºåŸŸï¼ˆç»Ÿä¸€æ ·å¼ Â· ä¸ energy.html ä¸€è‡´ï¼‰ ===== */
.card.section{
  max-width:1100px;
  margin:32px auto 40px;
  padding:18px 18px 22px;
  border-radius:var(--radius);
  border:1px solid #1f2a36;
  background:#11161dcc;
  box-shadow:var(--shadow);
  box-sizing:border-box;
}

.group-title{
  font-weight:800;
  color:#ffe084;
  font-size:1rem;
  margin:0 0 10px;
}

/* ä¸ŠåŠéƒ¨ï¼šå·¦å³ä¸¤å— VIP åˆ—è¡¨ */
.card.section .columns{
  display:grid;
  grid-template-columns:repeat(2,minmax(0,1fr));
  gap:16px;
  margin-top:10px;
}
.card.section .list-block{
  border-radius:12px;
  border:1px solid #1f2a36;
  background:#0f141d;
  padding:14px 16px;
}
.card.section .list-block ul{
  list-style:none;
  margin:6px 0 0;
  padding:0;
}
.card.section .list-block li{
  margin:.25rem 0;
  font-size:.95rem;
  color:var(--muted);
  line-height:1.6;
}

/* ä¸‹åŠéƒ¨ï¼šç™»å½•åŒºåŸŸ */
.astro-auth{
  margin-top:16px;
}
.astro-auth .auth-grid{
  display:grid;
  grid-template-columns:1.2fr 0.8fr;
  gap:16px;
}
.astro-auth .panel{
  background:#11161dcc;
  border-radius:14px;
  border:1px solid #1f2a36;
  box-shadow:0 8px 30px rgba(0,0,0,.35);
  padding:16px 18px 18px;
  box-sizing:border-box;
}
.astro-auth .panel .head{
  font-size:.95rem;
  font-weight:800;
  color:#ffe084;
  padding-bottom:8px;
  margin-bottom:10px;
  border-bottom:1px solid #1f2a36;
}
.astro-auth .panel .body{
  display:flex;
  flex-direction:column;
  gap:8px;
}
.astro-auth .body .row{
  display:flex;
  flex-direction:column;
  gap:8px;
}
.astro-auth .body .spacer{
  height:4px;
}

/* è¾“å…¥æ¡† = è·Ÿ energy.html ä¸€æ ·å®½åº¦ */
.astro-auth input[type="email"],
.astro-auth input[type="password"]{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:1px solid #243244;
  background:#0e1520;
  color:#e8edf3;
  font-size:15px;
  box-sizing:border-box;
}
.astro-auth input[type="email"]::placeholder,
.astro-auth input[type="password"]::placeholder{
  color:#6f8092;
}
.astro-auth input[type="email"]:focus,
.astro-auth input[type="password"]:focus{
  outline:none;
  border-color:#d4af37;
  box-shadow:0 0 0 2px rgba(212,175,55,.2);
}

/* ç™»å½• / é‡è®¾ / æ³¨å†ŒæŒ‰é’® = å’Œè¾“å…¥æ¡†åŒå®½ï¼Œpill å½¢çŠ¶ */
.astro-auth .btn{
  display:flex;
  align-items:center;
  justify-content:center;
  width:100%;
  max-width:100%;
  padding:11px 18px;
  border-radius:999px;
  border:1px solid #e6c76e;
  background:linear-gradient(180deg,#fff9e6,#e6c76e);
  color:#191919;
  font-weight:800;
  text-align:center;
  box-shadow:0 6px 20px rgba(230,199,110,.35);
  white-space:nowrap;
  box-sizing:border-box;
  transition:.12s ease;
}
.astro-auth .btn.block{
  width:100%;
}

/* æ·±è‰²çš„ reset æŒ‰é’®æ ·å¼ */
.astro-auth .btn.ghost.block{
  background:#101826;
  border-color:#273245;
  color:#e8edf3;
  box-shadow:none;
}
.astro-auth .btn:hover{
  transform:translateY(-1px);
  box-shadow:0 10px 24px rgba(230,199,110,.45);
}
.astro-auth .btn.ghost.block:hover{
  border-color:#d4af37;
  background:rgba(212,175,55,.08);
}

.error-message{
  color:#ff7b7b;
  font-size:.85rem;
}

/* å°å±ï¼šVIP åŒºã€ç™»å½•åŒºéƒ½ä¸€åˆ—æ’å¸ƒ */
@media (max-width:768px){
  .card.section .columns{
    grid-template-columns:1fr;
  }
  .astro-auth .auth-grid{
    grid-template-columns:1fr;
  }
}

/* ===== æ— éšœç¢ & å·¥å…· ===== */
.sr-only{
  position:absolute!important;
  width:1px;
  height:1px;
  padding:0;
  margin:-1px;
  overflow:hidden;
  clip:rect(0,0,0,0);
  white-space:nowrap;
  border:0;
}
.btn-row{
  display:flex;
  align-items:stretch;
  gap:10px;
  width:100%;
  box-sizing:border-box;
}
.btn-row .btn{
  flex:1 1 0;
  width:auto!important;
  max-width:100%;
  box-sizing:border-box;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
.btn-row .btn-block{
  display:flex;
  width:auto!important;
}

  /* èŠå¤© */
  .ss-chat-fab{
    position:fixed;
    right:18px;
    bottom:18px;
    z-index:50;
    width:56px;
    height:56px;
    border-radius:50%;
    background:linear-gradient(180deg,#fff9e6,#e6c76e);
    color:#191919;
    display:grid;
    place-items:center;
    font-weight:800;
    box-shadow:0 8px 30px rgba(0,0,0,.35);
    cursor:pointer;
    border:1px solid #e6c76e;
  }
  .ss-chat-panel{
    position:fixed;
    right:18px;
    bottom:88px;
    z-index:50;
    width:min(460px,92vw);
    display:none;
    background:#0e1520;
    border:1px solid #243244;
    border-radius:14px;
    box-shadow:var(--shadow);
  }
  .ss-chat-head{
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:10px 12px;
    border-bottom:1px solid #243244;
  }
  .ss-chat-title{font-weight:700}
  .ss-close{cursor:pointer;opacity:.8}
  .ss-chat-body{
    max-height:300px;
    overflow:auto;
    padding:10px 12px;
  }
  .ss-msg{
    padding:8px 10px;
    background:#0f1624;
    border:1px solid #243244;
    border-radius:10px;
    margin:6px 0;
    max-width:80%;
  }
  .ss-msg.me{
    margin-left:auto;
    background:#132033;
  }
  .ss-chat-input{
    display:flex;
    align-items:center;
    gap:8px;
    padding:10px 12px;
    border-top:1px solid #243244;
  }
  .ss-chat-input input{
    flex:1 1 auto;
    min-width:0;
  }
  .ss-chat-input .btn,
  .ss-chat-input button{
    flex:0 0 auto;
    width:auto !important;
    white-space:nowrap;
    padding:10px 14px;
  }

  /* æŠŠ AI è§£è¯»åŒºå—çš„é—´è·å‹ç´§ä¸€ç‚¹ */
  .sec.ai-block h3 {
    margin-top: 0.8rem;
    margin-bottom: 0.8rem;
  }
  .sec.ai-block p {
    margin: 0.35rem 0;
  }
  .sec.ai-block ul {
    margin: 0.8rem 0 0.8rem;
    padding-left: 1.2rem;
  }
  .sec.ai-block li {
    margin: 0.20rem 0;
  }
  .chips{
    display:flex;
    flex-wrap:wrap;
    gap:8px;
    margin-top:12px;
  }
  .chip{
    padding:6px 10px;
    border-radius:999px;
    border:1px solid #2a3546;
    background:#0e1520;
    color:#e8edf3;
    cursor:pointer;
  }
  .skeleton{
    display:grid;
    gap:8px;
  }
  .skeleton div{
    height:12px;
    border-radius:6px;
    background:linear-gradient(90deg,#1a2431,#1f2b3b,#1a2431);
    animation:sh 1.2s infinite;
  }
  @keyframes sh{
    0%{opacity:.5}
    50%{opacity:1}
    100%{opacity:.5}
  }
  .ai-lock-overlay{
    position:static;
    inset:auto;
    background:none;
    backdrop-filter:none;
    margin-top:10px;
    padding-top:10px;
    border-top:1px solid var(--line);
    text-align:center;
  }
  .ai-lock-overlay .tip{
    color:#ffd88a;
    font-weight:700;
    margin-bottom:4px;
  }
  .ai-lock-overlay .sub{color:var(--muted)}

  .error{
    color:#ff6b6b;
    margin-top:8px;
    display:none;
  }
  .sr-only{
    position:absolute;
    width:1px;
    height:1px;
    padding:0;
    margin:-1px;
    overflow:hidden;
    clip:rect(0,0,0,0);
    border:0;
  }
  .block{width:100%}
  .footnote{
    color:var(--muted);
    font-size:.85rem;
    margin-top:8px;
  }
  /* Make the row a flex container */
.btn-row{
  display:flex;
  align-items:stretch;
  gap:10px;              /* space between buttons */
  width:100%;            /* stay inside parent */
  box-sizing:border-box;
}

/* Inside this row: make BOTH buttons same width */
.btn-row .btn{
  flex:1 1 0;            /* each takes 50% */
  width:auto !important; /* kill any width:100% from old .btn/.btn-block */
  max-width:100%;
  box-sizing:border-box;
}

/* If .btn-block is forcing 100% somewhere, override it JUST in this row */
.btn-row .btn-block{
  display:flex;          /* keep layout */
  width:auto !important; /* no full-width here */
}

/* Optional: prevent long text from blowing layout */
.btn-row .btn{
  white-space:nowrap;    /* or normal if you want wrapping */
  overflow:hidden;
  text-overflow:ellipsis;
}
</style>
</head>
<body>
  <header class="site-header">
    <div class="head-inner container">
      <a class="brand" href="https://astro.5xliving.com" target="_self" rel="nofollow">
        <span class="brand-badge">5X</span>
        <span class="title">
        <span data-i18n="brand">5xLiving Â· Soul Sanctuary</span>
        </span>
      </a>

    <div class="lang">
      <label for="langSelect" class="muted" data-i18n="lang_label">è¯­è¨€</label>
      <select id="langSelect" aria-label="Language">
          <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
          <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
          <option value="en">English</option>
          <option value="ja">æ—¥æœ¬èª</option>
          <option value="th">à¹„à¸—à¸¢</option>
          <option value="ms">Bahasa Melayu</option>
      </select>
    </div>
  </div>
</header>

  <main class="container">
    <h1 class="h1" data-i18n="page_title">çµæ•°ç®€è¯„</h1>
    <p class="sub" data-i18n="site_subtitle">å…è´¹ç‰ˆ Â· ä¸é¦–é¡µç»Ÿä¸€é£æ ¼ | VIP å¯è§£é”å®Œæ•´çµæ•°åœ°å›¾</p>

    <!-- è¡¨å• -->
    <section class="card">
      <div class="row cols-3">
        <div>
          <label class="muted" for="birthdate" data-i18n="ph_birthdate">å‡ºç”Ÿæ—¥æœŸ</label>
          <input type="date" id="birthdate" data-i18n-ph="ph_birthdate">
        </div>
        <div>
          <label class="muted" for="calcRule" data-i18n="rule_pyth">æ¯•è¾¾å“¥æ‹‰æ–¯</label>
          <select id="calcRule">
            <option value="p" data-i18n="rule_pyth">æ¯•è¾¾å“¥æ‹‰æ–¯ / Pythagorean</option>
          </select>
        </div>
        <div style="display:flex;align-items:flex-end">
          <button class="btn" id="btnGen" data-i18n="btn_gen">ç”Ÿæˆåˆ†æ</button>
        </div>
      </div>
      <div class="muted" style="margin-top:6px" data-i18n="hint_text">
      </div>
      <div class="error" id="error" style="display:none"></div>
    </section>

    <!-- ç»“æœ -->
    <section class="card" id="result" style="display:none">
      <h2 style="margin:0 0 10px;color:var(--gold)" data-i18n="res_title">å¿ƒæ€œç®¡å®¶è§£è¯»ä¸å»ºè®®</h2>
      <div id="numReport" class="report"></div>
    </section>

    <!-- ä¼šå‘˜åŒº -->
    <section class="card section">
      <h2 class="group-title" data-i18n="vip_title">ğŸŒ™ ä¼šå‘˜åŒºåŸŸ VIP Segment</h2>
      <div class="columns">
        <div class="list-block">
          <div class="group-title" data-i18n="vip_mingli">ğŸ— å‘½ç†ç©ºé—´ä¸“å±å†…å®¹</div>
          <ul>
            <li data-i18n="vip_love">å§»ç¼˜æ–¹å‘ï¼šæ‹çˆ±ç¼˜åˆ†ã€å©šå§»èµ°åŠ¿</li>
            <li data-i18n="vip_career">äº‹ä¸šæ–¹å‘ï¼šèŒåœºå‘å±•ã€åˆ›ä¸šæ½œåŠ›</li>
            <li data-i18n="vip_wealth">è´¢è¿æ–¹å‘ï¼šè´¢ä½åˆ†æã€ç†è´¢æ—¶æœº</li>
            <li data-i18n="vip_pet">å® ç‰©å‘½ç†ï¼šä¼´ä¾£åŠ¨ç‰©çš„æ€§æ ¼ä¸ç¼˜åˆ†</li>
            <li data-i18n="vip_hepan">åˆç›˜åˆ†æï¼šå©šæœŸæ‹©æ—¥ã€æ–°ç”Ÿæ‹©æ—¶</li>
            <li data-i18n="vip_name">æµ‹ååˆ†æï¼šå…¬å¸åã€å®å®åã€å‘½åæ”¹è¿</li>
            <li data-i18n="vip_fengshui">è´¢ä½åˆç›˜ï¼šä½å®¶ / åŠå…¬å®¤åŠ¨çº¿é…åˆ</li>
          </ul>
        </div>
        <div class="list-block">
          <div class="group-title" data-i18n="vip_xinlian">ğŸŒ™ å¿ƒæ€œç©ºé—´ä¸“å±å†…å®¹</div>
          <ul>
            <li data-i18n="vip_record">çµæ€§è®°å½•ï¼šç…§ç‰‡ã€æ¢¦å¢ƒã€å£°éŸ³ã€æ„¿æœ›ç¥ˆç¥·</li>
            <li data-i18n="vip_course">å‘½ç†è¯¾ç¨‹ï¼šå…«å­— / å¡”ç½— / å æ˜Ÿ / çµæ•° / äººç±»å›¾</li>
            <li data-i18n="vip_memorial">å®¶æ—çºªå¿µç³»ç»Ÿï¼šäº²äººçµæ€§çºªå¿µ & å»¶ç»­</li>
            <li data-i18n="vip_tasks">æ¯å‘¨èƒ½é‡ç»ƒä¹  / ç¥æ˜ä»ªå¼ä»»åŠ¡</li>
            <li data-i18n="vip_shop">èƒ½é‡å•†åŸä¸“å±æŠ˜æ‰£ & å¾¡å®ˆè®¢åˆ¶</li>
          </ul>
        </div>
      </div>

      <div class="group-title" style="margin-top:14px" data-i18n="login_title">ğŸ’ ç™»å…¥ VIP åŠŸèƒ½</div>

      <section class="astro-auth">
        <div class="auth-grid">
          <div class="panel">
            <div class="head" data-i18n="panel_login_head">è´¦æˆ·ç™»å½• / æ³¨å†Œ</div>
            <div class="body">
              <div class="row" id="authFields">
                <label for="email" class="sr-only" data-i18n="ph_email">é‚®ç®± Email</label>
                <input id="email" name="email" type="email" inputmode="email" autocomplete="username">
                <label for="password" class="sr-only" data-i18n="ph_label_password">å¯†ç  Password</label>
                <input id="password" type="password" autocomplete="new-password" placeholder="å¯†ç  Passwordï¼ˆè‡³å°‘8ä½ï¼Œå«å¤§å°å†™æ•°å­—ç¬¦å·ï¼‰" data-i18n-ph="ph_password" required/>
              </div>
              <div class="spacer"></div>
              <form id="loginForm" class="row one">
                <button class="btn block" id="loginBtn" type="submit" data-i18n="btn_login">ç™»å…¥è´¦æˆ·</button>
              </form>
              <div class="spacer"></div>
              <div class="row one">
                <button class="btn ghost block" id="resetBtn" type="button" data-i18n="btn_reset">ğŸ”‘ é‡è®¾å¯†ç </button>
              </div>
              <div class="spacer"></div>
              <form class="row one" id="registerForm">
                <button class="btn block" id="registerBtn" type="submit" data-i18n="btn_register">æ³¨å†Œè´¦æˆ·</button>
                <div class="muted" data-i18n="note_price">æ³¨å†Œè´¦å·èµ é€ä¸€æ¬¡å…è´¹ä½“éªŒ</div>
                <div class="spacer"></div>
                <div class="error-message" id="authError" style="display:none"></div>
              </form>
            </div>
          </div>

          <div class="panel">
            <div class="head" data-i18n="panel_member_head">ä¼šå‘˜æœåŠ¡</div>
            <div class="body">
              <div class="row one">
                <a class="btn block" href="https://yourshopifyshop.com/products/monthly-vip" target="_blank" rel="noopener noreferrer" data-i18n="btn_upgrade">ğŸ’ å‡çº§ä¸º VIPï¼ˆæœˆè´¹ï¼‰</a>
              </div>
              <div class="spacer"></div>
              <div class="row one">
                <a class="btn ghost block" href="https://yourshopifyshop.myshopify.com" target="_blank" rel="noopener noreferrer" data-i18n="btn_backshop">â† è¿”å›å‘½ç†å•†åŸ</a>
              </div>
              <div class="spacer"></div>
              <div class="muted" data-i18n="note_price1">$9.9 / æœˆè´¹ VIPï¼ˆå‘½ç†ç©ºé—´ + å¿ƒæ€œç©ºé—´ + çµæ€§è¯¾ç¨‹ï¼‰</div>
              <div id="life-path-block"></div>
            </div>
          </div>
        </div>
      </section>
    </section>
  </main>

  <footer>Â© 5XLiving â€¢ Astro Sanctuary</footer>
</main>
</body>
          
<!-- GPT / å¿ƒæ€œç®¡å®¶ï¼ˆç»Ÿä¸€æµ®çª—ï¼‰ -->
<button class="ss-chat-fab" id="ssChatFab" type="button">
  <span data-i18n="chat_fab">é—®</span>
</button>

<div class="ss-chat-panel" id="chatPanel" aria-hidden="true">
  <div class="ss-chat-head">
    <div class="ss-chat-title" id="chatTitle" data-i18n="chat_title">
      å¿ƒæ€œç®¡å®¶ Â· GPT
    </div>
    <div class="ss-close" id="chatClose">âœ•</div>
  </div>

  <!-- èŠå¤©å†…å®¹åŒºï¼šä¿æŒä¸ºç©ºï¼Œæ¶ˆæ¯å…¨éƒ¨ç”± JS append -->
  <div class="ss-chat-body" id="chatBody"></div>

  <!-- è¾“å…¥åŒº -->
  <div class="ss-chat-input">
    <input
      id="chatInput"
      placeholder="è¾“å…¥é—®é¢˜â€¦"
      data-i18n-ph="chat_input_ph"
    />
    <button class="btn" id="chatSend" data-i18n="chat_send">å‘é€</button>
  </div>
</div>

<script>
(function(){
'use strict';

/* ===== åŸºç¡€å¸¸é‡ ===== */
const API_BASE = 'https://throbbing-lab-1440.hello5xliving.workers.dev';
const LANG_KEY = 'site_lang';
const gid = id => document.getElementById(id);
window.lastNumCtx = null;  // è®°ä½æœ€è¿‘ä¸€æ¬¡çš„ numerology ç»“æœ  

/* ===== i18n ===== */
const translations = {
  "zh-CN": {
    "brand":"5xLiving Â· Soul Sanctuary",
    "page_title":"çµæ•°ç®€è¯„", "site_title":"çµæ•°ç®€è¯„",
    "site_subtitle":"å…è´¹ç‰ˆ Â· ä¸é¦–é¡µç»Ÿä¸€é£æ ¼ | VIP å¯è§£é”å®Œæ•´çµæ•°åœ°å›¾",
    "lang_label":"è¯­è¨€", "ph_birthdate":"å‡ºç”Ÿæ—¥æœŸ", "rule_pyth":"æ¯•è¾¾å“¥æ‹‰æ–¯", "btn_gen":"ç”Ÿæˆåˆ†æ",
    "res_title":"å¿ƒæ€œç®¡å®¶è§£è¯»ä¸å»ºè®®",
    "vip_title":"ğŸŒ™ ä¼šå‘˜åŒºåŸŸ VIP Segment","vip_mingli":"ğŸ— å‘½ç†ç©ºé—´ä¸“å±å†…å®¹",
    "vip_love":"å§»ç¼˜æ–¹å‘ï¼šæ‹çˆ±ç¼˜åˆ†ã€å©šå§»èµ°åŠ¿","vip_career":"äº‹ä¸šæ–¹å‘ï¼šèŒåœºå‘å±•ã€åˆ›ä¸šæ½œåŠ›",
    "vip_wealth":"è´¢è¿æ–¹å‘ï¼šè´¢ä½åˆ†æã€ç†è´¢æ—¶æœº","vip_pet":"å® ç‰©å‘½ç†ï¼šä¼´ä¾£åŠ¨ç‰©çš„æ€§æ ¼ä¸ç¼˜åˆ†",
    "vip_hepan":"åˆç›˜åˆ†æï¼šå©šæœŸæ‹©æ—¥ã€æ–°ç”Ÿæ‹©æ—¶","vip_name":"æµ‹ååˆ†æï¼šå…¬å¸åã€å®å®åã€å‘½åæ”¹è¿",
    "vip_fengshui":"è´¢ä½åˆç›˜ï¼šä½å®¶ / åŠå…¬å®¤åŠ¨çº¿é…åˆ",
    "vip_xinlian":"ğŸŒ™ å¿ƒæ€œç©ºé—´ä¸“å±å†…å®¹","vip_record":"çµæ€§è®°å½•ï¼šç…§ç‰‡ã€æ¢¦å¢ƒã€å£°éŸ³ã€æ„¿æœ›ç¥ˆç¥·",
    "vip_course":"å‘½ç†è¯¾ç¨‹ï¼šå…«å­— / å¡”ç½— / å æ˜Ÿ / çµæ•° / äººç±»å›¾",
    "vip_memorial":"å®¶æ—çºªå¿µç³»ç»Ÿï¼šäº²äººçµæ€§çºªå¿µ & å»¶ç»­","vip_tasks":"æ¯å‘¨èƒ½é‡ç»ƒä¹  / ç¥æ˜ä»ªå¼ä»»åŠ¡",
    "vip_shop":"èƒ½é‡å•†åŸä¸“å±æŠ˜æ‰£ & å¾¡å®ˆè®¢åˆ¶","login_title":"ğŸ’ ç™»å…¥ VIP åŠŸèƒ½",
    "panel_login_head":"è´¦æˆ·ç™»å½• / æ³¨å†Œ","ph_email":"é‚®ç®± Email",
    "ph_label_password":"å¯†ç  Password","ph_password":"å¯†ç  Passwordï¼ˆè‡³å°‘8ä½ï¼Œå«å¤§å°å†™æ•°å­—ç¬¦å·ï¼‰",
    "btn_login":"ç™»å…¥è´¦æˆ·","btn_reset":"ğŸ”‘ é‡è®¾å¯†ç ","btn_register":"æ³¨å†Œè´¦æˆ·",
    "note_price":"æ³¨å†Œè´¦å·èµ é€ä¸€æ¬¡å…è´¹ä½“éªŒ","panel_member_head":"ä¼šå‘˜æœåŠ¡",
    "btn_upgrade":"ğŸ’ å‡çº§ä¸º VIPï¼ˆæœˆè´¹ï¼‰","btn_backshop":"â† è¿”å›å‘½ç†å•†åŸ",
    "note_price1":"$9.9 / æœˆè´¹ VIPï¼ˆå‘½ç†ç©ºé—´ + å¿ƒæ€œç©ºé—´ + çµæ€§è¯¾ç¨‹ï¼‰",
    "chat_fab":"é—®","chat_placeholder":"è¾“å…¥æ‚¨çš„é—®é¢˜...","chat_send":"å‘é€",
    "ai_title":"å¿ƒæ€œç®¡å®¶è§£è¯»","ai_local_note":"ï¼ˆå·²åˆ‡æ¢æœ¬åœ°è§£è¯»æºï¼šç½‘ç»œæ³¢åŠ¨ï¼‰",
    "sec_basic":"åŸºç¡€ä¿¡æ¯",
    "sec_lp":"ç”Ÿå‘½è·¯å¾„æ•°å­—",
    "sec_love":"æƒ…æ„Ÿæ•°å­—",
    "hint_text":"ç”Ÿå‘½è·¯å¾„ = å°†è¥¿å…ƒå¹´/æœˆ/æ—¥æ‰€æœ‰æ•°å­—ç›¸åŠ å¹¶ç¼©å‡ä¸º 1â€“9ï¼Œ11 / 22 / 33 ä¿ç•™ä¸ºå¤§å¸ˆæ•°å­—ï¼›æƒ…æ„Ÿæ•°å­— = å‡ºç”Ÿæ—¥ï¼ˆDDï¼‰ç¼©å‡ä¸º 1â€“9ã€‚",

      chat_fab: "é—®",
      chat_title: "å¿ƒæ€œç®¡å®¶ Â· Chat",
      chat_send: "å‘é€",
      chat_bot_name: "å¿ƒæ€œç®¡å®¶",
      chat_welcome: "ä½ å¥½ï¼æˆ‘æ˜¯ä½ çš„å¿ƒæ€œç®¡å®¶è§£è¯»åŠ©æ‰‹ï¼Œå¯ä»¥å¸®ä½ åˆ†ææˆ–è§£ç­”ç›¸å…³é—®é¢˜ã€‚",
      chat_input_ph: "è¾“å…¥é—®é¢˜â€¦"
  },
  
  "zh-TW": {
    "brand":"5xLiving Â· Soul Sanctuary",
    "page_title":"éˆæ•¸ç°¡è©•","site_title":"éˆæ•¸ç°¡è©•",
    "site_subtitle":"å…è²»ç‰ˆ Â· èˆ‡é¦–é é¢¨æ ¼ä¸€è‡´ï½œVIP å¯è§£é–å®Œæ•´éˆæ•¸åœ°åœ–",
    "lang_label":"èªè¨€","ph_birthdate":"å‡ºç”Ÿæ—¥æœŸ","rule_pyth":"ç•¢é”å“¥æ‹‰æ–¯","btn_gen":"ç”Ÿæˆè§£æ",
    "res_title":"å¿ƒæ†ç®¡å®¶è§£è®€èˆ‡å»ºè­°",
    "vip_title":"ğŸŒ™ æœƒå“¡å€åŸŸ VIP Segment","vip_mingli":"ğŸ— å‘½ç†ç©ºé–“å°ˆå±¬å…§å®¹",
    "vip_love":"å§»ç·£æ–¹å‘ï¼šæˆ€æ„›ç·£åˆ†ã€å©šå§»èµ°å‹¢","vip_career":"äº‹æ¥­æ–¹å‘ï¼šè·å ´ç™¼å±•ã€å‰µæ¥­æ½›åŠ›",
    "vip_wealth":"è²¡é‹æ–¹å‘ï¼šè²¡ä½åˆ†æã€ç†è²¡æ™‚æ©Ÿ","vip_pet":"å¯µç‰©å‘½ç†ï¼šä¼´ä¾¶å‹•ç‰©çš„æ€§æ ¼èˆ‡ç·£åˆ†",
    "vip_hepan":"åˆç›¤åˆ†æï¼šå©šæœŸæ“‡æ—¥ã€æ–°ç”Ÿæ“‡æ™‚","vip_name":"æ¸¬ååˆ†æï¼šå…¬å¸åã€å¯¶å¯¶åã€å‘½åæ”¹é‹",
    "vip_fengshui":"è²¡ä½åˆç›¤ï¼šä½å®¶ï¼è¾¦å…¬å®¤å‹•ç·šé…åˆ",
    "vip_xinlian":"ğŸŒ™ å¿ƒæ†ç©ºé–“å°ˆå±¬å…§å®¹","vip_record":"éˆæ€§è¨˜éŒ„ï¼šç…§ç‰‡ã€å¤¢å¢ƒã€è²éŸ³ã€é¡˜æœ›ç¥ˆç¦±",
    "vip_course":"å‘½ç†èª²ç¨‹ï¼šå…«å­—ï¼å¡”ç¾…ï¼å æ˜Ÿï¼éˆæ•¸ï¼äººé¡åœ–",
    "vip_memorial":"å®¶æ—ç´€å¿µç³»çµ±ï¼šè¦ªäººéˆæ€§ç´€å¿µï¼†å»¶çºŒ","vip_tasks":"æ¯é€±èƒ½é‡ç·´ç¿’ï¼ç¥æ˜å„€å¼ä»»å‹™",
    "vip_shop":"èƒ½é‡å•†åŸå°ˆå±¬æŠ˜æ‰£ï¼†å¾¡å®ˆè¨‚è£½","login_title":"ğŸ’ ç™»å…¥ VIP åŠŸèƒ½",
    "panel_login_head":"å¸³è™Ÿç™»å…¥ï¼è¨»å†Š","ph_email":"ä¿¡ç®± Email",
    "ph_label_password":"å¯†ç¢¼ Password","ph_password":"å¯†ç¢¼ Passwordï¼ˆè‡³å°‘ 8 ä½ï¼Œå«å¤§å°å¯«èˆ‡æ•¸å­—ç¬¦è™Ÿï¼‰",
    "btn_login":"ç™»å…¥å¸³è™Ÿ","btn_reset":"ğŸ”‘ é‡è¨­å¯†ç¢¼","btn_register":"è¨»å†Šå¸³è™Ÿ",
    "note_price":"è¨»å†Šå¸³è™Ÿè´ˆé€ä¸€æ¬¡å…è²»é«”é©—","panel_member_head":"æœƒå“¡æœå‹™",
    "btn_upgrade":"ğŸ’ å‡ç´šç‚º VIPï¼ˆæœˆè²»ï¼‰","btn_backshop":"â† è¿”å›å‘½ç†å•†åŸ",
    "note_price1":"$9.9 / æœˆè²» VIPï¼ˆå‘½ç†ç©ºé–“ï¼‹å¿ƒæ†ç©ºé–“ï¼‹éˆæ€§èª²ç¨‹ï¼‰",
    "chat_fab":"å•","chat_placeholder":"è¼¸å…¥æ‚¨çš„å•é¡Œâ€¦","chat_send":"é€å‡º",
    "ai_title":"å¿ƒæ†ç®¡å®¶è§£è®€","ai_local_note":"ï¼ˆå·²åˆ‡æ›æœ¬åœ°è§£è®€æºï¼šç¶²è·¯æ³¢å‹•ï¼‰",
    "sec_basic":"åŸºç¤è³‡è¨Š",
    "sec_lp":"ç”Ÿå‘½è·¯å¾‘æ•¸å­—",
    "sec_love":"æƒ…æ„Ÿæ•¸å­—",
    "hint_text":"ç”Ÿå‘½è·¯å¾‘ = å°‡è¥¿å…ƒå¹´ï¼æœˆï¼æ—¥æ‰€æœ‰æ•¸å­—ç›¸åŠ ä¸¦ç¸®æ¸›ç‚º 1â€“9ï¼Œ11 / 22 / 33 ä¿ç•™ç‚ºå¤§å¸«æ•¸ï¼›æƒ…æ„Ÿæ•¸å­— = å‡ºç”Ÿæ—¥ï¼ˆDDï¼‰ç¸®æ¸›ç‚º 1â€“9ã€‚",

      chat_fab: "å•",
      chat_title: "å¿ƒæ†ç®¡å®¶ Â· Chat",
      chat_send: "ç™¼é€",
      chat_bot_name: "å¿ƒæ€œç®¡å®¶",
      chat_welcome: "ä½ å¥½ï¼æˆ‘æ˜¯ä½ çš„å¿ƒæ€œç®¡å®¶è§£è®€åŠ©æ‰‹ï¼Œå¯ä»¥å¹«ä½ åˆ†ææˆ–è§£ç­”ç›¸é—œå•é¡Œã€‚",
      chat_input_ph: "è¼¸å…¥å•é¡Œâ€¦"
  },
  
  "en": {
    "brand":"5xLiving Â· Soul Sanctuary",
    "page_title":"Numerology Report","site_title":"Numerology Report",
    "site_subtitle":"Free version Â· VIP unlocks full numerology map",
    "lang_label":"Language","ph_birthdate":"Birth Date","rule_pyth":"Pythagorean","btn_gen":"Generate",
    "hint_text":"Life Path = sum of all digits in YYYYMMDD reduced to 1â€“9 (keep 11/22/33); Love Number = day (DD) reduced to 1â€“9.",
    "res_title":"Insights & Advice",
    "vip_title":"ğŸŒ™ VIP Segment","vip_mingli":"ğŸ— Astro Space Â· Exclusive",
    "vip_love":"Love: attraction patterns & marriage flow","vip_career":"Career: work style & business potential",
    "vip_wealth":"Wealth: money flow & timing","vip_pet":"Pet energy: temperament & bond with you",
    "vip_hepan":"Synastry: wedding date / baby timing","vip_name":"Names: company / baby / renaming for luck",
    "vip_fengshui":"Wealth & space: home / office layout sync",
    "vip_xinlian":"ğŸŒ™ Xinlian Space Â· Exclusive","vip_record":"Soul records: photos, dreams, voice, wishes",
    "vip_course":"Courses: Bazi / Tarot / Astrology / Numerology / Human Design",
    "vip_memorial":"Family memorial system","vip_tasks":"Weekly energy practice / ritual tasks",
    "vip_shop":"Energy shop discounts & amulets","login_title":"ğŸ’ VIP Login",
    "panel_login_head":"Account Login / Register","ph_email":"Email",
    "ph_label_password":"Password","ph_password":"Password (min 8 chars, mixed case & symbols)",
    "btn_login":"Login","btn_reset":"ğŸ”‘ Reset Password","btn_register":"Register",
    "note_price":"New account comes with one free trial","panel_member_head":"Membership",
    "btn_upgrade":"ğŸ’ Upgrade to VIP (Monthly)","btn_backshop":"â† Back to Astro Shop",
    "note_price1":"$9.9 / month VIP (Astro + Xinlian + Courses)",
    "chat_fab":"Chat","chat_placeholder":"Type your question...","chat_send":"Send",
    "ai_title":"Xinlian Butler Â· Insights","ai_local_note":"(Using local generator due to network)",
    "sec_basic":"Basic Information",
    "sec_lp":"Life Path Number",
    "sec_love":"Love Number",

      chat_fab: "Chat",
      chat_title: "Concierge Â· Chat",
      chat_send: "Send",
      chat_bot_name: "Xinlian Butler",
      chat_welcome: "Hello! I am your Xinlian Butler reading assistant. I can help you analyse or answer related questions.",
      chat_input_ph: "Type your questionâ€¦"
  },
  
  "ja": {
    "brand":"5xLiving Â· Soul Sanctuary",
    "page_title":"æ•°ç§˜è¡“ãƒ¬ãƒãƒ¼ãƒˆï¼ˆç°¡æ˜“ç‰ˆï¼‰","site_title":"æ•°ç§˜è¡“ãƒ¬ãƒãƒ¼ãƒˆ",
    "site_subtitle":"ç„¡æ–™ç‰ˆ Â· VIP ä¼šå“¡ã§å®Œå…¨ãªæ•°ç§˜ãƒãƒƒãƒ—ã‚’è§£æ”¾",
    "lang_label":"è¨€èª","ph_birthdate":"ç”Ÿå¹´æœˆæ—¥","rule_pyth":"ãƒ”ã‚¿ã‚´ãƒ©ã‚¹æ–¹å¼","btn_gen":"è§£æã‚’ç”Ÿæˆ",
    "hint_text":"ãƒ©ã‚¤ãƒ•ãƒ‘ã‚¹ãƒŠãƒ³ãƒãƒ¼ = ç”Ÿå¹´æœˆæ—¥ã®æ•°å­—ï¼ˆYYYYMMDDï¼‰ã‚’ã™ã¹ã¦è¶³ã—ã¦ 1ã€œ9 ã«ç¸®ç´„ï¼ˆ11/22/33 ã¯ãƒã‚¹ã‚¿ãƒ¼ãƒŠãƒ³ãƒãƒ¼ã¨ã—ã¦ä¿æŒï¼‰ã€‚ãƒ©ãƒ–ãƒŠãƒ³ãƒãƒ¼ = èª•ç”Ÿæ—¥ï¼ˆDDï¼‰ã‚’ 1ã€œ9 ã«ç¸®ç´„ã€‚",
    "res_title":"ã‚¤ãƒ³ã‚µã‚¤ãƒˆã¨ã‚¢ãƒ‰ãƒã‚¤ã‚¹",
    "vip_title":"ğŸŒ™ ä¼šå“¡ã‚¨ãƒªã‚¢ VIP Segment","vip_mingli":"ğŸ— å‘½ç†ã‚¹ãƒšãƒ¼ã‚¹é™å®šã‚³ãƒ³ãƒ†ãƒ³ãƒ„",
    "vip_love":"æ‹æ„›ãƒ»çµå©šï¼šã”ç¸ã®æµã‚Œã¨ãƒ‘ã‚¿ãƒ¼ãƒ³","vip_career":"ä»•äº‹ãƒ»ã‚­ãƒ£ãƒªã‚¢ï¼šé©æ€§ã¨èµ·æ¥­ã®å¯èƒ½æ€§",
    "vip_wealth":"ãŠé‡‘ãƒ»è±Šã‹ã•ï¼šåå…¥ã®æµã‚Œã¨ã‚¿ã‚¤ãƒŸãƒ³ã‚°","vip_pet":"ãƒšãƒƒãƒˆï¼šæ€§æ ¼ã¨ã‚ãªãŸã¨ã®ã”ç¸",
    "vip_hepan":"ç›¸æ€§ãƒ»ã‚·ãƒŠã‚¹ãƒˆãƒªãƒ¼ï¼šçµå©šæ—¥ï¼å‡ºç”£ã‚¿ã‚¤ãƒŸãƒ³ã‚°","vip_name":"å‘½åé‘‘å®šï¼šä¼šç¤¾åãƒ»èµ¤ã¡ã‚ƒã‚“ã®åå‰ãƒ»æ”¹å",
    "vip_fengshui":"è²¡ä½ãƒ»ç©ºé–“ï¼šè‡ªå®…ï¼ã‚ªãƒ•ã‚£ã‚¹å‹•ç·šã¨ã®èª¿å’Œ",
    "vip_xinlian":"ğŸŒ™ å¿ƒæ†ã‚¹ãƒšãƒ¼ã‚¹é™å®šã‚³ãƒ³ãƒ†ãƒ³ãƒ„","vip_record":"ã‚¹ãƒ”ãƒªãƒãƒ¥ã‚¢ãƒ«è¨˜éŒ²ï¼šå†™çœŸãƒ»å¤¢ãƒ»å£°ãƒ»ç¥ˆã‚Š",
    "vip_course":"ã‚³ãƒ¼ã‚¹ï¼šå››æŸ±æ¨å‘½ï¼ã‚¿ãƒ­ãƒƒãƒˆï¼å æ˜Ÿè¡“ï¼æ•°ç§˜è¡“ï¼ãƒ’ãƒ¥ãƒ¼ãƒãƒ³ãƒ‡ã‚¶ã‚¤ãƒ³",
    "vip_memorial":"å®¶æ—ãƒ¡ãƒ¢ãƒªã‚¢ãƒ«ã‚·ã‚¹ãƒ†ãƒ ","vip_tasks":"æ¯é€±ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ¯ãƒ¼ã‚¯ï¼å„€å¼ã‚¿ã‚¹ã‚¯",
    "vip_shop":"ã‚¨ãƒŠã‚¸ãƒ¼ã‚·ãƒ§ãƒƒãƒ—å‰²å¼•ï¼†ãŠå®ˆã‚Šã‚«ã‚¹ã‚¿ãƒ ","login_title":"ğŸ’ VIP ãƒ­ã‚°ã‚¤ãƒ³",
    "panel_login_head":"ãƒ­ã‚°ã‚¤ãƒ³ï¼ç™»éŒ²","ph_email":"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹",
    "ph_label_password":"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰","ph_password":"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆ8æ–‡å­—ä»¥ä¸Šãƒ»è‹±æ•°å­—ã¨è¨˜å·ï¼‰",
    "btn_login":"ãƒ­ã‚°ã‚¤ãƒ³","btn_reset":"ğŸ”‘ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å†è¨­å®š","btn_register":"æ–°è¦ç™»éŒ²",
    "note_price":"æ–°è¦ç™»éŒ²ã§ 1 å›ç„¡æ–™ä½“é¨“","panel_member_head":"ä¼šå“¡ã‚µãƒ¼ãƒ“ã‚¹",
    "btn_upgrade":"ğŸ’ VIPï¼ˆæœˆé¡ï¼‰ã¸ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰","btn_backshop":"â† å ã„ã‚·ãƒ§ãƒƒãƒ—ã¸æˆ»ã‚‹",
    "note_price1":"$9.9 / æœˆ Â· VIPï¼ˆå‘½ç†ã‚¹ãƒšãƒ¼ã‚¹ï¼‹å¿ƒæ†ã‚¹ãƒšãƒ¼ã‚¹ï¼‹ã‚³ãƒ¼ã‚¹ï¼‰",
    "chat_fab":"Chat","chat_placeholder":"ã”è³ªå•ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„â€¦","chat_send":"é€ä¿¡",
    "ai_title":"å¿ƒæ†ãƒãƒˆãƒ©ãƒ¼ãƒ»ãƒªãƒ¼ãƒ‡ã‚£ãƒ³ã‚°","ai_local_note":"ï¼ˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸å®‰å®šã®ãŸã‚ãƒ­ãƒ¼ã‚«ãƒ«è§£é‡ˆã‚’ä½¿ç”¨ï¼‰",
    "sec_basic":"åŸºæœ¬æƒ…å ±",
    "sec_lp":"ãƒ©ã‚¤ãƒ•ãƒ‘ã‚¹ãƒŠãƒ³ãƒãƒ¼",
    "sec_love":"æ„Ÿæƒ…ï¼æ‹æ„›ãƒŠãƒ³ãƒãƒ¼",

    chat_fab:"ãƒãƒ£ãƒƒãƒˆ", 
    chat_title:"ã‚³ãƒ³ã‚·ã‚§ãƒ«ã‚¸ãƒ¥ Â· ãƒãƒ£ãƒƒãƒˆ", 
    chat_send:"é€ä¿¡", chat_bot_name:"å¿ƒæ€œãƒãƒˆãƒ©ãƒ¼", 
    chat_welcome:"ã“ã‚“ã«ã¡ã¯ã€‚ã”è³ªå•ã«ãŠç­”ãˆã—ã¾ã™ã€‚", 
    chat_input_ph:"è³ªå•ã‚’å…¥åŠ›â€¦"
  },
  
  "th": {
    "brand":"5xLiving Â· Soul Sanctuary",
    "page_title":"à¸£à¸²à¸¢à¸‡à¸²à¸™à¸•à¸±à¸§à¹€à¸¥à¸‚à¸¨à¸²à¸ªà¸•à¸£à¹Œà¹à¸šà¸šà¸¢à¹ˆà¸­","site_title":"à¸£à¸²à¸¢à¸‡à¸²à¸™à¸•à¸±à¸§à¹€à¸¥à¸‚à¸¨à¸²à¸ªà¸•à¸£à¹Œ",
    "site_subtitle":"à¹€à¸§à¸­à¸£à¹Œà¸Šà¸±à¸™à¸Ÿà¸£à¸µ Â· VIP à¸›à¸¥à¸”à¸¥à¹‡à¸­à¸à¹à¸œà¸™à¸—à¸µà¹ˆà¸•à¸±à¸§à¹€à¸¥à¸‚à¹€à¸•à¹‡à¸¡à¸£à¸¹à¸›à¹à¸šà¸š",
    "lang_label":"à¸ à¸²à¸©à¸²","ph_birthdate":"à¸§à¸±à¸™à¹€à¸”à¸·à¸­à¸™à¸›à¸µà¹€à¸à¸´à¸”","rule_pyth":"à¸£à¸°à¸šà¸šà¸à¸´à¸—à¸²à¹‚à¸à¸£à¸±à¸ª","btn_gen":"à¸ªà¸£à¹‰à¸²à¸‡à¸„à¸³à¸—à¸³à¸™à¸²à¸¢",
    "hint_text":"à¹€à¸¥à¸‚à¹€à¸ªà¹‰à¸™à¸—à¸²à¸‡à¸Šà¸µà¸§à¸´à¸• = à¸œà¸¥à¸£à¸§à¸¡à¸•à¸±à¸§à¹€à¸¥à¸‚à¸‚à¸­à¸‡à¸§à¸±à¸™à¹€à¸”à¸·à¸­à¸™à¸›à¸µà¹€à¸à¸´à¸” (YYYYMMDD) à¸¥à¸”à¹ƒà¸«à¹‰à¹€à¸«à¸¥à¸·à¸­ 1â€“9 à¹‚à¸”à¸¢à¹€à¸à¹‡à¸š 11/22/33 à¹€à¸›à¹‡à¸™à¹€à¸¥à¸‚à¸¡à¸²à¸ªà¹€à¸•à¸­à¸£à¹Œ; à¹€à¸¥à¸‚à¸„à¸§à¸²à¸¡à¸£à¸±à¸ = à¸§à¸±à¸™à¹€à¸à¸´à¸” (DD) à¸¥à¸”à¹ƒà¸«à¹‰à¹€à¸«à¸¥à¸·à¸­ 1â€“9.",
    "res_title":"à¸¡à¸¸à¸¡à¸¡à¸­à¸‡à¹à¸¥à¸°à¸„à¸³à¹à¸™à¸°à¸™à¸³",
    "vip_title":"ğŸŒ™ à¸à¸·à¹‰à¸™à¸—à¸µà¹ˆà¸ªà¸¡à¸²à¸Šà¸´à¸ VIP","vip_mingli":"ğŸ— à¹€à¸™à¸·à¹‰à¸­à¸«à¸²à¸à¸´à¹€à¸¨à¸©à¹ƒà¸™à¹‚à¸‹à¸™à¸”à¸§à¸‡",
    "vip_love":"à¸„à¸§à¸²à¸¡à¸£à¸±à¸à¹à¸¥à¸°à¸„à¸¹à¹ˆà¸„à¸£à¸­à¸‡","vip_career":"à¸à¸²à¸£à¸‡à¸²à¸™à¹à¸¥à¸°à¸˜à¸¸à¸£à¸à¸´à¸ˆ",
    "vip_wealth":"à¸à¸²à¸£à¹€à¸‡à¸´à¸™à¹à¸¥à¸°à¸ˆà¸±à¸‡à¸«à¸§à¸°à¸£à¸²à¸¢à¹„à¸”à¹‰","vip_pet":"à¸ªà¸±à¸•à¸§à¹Œà¹€à¸¥à¸µà¹‰à¸¢à¸‡à¹à¸¥à¸°à¸ªà¸²à¸¢à¸ªà¸±à¸¡à¸à¸±à¸™à¸˜à¹Œ",
    "vip_hepan":"à¸„à¸§à¸²à¸¡à¹€à¸‚à¹‰à¸²à¸à¸±à¸™à¸‚à¸­à¸‡à¸”à¸§à¸‡ / à¸§à¸±à¸™à¹à¸•à¹ˆà¸‡à¸‡à¸²à¸™ / à¹€à¸§à¸¥à¸²à¹€à¸à¸´à¸”à¸¥à¸¹à¸","vip_name":"à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œà¸Šà¸·à¹ˆà¸­à¸šà¸£à¸´à¸©à¸±à¸— / à¸¥à¸¹à¸ / à¸à¸²à¸£à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸Šà¸·à¹ˆà¸­",
    "vip_fengshui":"à¸®à¸§à¸‡à¸ˆà¸¸à¹‰à¸¢à¸”à¹‰à¸²à¸™à¸à¸²à¸£à¹€à¸‡à¸´à¸™ï¼šà¸šà¹‰à¸²à¸™ / à¸ªà¸³à¸™à¸±à¸à¸‡à¸²à¸™",
    "vip_xinlian":"ğŸŒ™ à¸à¸·à¹‰à¸™à¸—à¸µà¹ˆ Xinlian à¸à¸´à¹€à¸¨à¸©","vip_record":"à¸šà¸±à¸™à¸—à¸¶à¸à¸ˆà¸´à¸•à¸§à¸´à¸à¸à¸²à¸“ï¼šà¸£à¸¹à¸›à¸ à¸²à¸ à¸„à¸§à¸²à¸¡à¸à¸±à¸™ à¹€à¸ªà¸µà¸¢à¸‡ à¸„à¸³à¸­à¸˜à¸´à¸©à¸à¸²à¸™",
    "vip_course":"à¸„à¸­à¸£à¹Œà¸ªï¼šà¸”à¸§à¸‡à¸ˆà¸µà¸™ / à¹„à¸à¹ˆà¸¢à¸´à¸›à¸‹à¸µ / à¹‚à¸«à¸£à¸²à¸¨à¸²à¸ªà¸•à¸£à¹Œ / à¸•à¸±à¸§à¹€à¸¥à¸‚ / Human Design",
    "vip_memorial":"à¸£à¸°à¸šà¸šà¸£à¸°à¸¥à¸¶à¸à¸–à¸¶à¸‡à¸„à¸£à¸­à¸šà¸„à¸£à¸±à¸§","vip_tasks":"à¹à¸šà¸šà¸à¸¶à¸à¸à¸¥à¸±à¸‡à¸‡à¸²à¸™à¸›à¸£à¸°à¸ˆà¸³à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œ / à¸‡à¸²à¸™à¸à¸´à¸˜à¸µà¸à¸£à¸£à¸¡",
    "vip_shop":"à¸ªà¹ˆà¸§à¸™à¸¥à¸”à¸£à¹‰à¸²à¸™à¸à¸¥à¸±à¸‡à¸‡à¸²à¸™ & à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸£à¸²à¸‡","login_title":"ğŸ’ à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š VIP",
    "panel_login_head":"à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š / à¸ªà¸¡à¸±à¸„à¸£à¸ªà¸¡à¸²à¸Šà¸´à¸","ph_email":"à¸­à¸µà¹€à¸¡à¸¥",
    "ph_label_password":"à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™","ph_password":"à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™ (à¸­à¸¢à¹ˆà¸²à¸‡à¸™à¹‰à¸­à¸¢ 8 à¸•à¸±à¸§à¸­à¸±à¸à¸©à¸£)",
    "btn_login":"à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š","btn_reset":"ğŸ”‘ à¸£à¸µà¹€à¸‹à¹‡à¸•à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™","btn_register":"à¸ªà¸¡à¸±à¸„à¸£à¸ªà¸¡à¸²à¸Šà¸´à¸",
    "note_price":"à¸ªà¸¡à¸±à¸„à¸£à¹ƒà¸«à¸¡à¹ˆà¸£à¸±à¸šà¸ªà¸´à¸—à¸˜à¸´à¹Œà¸—à¸”à¸¥à¸­à¸‡à¸Ÿà¸£à¸µ 1 à¸„à¸£à¸±à¹‰à¸‡","panel_member_head":"à¸šà¸£à¸´à¸à¸²à¸£à¸ªà¸¡à¸²à¸Šà¸´à¸",
    "btn_upgrade":"ğŸ’ à¸­à¸±à¸›à¹€à¸à¸£à¸”à¹€à¸›à¹‡à¸™ VIP (à¸£à¸²à¸¢à¹€à¸”à¸·à¸­à¸™)","btn_backshop":"â† à¸à¸¥à¸±à¸šà¸ªà¸¹à¹ˆà¸£à¹‰à¸²à¸™à¸„à¹‰à¸²",
    "note_price1":"$9.9 / à¹€à¸”à¸·à¸­à¸™ VIP (à¸”à¸§à¸‡ + Xinlian + à¸„à¸­à¸£à¹Œà¸ª)",
    "chat_fab":"à¸–à¸²à¸¡","chat_placeholder":"à¸à¸´à¸¡à¸à¹Œà¸„à¸³à¸–à¸²à¸¡à¸‚à¸­à¸‡à¸„à¸¸à¸“...","chat_send":"à¸ªà¹ˆà¸‡",
    "ai_title":"à¸œà¸¹à¹‰à¸Šà¹ˆà¸§à¸¢ Xinlian Â· à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢","ai_local_note":"(à¹ƒà¸Šà¹‰à¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œà¹à¸šà¸šà¸­à¸­à¸Ÿà¹„à¸¥à¸™à¹Œà¸Šà¸±à¹ˆà¸§à¸„à¸£à¸²à¸§)",
    "sec_basic":"à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸à¸·à¹‰à¸™à¸à¸²à¸™",
    "sec_lp":"à¹€à¸¥à¸‚à¹€à¸ªà¹‰à¸™à¸—à¸²à¸‡à¸Šà¸µà¸§à¸´à¸•",
    "sec_love":"à¹€à¸¥à¸‚à¸”à¹‰à¸²à¸™à¸­à¸²à¸£à¸¡à¸“à¹Œ / à¸„à¸§à¸²à¸¡à¸£à¸±à¸",
    chat_fab:"à¹à¸Šà¸•", 
    chat_title:"Concierge Â· à¹à¸Šà¸•", 
    chat_send:"à¸ªà¹ˆà¸‡", chat_bot_name:"Xinlian Butler", 
    chat_welcome:"à¸ªà¸§à¸±à¸ªà¸”à¸µ! à¸–à¸²à¸¡à¹„à¸”à¹‰à¹€à¸¥à¸¢", 
    chat_input_ph:"à¸à¸´à¸¡à¸à¹Œà¸„à¸³à¸–à¸²à¸¡â€¦"
  },
  
  "ms": {
    "brand":"5xLiving Â· Soul Sanctuary",
    "page_title":"Laporan Numerologi Ringkas","site_title":"Laporan Numerologi",
    "site_subtitle":"Versi percuma Â· VIP membuka peta numerologi penuh",
    "lang_label":"Bahasa","ph_birthdate":"Tarikh lahir","rule_pyth":"Sistem Pythagorean","btn_gen":"Jana Analisis",
    "hint_text":"Life Path = jumlah semua digit dalam tarikh lahir (YYYYMMDD) dikurangkan kepada 1â€“9, kekalkan 11/22/33; Nombor Cinta = hari (DD) dikurangkan kepada 1â€“9.",
    "res_title":"Pandangan & Nasihat",
    "vip_title":"ğŸŒ™ Segmen VIP","vip_mingli":"ğŸ— Kandungan Eksklusif Ruang Astrologi",
    "vip_love":"Cinta: pola tarikan & aliran perkahwinan","vip_career":"Kerjaya: gaya kerja & potensi bisnes",
    "vip_wealth":"Kewangan: aliran rezeki & masa yang sesuai","vip_pet":"Haiwan peliharaan: sikap & kaitan dengan anda",
    "vip_hepan":"Padanan carta: tarikh kahwin / masa kelahiran anak","vip_name":"Analisis nama: syarikat / bayi / penukaran nama",
    "vip_fengshui":"Fengshui rezeki: rumah / pejabat",
    "vip_xinlian":"ğŸŒ™ Ruang Xinlian Eksklusif","vip_record":"Rekod spiritual: gambar, mimpi, suara, doa",
    "vip_course":"Kursus: Bazi / Tarot / Astrologi / Numerologi / Human Design",
    "vip_memorial":"Sistem memorial keluarga","vip_tasks":"Latihan tenaga mingguan / tugasan ritual",
    "vip_shop":"Diskaun kedai tenaga & azimat","login_title":"ğŸ’ Log Masuk VIP",
    "panel_login_head":"Log masuk / Daftar","ph_email":"Emel",
    "ph_label_password":"Kata laluan","ph_password":"Kata laluan (min 8 aksara dengan huruf & simbol)",
    "btn_login":"Log masuk","btn_reset":"ğŸ”‘ Tetap semula kata laluan","btn_register":"Daftar",
    "note_price":"Akaun baharu menerima satu sesi percubaan percuma","panel_member_head":"Perkhidmatan ahli",
    "btn_upgrade":"ğŸ’ Naik taraf ke VIP (Bulanan)","btn_backshop":"â† Kembali ke kedai",
    "note_price1":"$9.9 / bulan VIP (Ruang Astro + Xinlian + Kursus)",
    "chat_fab":"Chat","chat_placeholder":"Tulis soalan anda...","chat_send":"Hantar",
    "ai_title":"Xinlian Butler Â· Insight","ai_local_note":"(Menggunakan penjana tempatan kerana rangkaian)",
    "sec_basic":"Maklumat Asas",
    "sec_lp":"Nombor Life Path",
    "sec_love":"Nombor Cinta",
    chat_fab:"Chat", 
    chat_title:"Concierge Â· Chat", 
    chat_send:"Hantar", 
    chat_bot_name:"Xinlian Butler", 
    chat_welcome:"Hai! Tanya apa-apa", 
    chat_input_ph:"Tulis soalanâ€¦"
  }
};

/* è¯­è¨€å·¥å…·ï¼ˆå¢åŠ è§„èŒƒåŒ–ï¼šen-US â†’ en, th-TH â†’ th, ms-MY â†’ ms ç­‰ï¼‰ */
function normalizeLang(raw){
  if(!raw) return 'zh-CN';
  if(raw.startsWith('zh')){
    return raw === 'zh-TW' ? 'zh-TW' : 'zh-CN';
  }
  if(raw.startsWith('en')) return 'en';
  if(raw.startsWith('ja')) return 'ja';
  if(raw.startsWith('th')) return 'th';
  if(raw.startsWith('ms')) return 'ms';
  return raw;
}
function getLang(){
  const stored = localStorage.getItem(LANG_KEY) || document.documentElement.lang || "zh-CN";
  return normalizeLang(stored);
}
function setLang(code){
  const norm = normalizeLang(code);
  localStorage.setItem(LANG_KEY, norm);
  document.documentElement.lang = norm;
}
function t(key){
  const pack = translations[getLang()] || translations["zh-CN"];
  return pack[key] || (translations["zh-CN"][key] || key);
}
function applyI18n(){
  document.querySelectorAll("[data-i18n]").forEach(el=>{
    const key = el.getAttribute("data-i18n");
    el.textContent = t(key);
  });
  document.querySelectorAll("[data-i18n-ph]").forEach(el=>{
    const key = el.getAttribute("data-i18n-ph");
    el.setAttribute("placeholder", t(key));
  });
  const titleEl = document.querySelector("title[data-i18n]");
  if (titleEl){
    const key = titleEl.getAttribute("data-i18n");
    titleEl.textContent = t(key);
  }
}
function applyChatI18n(){
  const fab = gid('ssChatFab');
  const inp = gid('ssChatInput');
  const btn = gid('ssChatSend');
  const title = document.querySelector('.ss-chat-title');
  if (fab) fab.textContent = t('chat_fab');
  if (inp) inp.placeholder = t('chat_placeholder');
  if (btn) btn.textContent = t('chat_send');
  if (title) title.textContent = 'å¿ƒæ€œç®¡å®¶ Â· Chat';
}

/* ===== é”™è¯¯æç¤º ===== */
function showErr(msg){
  const e=gid('error'); if(!e) return;
  e.textContent=msg; e.style.display='block';
  setTimeout(()=>{e.style.display='none';}, 4000);
}
function hideErr(){
  const e=gid('error'); if(e){ e.style.display='none'; e.textContent=''; }
}

/* ===== ç»“æ„ä¿éšœ ===== */
function ensureRootStructure(){
  let result=gid('result');
  if(!result){
    result=document.createElement('section');
    result.id='result'; result.className='card'; result.style.display='none';
    const main=document.querySelector('main')||document.body;
    main.appendChild(result);
    const h2=document.createElement('h2');
    h2.style.cssText='margin:0 0 10px;color:var(--gold)';
    h2.setAttribute('data-i18n','res_title');
    h2.textContent=t('res_title');
    result.appendChild(h2);
  }
  let numReport=gid('numReport');
  if(!numReport){
    numReport=document.createElement('div');
    numReport.id='numReport';
    numReport.className='report';
    result.appendChild(numReport);
  }
  return numReport;
}

/* ===== çµæ•°æ ¸å¿ƒ ===== */
const masters={11:1,22:1,33:1};
const isMaster=n=>!!masters[n];
function reduceNum(n){
  while(n>9 && !isMaster(n)){
    n = String(n).split('').reduce((a,b)=>a+Number(b),0);
  }
  return n;
}
function parseDateDigits(iso){
  if(!iso) return null;
  const d=iso.replace(/[^0-9]/g,'');
  if(d.length<8) return null;
  return d.split('').map(Number);
}
function calcLifePath(iso){
  const d=parseDateDigits(iso);
  if(!d) return null;
  return reduceNum(d.reduce((a,b)=>a+b,0));
}
function calcLoveNumber(iso){
  if(!iso) return null;
  const p=iso.split('-');
  const dd=Number(p[2]||'0');
  if(!dd) return null;
  return reduceNum(dd);
}

/* ===== æ¸²æŸ“åŸºç¡€æ‘˜è¦ï¼ˆæ•°å­— + ç®€çŸ­è¯´æ˜ï¼‰ ===== */
function renderProReport(obj){
  const wrap = ensureRootStructure();
  const { iso, lp, lv } = obj;
  const lang = getLang() || 'zh-CN';

  const basicTitle = t('sec_basic');
  const lpTitle    = t('sec_lp');
  const loveTitle  = t('sec_love');

  let birthLabel, lpLabel, loveLabel;
  switch (lang) {
    case 'zh-TW':
      birthLabel = 'å‡ºç”Ÿæ—¥æœŸï¼š';
      lpLabel    = 'ç”Ÿå‘½è·¯å¾‘ ';
      loveLabel  = 'æƒ…æ„Ÿæ•¸å­— ';
      break;
    case 'zh-CN':
      birthLabel = 'å‡ºç”Ÿæ—¥æœŸï¼š';
      lpLabel    = 'ç”Ÿå‘½è·¯å¾„ ';
      loveLabel  = 'æƒ…æ„Ÿæ•°å­— ';
      break;
    case 'ja':
      birthLabel = 'ç”Ÿå¹´æœˆæ—¥ï¼š';
      lpLabel    = 'ãƒ©ã‚¤ãƒ•ãƒ‘ã‚¹ãƒŠãƒ³ãƒãƒ¼ ';
      loveLabel  = 'æ„Ÿæƒ…ï¼æ‹æ„›ãƒŠãƒ³ãƒãƒ¼ ';
      break;
    case 'th':
      birthLabel = 'à¸§à¸±à¸™à¹€à¸”à¸·à¸­à¸™à¸›à¸µà¹€à¸à¸´à¸”: ';
      lpLabel    = 'à¹€à¸¥à¸‚à¹€à¸ªà¹‰à¸™à¸—à¸²à¸‡à¸Šà¸µà¸§à¸´à¸• ';
      loveLabel  = 'à¹€à¸¥à¸‚à¸”à¹‰à¸²à¸™à¸­à¸²à¸£à¸¡à¸“à¹Œ / à¸„à¸§à¸²à¸¡à¸£à¸±à¸ ';
      break;
    case 'ms':
      birthLabel = 'Tarikh lahir: ';
      lpLabel    = 'Nombor Life Path ';
      loveLabel  = 'Nombor Cinta ';
      break;
    default:
      birthLabel = 'Birth date: ';
      lpLabel    = 'Life Path ';
      loveLabel  = 'Love Number ';
  }

  const lpTag = isMaster(lp)
    ? (lang === 'ja'
        ? 'ï¼ˆãƒã‚¹ã‚¿ãƒ¼ãƒŠãƒ³ãƒãƒ¼ï¼‰'
        : (lang.startsWith('zh') ? 'ï¼ˆå¤§å¸ˆæ•°å­—ï¼‰' : ' (Master Number)'))
    : '';
  const lvTag = isMaster(lv)
    ? (lang === 'ja'
        ? 'ï¼ˆãƒã‚¹ã‚¿ãƒ¼ãƒŠãƒ³ãƒãƒ¼ï¼‰'
        : (lang.startsWith('zh') ? 'ï¼ˆå¤§å¸ˆæ•°å­—ï¼‰' : ' (Master Number)'))
    : '';

  let tones;
  if (lang === 'ja') {
    tones = {
      1:'ä¸»ä½“æ€§ãŒå¼·ãã€ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã‚’ç™ºæ®ã—ã‚„ã™ã„æ•°å­—ã§ã™ã€‚é ¼ã‚‹ã“ã¨ãƒ»äººã«ä»»ã›ã‚‹ã“ã¨ã‚‚å­¦ã³ã«ãªã‚Šã¾ã™ã€‚',
      2:'äººã®æ°—æŒã¡ã«æ•æ„Ÿã§ã€èª¿æ•´å½¹ã«ãªã‚Šã‚„ã™ã„ã‚¿ã‚¤ãƒ—ã§ã™ã€‚å¢ƒç•Œç·šã‚’æŒã¤ã“ã¨ã§ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’å®ˆã‚Œã¾ã™ã€‚',
      3:'è¡¨ç¾åŠ›ã¨ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–ãªæ„Ÿæ€§ãŒè±Šã‹ã§ã™ã€‚æ¥½ã—ã¿ãªãŒã‚‰ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã™ã‚‹ã¨é‹æ°—ãŒå‹•ãã¾ã™ã€‚',
      4:'å®‰å®šãƒ»ç§©åºãƒ»åœŸå°ã¥ãã‚Šã®æ•°å­—ã§ã™ã€‚é•·æœŸçš„ãªä»•çµ„ã¿ã¥ãã‚Šã«å‘ã„ã¦ã„ã¾ã™ãŒã€å¿ƒé…ã—ã™ãã«æ³¨æ„ã€‚',
      5:'å¤‰åŒ–ã¨è‡ªç”±ã‚’æ±‚ã‚ã‚‹æ¢ç©¶è€…ã‚¿ã‚¤ãƒ—ã§ã™ã€‚ç’°å¢ƒã‚’å¤‰ãˆã‚‹ã“ã¨ã§å¤§ããæˆé•·ã—ã¾ã™ãŒã€è‡ªå¾‹ã®ãƒãƒ©ãƒ³ã‚¹ã‚‚å¤§åˆ‡ã€‚',
      6:'è²¬ä»»æ„ŸãŒå¼·ãã€å®¶æ—ã‚„å‘¨å›²ã‚’å®ˆã‚ã†ã¨ã™ã‚‹å„ªã—ã•ãŒã‚ã‚Šã¾ã™ã€‚ã¾ãšè‡ªåˆ†ã‚’æº€ãŸã™ã“ã¨ãŒãƒ†ãƒ¼ãƒã«ãªã‚Šã¾ã™ã€‚',
      7:'ç‰©äº‹ã‚’æ·±ãè€ƒãˆã€æ¢æ±‚ã—ãŸã„æ°—æŒã¡ãŒå¼·ã„æ•°å­—ã§ã™ã€‚ç›´æ„Ÿã¨ãƒ‡ãƒ¼ã‚¿ã®ä¸¡æ–¹ã‚’å¤§äº‹ã«ã™ã‚‹ã¨å®‰å®šã—ã¾ã™ã€‚',
      8:'æˆæœãƒ»é”æˆãƒ»ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆã®æ•°å­—ã§ã™ã€‚ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã‚„ãŠé‡‘ã®æ‰±ã„ã«å­¦ã³ãŒã‚ã‚Šã¾ã™ã€‚',
      9:'å…±æ„ŸåŠ›ãŒé«˜ãã€äººã®ãŸã‚ã«å‹•ãã‚„ã™ã„ãƒ’ãƒ¥ãƒ¼ãƒãƒ‹ã‚¹ãƒˆã§ã™ã€‚æŠ±ãˆè¾¼ã¿ã™ããªã„æ‰‹æ”¾ã—ãŒå¤§äº‹ãªãƒ†ãƒ¼ãƒã§ã™ã€‚',
      11:'ç›´æ„Ÿã¨ã‚¤ãƒ³ã‚¹ãƒ”ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒå¼·ã„ãƒã‚¹ã‚¿ãƒ¼ãƒŠãƒ³ãƒãƒ¼ã§ã™ã€‚groundingï¼ˆåœ°ã«è¶³ã‚’ã¤ã‘ã‚‹ã“ã¨ï¼‰ãŒéµã«ãªã‚Šã¾ã™ã€‚',
      22:'å¤§ããªãƒ“ã‚¸ãƒ§ãƒ³ã‚’ç¾å®Ÿã«è½ã¨ã—è¾¼ã‚€åŠ›ã‚’æŒã¤ãƒã‚¹ã‚¿ãƒ¼ãƒŠãƒ³ãƒãƒ¼ã§ã™ã€‚æ®µéšçš„ãªè¨ˆç”»ãŒæˆåŠŸã®ãƒã‚¤ãƒ³ãƒˆã§ã™ã€‚',
      33:'å¥‰ä»•ãƒ»ç™’ã—ãƒ»æ•™ãˆã‚‹ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒå¼·ã„æ•°å­—ã§ã™ã€‚è‡ªåˆ†ã‚’çŠ ç‰²ã«ã—éããªã„ã“ã¨ãŒæœ€å¤§ã®ãƒ†ãƒ¼ãƒã«ãªã‚Šã¾ã™ã€‚'
    };
  } else if (lang.startsWith('zh')) {
    tones = {
      1:'ç‹¬ç«‹ã€å¼€åˆ›ï¼Œå¾ˆé€‚åˆå¸¦å¤´ï¼›éœ€è¦å­¦ä¹ çš„æ˜¯ã€Œè¯·äººå¸®å¿™ã€ã€‚',
      2:'æ¸©å’Œã€æ•æ„Ÿï¼Œæ“…é•¿åè°ƒå…³ç³»ï¼›éœ€è¦ç•Œçº¿æ„Ÿé¿å…è¢«æ¶ˆè€—ã€‚',
      3:'è¡¨è¾¾åŠ›ä¸åˆ›æ„å¼ºï¼Œé€‚åˆè¯´å†™æ¼”ï¼›è¦é¿å…åˆ†å¿ƒä¸åŠé€”è€ŒåºŸã€‚',
      4:'é‡è§†ç§©åºä¸å®‰å…¨ï¼Œé€‚åˆæ­å»ºç³»ç»Ÿï¼›æœ‰æ—¶ä¼šè¿‡åº¦ç´§ç»·ä¸æ‹…å¿ƒã€‚',
      5:'çƒ­çˆ±è‡ªç”±ä¸å˜åŒ–ï¼Œé€‚åˆæ¢ç´¢ä¸æµåŠ¨ï¼›éœ€è¦è‡ªå¾‹æ¥é¿å…å¤±æ§ã€‚',
      6:'åœ¨ä¹è´£ä»»ä¸æ‰¿è¯ºï¼Œæœ‰ã€Œç…§é¡¾äººã€çš„å¤©æ€§ï¼›è¦å­¦ä¼šå…ˆç…§é¡¾è‡ªå·±ã€‚',
      7:'å†…åœ¨æ€è€ƒå¾ˆå¤šï¼Œå–œæ¬¢ç ”ç©¶ä¸æ·±åº¦ï¼›éœ€è¦ä¿¡ä»»ç›´è§‰ä¸èº«ä½“æ„Ÿå—ã€‚',
      8:'ç›®æ ‡æ„Ÿå¼ºï¼Œé€‚åˆç†è´¢ä¸ç®¡ç†ï¼›ä¹Ÿè¦å­¦ä¹ æŸ”è½¯ä¸åˆ†äº«ã€‚',
      9:'åŒ…å®¹ã€å…±æƒ…ï¼Œå®¹æ˜“ä¸ºåˆ«äººä»˜å‡ºï¼›è¦ç•™æ„æƒ…ç»ªç´¯ç§¯ä¸é€ƒé¿ã€‚',
      11:'çµæ„Ÿå¼ºã€æ„Ÿå—ç»†è…»ï¼Œæ˜¯ã€Œå¤©çº¿å‹ã€ï¼›éœ€è¦ç¨³æ‰åœ°æ°”ä¸ç°å®ç»“æ„ã€‚',
      22:'æœ‰æŠŠæ„¿æ™¯è½åœ°çš„èƒ½åŠ›ï¼Œé€‚åˆå¤§é¡¹ç›®ï¼›è¦åˆ†é˜¶æ®µæ‰§è¡Œï¼Œé¿å…è¿‡å‹ã€‚',
      33:'å¸¦æœ‰ç–—æ„ˆä¸æœåŠ¡ä½¿å‘½ï¼Œä½†è¦å…ˆç…§é¡¾å¥½è‡ªå·±ï¼Œæ‰ä¸ä¼šè¿‡åº¦é€æ”¯ã€‚'
    };
  } else if (lang === 'th') {
    tones = {
      1:'à¸¡à¸µà¸„à¸§à¸²à¸¡à¹€à¸›à¹‡à¸™à¸œà¸¹à¹‰à¸™à¸³à¸ªà¸¹à¸‡ à¸à¸¥à¹‰à¸²à¸•à¸±à¸”à¸ªà¸´à¸™à¹ƒà¸ˆ à¹à¸•à¹ˆà¸­à¸¢à¹ˆà¸²à¸£à¸±à¸šà¸—à¸¸à¸à¸­à¸¢à¹ˆà¸²à¸‡à¹„à¸§à¹‰à¸„à¸™à¹€à¸”à¸µà¸¢à¸§à¸ˆà¸™à¹€à¸«à¸™à¸·à¹ˆà¸­à¸¢à¹€à¸à¸´à¸™à¹„à¸›',
      2:'à¸­à¹ˆà¸­à¸™à¹‚à¸¢à¸™ à¹€à¸‚à¹‰à¸²à¹ƒà¸ˆà¸„à¸§à¸²à¸¡à¸£à¸¹à¹‰à¸ªà¸¶à¸à¸„à¸™à¸­à¸·à¹ˆà¸™à¹€à¸à¹ˆà¸‡ à¸•à¹‰à¸­à¸‡à¸¡à¸µà¸‚à¸­à¸šà¹€à¸‚à¸•à¸Šà¸±à¸”à¹€à¸ˆà¸™à¹€à¸à¸·à¹ˆà¸­à¸£à¸±à¸à¸©à¸²à¸à¸¥à¸±à¸‡à¸•à¸±à¸§à¹€à¸­à¸‡',
      3:'à¸Šà¸­à¸šà¸ªà¸·à¹ˆà¸­à¸ªà¸²à¸£à¹à¸¥à¸°à¸ªà¸£à¹‰à¸²à¸‡à¸ªà¸£à¸£à¸„à¹Œ à¸¢à¸´à¹ˆà¸‡à¹„à¸”à¹‰à¸à¸¹à¸” à¹€à¸‚à¸µà¸¢à¸™ à¸«à¸£à¸·à¸­à¹€à¸¥à¹ˆà¸² à¸¢à¸´à¹ˆà¸‡à¸—à¸³à¹ƒà¸«à¹‰à¸à¸¥à¸±à¸‡à¹„à¸«à¸¥à¸¥à¸·à¹ˆà¸™',
      4:'à¸£à¸±à¸à¸„à¸§à¸²à¸¡à¸¡à¸±à¹ˆà¸™à¸„à¸‡à¹à¸¥à¸°à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡ à¹€à¸«à¸¡à¸²à¸°à¸à¸±à¸šà¸‡à¸²à¸™à¸§à¸²à¸‡à¸£à¸°à¸šà¸š à¹à¸•à¹ˆà¸­à¸¢à¹ˆà¸²à¸à¸”à¸”à¸±à¸™à¸•à¸±à¸§à¹€à¸­à¸‡à¸ˆà¸™à¹€à¸à¸´à¸™à¹„à¸›',
      5:'à¸£à¸±à¸à¸­à¸´à¸ªà¸£à¸°à¹à¸¥à¸°à¸à¸²à¸£à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹à¸›à¸¥à¸‡ à¹€à¸•à¸´à¸šà¹‚à¸•à¹„à¸”à¹‰à¸”à¸µà¹€à¸¡à¸·à¹ˆà¸­à¹„à¸”à¹‰à¸¥à¸­à¸‡à¸ªà¸´à¹ˆà¸‡à¹ƒà¸«à¸¡à¹ˆ à¹† à¹à¸•à¹ˆà¸•à¹‰à¸­à¸‡à¸¡à¸µà¸§à¸´à¸™à¸±à¸¢à¹€à¸¥à¹‡à¸à¸™à¹‰à¸­à¸¢à¸„à¸­à¸¢à¸à¸¢à¸¸à¸‡',
      6:'à¹ƒà¸ªà¹ˆà¹ƒà¸ˆà¸”à¸¹à¹à¸¥à¸„à¸™à¸£à¸­à¸šà¸‚à¹‰à¸²à¸‡à¸¡à¸²à¸ à¸„à¸§à¸£à¹€à¸£à¸´à¹ˆà¸¡à¸ˆà¸²à¸à¸à¸²à¸£à¸”à¸¹à¹à¸¥à¸•à¸±à¸§à¹€à¸­à¸‡à¹ƒà¸«à¹‰à¹€à¸•à¹‡à¸¡à¸à¹ˆà¸­à¸™',
      7:'à¸Šà¸­à¸šà¸„à¸´à¸”à¸¥à¸¶à¸ à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œ à¹à¸¥à¸°à¸„à¹‰à¸™à¸„à¸§à¹‰à¸² à¹ƒà¸«à¹‰à¹ƒà¸Šà¹‰à¸—à¸±à¹‰à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹à¸¥à¸°à¸„à¸§à¸²à¸¡à¸£à¸¹à¹‰à¸ªà¸¶à¸à¸„à¸§à¸šà¸„à¸¹à¹ˆà¸à¸±à¸™',
      8:'à¹‚à¸Ÿà¸à¸±à¸ªà¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œà¹à¸¥à¸°à¸„à¸§à¸²à¸¡à¸ªà¸³à¹€à¸£à¹‡à¸ˆà¹€à¸à¹ˆà¸‡ à¸•à¹‰à¸­à¸‡à¸šà¸²à¸¥à¸²à¸™à¸‹à¹Œà¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡à¸‡à¸²à¸™ à¹€à¸‡à¸´à¸™ à¹à¸¥à¸°à¸à¸²à¸£à¸à¸±à¸à¹ƒà¸ˆ',
      9:'à¹€à¸¡à¸•à¸•à¸² à¹€à¸«à¹‡à¸™à¹ƒà¸ˆà¸œà¸¹à¹‰à¸­à¸·à¹ˆà¸™à¸‡à¹ˆà¸²à¸¢ à¸£à¸°à¸§à¸±à¸‡à¹à¸šà¸à¹€à¸£à¸·à¹ˆà¸­à¸‡à¸„à¸™à¸­à¸·à¹ˆà¸™à¸¡à¸²à¸à¹€à¸à¸´à¸™à¹„à¸›à¸ˆà¸™à¸¥à¹‰à¸²',
      11:'à¸­à¸´à¸™à¸—à¸¹à¸­à¸´à¸Šà¸±à¸™à¹à¸£à¸‡ à¸£à¸±à¸šà¸à¸¥à¸±à¸‡à¸£à¸­à¸šà¸•à¸±à¸§à¹„à¸”à¹‰à¹„à¸§ à¸•à¹‰à¸­à¸‡à¸¡à¸µà¸à¸·à¹‰à¸™à¸—à¸µà¹ˆà¸ªà¸‡à¸šà¹ƒà¸«à¹‰à¸•à¸±à¸§à¹€à¸­à¸‡ ground à¸ˆà¸´à¸•à¹ƒà¸ˆ',
      22:'à¸¡à¸µà¸à¸¥à¸±à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¸ªà¸´à¹ˆà¸‡à¹ƒà¸«à¸à¹ˆ à¹† à¹ƒà¸«à¹‰à¹€à¸›à¹‡à¸™à¸£à¸¹à¸›à¸˜à¸£à¸£à¸¡ à¸„à¹ˆà¸­à¸¢ à¹† à¹à¸šà¹ˆà¸‡à¹€à¸›à¹‡à¸™à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸ˆà¸°à¹€à¸«à¹‡à¸™à¸œà¸¥à¸Šà¸±à¸”à¹€à¸ˆà¸™',
      33:'à¸à¸¥à¸±à¸‡à¸à¸²à¸£à¹€à¸¢à¸µà¸¢à¸§à¸¢à¸²à¹à¸¥à¸°à¸à¸²à¸£à¹ƒà¸«à¹‰à¸ªà¸¹à¸‡ à¸£à¸°à¸§à¸±à¸‡à¸­à¸¢à¹ˆà¸²à¸—à¸³à¸•à¸±à¸§à¹€à¸­à¸‡à¸«à¸¡à¸”à¹à¸£à¸‡à¸ˆà¸²à¸à¸à¸²à¸£à¸Šà¹ˆà¸§à¸¢à¸„à¸™à¸­à¸·à¹ˆà¸™à¸¡à¸²à¸à¹€à¸à¸´à¸™à¹„à¸›'
    };
  } else if (lang === 'ms') {
    tones = {
      1:'Bersifat berdikari dan suka memimpin, tetapi jangan memikul semua tanggungjawab seorang diri.',
      2:'Lembut, mudah bekerjasama dan peka pada emosi orang lain; perlu sempadan yang sihat untuk jaga tenaga.',
      3:'Ekspresif dan kreatif; lagi banyak berkongsi idea, lagi lancar aliran hidup anda.',
      4:'Sistematik dan praktikal; kuat dalam membina struktur, tetapi jangan keras pada diri sendiri terlalu banyak.',
      5:'Suka perubahan dan kebebasan; berkembang melalui pengalaman baru, dengan rutin ringkas sebagai jangkar.',
      6:'Suka menjaga orang lain; mula dahulu dengan menjaga diri sendiri supaya tidak letih emosi.',
      7:'Analitik dan intuitif; seimbangkan antara logik dan gerak hati.',
      8:'Berorientasikan pencapaian dan hasil; sesuai memimpin dan mengurus, tetapi perlu ruang untuk berehat.',
      9:'Prihatin, berjiwa besar dan humanis; perhatikan masa rehat supaya tidak keletihan emosi.',
      11:'Intuitif dan visionari; perlukan sempadan tenaga dan kehidupan harian yang stabil.',
      22:'Pembangun berskala besar; mampu menukar visi kepada kesan nyata dengan langkah kecil yang konsisten.',
      33:'Cenderung menyembuh dan berkhidmat; elakkan pengorbanan diri yang berlebihan.'
    };
  } else {
    tones = {
      1:'Independent, pioneering, and needs room to lead.',
      2:'Gentle, cooperative, and sensitive to atmosphere.',
      3:'Expressive, creative, and thrives when sharing ideas.',
      4:'Structured, practical, and strong with systems.',
      5:'Dynamic, curious, and grows through change and travel.',
      6:'Caring, responsible, and focused on home and loved ones.',
      7:'Analytical, intuitive, and drawn to research or spirituality.',
      8:'Ambitious, strategic, and attracted to leadership and results.',
      9:'Compassionate, big-picture, and humanitarian.',
      11:'Highly intuitive and visionary, needs good energetic boundaries.',
      22:'Big-scale builder who can turn vision into concrete impact.',
      33:'Healing, teaching, and service-oriented, but must avoid self-sacrifice.'
    };
  }

  const lpNote = tones[lp] || '';
  const lvNote = tones[lv] || '';

  wrap.innerHTML = `
    <div class="sec">
      <h3>${basicTitle}</h3>
      <p>${birthLabel}${iso}</p>
    </div>
    <div class="sec">
      <h3>${lpTitle}</h3>
      <p>${lpLabel}<b>${lp}</b> ${lpTag}</p>
      ${lpNote ? `<p>${lpNote}</p>` : ''}
    </div>
    <div class="sec">
      <h3>${loveTitle}</h3>
      <p>${loveLabel}<b>${lv}</b> ${lvTag}</p>
      ${lvNote ? `<p>${lvNote}</p>` : ''}
    </div>
  `;
}

/* ===== æœ¬åœ°å…œåº•æ–‡æ¡ˆï¼ˆAI æ‰çº¿ / é™æµæ—¶ç”¨ï¼Œä¹Ÿå˜æˆä¸»åŠ›å¼•æ“ï¼‰ ===== */
/* ===== æœ¬åœ°å…œåº•æ–‡æ¡ˆï¼ˆAI æ‰çº¿ / é™æµæ—¶ç”¨ï¼‰ ===== */
function localNumerologyInsight({ iso, lp, lv }) {
  const lang = (typeof getLang === 'function' ? getLang() : 'en') || 'en';
  const isZh  = lang.startsWith('zh');
  const isJa  = lang === 'ja';
  const isTh  = lang === 'th';
  const isMs  = lang === 'ms';

  function isMaster(n) {
    return n === 11 || n === 22 || n === 33;
  }

  // ===== ä¸­æ–‡ç‰¹ä¾‹ï¼š3 / 3 ç»„åˆï¼Œç”¨é•¿ç‰ˆ =====
  if (isZh && lp === 3 && lv === 3) {
    return `
<h3>æ ¸å¿ƒç”»åƒ</h3>
<p>
ç”Ÿå‘½è·¯å¾„ <b>3</b> ä¸æƒ…æ„Ÿæ•°å­— <b>3</b> çš„ç»„åˆï¼Œæ˜¯ä¸€ä¸ªã€Œå†…å¤–å¦‚ä¸€çš„è¡¨è¾¾è€…ã€ç»“æ„ï¼š
ä½ çš„é•¿æœŸé©±åŠ¨åŠ›èµ°è¡¨è¾¾ä¸åˆ›æ„ï¼Œæƒ…ç»ªè¿ä½œæ–¹å¼ä¹Ÿé€šè¿‡è¡¨è¾¾æ¥æ¶ˆåŒ–ã€ç–—æ„ˆä¸è¿æ¥ã€‚
å½“ä½ ä¸€è¾¹åšã€ä¸€è¾¹è®²ã€ä¸€è¾¹å†™æ—¶ï¼Œæ•´ä½“èƒ½é‡æ˜¯æœ€é¡ºçš„ã€‚
</p>
<p>
å½“ç¯å¢ƒå…è®¸ä½ åšè‡ªå·±ã€æ„¿æ„å¬ä½ è¯´ï¼Œä½ ä¼šè‡ªç„¶ç»½æ”¾ï¼šç‚¹å­å¤šã€ç”»é¢æ„Ÿå¼ºã€æ•…äº‹æ„Ÿå¾ˆè¶³ï¼Œ
ä¹Ÿå¾ˆå®¹æ˜“ç”¨ä¸€å¥è¯å°±å®‰æŠšåˆ°åˆ«äººã€‚ä½†å¦‚æœé•¿æœŸè¢«æ‰“æ–­ã€è¢«å¦å®šï¼Œä½ çš„è¡¨è¾¾èƒ½é‡ä¼šå¾€å†…æ”¶ï¼Œ
å˜æˆè‡ªæˆ‘æ€€ç–‘ã€æ‹–å»¶ï¼Œæˆ–ä»€ä¹ˆéƒ½ä¸æƒ³è¯´ã€‚
</p>

<h3>æ€§æ ¼ä¸å¤©èµ‹</h3>
<p>
<b>ç”Ÿå‘½è·¯å¾„ 3</b> è®©ä½ è‡ªå¸¦ä¸€ä¸ªã€Œå°èˆå°ã€ï¼šä½ é€‚åˆè¯´ã€å†™ã€åˆ†äº«è¿‡ç¨‹ï¼Œ
æŠŠæŠ½è±¡çš„ä¸œè¥¿å˜æˆåˆ«äººå¬å¾—æ‡‚çš„ä¾‹å­ä¸æ•…äº‹ã€‚ä½ å¾ˆé€‚åˆï¼š
</p>
<ul>
  <li><b>åšå†…å®¹ï¼š</b>æ–‡å­—ã€è„šæœ¬ã€æ•™å­¦ã€é¡¾é—®è¯´æ˜ã€ç®€æŠ¥ã€ä¼åˆ’åŒ…è£…ï¼›</li>
  <li><b>åšæ¡¥æ¢ï¼š</b>å¸®åˆ«äººç¿»è¯‘å¤æ‚èµ„è®¯ï¼Œå˜æˆç®€å•æ­¥éª¤æˆ–å›¾åƒï¼›</li>
  <li><b>åšæ°”æ°›ï¼š</b>ç”¨å¹½é»˜ã€æ¯”å–»ã€ç©ç¬‘ï¼Œè®©åœºé¢æ¾ä¸‹æ¥ã€äººæ”¾æ¾ä¸‹æ¥ã€‚</li>
</ul>
<p>
ä½ çš„å­¦ä¹ æ–¹å¼ä¹Ÿå¾ˆ 3 å·ï¼šä¸æ˜¯é—·å¤´çœ‹ä¹¦ï¼Œè€Œæ˜¯ã€Œè®²å‡ºæ¥å°±æ›´æ‡‚ã€ã€‚
åªè¦ä½ å…è®¸è‡ªå·±è¾¹è¾“å‡ºè¾¹ä¿®æ­£ï¼Œä¸“ä¸šåº¦ä¼šåœ¨è¯´æ˜çš„è¿‡ç¨‹ä¸­å¿«é€Ÿç´¯ç§¯ã€‚
</p>

<h3>æ„Ÿæƒ…ä¸å…³ç³»</h3>
<p>
<b>æƒ…æ„Ÿæ•°å­— 3</b> ä»£è¡¨ä½ åœ¨äº²å¯†å…³ç³»é‡Œï¼Œä¹Ÿæ˜¯èµ°ã€Œè¡¨è¾¾å‹ã€è·¯çº¿ï¼š
å¿«ä¹ä¼šæƒ³åˆ†äº«ï¼Œå—ä¼¤ä¼šæƒ³è¯´å‡ºæ¥æˆ–å†™å‡ºæ¥ã€‚
ä½ éœ€è¦çš„æ˜¯å¯ä»¥ä¸€èµ·èŠå¤©ã€äº¤æ¢æƒ³æ³•ã€åˆ†äº«æ—¥å¸¸ç»†èŠ‚çš„è¿ç»“ï¼Œè€Œä¸æ˜¯åªæœ‰ã€Œä¸€èµ·åšäº‹å´ä¸è¯´è¯ã€ã€‚
</p>
<p>
å½“å¦ä¸€æ–¹è‚¯å¬ä½ è®²ï¼Œä¹Ÿæ„¿æ„åˆ†äº«è‡ªå·±çš„å†…å¿ƒæ—¶ï¼Œä½ ä¼šå¾ˆæœ‰å®‰å…¨æ„Ÿï¼›
ä½†å¦‚æœé•¿æœŸè¢«æ•·è¡ã€è¢«å¿½ç•¥ï¼Œä½ ä¼šï¼š
</p>
<ul>
  <li>ä¸€å¼€å§‹è®²å¾ˆå¤šã€è§£é‡Šå¾ˆå¤šï¼Œè¯•å›¾è®©å¯¹æ–¹æ‡‚ä½ ï¼›</li>
  <li>åæ¥çªç„¶å®‰é™ã€æ”¶å›è¯è¯­æƒï¼Œè§‰å¾—ã€Œè®²äº†ä¹Ÿæ²¡æœ‰ç”¨ã€ã€‚</li>
</ul>
<p>
é‡ç‚¹ä¸æ˜¯å«ä½ é—­å˜´ï¼Œè€Œæ˜¯ï¼šç”¨æ¯”è¾ƒã€Œæœ‰è¾¹ç•Œã€çš„æ–¹å¼è¡¨è¾¾â€”â€”å…ˆè¯´ã€Œæˆ‘ç°åœ¨çš„æ„Ÿå—æ˜¯â€¦â€¦ã€ï¼Œå†æ…¢æ…¢è®²ç»†èŠ‚ï¼Œ
è€Œä¸æ˜¯ä¸€æ¬¡æŠŠæ‰€æœ‰ä¸œè¥¿å…¨éƒ¨å€’å‡ºæ¥ã€‚
</p>

<h3>ä¼˜åŠ¿ä¸ç›²ç‚¹</h3>
<p><b>ä¼˜åŠ¿ï¼š</b></p>
<ul>
  <li><b>è¡¨è¾¾ä¸æ•…äº‹åŠ›ï¼š</b>èƒ½æŠŠå¤æ‚ä¸»é¢˜è®²æˆåˆ«äººå¬å¾—æ‡‚çš„æ•…äº‹ä¸ç”»é¢ã€‚</li>
  <li><b>åˆ›æ„ä¸è”æƒ³åŠ›ï¼š</b>çœ‹åˆ°ä¸€ä¸ªç‚¹ï¼Œå¯ä»¥è”æƒ³åˆ°ä¸€æ•´ä¸²ç”»é¢ä¸å¯èƒ½æ€§ã€‚</li>
  <li><b>ç–—æ„ˆå¼å¹½é»˜æ„Ÿï¼š</b>ä½ çŠ¶æ€å¥½æ—¶ï¼Œåæ§½ã€ç©ç¬‘éƒ½å¸¦ä¸€ç‚¹ç–—æ„ˆæ•ˆæœã€‚</li>
  <li><b>è¾¹åšè¾¹è¯´çš„æ•´åˆåŠ›ï¼š</b>è®²è§£çš„è¿‡ç¨‹ï¼Œå°±æ˜¯å¸®è‡ªå·±æ•´ç†é€»è¾‘çš„è¿‡ç¨‹ã€‚</li>
</ul>
<p><b>éœ€è¦ç•™æ„ï¼š</b></p>
<ul>
  <li><b>å®¹æ˜“åˆ†å¿ƒã€é¡¹ç›®åšä¸€åŠï¼š</b>ç‚¹å­å¤ªå¤šï¼Œå¦‚æœæ²¡æœ‰ã€Œå®Œæˆå®šä¹‰ã€ï¼Œå¾ˆéš¾æ”¶å°¾ã€‚</li>
  <li><b>æƒ…ç»ªæ‹‰ç€èµ°ï¼š</b>åˆ«äººæœ‰æ²’æœ‰å›åº”ï¼Œå¾ˆå®¹æ˜“è¢«å½“æˆã€Œæˆ‘åˆ°åº•å¥½ä¸å¥½ã€ã€‚</li>
  <li><b>è¢«è¯¯è§£æ—¶ä¼šç”¨åŠ›è¿‡çŒ›ï¼š</b>è¶Šæƒ³è§£é‡Šæ¸…æ¥šï¼Œåˆ«äººè¶Šè·Ÿä¸ä¸Šã€‚</li>
</ul>

<h3>é˜¶æ®µè¯¾é¢˜ä¸ç–—æ„ˆ</h3>
<p>
é‡è¦è¯¾é¢˜æ˜¯ã€Œè®©è¡¨è¾¾æœ‰ç»“æ„ã€ï¼Œè€Œä¸æ˜¯ã€Œä¸è¦è¡¨è¾¾ã€ã€‚
å½“ä½ ä¸ºè‡ªå·±çš„è¾“å‡ºè®¾å®šè¾¹ç•Œä¸èŠ‚å¥æ—¶ï¼Œ3 å·èƒ½é‡ä¼šå˜æˆå¾ˆæœ‰åŠ›é‡çš„å·¥å…·ï¼Œè€Œä¸æ˜¯è®©ä½ ç´¯çš„æ¥æºã€‚
</p>

<h3>ä»Šæ—¥ï¼æœ¬å‘¨å¯æ‰§è¡Œ</h3>
<ul>
  <li><b>1ï¼‰25 åˆ†é’Ÿå•ç‚¹å°å†²åˆºï¼š</b>åªåšä¸€ä»¶äº‹ï¼Œä¾‹å¦‚å†™ä¸€æ®µæ–‡æ¡ˆæˆ–æ•´ç†ä¸€é¡µå†…å®¹ã€‚</li>
  <li><b>2ï¼‰å†™ä¸‹ä¸€ä¸ªç›®æ ‡çš„å®Œæˆå®šä¹‰ï¼š</b>ä¾‹å¦‚ã€Œè¿™é¡µæœ‰ä¸‰æ®µè¯´æ˜ï¼‹ä¸€ä¸ªæŒ‰é’®å°±ç®—å®Œæˆã€ã€‚</li>
  <li><b>3ï¼‰æ¯å¤©ä¸‰è¡Œæ—¥è®°ï¼š</b>ä»Šå¤©çš„è§‚å¯Ÿã€æ„Ÿè°¢çš„äº‹ã€æœ€å›°æ‰°çš„ä¸€ç‚¹ã€‚</li>
  <li><b>4ï¼‰ç»ƒä¹ ä¸€å¥æƒ…ç»ªç”¨è¯­ï¼š</b>ã€Œæˆ‘ç°åœ¨æœ‰ç‚¹ä¹±ï¼Œæƒ³å…ˆç†ä¸€ä¸‹å†è¯´ã€ã€‚</li>
</ul>
    `;
  }

  // ===== ä¸­æ–‡ç‰¹ä¾‹ï¼š1 / 8 ç»„åˆï¼Œç”¨é•¿ç‰ˆ =====
  if (isZh && lp === 1 && lv === 8) {
    return `
<h3>æ ¸å¿ƒç”»åƒ</h3>
<p>
ç”Ÿå‘½è·¯å¾„ <b>1</b> æ­é…æƒ…æ„Ÿæ•°å­— <b>8</b>ï¼Œæ˜¯ä¸€ç»„ã€Œå†…åœ¨å¼€åˆ›ã€æƒ…ç»ªç»è¥ã€çš„ç»„åˆã€‚
ä½ çš„äººç”Ÿä¸»çº¿æ˜¯ï¼šèµ°åœ¨å‰é¢ã€åšå†³å®šã€å¼€è·¯ï¼›åŒæ—¶åœ¨å…³ç³»ä¸æƒ…ç»ªä¸Šï¼Œåˆå¾ˆåœ¨æ„è´£ä»»ã€ç¨³å›ºå’Œå®é™…æˆæœã€‚
</p>

<h3>æ€§æ ¼ä¸å¤©èµ‹</h3>
<p>
<b>ç”Ÿå‘½è·¯å¾„ 1</b> ä»£è¡¨ä½ é€‚åˆå½“å‘èµ·è€…ä¸å¸¦å¤´çš„äººï¼š
</p>
<ul>
  <li>æ•¢å…ˆåŠ¨æ‰‹è¯•ï¼Œé‡åˆ°æ–°ä¸œè¥¿ä¹Ÿèƒ½å¾ˆå¿«ä¸Šæ‰‹ï¼›</li>
  <li>æœ‰è‡ªå·±çš„æƒ³æ³•ï¼Œä¸é€‚åˆå®Œå…¨ç…§ç€åˆ«äººæ¨¡å¼å¤åˆ¶ï¼›</li>
  <li>å–œæ¬¢çŸ¥é“æ–¹å‘ï¼Œä¸€æ—¦ç¡®å®šã€Œè¦è¿™æ ·åšã€ï¼Œå°±ä¼šç›´æ¥å†²ã€‚</li>
</ul>

<h3>æ„Ÿæƒ…ä¸å…³ç³»</h3>
<p>
<b>æƒ…æ„Ÿæ•°å­— 8</b> è®©ä½ åœ¨å…³ç³»é‡Œï¼Œå¾ˆéš¾åªè°ˆæ„Ÿè§‰ï¼Œä½ ä¼šçœ‹ï¼š
</p>
<ul>
  <li>å¯¹æ–¹æœ‰æ²¡æœ‰ä¸€èµ·æ‰¿æ‹…ç°å®ï¼ˆæ—¶é—´ã€é‡‘é’±ã€å®¶åŠ¡ã€æœªæ¥ï¼‰ï¼›</li>
  <li>å…³é”®æ—¶åˆ»æ„¿ä¸æ„¿æ„ç«™å‡ºæ¥ï¼Œè€Œä¸æ˜¯è®©ä½ ä¸€ä¸ªäººæ‰›ï¼›</li>
  <li>ä¸¤ä¸ªäººæ˜¯ä¸æ˜¯åœ¨å¾€åŒä¸€ä¸ªç›®æ ‡èµ°ã€‚</li>
</ul>

<h3>ä¼˜åŠ¿ä¸ç›²ç‚¹</h3>
<p><b>ä¼˜åŠ¿ï¼š</b></p>
<ul>
  <li>æ–¹å‘æ„Ÿå¼ºï¼Œèƒ½å¤Ÿå¸¦ç€å›¢é˜Ÿæˆ–å®¶åº­å¾€å‰èµ°ï¼›</li>
  <li>å¯¹ç›®æ ‡ã€æ•°å­—ã€æˆæœå¾ˆæ•æ„Ÿï¼Œé€‚åˆåšå†³ç­–ä¸è§„åˆ’ï¼›</li>
  <li>æŠ—å‹æ€§ä¸é”™ï¼Œé‡åˆ°äº‹ä¼šå…ˆæƒ³åŠæ³•ï¼Œè€Œä¸æ˜¯é©¬ä¸Šæ”¾å¼ƒã€‚</li>
</ul>
<p><b>ç›²ç‚¹ï¼š</b></p>
<ul>
  <li>ä¹ æƒ¯è‡ªå·±æ‰›å¤ªå¤šï¼Œä¹…äº†ä¼šè§‰å¾—ã€Œæ²¡æœ‰äººå¯ä»¥ä¾é ã€ã€‚</li>
  <li>å®¹æ˜“æŠŠè‡ªæˆ‘ä»·å€¼ç»‘åœ¨æˆç»©æˆ–æ”¶å…¥ä¸Šã€‚</li>
  <li>ä¸»å¯¼æ„Ÿå¤ªå¼ºæ—¶ï¼Œåˆ«äººä¼šè§‰å¾—ã€Œè¢«ç®¡ç†ã€å¤šè¿‡ã€Œè¢«æ”¯æŒã€ã€‚</li>
</ul>

<h3>é˜¶æ®µè¯¾é¢˜ä¸ç–—æ„ˆ</h3>
<p>
è¿™ä¸€ç»„æ•°å­—çš„è¯¾é¢˜ï¼Œæ˜¯ç»ƒä¹ ã€Œåœ¨ä¿æŒé¢†å¯¼åŠ›çš„åŒæ—¶ï¼Œä¹Ÿå…è®¸è‡ªå·±è¢«æ”¯æŒã€ã€‚
ä¸æ˜¯ä»€ä¹ˆéƒ½è‡ªå·±æ¥ï¼Œè€Œæ˜¯å­¦ä¼šï¼š
</p>
<ul>
  <li>æŠŠç›®æ ‡è®²æ¸…æ¥šï¼Œç„¶ååˆç†åˆ†å·¥ï¼›</li>
  <li>åœ¨å…³ç³»é‡Œæ‰¿è®¤ã€Œæˆ‘ä¹Ÿä¼šç´¯ã€æˆ‘ä¹Ÿéœ€è¦è¢«ç…§é¡¾ã€ï¼›</li>
  <li>æ¥å—ä¸å®Œç¾ç‰ˆæœ¬ï¼Œè€Œä¸æ˜¯ä¸€ç›´ç­‰ 100 åˆ†æ‰æ•¢äº¤ä»˜ã€‚</li>
</ul>

<h3>ä»Šæ—¥ï¼æœ¬å‘¨å¯æ‰§è¡Œ</h3>
<ul>
  <li><b>1ï¼‰é€‰ä¸€ä»¶æœ€é‡è¦å´è¢«ä½ æ‹–å»¶çš„äº‹ï¼Œç»™è‡ªå·± 25 åˆ†é’Ÿåªåšè¿™ä¸€ä»¶ã€‚</b></li>
  <li><b>2ï¼‰å†™ä¸‹ä¸€ä¸ªçŸ­æœŸç›®æ ‡ï¼‹å…·ä½“æ•°å­—ï¼š</b>ä¾‹å¦‚ã€Œæœ¬å‘¨å®Œæˆ 1 ä¸ªé¡µé¢ï¼æœ¬æœˆå®Œæˆ 3 æ¬¡æµ‹è¯•ã€ã€‚</li>
  <li><b>3ï¼‰åˆ»æ„æŠŠä¸€ä»¶å°äº‹äº¤ç»™åˆ«äººå¸®å¿™åšï¼Œä¸æ˜¯å› ä¸ºä½ åšä¸åˆ°ï¼Œè€Œæ˜¯ç»ƒä¹ å»ºç«‹ç³»ç»Ÿã€‚</li>
  <li><b>4ï¼‰å®‰æ’ 20 åˆ†é’Ÿã€Œéæ•ˆç‡æ—¶é—´ã€ï¼š</b>æ•£æ­¥ã€å‘å‘†æˆ–å¬æ­Œï¼Œä¸çœ‹æŠ¥è¡¨ã€ä¸çœ‹æ•°å­—ã€‚</li>
</ul>
    `;
  }

  // ===== æ—¥æ–‡ç‰ˆç»Ÿä¸€ç®€åŒ–ç‰ˆ =====
  if (isJa) {
    const tone = {
      1:'ä¸»ä½“æ€§ãƒ»ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã®æ•°å­—ã§ã™ã€‚ã²ã¨ã‚Šã§æŠ±ãˆè¾¼ã¿ã™ããªã„ã“ã¨ãŒãƒ†ãƒ¼ãƒã«ãªã‚Šã¾ã™ã€‚',
      2:'äººã®æ°—æŒã¡ã«æ•æ„Ÿã§ã€èª¿æ•´å½¹ã«ãªã‚Šã‚„ã™ã„ã‚¿ã‚¤ãƒ—ã§ã™ã€‚å¢ƒç•Œç·šã‚’å¼•ãã“ã¨ãŒå¤§åˆ‡ã§ã™ã€‚',
      3:'è¡¨ç¾åŠ›ã¨ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–ãªæ„Ÿæ€§ãŒè±Šã‹ãªæ•°å­—ã§ã™ã€‚æ¥½ã—ãã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã™ã‚‹ã¨é‹æ°—ãŒå‹•ãã¾ã™ã€‚',
      4:'å®‰å®šãƒ»åœŸå°ã¥ãã‚Šã®æ•°å­—ã§ã™ã€‚ã‚³ãƒ„ã‚³ãƒ„ç©ã¿ä¸Šã’ã‚‹åŠ›ãŒã‚ã‚‹ä¸€æ–¹ã€å¿ƒé…ã—ã™ãã«æ³¨æ„ã§ã™ã€‚',
      5:'å¤‰åŒ–ã¨è‡ªç”±ã‚’æ±‚ã‚ã‚‹æ¢æ¤œå®¶ã‚¿ã‚¤ãƒ—ã§ã™ã€‚æ–°ã—ã„ä½“é¨“ãŒãã®ã¾ã¾æˆé•·ã«ã¤ãªãŒã‚Šã¾ã™ã€‚',
      6:'è²¬ä»»æ„ŸãŒå¼·ãã€äººã‚’å®ˆã‚ã†ã¨ã™ã‚‹å„ªã—ã•ãŒã‚ã‚Šã¾ã™ã€‚ã¾ãšè‡ªåˆ†ã®ã‚±ã‚¢ãŒãƒ†ãƒ¼ãƒã§ã™ã€‚',
      7:'ç‰©äº‹ã‚’æ·±ãè€ƒãˆã‚‹ç ”ç©¶è€…ã‚¿ã‚¤ãƒ—ã§ã™ã€‚ç›´æ„Ÿã¨ãƒ­ã‚¸ãƒƒã‚¯ã®ä¸¡æ–¹ã‚’å¤§åˆ‡ã«ã™ã‚‹ã¨å®‰å®šã—ã¾ã™ã€‚',
      8:'é”æˆãƒ»ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆã®æ•°å­—ã§ã™ã€‚ç›®æ¨™è¨­å®šã¨ãƒšãƒ¼ã‚¹é…åˆ†ãŒéµã«ãªã‚Šã¾ã™ã€‚',
      9:'äººã®ç—›ã¿ã«å…±æ„Ÿã—ã‚„ã™ã„ãƒ’ãƒ¥ãƒ¼ãƒãƒ‹ã‚¹ãƒˆã§ã™ã€‚æŠ±ãˆè¾¼ã¿ã™ããšæ‰‹æ”¾ã™ã“ã¨ãŒèª²é¡Œã§ã™ã€‚',
      11:'ç›´æ„Ÿã¨ã‚¤ãƒ³ã‚¹ãƒ”ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒå¼·ã„ãƒã‚¹ã‚¿ãƒ¼ãƒŠãƒ³ãƒãƒ¼ã§ã™ã€‚åœ°ã«è¶³ã‚’ã¤ã‘ã‚‹ç¿’æ…£ãŒé‡è¦ã§ã™ã€‚',
      22:'å¤§ããªãƒ“ã‚¸ãƒ§ãƒ³ã‚’ç¾å®Ÿã«ã™ã‚‹åŠ›ã‚’æŒã¤ãƒã‚¹ã‚¿ãƒ¼ãƒŠãƒ³ãƒãƒ¼ã§ã™ã€‚ã‚¹ãƒ†ãƒƒãƒ—åˆ†ã‘ãŒæˆåŠŸãƒã‚¤ãƒ³ãƒˆã§ã™ã€‚',
      33:'ç™’ã—ã¨å¥‰ä»•ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒå¼·ã„æ•°å­—ã§ã™ã€‚è‡ªå·±çŠ ç‰²ã«ãªã‚‰ãªã„å¢ƒç•Œç·šã¥ãã‚ŠãŒãƒ†ãƒ¼ãƒã§ã™ã€‚'
    };
    const key = n => tone[n] || 'è‡ªåˆ†ã®ãƒšãƒ¼ã‚¹ã§ã€å°ã•ãªä¸€æ­©ã‚’ä¸å¯§ã«ç¶šã‘ã¦ã„ãã¾ã—ã‚‡ã†ã€‚';

    return `
<h3>ã‚³ã‚¢ã‚¤ãƒ¡ãƒ¼ã‚¸</h3>
<p>ãƒ©ã‚¤ãƒ•ãƒ‘ã‚¹ <b>${lp}</b>${isMaster(lp)?'ï¼ˆãƒã‚¹ã‚¿ãƒ¼ãƒŠãƒ³ãƒãƒ¼ï¼‰':''} ã¨æ„Ÿæƒ…ï¼æ‹æ„›ãƒŠãƒ³ãƒãƒ¼ <b>${lv}</b>${isMaster(lv)?'ï¼ˆãƒã‚¹ã‚¿ãƒ¼ãƒŠãƒ³ãƒãƒ¼ï¼‰':''} ã®çµ„ã¿åˆã‚ã›ã¯ã€ã‚ãªãŸã®é•·æœŸçš„ãªãƒ†ãƒ¼ãƒã¨ã€æ„Ÿæƒ…ãƒ»è¦ªå¯†ã•ã®æ‰±ã„æ–¹ã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚</p>

<h3>å¼·ã¿ã¨ãƒ–ãƒ©ã‚¤ãƒ³ãƒ‰ã‚¹ãƒãƒƒãƒˆ</h3>
<p>â€¢ ãƒ©ã‚¤ãƒ•ãƒ‘ã‚¹ï¼š${key(lp)}<br>â€¢ æ„Ÿæƒ…ï¼æ‹æ„›ï¼š${key(lv)}</p>

<h3>ä»Šæ—¥ã€œä»Šé€±ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</h3>
<p>â€¢ 25 åˆ†ã ã‘ã€Œä¸€ã¤ã®ã“ã¨ã ã‘ã«é›†ä¸­ã™ã‚‹æ™‚é–“ã€ã‚’ã¤ãã‚‹ã€‚<br>
â€¢ ç›´è¿‘ã®ç›®æ¨™ã‚’ 1 ã¤é¸ã³ã€ã€Œã„ã¤çµ‚ã‚ã‚Šã¨ã¿ãªã™ã‹ï¼ˆå®Œäº†æ¡ä»¶ï¼‰ã€ã‚’æ›¸ãå‡ºã™ã€‚<br>
â€¢ æ¯æ—¥ï¼æ¯é€±æ±ºã¾ã£ãŸæ™‚é–“ã«ã‚¢ãƒ©ãƒ¼ãƒ ã‚’ã‚»ãƒƒãƒˆã—ã€ã€Œãƒªã‚»ãƒƒãƒˆæ™‚é–“ã€ã¨ã—ã¦ä½¿ã†ã€‚</p>
    `;
  }

  // ===== æ³°è¯­é€šç”¨ç‰ˆ =====
  if (isTh) {
    const tone = {
      1:'à¹€à¸›à¹‡à¸™à¹€à¸¥à¸‚à¸‚à¸­à¸‡à¸œà¸¹à¹‰à¸™à¸³ à¸„à¸™à¸—à¸µà¹ˆà¸à¸¥à¹‰à¸²à¸•à¸±à¸”à¸ªà¸´à¸™à¹ƒà¸ˆà¹à¸¥à¸°à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™ à¹à¸•à¹ˆà¸•à¹‰à¸­à¸‡à¸£à¸°à¸§à¸±à¸‡à¹„à¸¡à¹ˆà¸—à¸³à¸—à¸¸à¸à¸­à¸¢à¹ˆà¸²à¸‡à¸„à¸™à¹€à¸”à¸µà¸¢à¸§à¸ˆà¸™à¹€à¸«à¸™à¸·à¹ˆà¸­à¸¢à¹€à¸à¸´à¸™à¹„à¸›',
      2:'à¸­à¹ˆà¸­à¸™à¹‚à¸¢à¸™ à¹€à¸‚à¹‰à¸²à¹ƒà¸ˆà¸„à¸™à¸­à¸·à¹ˆà¸™à¹€à¸à¹ˆà¸‡ à¹€à¸«à¸¡à¸²à¸°à¸à¸±à¸šà¸à¸²à¸£à¸›à¸£à¸°à¸ªà¸²à¸™à¸‡à¸²à¸™ à¹à¸•à¹ˆà¸•à¹‰à¸­à¸‡à¸¡à¸µà¸‚à¸­à¸šà¹€à¸‚à¸•à¸—à¸µà¹ˆà¸Šà¸±à¸”à¹€à¸ˆà¸™à¹€à¸à¸·à¹ˆà¸­à¹„à¸¡à¹ˆà¹ƒà¸«à¹‰à¹‚à¸”à¸™à¸”à¸¹à¸”à¸à¸¥à¸±à¸‡',
      3:'à¸£à¸±à¸à¸à¸²à¸£à¸ªà¸·à¹ˆà¸­à¸ªà¸²à¸£à¹à¸¥à¸°à¸ªà¸£à¹‰à¸²à¸‡à¸ªà¸£à¸£à¸„à¹Œ à¸–à¹‰à¸²à¹„à¸”à¹‰à¸à¸¹à¸” à¹€à¸‚à¸µà¸¢à¸™ à¸«à¸£à¸·à¸­à¹€à¸¥à¹ˆà¸²à¹€à¸£à¸·à¹ˆà¸­à¸‡ à¸à¸¥à¸±à¸‡à¸‡à¸²à¸™à¸ˆà¸°à¹„à¸«à¸¥à¸¥à¸·à¹ˆà¸™à¸¡à¸²à¸',
      4:'à¸Šà¸­à¸šà¸„à¸§à¸²à¸¡à¸¡à¸±à¹ˆà¸™à¸„à¸‡à¹à¸¥à¸°à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡ à¹€à¸«à¸¡à¸²à¸°à¸à¸±à¸šà¸‡à¸²à¸™à¸§à¸²à¸‡à¸£à¸°à¸šà¸š à¹à¸•à¹ˆà¸•à¹‰à¸­à¸‡à¸£à¸°à¸§à¸±à¸‡à¸„à¸§à¸²à¸¡à¸à¸±à¸‡à¸§à¸¥à¹à¸¥à¸°à¸„à¸§à¸²à¸¡à¹€à¸›à¹Šà¸°à¹€à¸à¸´à¸™à¹„à¸›',
      5:'à¸Šà¸­à¸šà¸à¸²à¸£à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹à¸›à¸¥à¸‡à¹à¸¥à¸°à¸­à¸´à¸ªà¸£à¸° à¹€à¸•à¸´à¸šà¹‚à¸•à¹„à¸”à¹‰à¸”à¸µà¹€à¸¡à¸·à¹ˆà¸­à¸¡à¸µà¹‚à¸­à¸à¸²à¸ªà¸¥à¸­à¸‡à¸ªà¸´à¹ˆà¸‡à¹ƒà¸«à¸¡à¹ˆ à¹† à¹à¸•à¹ˆà¸„à¸§à¸£à¸¡à¸µ routine à¹€à¸¥à¹‡à¸ à¹† à¹€à¸›à¹‡à¸™à¸à¸²à¸™',
      6:'à¹ƒà¸ªà¹ˆà¹ƒà¸ˆà¸„à¸£à¸­à¸šà¸„à¸£à¸±à¸§à¹à¸¥à¸°à¸„à¸™à¸£à¸­à¸šà¸•à¸±à¸§à¸¡à¸²à¸ à¹€à¸›à¹‡à¸™à¸œà¸¹à¹‰à¹ƒà¸«à¹‰à¹‚à¸”à¸¢à¸˜à¸£à¸£à¸¡à¸Šà¸²à¸•à¸´ à¹à¸•à¹ˆà¸•à¹‰à¸­à¸‡à¹€à¸£à¸µà¸¢à¸™à¸£à¸¹à¹‰à¸à¸²à¸£à¸”à¸¹à¹à¸¥à¸•à¸±à¸§à¹€à¸­à¸‡à¸à¹ˆà¸­à¸™',
      7:'à¸„à¸´à¸”à¸¥à¸¶à¸ à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œà¹€à¸à¹ˆà¸‡ à¸ªà¸™à¹ƒà¸ˆà¸„à¹‰à¸™à¸«à¸²à¸„à¸§à¸²à¸¡à¸ˆà¸£à¸´à¸‡à¸—à¸±à¹‰à¸‡à¸ à¸²à¸¢à¹ƒà¸™à¹à¸¥à¸°à¸ à¸²à¸¢à¸™à¸­à¸ à¸•à¹‰à¸­à¸‡à¸šà¸²à¸¥à¸²à¸™à¸‹à¹Œà¹€à¸«à¸•à¸¸à¸œà¸¥à¸à¸±à¸šà¸ªà¸±à¸à¸Šà¸²à¸•à¸à¸²à¸“',
      8:'à¹‚à¸Ÿà¸à¸±à¸ªà¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œ à¸„à¸§à¸²à¸¡à¸ªà¸³à¹€à¸£à¹‡à¸ˆ à¹à¸¥à¸°à¸•à¸±à¸§à¹€à¸¥à¸‚à¹€à¸à¹ˆà¸‡ à¹€à¸«à¸¡à¸²à¸°à¸à¸±à¸šà¸‡à¸²à¸™à¸šà¸£à¸´à¸«à¸²à¸£à¹à¸¥à¸°à¸à¸²à¸£à¹€à¸‡à¸´à¸™ à¹à¸•à¹ˆà¸•à¹‰à¸­à¸‡à¸«à¸²à¹€à¸§à¸¥à¸²à¸à¸±à¸à¸­à¸¢à¹ˆà¸²à¸‡à¸ˆà¸£à¸´à¸‡à¸ˆà¸±à¸‡',
      9:'à¹€à¸¡à¸•à¸•à¸² à¸¡à¸­à¸‡à¸ à¸²à¸à¸£à¸§à¸¡ à¹à¸¥à¸°à¸Šà¸­à¸šà¸Šà¹ˆà¸§à¸¢à¹€à¸«à¸¥à¸·à¸­à¸„à¸™à¸­à¸·à¹ˆà¸™ à¸£à¸°à¸§à¸±à¸‡à¹€à¸à¹‡à¸šà¸—à¸¸à¸à¸­à¸¢à¹ˆà¸²à¸‡à¸¡à¸²à¹ƒà¸ªà¹ˆà¹ƒà¸ˆà¸ˆà¸™à¹ƒà¸ˆà¸¥à¹‰à¸²',
      11:'à¸­à¸´à¸™à¸—à¸¹à¸­à¸´à¸Šà¸±à¸™à¹à¸£à¸‡ à¸£à¸±à¸šà¸à¸¥à¸±à¸‡à¸£à¸­à¸šà¸•à¸±à¸§à¹„à¸”à¹‰à¹„à¸§ à¸•à¹‰à¸­à¸‡à¸¡à¸µà¸à¸·à¹‰à¸™à¸—à¸µà¹ˆà¸ªà¸‡à¸šà¹à¸¥à¸°à¸à¸´à¸ˆà¸§à¸±à¸•à¸£à¸—à¸µà¹ˆà¸Šà¹ˆà¸§à¸¢ ground à¸•à¸±à¸§à¹€à¸­à¸‡',
      22:'à¸¡à¸µà¸à¸¥à¸±à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¸ªà¸´à¹ˆà¸‡à¹ƒà¸«à¸à¹ˆ à¹† à¹ƒà¸«à¹‰à¹€à¸›à¹‡à¸™à¸£à¸¹à¸›à¸˜à¸£à¸£à¸¡ à¸•à¹‰à¸­à¸‡à¹ƒà¸Šà¹‰à¹à¸œà¸™à¸—à¸µà¸¥à¸°à¸‚à¸±à¹‰à¸™à¹€à¸à¸·à¹ˆà¸­à¹„à¸¡à¹ˆà¹ƒà¸«à¹‰à¸à¸”à¸”à¸±à¸™à¸•à¸±à¸§à¹€à¸­à¸‡à¹€à¸à¸´à¸™à¹„à¸›',
      33:'à¸¡à¸µà¸à¸¥à¸±à¸‡à¸à¸²à¸£à¹€à¸¢à¸µà¸¢à¸§à¸¢à¸²à¹à¸¥à¸°à¸à¸²à¸£à¹ƒà¸«à¹‰à¸ªà¸¹à¸‡à¸¡à¸²à¸ à¸•à¹‰à¸­à¸‡à¸£à¸°à¸§à¸±à¸‡à¹„à¸¡à¹ˆà¹€à¸ªà¸µà¸¢à¸ªà¸¥à¸°à¸•à¸±à¸§à¹€à¸­à¸‡à¸ˆà¸™à¸«à¸¡à¸”à¹à¸£à¸‡'
    };
    const key = n => tone[n] || 'à¸„à¹ˆà¸­à¸¢ à¹† à¹€à¸”à¸´à¸™à¹„à¸›à¸—à¸µà¸¥à¸°à¸à¹‰à¸²à¸§ à¹€à¸¥à¸·à¸­à¸à¸ˆà¸±à¸‡à¸«à¸§à¸°à¸—à¸µà¹ˆà¸•à¸±à¸§à¹€à¸­à¸‡à¸ªà¸šà¸²à¸¢à¹ƒà¸ˆà¹à¸¥à¸°à¸£à¸¹à¹‰à¸ªà¸¶à¸à¸›à¸¥à¸­à¸”à¸ à¸±à¸¢';

    return `
<h3>à¸ à¸²à¸à¸£à¸§à¸¡à¸•à¸±à¸§à¸•à¸™</h3>
<p>à¸§à¸±à¸™à¹€à¸”à¸·à¸­à¸™à¸›à¸µà¹€à¸à¸´à¸”: ${iso}</p>
<p>à¹€à¸¥à¸‚à¹€à¸ªà¹‰à¸™à¸—à¸²à¸‡à¸Šà¸µà¸§à¸´à¸• <b>${lp}</b>${isMaster(lp)?' (Master Number)':''} + à¹€à¸¥à¸‚à¸”à¹‰à¸²à¸™à¸­à¸²à¸£à¸¡à¸“à¹Œ / à¸„à¸§à¸²à¸¡à¸£à¸±à¸ <b>${lv}</b>${isMaster(lv)?' (Master Number)':''}
à¸ªà¸°à¸—à¹‰à¸­à¸™à¸˜à¸µà¸¡à¸Šà¸µà¸§à¸´à¸•à¸«à¸¥à¸±à¸à¹à¸¥à¸°à¸ªà¹„à¸•à¸¥à¹Œà¸à¸²à¸£à¹à¸ªà¸”à¸‡à¸­à¸­à¸à¸—à¸²à¸‡à¸„à¸§à¸²à¸¡à¸£à¸¹à¹‰à¸ªà¸¶à¸à¸‚à¸­à¸‡à¸„à¸¸à¸“</p>

<h3>à¸ˆà¸¸à¸”à¹à¸‚à¹‡à¸‡à¹à¸¥à¸°à¸ˆà¸¸à¸”à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸£à¸°à¸§à¸±à¸‡</h3>
<p>â€¢ à¹€à¸ªà¹‰à¸™à¸—à¸²à¸‡à¸Šà¸µà¸§à¸´à¸•: ${key(lp)}<br>
â€¢ à¸”à¹‰à¸²à¸™à¸­à¸²à¸£à¸¡à¸“à¹Œ / à¸„à¸§à¸²à¸¡à¸£à¸±à¸: ${key(lv)}</p>

<h3>à¸ªà¸´à¹ˆà¸‡à¸—à¸µà¹ˆà¸—à¸³à¹„à¸”à¹‰à¸§à¸±à¸™à¸™à¸µà¹‰ / à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œà¸™à¸µà¹‰</h3>
<ul>
  <li>à¸à¸±à¸™à¹€à¸§à¸¥à¸² 20â€“25 à¸™à¸²à¸—à¸µ à¹‚à¸Ÿà¸à¸±à¸ªà¸à¸±à¸šà¸‡à¸²à¸™à¸«à¸™à¸¶à¹ˆà¸‡à¸­à¸¢à¹ˆà¸²à¸‡à¸—à¸µà¹ˆà¸ªà¸³à¸„à¸±à¸à¸ªà¸³à¸«à¸£à¸±à¸šà¸„à¸¸à¸“</li>
  <li>à¹€à¸‚à¸µà¸¢à¸™à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢à¸ªà¸±à¹‰à¸™ à¹† 1 à¸‚à¹‰à¸­ à¸à¸£à¹‰à¸­à¸¡à¸™à¸´à¸¢à¸²à¸¡à¸§à¹ˆà¸² â€œà¹€à¸ªà¸£à¹‡à¸ˆà¹à¸¥à¹‰à¸§â€ à¸ªà¸³à¸«à¸£à¸±à¸šà¸„à¸¸à¸“à¸„à¸·à¸­à¸«à¸™à¹‰à¸²à¸•à¸²à¹à¸šà¸šà¹„à¸«à¸™</li>
  <li>à¹€à¸¥à¸·à¸­à¸à¹€à¸§à¸¥à¸²à¸•à¸²à¸¢à¸•à¸±à¸§à¹ƒà¸™à¹à¸•à¹ˆà¸¥à¸°à¸§à¸±à¸™à¸«à¸£à¸·à¸­à¹à¸•à¹ˆà¸¥à¸°à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œ à¹€à¸›à¹‡à¸™à¸Šà¹ˆà¸§à¸‡à¹€à¸§à¸¥à¸²à¸ªà¸³à¸«à¸£à¸±à¸š reset à¹ƒà¸ˆà¹à¸¥à¸°à¸£à¹ˆà¸²à¸‡à¸à¸²à¸¢</li>
</ul>
    `;
  }

  // ===== é©¬æ¥è¯­é€šç”¨ç‰ˆ =====
  if (isMs) {
    const tone = {
      1:'Nombor pemula dan pemimpin; anda suka memulakan, tetapi jangan memikul semua beban seorang diri.',
      2:'Lembut, mudah bekerjasama dan sensitif; anda perlukan sempadan yang sihat untuk jaga tenaga sendiri.',
      3:'Ekspresif dan kreatif; anda jelas apabila menulis, bercakap atau berkongsi idea dengan orang lain.',
      4:'Sistematik dan suka kestabilan; sesuai untuk bina struktur dan proses, cuma elak terlalu perfeksionis.',
      5:'Suka kebebasan dan perubahan; berkembang melalui pengalaman baru, dengan rutin ringkas sebagai asas.',
      6:'Suka menjaga keluarga dan orang sekeliling; penting untuk belajar sayang diri sendiri dahulu.',
      7:'Analitik dan intuitif; anda mencari makna yang lebih dalam dalam hidup dan perlukan masa bersendirian.',
      8:'Berorientasikan pencapaian dan hasil; bijak mengurus wang dan projek, tapi jangan abaikan rehat.',
      9:'Berhati besar dan penyayang; mudah tersentuh dengan cerita orang lain, perlu masa rehat emosi yang cukup.',
      11:'Intuitif dan visionari; perlukan struktur harian yang stabil dan sempadan tenaga yang jelas.',
      22:'Pembina skala besar; mampu menjadikan visi besar kepada realiti melalui langkah kecil yang konsisten.',
      33:'Cenderung menyembuh dan berkhidmat; perlu elak corak mengorbankan diri secara berlebihan.'
    };
    const key = n => tone[n] || 'Teruskan melangkah dengan langkah kecil yang konsisten dan penuh kesedaran.';

    return `
<h3>Profil Teras</h3>
<p>Tarikh lahir: ${iso}</p>
<p>Nombor Life Path <b>${lp}</b>${isMaster(lp)?' (Master Number)':''} + Nombor Cinta <b>${lv}</b>${isMaster(lv)?' (Master Number)':''}
menerangkan tema hidup utama dan gaya emosi / keintiman anda.</p>

<h3>Kekuatan & Titik Buta</h3>
<p>â€¢ Life Path: ${key(lp)}<br>
â€¢ Nombor Cinta: ${key(lv)}</p>

<h3>Tindakan Untuk Hari Ini / Minggu Ini</h3>
<ul>
  <li>Peruntukkan 20â€“25 minit untuk fokus pada satu tugas penting sahaja.</li>
  <li>Tulis satu matlamat ringkas dan jelaskan rupa â€œsiapâ€ bagi anda.</li>
  <li>Pilih satu waktu tetap setiap hari atau minggu sebagai masa reset emosi dan mental.</li>
</ul>
    `;
  }

  // ===== è‹±æ–‡ç‰¹ä¾‹ï¼š3 / 3 ç»„åˆï¼Œç”¨é•¿ç‰ˆï¼ˆé zh / ja / th / msï¼‰ =====
  if (!isZh && !isJa && !isTh && !isMs && lp === 3 && lv === 3) {
    return `
<h3>Core Pattern</h3>
<p>
With Life Path <b>3</b> and Love Number <b>3</b>, you are a doubleâ€“expression type.
Your long-term drive and your emotional style both run through speaking, writing,
sharing, and creating. When you can turn your inner world into words, stories or
creative output, your system starts to relax and your energy flows.
</p>
<p>
When people give you space to be yourself and actually listen, you naturally light up:
ideas come quickly, images are vivid, and you can often say one sentence that
shifts the whole mood. When you feel ignored or shut down for too long, this
same energy can collapse inward into self-doubt, overthinking, or simply not
wanting to talk anymore.
</p>

<h3>Personality & Talents</h3>
<p>
Life Path <b>3</b> makes you a natural communicator. You are good at:
</p>
<ul>
  <li>turning complex or heavy topics into something people can understand;</li>
  <li>using stories, jokes, or metaphors to soften tense situations;</li>
  <li>learning by explaining â€” the more you talk it through, the clearer it becomes.</li>
</ul>
<p>
You are not meant to be a silent worker in the corner.
Your growth comes from <b>creating and sharing</b> â€” even if it feels imperfect at first.
When you allow yourself to â€œpublish messyâ€, your skill and confidence grow very fast.
</p>

<h3>Love & Emotional Style</h3>
<p>
With Love Number <b>3</b>, emotional connection for you means:
</p>
<ul>
  <li>talking about daily details, not just big events;</li>
  <li>sharing how you feel in the moment, not storing everything inside;</li>
  <li>having someone who can listen, respond, and play with ideas together.</li>
</ul>
<p>
You donâ€™t need drama; you need <b>responsive presence</b>.
If a partner keeps dismissing, interrupting, or changing the topic,
you may start with over-explaining, then suddenly go quiet and pull back.
</p>
<p>
Your key practice here is <b>clean, simple emotional language</b>:
instead of pouring everything out at once, start with sentences like
â€œI feel a bit overloaded right now, can we slow down?â€ or
â€œI feel unseen when this happensâ€¦â€.
This keeps 3-energy expressive without burning you out.
</p>

<h3>Strengths & Blind Spots</h3>
<p><b>Strengths</b></p>
<ul>
  <li>Strong verbal / written expression; you can â€œtranslateâ€ between worlds.</li>
  <li>Creative problem-solving â€” you see multiple angles and options.</li>
  <li>Natural mood-shifter: your presence, humour, or honesty changes the room.</li>
  <li>Integration through sharing: talking or writing things out is your real thinking process.</li>
</ul>
<p><b>Watch-outs</b></p>
<ul>
  <li>Too many ideas, not enough completion â€” projects can pile up at 60â€“80% done.</li>
  <li>Emotional state tied too strongly to feedback and reactions from others.</li>
  <li>When misunderstood, you may talk faster or more, which makes people shut down.</li>
</ul>

<h3>Current Lesson</h3>
<p>
The big lesson for a 3-3 pattern is not â€œtalk lessâ€, but
<b>give your expression structure</b>.
Clear containers â€” one page, one topic, one time block â€” turn your talent into
results instead of mental overload.
</p>

<h3>Action Steps for This Week</h3>
<ul>
  <li>
    Choose <b>one</b> thing you care about and give it a 25-minute no-distraction sprint.
    No multi-tasking, no perfecting â€” just move it forward.
  </li>
  <li>
    Define what â€œdoneâ€ means for a small project
    (for example: â€œthree short sections and one call-to-action buttonâ€).
  </li>
  <li>
    Start a 3-line daily note: todayâ€™s observation, one thing you are grateful for,
    and one thing that is bothering you.
  </li>
  <li>
    Practice one clean sentence when emotions rise:
    â€œI need a moment to sort my thoughts before I answer.â€
  </li>
</ul>
    `;
  }

  // ===== ä¸­æ–‡é€šç”¨ç‰ˆï¼ˆå…¶ä»–ç»„åˆï¼‰=====
  if (isZh) {
    const tone = {
      1:'ç‹¬ç«‹ / å¼€åˆ›ï¼Œè¡ŒåŠ¨åŠ›å¼ºï¼Œè¦è®°å¾—è¾¹å†²è¾¹å¤ç›˜ã€‚',
      2:'æ¸©å’Œ / åä½œï¼Œé€‚åˆåšåè°ƒè€…ï¼Œä½†è¦ä¿æŠ¤å¥½è‡ªå·±çš„ç•Œçº¿ã€‚',
      3:'è¡¨è¾¾ / åˆ›æ„ï¼Œè¶Šè¾“å‡ºè¶Šæ¸…æ™°ï¼Œé¿å…åªæƒ³ä¸åšã€‚',
      4:'ç§©åº / ç¨³å›ºï¼Œé€‚åˆæ­å»ºç³»ç»Ÿï¼Œå°å¿ƒå®Œç¾ä¸»ä¹‰å¡ä½è‡ªå·±ã€‚',
      5:'å˜åŒ– / æ¢ç´¢ï¼Œéœ€è¦è‡ªç”±ï¼Œä¹Ÿéœ€è¦ä¸€ç‚¹ç‚¹è‡ªå¾‹æ¥å®ˆä½åº•çº¿ã€‚',
      6:'ç…§é¡¾ / è´£ä»»ï¼Œå¤©ç”Ÿä¼šä¸ºåˆ«äººç€æƒ³ï¼Œå…ˆç…§é¡¾å¥½è‡ªå·±æ‰èµ°å¾—è¿œã€‚',
      7:'æ´å¯Ÿ / ç ”ç©¶ï¼Œæƒ³å¾ˆå¤šï¼Œé€‚åˆæ·±åº¦åˆ†æï¼Œä¹Ÿè¦ç›¸ä¿¡èº«ä½“æ„Ÿå—ã€‚',
      8:'æˆå°± / ç®¡ç†ï¼Œç›®æ ‡æ„Ÿå¼ºï¼Œå­¦ä¹ ã€Œä¸æ˜¯æ‰€æœ‰äº‹éƒ½è¦ç°åœ¨å®Œæˆã€ã€‚',
      9:'å…±æƒ… / å¤§å±€ï¼Œå®¹æ˜“ä¸ºåˆ«äººä»˜å‡ºï¼Œä¹Ÿè¦ç»ƒä¹ è½»è½»æ”¾æ‰‹ã€‚',
      11:'çµæ„Ÿ / è§‰å¯Ÿï¼Œå¤©çº¿å¾ˆæ•é”ï¼Œéœ€è¦ç¨³å®šçš„ç”Ÿæ´»èŠ‚å¥æ¥è½åœ°ã€‚',
      22:'å®è§‚ / è½åœ°ï¼Œå¤§è®¡åˆ’çš„æ‰§è¡Œè€…ï¼Œç”¨å°æ­¥éª¤æ¥æ‹†å¤§æ„¿æ™¯ã€‚',
      33:'ç–—æ„ˆ / æœåŠ¡ï¼Œå¾ˆæƒ³å¸®äººï¼Œä¹Ÿè¦å…ˆè®©è‡ªå·±å¤„åœ¨è¢«æ»‹å…»çš„ä½ç½®ã€‚'
    };
    const key = n => tone[n] || 'ä¿æŒèŠ‚å¾‹ä¸ä¸“æ³¨ï¼ŒæŒç»­å°æ­¥å¿«è·‘ã€‚';

    return `
<h3>æ ¸å¿ƒç”»åƒ</h3>
<p>å‡ºç”Ÿæ—¥æœŸï¼š${iso}</p>
<p>ç”Ÿå‘½è·¯å¾„ <b>${lp}</b>${isMaster(lp)?'ï¼ˆå¤§å¸ˆæ•°å­—ï¼‰':''} ï¼‹ æƒ…æ„Ÿæ•°å­— <b>${lv}</b>${isMaster(lv)?'ï¼ˆå¤§å¸ˆæ•°å­—ï¼‰':''}ï¼Œä»£è¡¨ä½ çš„äººç”Ÿä¸»é¢˜ä¸æƒ…ç»ªè¡¨è¾¾æ–¹å¼å¦‚ä½•äº’ç›¸å½±å“ã€‚</p>

<h3>ä¼˜åŠ¿ä¸ç›²ç‚¹</h3>
<p>â€¢ ç”Ÿå‘½è·¯å¾„ï¼š${key(lp)}<br>â€¢ æƒ…æ„Ÿæ•°å­—ï¼š${key(lv)}</p>

<h3>ä»Šæ—¥ / æœ¬å‘¨å¯æ‰§è¡Œ</h3>
<ul>
  <li>ç”¨ 25 åˆ†é’Ÿåªåšä¸€ä»¶å¯¹ä½ æ¥è¯´é‡è¦çš„å°ä»»åŠ¡ã€‚</li>
  <li>å†™ä¸‹ä¸€ä¸ªå…·ä½“ç›®æ ‡ï¼Œå¹¶æ ‡è®°ã€Œåšåˆ°ä»€ä¹ˆç¨‹åº¦å°±ç®—å®Œæˆã€ã€‚</li>
  <li>å®‰æ’ä¸€ä¸ªå›ºå®šæ—¶é—´æ®µï¼ˆæ¯å¤©æˆ–æ¯å‘¨åŒä¸€æ—¶é—´ï¼‰ï¼Œå½“ä½œè‡ªå·±çš„ reset ä»ªå¼ã€‚</li>
</ul>
    `;
  }

  // ===== å…¶ä»–è¯­è¨€ï¼šè‹±æ–‡å…œåº• =====
  const tone = {
    1:'Independent / pioneering â€” move fast, but remember to review and adjust.',
    2:'Gentle / cooperative â€” set boundaries so your energy is not drained.',
    3:'Expressive / creative â€” share your ideas regularly to stay in flow.',
    4:'Structured / practical â€” break long-term goals into weekly checklists.',
    5:'Dynamic / curious â€” grow through change, but keep a simple routine as an anchor.',
    6:'Caring / responsible â€” care for yourself first, then for the world.',
    7:'Analytical / intuitive â€” let data and intuition work together.',
    8:'Ambitious / strategic â€” keep goals measurable and your rhythm steady.',
    9:'Compassionate / big-picture â€” protect alone-time to recharge.',
    11:'Highly intuitive and visionary, needs good energetic boundaries.',
    22:'Big-scale builder who can turn vision into concrete impact.',
    33:'Healing, teaching, and service-oriented, but must avoid self-sacrifice.'
  };
  const key = n => tone[n] || 'Keep your rhythm and focus, and continue with small consistent steps.';

  return `
<h3>Core Profile</h3>
<p>Birth date: ${iso}</p>
<p>Life Path <b>${lp}</b>${isMaster(lp)?' (Master Number)':''} + Love Number <b>${lv}</b>${isMaster(lv)?' (Master Number)':''} describe your main life drive and your emotional / intimacy style.</p>

<h3>Strengths & Blind Spots</h3>
<p>â€¢ Life Path: ${key(lp)}<br>
â€¢ Love Number: ${key(lv)}</p>

<h3>Action Steps for Today / This Week</h3>
<ul>
  <li>Block 25 minutes for a single-focus sprint on one meaningful task.</li>
  <li>Write down one clear goal and what â€œdoneâ€ looks like for you.</li>
  <li>Choose a fixed time each day or week as your reset ritual.</li>
</ul>
  `;
}

/* ===== ç™»å½•/æ³¨å†Œï¼ˆå ä½ï¼‰ ===== */
async function safeJson(resp){
  try{return await resp.json();}catch{return {ok:false,msg:'upstream_error'};}
}
async function loginFlow(email,password){
  try{
    const res = await safeJson(await fetch(`${API_BASE}/api/login`,{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({email,password})
    }));
    if(res.ok){
      localStorage.setItem('vipEmail',res.email||email);
      alert('ç™»å½•æˆåŠŸ');
      return;
    }
    if(res.msg==='no_account') return showErr('è´¦æˆ·ä¸å­˜åœ¨');
    if(res.msg==='wrong_pwd') return showErr('å¯†ç é”™è¯¯');
    showErr('ç™»å½•å¤±è´¥ï¼š'+(res.msg||''));
  }catch(e){
    showErr('ç½‘ç»œé”™è¯¯ï¼š'+e.message);
  }
}
async function registerFlow(email,password){
  try{
    const res = await safeJson(await fetch(`${API_BASE}/api/register`,{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({email,password})
    }));
    if(res.ok){
      alert('æ³¨å†ŒæˆåŠŸï¼è¯·ç™»å½•ã€‚');
      return;
    }
    showErr('æ³¨å†Œå¤±è´¥ï¼š'+(res.msg||'')); 
  }catch(e){
    showErr('ç½‘ç»œé”™è¯¯ï¼š'+e.message);
  }
}

/* ===== Chatï¼šå®Œå…¨æœ¬åœ°ï¼Œä¸è°ƒç”¨ API ===== */
function localChatReply(text, lang){
  const msg = (text || '').trim();
  if (!msg) return '';

  if (lang === 'en') {
    return `Iâ€™m offline on this page, so Iâ€™m not calling the AI server.\n\n` +
           `But I did receive your message:\nâ€œ${msg}â€\n\n` +
           `You can still use the Numerology result above as a reference and reflect on it.`;
  }

  if (lang === 'ja') {
    return `ã“ã®ãƒšãƒ¼ã‚¸ã§ã¯ã‚µãƒ¼ãƒãƒ¼å´ã®AIå‘¼ã³å‡ºã—ã‚’åœæ­¢ã—ã¦ã„ã¾ã™ã€‚\n\n` +
           `ä»Šã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã¡ã‚ƒã‚“ã¨å—ã‘å–ã‚Šã¾ã—ãŸï¼š\nã€Œ${msg}ã€\n\n` +
           `ä¸Šã®æ•°ç§˜çµæœã‚’å‚è€ƒã«ã—ãªãŒã‚‰ã€è‡ªåˆ†ã®ãƒšãƒ¼ã‚¹ã§æŒ¯ã‚Šè¿”ã£ã¦ã¿ã¦ãã ã•ã„ã­ã€‚`;
  }

  if (lang === 'th') {
    return `à¸«à¸™à¹‰à¸²à¸™à¸µà¹‰à¸›à¸´à¸”à¸à¸²à¸£à¹€à¸£à¸µà¸¢à¸à¹ƒà¸Šà¹‰ AI à¸à¸±à¹ˆà¸‡à¹€à¸‹à¸´à¸£à¹Œà¸Ÿà¹€à¸§à¸­à¸£à¹Œà¹„à¸§à¹‰à¹à¸¥à¹‰à¸§\n\n` +
           `à¸‰à¸±à¸™à¹„à¸”à¹‰à¸£à¸±à¸šà¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸‚à¸­à¸‡à¸„à¸¸à¸“à¸§à¹ˆà¸²:\nâ€œ${msg}â€\n\n` +
           `à¸¥à¸­à¸‡à¸”à¸¹à¸œà¸¥à¸•à¸±à¸§à¹€à¸¥à¸‚à¸”à¹‰à¸²à¸™à¸šà¸™à¹à¸¥à¹‰à¸§à¹ƒà¸Šà¹‰à¹€à¸›à¹‡à¸™à¹à¸™à¸§à¸—à¸²à¸‡à¸ªà¸°à¸—à¹‰à¸­à¸™à¸•à¸±à¸§à¹€à¸­à¸‡à¹„à¸”à¹‰à¹€à¸¥à¸¢à¸„à¹ˆà¸°`;
  }

  if (lang === 'ms') {
    return `Pada halaman ini, panggilan AI ke server telah dimatikan.\n\n` +
           `Saya sudah menerima mesej anda:\nâ€œ${msg}â€\n\n` +
           `Anda boleh gunakan keputusan numerologi di atas sebagai rujukan untuk refleksi.`;
  }

  if (lang === 'zh-TW') {
    return `é€™å€‹é é¢å·²ç¶“é—œé–‰é›²ç«¯ AI å‘¼å«ï¼Œæ‰€ä»¥ä¸æœƒå†æ¶ˆè€—é¡åº¦ã€‚\n\n` +
           `ä½ çš„è¨Šæ¯æˆ‘æœ‰æ”¶åˆ°ï¼š\nã€Œ${msg}ã€\n\n` +
           `å¯ä»¥æ­é…ä¸Šé¢çš„éˆæ•¸çµæœï¼Œè‡ªå·±æ…¢æ…¢æ•´ç†èˆ‡è¦ºå¯Ÿã€‚`;
  }

  // zh-CN + é»˜è®¤
  return `è¿™ä¸ªé¡µé¢å·²ç»å…³æ‰äº‘ç«¯ AI è°ƒç”¨ï¼Œä¸ä¼šå†æ¶ˆè€—é¢åº¦ã€‚\n\n` +
         `ä½ çš„è®¯æ¯æˆ‘æœ‰æ”¶åˆ°ï¼š\nã€Œ${msg}ã€\n\n` +
         `å¯ä»¥æ­é…ä¸Šé¢çš„çµæ•°ç»“æœï¼Œè‡ªå·±æ…¢æ…¢æ•´ç†ä¸è§‰å¯Ÿã€‚`;
}
    
/* ===== åˆå§‹åŒ– ===== */
function initLangUI(){
  const select  = gid('langSelect');
  const current = getLang();

  if (select) {
    select.value = current;
    select.addEventListener('change', () => {
      setLang(select.value);
      applyI18n();
      applyChatI18n();

      // å¦‚æœå·²ç»æœ‰ä¸€ä»½ numerology ç»“æœï¼Œåˆ‡æ¢è¯­è¨€æ—¶æœ¬åœ°é‡æ–°æ¸²æŸ“
      if (window.lastNumCtx) {
        const payload = window.lastNumCtx;
        const resultSec = gid('result');
        if (resultSec) resultSec.style.display = 'block';

        // ä¸ŠåŠéƒ¨ï¼šæ•°å­—ç®€è¯„
        renderProReport(payload);

        // ä¸‹åŠéƒ¨ï¼šæœ¬åœ°ã€Œå¿ƒæ€œç®¡å®¶è§£è¯»ã€
        const wrap = ensureRootStructure();
        wrap.querySelectorAll('.sec.ai-block').forEach(s => s.remove());
        const sec = document.createElement('div');
        sec.className = 'sec ai-block';
        sec.innerHTML = `<h3>${t('ai_title')}</h3>
          <div class="ai-content">${localNumerologyInsight(payload)}</div>`;
        wrap.appendChild(sec);
      }
    });
  }

  applyI18n();
}

function initAuthHandlers(){
  gid('loginForm')?.addEventListener('submit', async (e)=>{
    e.preventDefault();
    const email=gid('email').value;
    const pwd=gid('password').value;
    if(!email||!pwd){showErr('è¯·å¡«å†™é‚®ç®±å’Œå¯†ç ');return;}
    await loginFlow(email,pwd);
  });
  gid('registerForm')?.addEventListener('submit', async (e)=>{
    e.preventDefault();
    const email=gid('email').value;
    const pwd=gid('password').value;
    if(!email||!pwd){showErr('è¯·å¡«å†™é‚®ç®±å’Œå¯†ç ');return;}
    if(pwd.length<8){showErr('å¯†ç è‡³å°‘éœ€è¦8ä½å­—ç¬¦');return;}
    await registerFlow(email,pwd);
  });
  gid('resetBtn')?.addEventListener('click', ()=>alert('å¯†ç é‡ç½®åŠŸèƒ½å³å°†å¼€æ”¾'));
}

document.addEventListener('DOMContentLoaded', () => {
  initLangUI();
  ensureRootStructure();
  initAuthHandlers();

  const bd  = gid('birthdate');
  const btn = gid('btnGen');

  if (bd && !bd.value) {
    const today = new Date();
    bd.value = today.toISOString().split('T')[0];
  }

  function generateNow() {
    const iso = bd ? bd.value : '';
    if (!iso) {
      showErr(getLang() === 'en' ? 'Please select your birth date.' : 'è¯·é€‰æ‹©å‡ºç”Ÿæ—¥æœŸ');
      return;
    }
    hideErr();

    const lp = calcLifePath(iso);
    const lv = calcLoveNumber(iso);
    if (!lp || !lv) {
      showErr(getLang() === 'en' ? 'Invalid date format.' : 'æ—¥æœŸæ ¼å¼é”™è¯¯ï¼Œè¯·æ£€æŸ¥è¾“å…¥');
      return;
    }

    const resultSec = gid('result');
    if (resultSec) resultSec.style.display = 'block';

    const payload = { iso, lp, lv };
    window.lastNumCtx = payload;

    // ä¸ŠåŠéƒ¨ï¼šæ•°å­—ç®€è¯„ï¼ˆåŸºç¡€ä¿¡æ¯ + ç”Ÿå‘½è·¯å¾„ + æƒ…æ„Ÿæ•°å­—ï¼‰
    renderProReport(payload);

    // ä¸‹åŠéƒ¨ï¼šæœ¬åœ°ç”Ÿæˆã€Œå¿ƒæ€œç®¡å®¶è§£è¯»ã€ï¼Œå®Œå…¨ä¸æ‰“ API
    const wrap = ensureRootStructure();
    wrap.querySelectorAll('.sec.ai-block').forEach(s => s.remove());
    const sec = document.createElement('div');
    sec.className = 'sec ai-block';
    sec.innerHTML = `<h3>${t('ai_title')}</h3>
      <div class="ai-content">${localNumerologyInsight(payload)}</div>`;
    wrap.appendChild(sec);

    resultSec?.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }

  if (btn) {
    btn.addEventListener('click', generateNow);
  }
  if (bd) {
    bd.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') generateNow();
    });
  }

/* ========== XINLIAN BUTLER FLOAT CHAT (Worker) ========== */
const chatFab   = gid("ssChatFab");
const chatPanel = gid("chatPanel");
const chatClose = gid("chatClose");
const chatBody  = gid("chatBody");
const chatInput = gid("chatInput");
const chatSend  = gid("chatSend");

let butlerHistory = [];

function resetButlerSystemPrompt(){
  const lang = getLang();
  // ä½ ä¹Ÿå¯ä»¥æ”¹æˆæ›´å¼ºçš„ system prompt
  butlerHistory = [{
    role: "system",
    content:
      `You are Xinlian Butler, a helpful numerology assistant for 5XLiving. ` +
      `Reply in language code: ${lang}. ` +
      `Be concise, practical, and friendly.`
  }];
}

function setChatOpen(open){
  if (!chatPanel) return;
  chatPanel.style.display = open ? "block" : "none";   // âœ… show/hide
  chatPanel.setAttribute("aria-hidden", open ? "false" : "true");

  // greet once
  if (open && chatBody && !chatBody.dataset.inited){
    chatBody.dataset.inited = "1";
    appendButler(t("chat_welcome"), false);
  }
}

function toggleChat(force){
  if (!chatPanel) return;
  const isOpen = chatPanel.getAttribute("aria-hidden") === "false";
  const next = (typeof force === "boolean") ? force : !isOpen;
  setChatOpen(next);
}

function appendButler(text, me=false){
  if (!chatBody) return;
  const div = document.createElement("div");
  div.className = "ss-msg" + (me ? " me" : "");
  div.textContent = String(text ?? "");
  chatBody.appendChild(div);
  chatBody.scrollTop = chatBody.scrollHeight;
}

function buildNumerologyContext(){
  const p = window.lastNumCtx;
  if (!p) return "";
  return [
    "Numerology context:",
    `- Birth date: ${p.iso}`,
    `- Life Path: ${p.lp}`,
    `- Love Number: ${p.lv}`
  ].join("\n");
}

async function butlerCallWorker(messages){
  const url = API_BASE + CHAT_ENDPOINT;
  const res = await fetch(url, {
    method: "POST",
    headers: {"Content-Type":"application/json"},
    body: JSON.stringify({
      messages,
      meta: {
        module: "numerology_butler",
        lang: getLang(),
        page: "numerology"
      }
    })
  });

  if (!res.ok){
    const txt = await res.text().catch(()=>res.statusText);
    throw new Error(txt || res.statusText);
  }
  const data = await res.json();
  return (data.reply || data.text || data.choices?.[0]?.message?.content || "").trim();
}

function initButlerChat(){
  if (!chatPanel || !chatBody || !chatInput || !chatSend || !chatFab) return;

  resetButlerSystemPrompt();

  // start hidden
  setChatOpen(false);

  chatFab.addEventListener("click", ()=>toggleChat());
  chatClose?.addEventListener("click", ()=>toggleChat(false));

  chatSend.addEventListener("click", async ()=>{
    const text = (chatInput.value || "").trim();
    if (!text) return;

    appendButler(text, true);
    chatInput.value = "";

    // âœ… attach numerology context (not tarot)
    const ctx = buildNumerologyContext();
    const userMsg = ctx ? `${ctx}\n\nUser: ${text}` : text;

    butlerHistory.push({role:"user", content:userMsg});
    appendButler("â€¦", false);
    const last = chatBody.lastElementChild;

    try{
      const reply = await butlerCallWorker(butlerHistory);
      if (last) last.textContent = reply;
      butlerHistory.push({role:"assistant", content:reply});
    }catch(err){
      if (last) last.textContent = `Error: ${String(err?.message || err)}`;
    }
  });

  chatInput.addEventListener("keydown", (e)=>{
    if (e.key === "Enter") chatSend.click();
  });
}

/* ========== INIT ========== */
document.addEventListener("DOMContentLoaded", ()=>{
  // keep your existing init calls ABOVE this if they are valid
  applyI18n();
  applyChatI18n();

  // âœ… do NOT call initHeaderScroll/initDrawButton/initShare here (they don't exist on this page)
  initButlerChat();
});

})();
</script>
</body>  
</html>  

